(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function cx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ux={exports:{}},Cc={},dx={exports:{}},Te={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var So=Symbol.for("react.element"),_N=Symbol.for("react.portal"),wN=Symbol.for("react.fragment"),SN=Symbol.for("react.strict_mode"),CN=Symbol.for("react.profiler"),kN=Symbol.for("react.provider"),EN=Symbol.for("react.context"),AN=Symbol.for("react.forward_ref"),RN=Symbol.for("react.suspense"),MN=Symbol.for("react.memo"),PN=Symbol.for("react.lazy"),oh=Symbol.iterator;function TN(e){return e===null||typeof e!="object"?null:(e=oh&&e[oh]||e["@@iterator"],typeof e=="function"?e:null)}var mx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fx=Object.assign,hx={};function ll(e,t,n){this.props=e,this.context=t,this.refs=hx,this.updater=n||mx}ll.prototype.isReactComponent={};ll.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ll.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function px(){}px.prototype=ll.prototype;function Lm(e,t,n){this.props=e,this.context=t,this.refs=hx,this.updater=n||mx}var $m=Lm.prototype=new px;$m.constructor=Lm;fx($m,ll.prototype);$m.isPureReactComponent=!0;var ih=Array.isArray,xx=Object.prototype.hasOwnProperty,Dm={current:null},gx={key:!0,ref:!0,__self:!0,__source:!0};function vx(e,t,n){var r,a={},l=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(l=""+t.key),t)xx.call(t,r)&&!gx.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var i=Array(c),u=0;u<c;u++)i[u]=arguments[u+2];a.children=i}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:So,type:e,key:l,ref:o,props:a,_owner:Dm.current}}function ON(e,t){return{$$typeof:So,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Fm(e){return typeof e=="object"&&e!==null&&e.$$typeof===So}function IN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ch=/\/+/g;function ou(e,t){return typeof e=="object"&&e!==null&&e.key!=null?IN(""+e.key):t.toString(36)}function xi(e,t,n,r,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case So:case _N:o=!0}}if(o)return o=e,a=a(o),e=r===""?"."+ou(o,0):r,ih(a)?(n="",e!=null&&(n=e.replace(ch,"$&/")+"/"),xi(a,t,n,"",function(u){return u})):a!=null&&(Fm(a)&&(a=ON(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(ch,"$&/")+"/")+e)),t.push(a)),1;if(o=0,r=r===""?".":r+":",ih(e))for(var c=0;c<e.length;c++){l=e[c];var i=r+ou(l,c);o+=xi(l,t,n,i,a)}else if(i=TN(e),typeof i=="function")for(e=i.call(e),c=0;!(l=e.next()).done;)l=l.value,i=r+ou(l,c++),o+=xi(l,t,n,i,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Vo(e,t,n){if(e==null)return e;var r=[],a=0;return xi(e,r,"","",function(l){return t.call(n,l,a++)}),r}function LN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var un={current:null},gi={transition:null},$N={ReactCurrentDispatcher:un,ReactCurrentBatchConfig:gi,ReactCurrentOwner:Dm};function bx(){throw Error("act(...) is not supported in production builds of React.")}Te.Children={map:Vo,forEach:function(e,t,n){Vo(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Vo(e,function(){t++}),t},toArray:function(e){return Vo(e,function(t){return t})||[]},only:function(e){if(!Fm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Te.Component=ll;Te.Fragment=wN;Te.Profiler=CN;Te.PureComponent=Lm;Te.StrictMode=SN;Te.Suspense=RN;Te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$N;Te.act=bx;Te.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=fx({},e.props),a=e.key,l=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,o=Dm.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(i in t)xx.call(t,i)&&!gx.hasOwnProperty(i)&&(r[i]=t[i]===void 0&&c!==void 0?c[i]:t[i])}var i=arguments.length-2;if(i===1)r.children=n;else if(1<i){c=Array(i);for(var u=0;u<i;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:So,type:e.type,key:a,ref:l,props:r,_owner:o}};Te.createContext=function(e){return e={$$typeof:EN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kN,_context:e},e.Consumer=e};Te.createElement=vx;Te.createFactory=function(e){var t=vx.bind(null,e);return t.type=e,t};Te.createRef=function(){return{current:null}};Te.forwardRef=function(e){return{$$typeof:AN,render:e}};Te.isValidElement=Fm;Te.lazy=function(e){return{$$typeof:PN,_payload:{_status:-1,_result:e},_init:LN}};Te.memo=function(e,t){return{$$typeof:MN,type:e,compare:t===void 0?null:t}};Te.startTransition=function(e){var t=gi.transition;gi.transition={};try{e()}finally{gi.transition=t}};Te.unstable_act=bx;Te.useCallback=function(e,t){return un.current.useCallback(e,t)};Te.useContext=function(e){return un.current.useContext(e)};Te.useDebugValue=function(){};Te.useDeferredValue=function(e){return un.current.useDeferredValue(e)};Te.useEffect=function(e,t){return un.current.useEffect(e,t)};Te.useId=function(){return un.current.useId()};Te.useImperativeHandle=function(e,t,n){return un.current.useImperativeHandle(e,t,n)};Te.useInsertionEffect=function(e,t){return un.current.useInsertionEffect(e,t)};Te.useLayoutEffect=function(e,t){return un.current.useLayoutEffect(e,t)};Te.useMemo=function(e,t){return un.current.useMemo(e,t)};Te.useReducer=function(e,t,n){return un.current.useReducer(e,t,n)};Te.useRef=function(e){return un.current.useRef(e)};Te.useState=function(e){return un.current.useState(e)};Te.useSyncExternalStore=function(e,t,n){return un.current.useSyncExternalStore(e,t,n)};Te.useTransition=function(){return un.current.useTransition()};Te.version="18.3.1";dx.exports=Te;var M=dx.exports;const Vm=cx(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DN=M,FN=Symbol.for("react.element"),VN=Symbol.for("react.fragment"),zN=Object.prototype.hasOwnProperty,HN=DN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UN={key:!0,ref:!0,__self:!0,__source:!0};function yx(e,t,n){var r,a={},l=null,o=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)zN.call(t,r)&&!UN.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:FN,type:e,key:l,ref:o,props:a,_owner:HN.current}}Cc.Fragment=VN;Cc.jsx=yx;Cc.jsxs=yx;ux.exports=Cc;var s=ux.exports,ld={},Nx={exports:{}},Pn={},jx={exports:{}},_x={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(I,O){var F=I.length;I.push(O);e:for(;0<F;){var U=F-1>>>1,B=I[U];if(0<a(B,O))I[U]=O,I[F]=B,F=U;else break e}}function n(I){return I.length===0?null:I[0]}function r(I){if(I.length===0)return null;var O=I[0],F=I.pop();if(F!==O){I[0]=F;e:for(var U=0,B=I.length,Z=B>>>1;U<Z;){var ee=2*(U+1)-1,ce=I[ee],oe=ee+1,Y=I[oe];if(0>a(ce,F))oe<B&&0>a(Y,ce)?(I[U]=Y,I[oe]=F,U=oe):(I[U]=ce,I[ee]=F,U=ee);else if(oe<B&&0>a(Y,F))I[U]=Y,I[oe]=F,U=oe;else break e}}return O}function a(I,O){var F=I.sortIndex-O.sortIndex;return F!==0?F:I.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var i=[],u=[],m=1,h=null,f=3,g=!1,b=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(I){for(var O=n(u);O!==null;){if(O.callback===null)r(u);else if(O.startTime<=I)r(u),O.sortIndex=O.expirationTime,t(i,O);else break;O=n(u)}}function N(I){if(w=!1,v(I),!b)if(n(i)!==null)b=!0,P(C);else{var O=n(u);O!==null&&L(N,O.startTime-I)}}function C(I,O){b=!1,w&&(w=!1,d(y),y=-1),g=!0;var F=f;try{for(v(O),h=n(i);h!==null&&(!(h.expirationTime>O)||I&&!k());){var U=h.callback;if(typeof U=="function"){h.callback=null,f=h.priorityLevel;var B=U(h.expirationTime<=O);O=e.unstable_now(),typeof B=="function"?h.callback=B:h===n(i)&&r(i),v(O)}else r(i);h=n(i)}if(h!==null)var Z=!0;else{var ee=n(u);ee!==null&&L(N,ee.startTime-O),Z=!1}return Z}finally{h=null,f=F,g=!1}}var j=!1,E=null,y=-1,R=5,$=-1;function k(){return!(e.unstable_now()-$<R)}function A(){if(E!==null){var I=e.unstable_now();$=I;var O=!0;try{O=E(!0,I)}finally{O?D():(j=!1,E=null)}}else j=!1}var D;if(typeof p=="function")D=function(){p(A)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,T=S.port2;S.port1.onmessage=A,D=function(){T.postMessage(null)}}else D=function(){x(A,0)};function P(I){E=I,j||(j=!0,D())}function L(I,O){y=x(function(){I(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,P(C))},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(i)},e.unstable_next=function(I){switch(f){case 1:case 2:case 3:var O=3;break;default:O=f}var F=f;f=O;try{return I()}finally{f=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(I,O){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var F=f;f=I;try{return O()}finally{f=F}},e.unstable_scheduleCallback=function(I,O,F){var U=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?U+F:U):F=U,I){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=F+B,I={id:m++,callback:O,priorityLevel:I,startTime:F,expirationTime:B,sortIndex:-1},F>U?(I.sortIndex=F,t(u,I),n(i)===null&&I===n(u)&&(w?(d(y),y=-1):w=!0,L(N,F-U))):(I.sortIndex=B,t(i,I),b||g||(b=!0,P(C))),I},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(I){var O=f;return function(){var F=f;f=O;try{return I.apply(this,arguments)}finally{f=F}}}})(_x);jx.exports=_x;var BN=jx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WN=M,Rn=BN;function ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wx=new Set,Bl={};function ua(e,t){za(e,t),za(e+"Capture",t)}function za(e,t){for(Bl[e]=t,e=0;e<t.length;e++)wx.add(t[e])}var Ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),od=Object.prototype.hasOwnProperty,GN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uh={},dh={};function YN(e){return od.call(dh,e)?!0:od.call(uh,e)?!1:GN.test(e)?dh[e]=!0:(uh[e]=!0,!1)}function qN(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function XN(e,t,n,r){if(t===null||typeof t>"u"||qN(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function dn(e,t,n,r,a,l,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=o}var Wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wt[e]=new dn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wt[t]=new dn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wt[e]=new dn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wt[e]=new dn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wt[e]=new dn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wt[e]=new dn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wt[e]=new dn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wt[e]=new dn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wt[e]=new dn(e,5,!1,e.toLowerCase(),null,!1,!1)});var zm=/[\-:]([a-z])/g;function Hm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(zm,Hm);Wt[t]=new dn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(zm,Hm);Wt[t]=new dn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(zm,Hm);Wt[t]=new dn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wt[e]=new dn(e,1,!1,e.toLowerCase(),null,!1,!1)});Wt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wt[e]=new dn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Um(e,t,n,r){var a=Wt.hasOwnProperty(t)?Wt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(XN(t,n,a,r)&&(n=null),r||a===null?YN(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ks=WN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zo=Symbol.for("react.element"),xa=Symbol.for("react.portal"),ga=Symbol.for("react.fragment"),Bm=Symbol.for("react.strict_mode"),id=Symbol.for("react.profiler"),Sx=Symbol.for("react.provider"),Cx=Symbol.for("react.context"),Wm=Symbol.for("react.forward_ref"),cd=Symbol.for("react.suspense"),ud=Symbol.for("react.suspense_list"),Gm=Symbol.for("react.memo"),ar=Symbol.for("react.lazy"),kx=Symbol.for("react.offscreen"),mh=Symbol.iterator;function dl(e){return e===null||typeof e!="object"?null:(e=mh&&e[mh]||e["@@iterator"],typeof e=="function"?e:null)}var dt=Object.assign,iu;function Sl(e){if(iu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);iu=t&&t[1]||""}return`
`+iu+e}var cu=!1;function uu(e,t){if(!e||cu)return"";cu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),l=r.stack.split(`
`),o=a.length-1,c=l.length-1;1<=o&&0<=c&&a[o]!==l[c];)c--;for(;1<=o&&0<=c;o--,c--)if(a[o]!==l[c]){if(o!==1||c!==1)do if(o--,c--,0>c||a[o]!==l[c]){var i=`
`+a[o].replace(" at new "," at ");return e.displayName&&i.includes("<anonymous>")&&(i=i.replace("<anonymous>",e.displayName)),i}while(1<=o&&0<=c);break}}}finally{cu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Sl(e):""}function QN(e){switch(e.tag){case 5:return Sl(e.type);case 16:return Sl("Lazy");case 13:return Sl("Suspense");case 19:return Sl("SuspenseList");case 0:case 2:case 15:return e=uu(e.type,!1),e;case 11:return e=uu(e.type.render,!1),e;case 1:return e=uu(e.type,!0),e;default:return""}}function dd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ga:return"Fragment";case xa:return"Portal";case id:return"Profiler";case Bm:return"StrictMode";case cd:return"Suspense";case ud:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Cx:return(e.displayName||"Context")+".Consumer";case Sx:return(e._context.displayName||"Context")+".Provider";case Wm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Gm:return t=e.displayName||null,t!==null?t:dd(e.type)||"Memo";case ar:t=e._payload,e=e._init;try{return dd(e(t))}catch{}}return null}function KN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dd(t);case 8:return t===Bm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ex(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ZN(e){var t=Ex(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,l.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ho(e){e._valueTracker||(e._valueTracker=ZN(e))}function Ax(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Ex(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ii(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function md(e,t){var n=t.checked;return dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function fh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=jr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Rx(e,t){t=t.checked,t!=null&&Um(e,"checked",t,!1)}function fd(e,t){Rx(e,t);var n=jr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?hd(e,t.type,n):t.hasOwnProperty("defaultValue")&&hd(e,t.type,jr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function hd(e,t,n){(t!=="number"||Ii(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Cl=Array.isArray;function Ta(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+jr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function pd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ie(91));return dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ph(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ie(92));if(Cl(n)){if(1<n.length)throw Error(ie(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:jr(n)}}function Mx(e,t){var n=jr(t.value),r=jr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function xh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Px(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Px(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Uo,Tx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Uo=Uo||document.createElement("div"),Uo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Uo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wl(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Tl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},JN=["Webkit","ms","Moz","O"];Object.keys(Tl).forEach(function(e){JN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Tl[t]=Tl[e]})});function Ox(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Tl.hasOwnProperty(e)&&Tl[e]?(""+t).trim():t+"px"}function Ix(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=Ox(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var ej=dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gd(e,t){if(t){if(ej[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ie(62))}}function vd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bd=null;function Ym(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yd=null,Oa=null,Ia=null;function gh(e){if(e=Eo(e)){if(typeof yd!="function")throw Error(ie(280));var t=e.stateNode;t&&(t=Mc(t),yd(e.stateNode,e.type,t))}}function Lx(e){Oa?Ia?Ia.push(e):Ia=[e]:Oa=e}function $x(){if(Oa){var e=Oa,t=Ia;if(Ia=Oa=null,gh(e),t)for(e=0;e<t.length;e++)gh(t[e])}}function Dx(e,t){return e(t)}function Fx(){}var du=!1;function Vx(e,t,n){if(du)return e(t,n);du=!0;try{return Dx(e,t,n)}finally{du=!1,(Oa!==null||Ia!==null)&&(Fx(),$x())}}function Gl(e,t){var n=e.stateNode;if(n===null)return null;var r=Mc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ie(231,t,typeof n));return n}var Nd=!1;if(Ws)try{var ml={};Object.defineProperty(ml,"passive",{get:function(){Nd=!0}}),window.addEventListener("test",ml,ml),window.removeEventListener("test",ml,ml)}catch{Nd=!1}function tj(e,t,n,r,a,l,o,c,i){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(m){this.onError(m)}}var Ol=!1,Li=null,$i=!1,jd=null,nj={onError:function(e){Ol=!0,Li=e}};function sj(e,t,n,r,a,l,o,c,i){Ol=!1,Li=null,tj.apply(nj,arguments)}function rj(e,t,n,r,a,l,o,c,i){if(sj.apply(this,arguments),Ol){if(Ol){var u=Li;Ol=!1,Li=null}else throw Error(ie(198));$i||($i=!0,jd=u)}}function da(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function zx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vh(e){if(da(e)!==e)throw Error(ie(188))}function aj(e){var t=e.alternate;if(!t){if(t=da(e),t===null)throw Error(ie(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return vh(a),e;if(l===r)return vh(a),t;l=l.sibling}throw Error(ie(188))}if(n.return!==r.return)n=a,r=l;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=l;break}if(c===r){o=!0,r=a,n=l;break}c=c.sibling}if(!o){for(c=l.child;c;){if(c===n){o=!0,n=l,r=a;break}if(c===r){o=!0,r=l,n=a;break}c=c.sibling}if(!o)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?e:t}function Hx(e){return e=aj(e),e!==null?Ux(e):null}function Ux(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ux(e);if(t!==null)return t;e=e.sibling}return null}var Bx=Rn.unstable_scheduleCallback,bh=Rn.unstable_cancelCallback,lj=Rn.unstable_shouldYield,oj=Rn.unstable_requestPaint,pt=Rn.unstable_now,ij=Rn.unstable_getCurrentPriorityLevel,qm=Rn.unstable_ImmediatePriority,Wx=Rn.unstable_UserBlockingPriority,Di=Rn.unstable_NormalPriority,cj=Rn.unstable_LowPriority,Gx=Rn.unstable_IdlePriority,kc=null,Cs=null;function uj(e){if(Cs&&typeof Cs.onCommitFiberRoot=="function")try{Cs.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var is=Math.clz32?Math.clz32:fj,dj=Math.log,mj=Math.LN2;function fj(e){return e>>>=0,e===0?32:31-(dj(e)/mj|0)|0}var Bo=64,Wo=4194304;function kl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,l=e.pingedLanes,o=n&268435455;if(o!==0){var c=o&~a;c!==0?r=kl(c):(l&=o,l!==0&&(r=kl(l)))}else o=n&~a,o!==0?r=kl(o):l!==0&&(r=kl(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-is(t),a=1<<n,r|=e[n],t&=~a;return r}function hj(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pj(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var o=31-is(l),c=1<<o,i=a[o];i===-1?(!(c&n)||c&r)&&(a[o]=hj(c,t)):i<=t&&(e.expiredLanes|=c),l&=~c}}function _d(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yx(){var e=Bo;return Bo<<=1,!(Bo&4194240)&&(Bo=64),e}function mu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Co(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-is(t),e[t]=n}function xj(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-is(n),l=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~l}}function Xm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-is(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Be=0;function qx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Xx,Qm,Qx,Kx,Zx,wd=!1,Go=[],mr=null,fr=null,hr=null,Yl=new Map,ql=new Map,or=[],gj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yh(e,t){switch(e){case"focusin":case"focusout":mr=null;break;case"dragenter":case"dragleave":fr=null;break;case"mouseover":case"mouseout":hr=null;break;case"pointerover":case"pointerout":Yl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ql.delete(t.pointerId)}}function fl(e,t,n,r,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[a]},t!==null&&(t=Eo(t),t!==null&&Qm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function vj(e,t,n,r,a){switch(t){case"focusin":return mr=fl(mr,e,t,n,r,a),!0;case"dragenter":return fr=fl(fr,e,t,n,r,a),!0;case"mouseover":return hr=fl(hr,e,t,n,r,a),!0;case"pointerover":var l=a.pointerId;return Yl.set(l,fl(Yl.get(l)||null,e,t,n,r,a)),!0;case"gotpointercapture":return l=a.pointerId,ql.set(l,fl(ql.get(l)||null,e,t,n,r,a)),!0}return!1}function Jx(e){var t=Vr(e.target);if(t!==null){var n=da(t);if(n!==null){if(t=n.tag,t===13){if(t=zx(n),t!==null){e.blockedOn=t,Zx(e.priority,function(){Qx(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Sd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);bd=r,n.target.dispatchEvent(r),bd=null}else return t=Eo(n),t!==null&&Qm(t),e.blockedOn=n,!1;t.shift()}return!0}function Nh(e,t,n){vi(e)&&n.delete(t)}function bj(){wd=!1,mr!==null&&vi(mr)&&(mr=null),fr!==null&&vi(fr)&&(fr=null),hr!==null&&vi(hr)&&(hr=null),Yl.forEach(Nh),ql.forEach(Nh)}function hl(e,t){e.blockedOn===t&&(e.blockedOn=null,wd||(wd=!0,Rn.unstable_scheduleCallback(Rn.unstable_NormalPriority,bj)))}function Xl(e){function t(a){return hl(a,e)}if(0<Go.length){hl(Go[0],e);for(var n=1;n<Go.length;n++){var r=Go[n];r.blockedOn===e&&(r.blockedOn=null)}}for(mr!==null&&hl(mr,e),fr!==null&&hl(fr,e),hr!==null&&hl(hr,e),Yl.forEach(t),ql.forEach(t),n=0;n<or.length;n++)r=or[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<or.length&&(n=or[0],n.blockedOn===null);)Jx(n),n.blockedOn===null&&or.shift()}var La=Ks.ReactCurrentBatchConfig,Vi=!0;function yj(e,t,n,r){var a=Be,l=La.transition;La.transition=null;try{Be=1,Km(e,t,n,r)}finally{Be=a,La.transition=l}}function Nj(e,t,n,r){var a=Be,l=La.transition;La.transition=null;try{Be=4,Km(e,t,n,r)}finally{Be=a,La.transition=l}}function Km(e,t,n,r){if(Vi){var a=Sd(e,t,n,r);if(a===null)ju(e,t,r,zi,n),yh(e,r);else if(vj(a,e,t,n,r))r.stopPropagation();else if(yh(e,r),t&4&&-1<gj.indexOf(e)){for(;a!==null;){var l=Eo(a);if(l!==null&&Xx(l),l=Sd(e,t,n,r),l===null&&ju(e,t,r,zi,n),l===a)break;a=l}a!==null&&r.stopPropagation()}else ju(e,t,r,null,n)}}var zi=null;function Sd(e,t,n,r){if(zi=null,e=Ym(r),e=Vr(e),e!==null)if(t=da(e),t===null)e=null;else if(n=t.tag,n===13){if(e=zx(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return zi=e,null}function eg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ij()){case qm:return 1;case Wx:return 4;case Di:case cj:return 16;case Gx:return 536870912;default:return 16}default:return 16}}var cr=null,Zm=null,bi=null;function tg(){if(bi)return bi;var e,t=Zm,n=t.length,r,a="value"in cr?cr.value:cr.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===a[l-r];r++);return bi=a.slice(e,1<r?1-r:void 0)}function yi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yo(){return!0}function jh(){return!1}function Tn(e){function t(n,r,a,l,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(l):l[c]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Yo:jh,this.isPropagationStopped=jh,this}return dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Yo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Yo)},persist:function(){},isPersistent:Yo}),t}var ol={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jm=Tn(ol),ko=dt({},ol,{view:0,detail:0}),jj=Tn(ko),fu,hu,pl,Ec=dt({},ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ef,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pl&&(pl&&e.type==="mousemove"?(fu=e.screenX-pl.screenX,hu=e.screenY-pl.screenY):hu=fu=0,pl=e),fu)},movementY:function(e){return"movementY"in e?e.movementY:hu}}),_h=Tn(Ec),_j=dt({},Ec,{dataTransfer:0}),wj=Tn(_j),Sj=dt({},ko,{relatedTarget:0}),pu=Tn(Sj),Cj=dt({},ol,{animationName:0,elapsedTime:0,pseudoElement:0}),kj=Tn(Cj),Ej=dt({},ol,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Aj=Tn(Ej),Rj=dt({},ol,{data:0}),wh=Tn(Rj),Mj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Oj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Tj[e])?!!t[e]:!1}function ef(){return Oj}var Ij=dt({},ko,{key:function(e){if(e.key){var t=Mj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Pj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ef,charCode:function(e){return e.type==="keypress"?yi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Lj=Tn(Ij),$j=dt({},Ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sh=Tn($j),Dj=dt({},ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ef}),Fj=Tn(Dj),Vj=dt({},ol,{propertyName:0,elapsedTime:0,pseudoElement:0}),zj=Tn(Vj),Hj=dt({},Ec,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Uj=Tn(Hj),Bj=[9,13,27,32],tf=Ws&&"CompositionEvent"in window,Il=null;Ws&&"documentMode"in document&&(Il=document.documentMode);var Wj=Ws&&"TextEvent"in window&&!Il,ng=Ws&&(!tf||Il&&8<Il&&11>=Il),Ch=" ",kh=!1;function sg(e,t){switch(e){case"keyup":return Bj.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var va=!1;function Gj(e,t){switch(e){case"compositionend":return rg(t);case"keypress":return t.which!==32?null:(kh=!0,Ch);case"textInput":return e=t.data,e===Ch&&kh?null:e;default:return null}}function Yj(e,t){if(va)return e==="compositionend"||!tf&&sg(e,t)?(e=tg(),bi=Zm=cr=null,va=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ng&&t.locale!=="ko"?null:t.data;default:return null}}var qj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Eh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qj[e.type]:t==="textarea"}function ag(e,t,n,r){Lx(r),t=Hi(t,"onChange"),0<t.length&&(n=new Jm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ll=null,Ql=null;function Xj(e){xg(e,0)}function Ac(e){var t=Na(e);if(Ax(t))return e}function Qj(e,t){if(e==="change")return t}var lg=!1;if(Ws){var xu;if(Ws){var gu="oninput"in document;if(!gu){var Ah=document.createElement("div");Ah.setAttribute("oninput","return;"),gu=typeof Ah.oninput=="function"}xu=gu}else xu=!1;lg=xu&&(!document.documentMode||9<document.documentMode)}function Rh(){Ll&&(Ll.detachEvent("onpropertychange",og),Ql=Ll=null)}function og(e){if(e.propertyName==="value"&&Ac(Ql)){var t=[];ag(t,Ql,e,Ym(e)),Vx(Xj,t)}}function Kj(e,t,n){e==="focusin"?(Rh(),Ll=t,Ql=n,Ll.attachEvent("onpropertychange",og)):e==="focusout"&&Rh()}function Zj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ac(Ql)}function Jj(e,t){if(e==="click")return Ac(t)}function e_(e,t){if(e==="input"||e==="change")return Ac(t)}function t_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ds=typeof Object.is=="function"?Object.is:t_;function Kl(e,t){if(ds(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!od.call(t,a)||!ds(e[a],t[a]))return!1}return!0}function Mh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ph(e,t){var n=Mh(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Mh(n)}}function ig(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ig(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cg(){for(var e=window,t=Ii();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ii(e.document)}return t}function nf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function n_(e){var t=cg(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ig(n.ownerDocument.documentElement,n)){if(r!==null&&nf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(r.start,a);r=r.end===void 0?l:Math.min(r.end,a),!e.extend&&l>r&&(a=r,r=l,l=a),a=Ph(n,l);var o=Ph(n,r);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var s_=Ws&&"documentMode"in document&&11>=document.documentMode,ba=null,Cd=null,$l=null,kd=!1;function Th(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;kd||ba==null||ba!==Ii(r)||(r=ba,"selectionStart"in r&&nf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$l&&Kl($l,r)||($l=r,r=Hi(Cd,"onSelect"),0<r.length&&(t=new Jm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ba)))}function qo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ya={animationend:qo("Animation","AnimationEnd"),animationiteration:qo("Animation","AnimationIteration"),animationstart:qo("Animation","AnimationStart"),transitionend:qo("Transition","TransitionEnd")},vu={},ug={};Ws&&(ug=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function Rc(e){if(vu[e])return vu[e];if(!ya[e])return e;var t=ya[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ug)return vu[e]=t[n];return e}var dg=Rc("animationend"),mg=Rc("animationiteration"),fg=Rc("animationstart"),hg=Rc("transitionend"),pg=new Map,Oh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){pg.set(e,t),ua(t,[e])}for(var bu=0;bu<Oh.length;bu++){var yu=Oh[bu],r_=yu.toLowerCase(),a_=yu[0].toUpperCase()+yu.slice(1);Ar(r_,"on"+a_)}Ar(dg,"onAnimationEnd");Ar(mg,"onAnimationIteration");Ar(fg,"onAnimationStart");Ar("dblclick","onDoubleClick");Ar("focusin","onFocus");Ar("focusout","onBlur");Ar(hg,"onTransitionEnd");za("onMouseEnter",["mouseout","mouseover"]);za("onMouseLeave",["mouseout","mouseover"]);za("onPointerEnter",["pointerout","pointerover"]);za("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var El="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),l_=new Set("cancel close invalid load scroll toggle".split(" ").concat(El));function Ih(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,rj(r,t,void 0,e),e.currentTarget=null}function xg(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var o=r.length-1;0<=o;o--){var c=r[o],i=c.instance,u=c.currentTarget;if(c=c.listener,i!==l&&a.isPropagationStopped())break e;Ih(a,c,u),l=i}else for(o=0;o<r.length;o++){if(c=r[o],i=c.instance,u=c.currentTarget,c=c.listener,i!==l&&a.isPropagationStopped())break e;Ih(a,c,u),l=i}}}if($i)throw e=jd,$i=!1,jd=null,e}function Ze(e,t){var n=t[Pd];n===void 0&&(n=t[Pd]=new Set);var r=e+"__bubble";n.has(r)||(gg(t,e,2,!1),n.add(r))}function Nu(e,t,n){var r=0;t&&(r|=4),gg(n,e,r,t)}var Xo="_reactListening"+Math.random().toString(36).slice(2);function Zl(e){if(!e[Xo]){e[Xo]=!0,wx.forEach(function(n){n!=="selectionchange"&&(l_.has(n)||Nu(n,!1,e),Nu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Xo]||(t[Xo]=!0,Nu("selectionchange",!1,t))}}function gg(e,t,n,r){switch(eg(t)){case 1:var a=yj;break;case 4:a=Nj;break;default:a=Km}n=a.bind(null,t,n,e),a=void 0,!Nd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function ju(e,t,n,r,a){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var i=o.tag;if((i===3||i===4)&&(i=o.stateNode.containerInfo,i===a||i.nodeType===8&&i.parentNode===a))return;o=o.return}for(;c!==null;){if(o=Vr(c),o===null)return;if(i=o.tag,i===5||i===6){r=l=o;continue e}c=c.parentNode}}r=r.return}Vx(function(){var u=l,m=Ym(n),h=[];e:{var f=pg.get(e);if(f!==void 0){var g=Jm,b=e;switch(e){case"keypress":if(yi(n)===0)break e;case"keydown":case"keyup":g=Lj;break;case"focusin":b="focus",g=pu;break;case"focusout":b="blur",g=pu;break;case"beforeblur":case"afterblur":g=pu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=_h;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=wj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Fj;break;case dg:case mg:case fg:g=kj;break;case hg:g=zj;break;case"scroll":g=jj;break;case"wheel":g=Uj;break;case"copy":case"cut":case"paste":g=Aj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Sh}var w=(t&4)!==0,x=!w&&e==="scroll",d=w?f!==null?f+"Capture":null:f;w=[];for(var p=u,v;p!==null;){v=p;var N=v.stateNode;if(v.tag===5&&N!==null&&(v=N,d!==null&&(N=Gl(p,d),N!=null&&w.push(Jl(p,N,v)))),x)break;p=p.return}0<w.length&&(f=new g(f,b,null,n,m),h.push({event:f,listeners:w}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",f&&n!==bd&&(b=n.relatedTarget||n.fromElement)&&(Vr(b)||b[Gs]))break e;if((g||f)&&(f=m.window===m?m:(f=m.ownerDocument)?f.defaultView||f.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=u,b=b?Vr(b):null,b!==null&&(x=da(b),b!==x||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=u),g!==b)){if(w=_h,N="onMouseLeave",d="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(w=Sh,N="onPointerLeave",d="onPointerEnter",p="pointer"),x=g==null?f:Na(g),v=b==null?f:Na(b),f=new w(N,p+"leave",g,n,m),f.target=x,f.relatedTarget=v,N=null,Vr(m)===u&&(w=new w(d,p+"enter",b,n,m),w.target=v,w.relatedTarget=x,N=w),x=N,g&&b)t:{for(w=g,d=b,p=0,v=w;v;v=ma(v))p++;for(v=0,N=d;N;N=ma(N))v++;for(;0<p-v;)w=ma(w),p--;for(;0<v-p;)d=ma(d),v--;for(;p--;){if(w===d||d!==null&&w===d.alternate)break t;w=ma(w),d=ma(d)}w=null}else w=null;g!==null&&Lh(h,f,g,w,!1),b!==null&&x!==null&&Lh(h,x,b,w,!0)}}e:{if(f=u?Na(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var C=Qj;else if(Eh(f))if(lg)C=e_;else{C=Zj;var j=Kj}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=Jj);if(C&&(C=C(e,u))){ag(h,C,n,m);break e}j&&j(e,f,u),e==="focusout"&&(j=f._wrapperState)&&j.controlled&&f.type==="number"&&hd(f,"number",f.value)}switch(j=u?Na(u):window,e){case"focusin":(Eh(j)||j.contentEditable==="true")&&(ba=j,Cd=u,$l=null);break;case"focusout":$l=Cd=ba=null;break;case"mousedown":kd=!0;break;case"contextmenu":case"mouseup":case"dragend":kd=!1,Th(h,n,m);break;case"selectionchange":if(s_)break;case"keydown":case"keyup":Th(h,n,m)}var E;if(tf)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else va?sg(e,n)&&(y="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(ng&&n.locale!=="ko"&&(va||y!=="onCompositionStart"?y==="onCompositionEnd"&&va&&(E=tg()):(cr=m,Zm="value"in cr?cr.value:cr.textContent,va=!0)),j=Hi(u,y),0<j.length&&(y=new wh(y,e,null,n,m),h.push({event:y,listeners:j}),E?y.data=E:(E=rg(n),E!==null&&(y.data=E)))),(E=Wj?Gj(e,n):Yj(e,n))&&(u=Hi(u,"onBeforeInput"),0<u.length&&(m=new wh("onBeforeInput","beforeinput",null,n,m),h.push({event:m,listeners:u}),m.data=E))}xg(h,t)})}function Jl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=Gl(e,n),l!=null&&r.unshift(Jl(e,l,a)),l=Gl(e,t),l!=null&&r.push(Jl(e,l,a))),e=e.return}return r}function ma(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Lh(e,t,n,r,a){for(var l=t._reactName,o=[];n!==null&&n!==r;){var c=n,i=c.alternate,u=c.stateNode;if(i!==null&&i===r)break;c.tag===5&&u!==null&&(c=u,a?(i=Gl(n,l),i!=null&&o.unshift(Jl(n,i,c))):a||(i=Gl(n,l),i!=null&&o.push(Jl(n,i,c)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var o_=/\r\n?/g,i_=/\u0000|\uFFFD/g;function $h(e){return(typeof e=="string"?e:""+e).replace(o_,`
`).replace(i_,"")}function Qo(e,t,n){if(t=$h(t),$h(e)!==t&&n)throw Error(ie(425))}function Ui(){}var Ed=null,Ad=null;function Rd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Md=typeof setTimeout=="function"?setTimeout:void 0,c_=typeof clearTimeout=="function"?clearTimeout:void 0,Dh=typeof Promise=="function"?Promise:void 0,u_=typeof queueMicrotask=="function"?queueMicrotask:typeof Dh<"u"?function(e){return Dh.resolve(null).then(e).catch(d_)}:Md;function d_(e){setTimeout(function(){throw e})}function _u(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),Xl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Xl(t)}function pr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var il=Math.random().toString(36).slice(2),ws="__reactFiber$"+il,eo="__reactProps$"+il,Gs="__reactContainer$"+il,Pd="__reactEvents$"+il,m_="__reactListeners$"+il,f_="__reactHandles$"+il;function Vr(e){var t=e[ws];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Gs]||n[ws]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Fh(e);e!==null;){if(n=e[ws])return n;e=Fh(e)}return t}e=n,n=e.parentNode}return null}function Eo(e){return e=e[ws]||e[Gs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Na(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ie(33))}function Mc(e){return e[eo]||null}var Td=[],ja=-1;function Rr(e){return{current:e}}function et(e){0>ja||(e.current=Td[ja],Td[ja]=null,ja--)}function Xe(e,t){ja++,Td[ja]=e.current,e.current=t}var _r={},Jt=Rr(_r),yn=Rr(!1),Zr=_r;function Ha(e,t){var n=e.type.contextTypes;if(!n)return _r;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Nn(e){return e=e.childContextTypes,e!=null}function Bi(){et(yn),et(Jt)}function Vh(e,t,n){if(Jt.current!==_r)throw Error(ie(168));Xe(Jt,t),Xe(yn,n)}function vg(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(ie(108,KN(e)||"Unknown",a));return dt({},n,r)}function Wi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_r,Zr=Jt.current,Xe(Jt,e),Xe(yn,yn.current),!0}function zh(e,t,n){var r=e.stateNode;if(!r)throw Error(ie(169));n?(e=vg(e,t,Zr),r.__reactInternalMemoizedMergedChildContext=e,et(yn),et(Jt),Xe(Jt,e)):et(yn),Xe(yn,n)}var Ds=null,Pc=!1,wu=!1;function bg(e){Ds===null?Ds=[e]:Ds.push(e)}function h_(e){Pc=!0,bg(e)}function Mr(){if(!wu&&Ds!==null){wu=!0;var e=0,t=Be;try{var n=Ds;for(Be=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Ds=null,Pc=!1}catch(a){throw Ds!==null&&(Ds=Ds.slice(e+1)),Bx(qm,Mr),a}finally{Be=t,wu=!1}}return null}var _a=[],wa=0,Gi=null,Yi=0,Dn=[],Fn=0,Jr=null,Vs=1,zs="";function $r(e,t){_a[wa++]=Yi,_a[wa++]=Gi,Gi=e,Yi=t}function yg(e,t,n){Dn[Fn++]=Vs,Dn[Fn++]=zs,Dn[Fn++]=Jr,Jr=e;var r=Vs;e=zs;var a=32-is(r)-1;r&=~(1<<a),n+=1;var l=32-is(t)+a;if(30<l){var o=a-a%5;l=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Vs=1<<32-is(t)+a|n<<a|r,zs=l+e}else Vs=1<<l|n<<a|r,zs=e}function sf(e){e.return!==null&&($r(e,1),yg(e,1,0))}function rf(e){for(;e===Gi;)Gi=_a[--wa],_a[wa]=null,Yi=_a[--wa],_a[wa]=null;for(;e===Jr;)Jr=Dn[--Fn],Dn[Fn]=null,zs=Dn[--Fn],Dn[Fn]=null,Vs=Dn[--Fn],Dn[Fn]=null}var En=null,kn=null,at=!1,ts=null;function Ng(e,t){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Hh(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,En=e,kn=pr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,En=e,kn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Jr!==null?{id:Vs,overflow:zs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,En=e,kn=null,!0):!1;default:return!1}}function Od(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Id(e){if(at){var t=kn;if(t){var n=t;if(!Hh(e,t)){if(Od(e))throw Error(ie(418));t=pr(n.nextSibling);var r=En;t&&Hh(e,t)?Ng(r,n):(e.flags=e.flags&-4097|2,at=!1,En=e)}}else{if(Od(e))throw Error(ie(418));e.flags=e.flags&-4097|2,at=!1,En=e}}}function Uh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;En=e}function Ko(e){if(e!==En)return!1;if(!at)return Uh(e),at=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Rd(e.type,e.memoizedProps)),t&&(t=kn)){if(Od(e))throw jg(),Error(ie(418));for(;t;)Ng(e,t),t=pr(t.nextSibling)}if(Uh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){kn=pr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}kn=null}}else kn=En?pr(e.stateNode.nextSibling):null;return!0}function jg(){for(var e=kn;e;)e=pr(e.nextSibling)}function Ua(){kn=En=null,at=!1}function af(e){ts===null?ts=[e]:ts.push(e)}var p_=Ks.ReactCurrentBatchConfig;function xl(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,e));var a=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(o){var c=a.refs;o===null?delete c[l]:c[l]=o},t._stringRef=l,t)}if(typeof e!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,e))}return e}function Zo(e,t){throw e=Object.prototype.toString.call(t),Error(ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Bh(e){var t=e._init;return t(e._payload)}function _g(e){function t(d,p){if(e){var v=d.deletions;v===null?(d.deletions=[p],d.flags|=16):v.push(p)}}function n(d,p){if(!e)return null;for(;p!==null;)t(d,p),p=p.sibling;return null}function r(d,p){for(d=new Map;p!==null;)p.key!==null?d.set(p.key,p):d.set(p.index,p),p=p.sibling;return d}function a(d,p){return d=br(d,p),d.index=0,d.sibling=null,d}function l(d,p,v){return d.index=v,e?(v=d.alternate,v!==null?(v=v.index,v<p?(d.flags|=2,p):v):(d.flags|=2,p)):(d.flags|=1048576,p)}function o(d){return e&&d.alternate===null&&(d.flags|=2),d}function c(d,p,v,N){return p===null||p.tag!==6?(p=Mu(v,d.mode,N),p.return=d,p):(p=a(p,v),p.return=d,p)}function i(d,p,v,N){var C=v.type;return C===ga?m(d,p,v.props.children,N,v.key):p!==null&&(p.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ar&&Bh(C)===p.type)?(N=a(p,v.props),N.ref=xl(d,p,v),N.return=d,N):(N=ki(v.type,v.key,v.props,null,d.mode,N),N.ref=xl(d,p,v),N.return=d,N)}function u(d,p,v,N){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=Pu(v,d.mode,N),p.return=d,p):(p=a(p,v.children||[]),p.return=d,p)}function m(d,p,v,N,C){return p===null||p.tag!==7?(p=Yr(v,d.mode,N,C),p.return=d,p):(p=a(p,v),p.return=d,p)}function h(d,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Mu(""+p,d.mode,v),p.return=d,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case zo:return v=ki(p.type,p.key,p.props,null,d.mode,v),v.ref=xl(d,null,p),v.return=d,v;case xa:return p=Pu(p,d.mode,v),p.return=d,p;case ar:var N=p._init;return h(d,N(p._payload),v)}if(Cl(p)||dl(p))return p=Yr(p,d.mode,v,null),p.return=d,p;Zo(d,p)}return null}function f(d,p,v,N){var C=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return C!==null?null:c(d,p,""+v,N);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zo:return v.key===C?i(d,p,v,N):null;case xa:return v.key===C?u(d,p,v,N):null;case ar:return C=v._init,f(d,p,C(v._payload),N)}if(Cl(v)||dl(v))return C!==null?null:m(d,p,v,N,null);Zo(d,v)}return null}function g(d,p,v,N,C){if(typeof N=="string"&&N!==""||typeof N=="number")return d=d.get(v)||null,c(p,d,""+N,C);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case zo:return d=d.get(N.key===null?v:N.key)||null,i(p,d,N,C);case xa:return d=d.get(N.key===null?v:N.key)||null,u(p,d,N,C);case ar:var j=N._init;return g(d,p,v,j(N._payload),C)}if(Cl(N)||dl(N))return d=d.get(v)||null,m(p,d,N,C,null);Zo(p,N)}return null}function b(d,p,v,N){for(var C=null,j=null,E=p,y=p=0,R=null;E!==null&&y<v.length;y++){E.index>y?(R=E,E=null):R=E.sibling;var $=f(d,E,v[y],N);if($===null){E===null&&(E=R);break}e&&E&&$.alternate===null&&t(d,E),p=l($,p,y),j===null?C=$:j.sibling=$,j=$,E=R}if(y===v.length)return n(d,E),at&&$r(d,y),C;if(E===null){for(;y<v.length;y++)E=h(d,v[y],N),E!==null&&(p=l(E,p,y),j===null?C=E:j.sibling=E,j=E);return at&&$r(d,y),C}for(E=r(d,E);y<v.length;y++)R=g(E,d,y,v[y],N),R!==null&&(e&&R.alternate!==null&&E.delete(R.key===null?y:R.key),p=l(R,p,y),j===null?C=R:j.sibling=R,j=R);return e&&E.forEach(function(k){return t(d,k)}),at&&$r(d,y),C}function w(d,p,v,N){var C=dl(v);if(typeof C!="function")throw Error(ie(150));if(v=C.call(v),v==null)throw Error(ie(151));for(var j=C=null,E=p,y=p=0,R=null,$=v.next();E!==null&&!$.done;y++,$=v.next()){E.index>y?(R=E,E=null):R=E.sibling;var k=f(d,E,$.value,N);if(k===null){E===null&&(E=R);break}e&&E&&k.alternate===null&&t(d,E),p=l(k,p,y),j===null?C=k:j.sibling=k,j=k,E=R}if($.done)return n(d,E),at&&$r(d,y),C;if(E===null){for(;!$.done;y++,$=v.next())$=h(d,$.value,N),$!==null&&(p=l($,p,y),j===null?C=$:j.sibling=$,j=$);return at&&$r(d,y),C}for(E=r(d,E);!$.done;y++,$=v.next())$=g(E,d,y,$.value,N),$!==null&&(e&&$.alternate!==null&&E.delete($.key===null?y:$.key),p=l($,p,y),j===null?C=$:j.sibling=$,j=$);return e&&E.forEach(function(A){return t(d,A)}),at&&$r(d,y),C}function x(d,p,v,N){if(typeof v=="object"&&v!==null&&v.type===ga&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case zo:e:{for(var C=v.key,j=p;j!==null;){if(j.key===C){if(C=v.type,C===ga){if(j.tag===7){n(d,j.sibling),p=a(j,v.props.children),p.return=d,d=p;break e}}else if(j.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===ar&&Bh(C)===j.type){n(d,j.sibling),p=a(j,v.props),p.ref=xl(d,j,v),p.return=d,d=p;break e}n(d,j);break}else t(d,j);j=j.sibling}v.type===ga?(p=Yr(v.props.children,d.mode,N,v.key),p.return=d,d=p):(N=ki(v.type,v.key,v.props,null,d.mode,N),N.ref=xl(d,p,v),N.return=d,d=N)}return o(d);case xa:e:{for(j=v.key;p!==null;){if(p.key===j)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){n(d,p.sibling),p=a(p,v.children||[]),p.return=d,d=p;break e}else{n(d,p);break}else t(d,p);p=p.sibling}p=Pu(v,d.mode,N),p.return=d,d=p}return o(d);case ar:return j=v._init,x(d,p,j(v._payload),N)}if(Cl(v))return b(d,p,v,N);if(dl(v))return w(d,p,v,N);Zo(d,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(n(d,p.sibling),p=a(p,v),p.return=d,d=p):(n(d,p),p=Mu(v,d.mode,N),p.return=d,d=p),o(d)):n(d,p)}return x}var Ba=_g(!0),wg=_g(!1),qi=Rr(null),Xi=null,Sa=null,lf=null;function of(){lf=Sa=Xi=null}function cf(e){var t=qi.current;et(qi),e._currentValue=t}function Ld(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function $a(e,t){Xi=e,lf=Sa=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(gn=!0),e.firstContext=null)}function Wn(e){var t=e._currentValue;if(lf!==e)if(e={context:e,memoizedValue:t,next:null},Sa===null){if(Xi===null)throw Error(ie(308));Sa=e,Xi.dependencies={lanes:0,firstContext:e}}else Sa=Sa.next=e;return t}var zr=null;function uf(e){zr===null?zr=[e]:zr.push(e)}function Sg(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,uf(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ys(e,r)}function Ys(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var lr=!1;function df(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cg(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Fe&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ys(e,n)}return a=r.interleaved,a===null?(t.next=t,uf(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ys(e,n)}function Ni(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Xm(e,n)}}function Wh(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=o:l=l.next=o,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Qi(e,t,n,r){var a=e.updateQueue;lr=!1;var l=a.firstBaseUpdate,o=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var i=c,u=i.next;i.next=null,o===null?l=u:o.next=u,o=i;var m=e.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=u:c.next=u,m.lastBaseUpdate=i))}if(l!==null){var h=a.baseState;o=0,m=u=i=null,c=l;do{var f=c.lane,g=c.eventTime;if((r&f)===f){m!==null&&(m=m.next={eventTime:g,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var b=e,w=c;switch(f=t,g=n,w.tag){case 1:if(b=w.payload,typeof b=="function"){h=b.call(g,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=w.payload,f=typeof b=="function"?b.call(g,h,f):b,f==null)break e;h=dt({},h,f);break e;case 2:lr=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[c]:f.push(c))}else g={eventTime:g,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(u=m=g,i=h):m=m.next=g,o|=f;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;f=c,c=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(m===null&&(i=h),a.baseState=i,a.firstBaseUpdate=u,a.lastBaseUpdate=m,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);ta|=o,e.lanes=o,e.memoizedState=h}}function Gh(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(ie(191,a));a.call(r)}}}var Ao={},ks=Rr(Ao),to=Rr(Ao),no=Rr(Ao);function Hr(e){if(e===Ao)throw Error(ie(174));return e}function mf(e,t){switch(Xe(no,t),Xe(to,e),Xe(ks,Ao),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:xd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=xd(t,e)}et(ks),Xe(ks,t)}function Wa(){et(ks),et(to),et(no)}function kg(e){Hr(no.current);var t=Hr(ks.current),n=xd(t,e.type);t!==n&&(Xe(to,e),Xe(ks,n))}function ff(e){to.current===e&&(et(ks),et(to))}var ct=Rr(0);function Ki(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Su=[];function hf(){for(var e=0;e<Su.length;e++)Su[e]._workInProgressVersionPrimary=null;Su.length=0}var ji=Ks.ReactCurrentDispatcher,Cu=Ks.ReactCurrentBatchConfig,ea=0,ut=null,St=null,Tt=null,Zi=!1,Dl=!1,so=0,x_=0;function Xt(){throw Error(ie(321))}function pf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ds(e[n],t[n]))return!1;return!0}function xf(e,t,n,r,a,l){if(ea=l,ut=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ji.current=e===null||e.memoizedState===null?y_:N_,e=n(r,a),Dl){l=0;do{if(Dl=!1,so=0,25<=l)throw Error(ie(301));l+=1,Tt=St=null,t.updateQueue=null,ji.current=j_,e=n(r,a)}while(Dl)}if(ji.current=Ji,t=St!==null&&St.next!==null,ea=0,Tt=St=ut=null,Zi=!1,t)throw Error(ie(300));return e}function gf(){var e=so!==0;return so=0,e}function js(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?ut.memoizedState=Tt=e:Tt=Tt.next=e,Tt}function Gn(){if(St===null){var e=ut.alternate;e=e!==null?e.memoizedState:null}else e=St.next;var t=Tt===null?ut.memoizedState:Tt.next;if(t!==null)Tt=t,St=e;else{if(e===null)throw Error(ie(310));St=e,e={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Tt===null?ut.memoizedState=Tt=e:Tt=Tt.next=e}return Tt}function ro(e,t){return typeof t=="function"?t(e):t}function ku(e){var t=Gn(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var r=St,a=r.baseQueue,l=n.pending;if(l!==null){if(a!==null){var o=a.next;a.next=l.next,l.next=o}r.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,r=r.baseState;var c=o=null,i=null,u=l;do{var m=u.lane;if((ea&m)===m)i!==null&&(i=i.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};i===null?(c=i=h,o=r):i=i.next=h,ut.lanes|=m,ta|=m}u=u.next}while(u!==null&&u!==l);i===null?o=r:i.next=c,ds(r,t.memoizedState)||(gn=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=i,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do l=a.lane,ut.lanes|=l,ta|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Eu(e){var t=Gn(),n=t.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do l=e(l,o.action),o=o.next;while(o!==a);ds(l,t.memoizedState)||(gn=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function Eg(){}function Ag(e,t){var n=ut,r=Gn(),a=t(),l=!ds(r.memoizedState,a);if(l&&(r.memoizedState=a,gn=!0),r=r.queue,vf(Pg.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||Tt!==null&&Tt.memoizedState.tag&1){if(n.flags|=2048,ao(9,Mg.bind(null,n,r,a,t),void 0,null),It===null)throw Error(ie(349));ea&30||Rg(n,t,a)}return a}function Rg(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ut.updateQueue,t===null?(t={lastEffect:null,stores:null},ut.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Mg(e,t,n,r){t.value=n,t.getSnapshot=r,Tg(t)&&Og(e)}function Pg(e,t,n){return n(function(){Tg(t)&&Og(e)})}function Tg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ds(e,n)}catch{return!0}}function Og(e){var t=Ys(e,1);t!==null&&cs(t,e,1,-1)}function Yh(e){var t=js();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:e},t.queue=e,e=e.dispatch=b_.bind(null,ut,e),[t.memoizedState,e]}function ao(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ut.updateQueue,t===null?(t={lastEffect:null,stores:null},ut.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Ig(){return Gn().memoizedState}function _i(e,t,n,r){var a=js();ut.flags|=e,a.memoizedState=ao(1|t,n,void 0,r===void 0?null:r)}function Tc(e,t,n,r){var a=Gn();r=r===void 0?null:r;var l=void 0;if(St!==null){var o=St.memoizedState;if(l=o.destroy,r!==null&&pf(r,o.deps)){a.memoizedState=ao(t,n,l,r);return}}ut.flags|=e,a.memoizedState=ao(1|t,n,l,r)}function qh(e,t){return _i(8390656,8,e,t)}function vf(e,t){return Tc(2048,8,e,t)}function Lg(e,t){return Tc(4,2,e,t)}function $g(e,t){return Tc(4,4,e,t)}function Dg(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Fg(e,t,n){return n=n!=null?n.concat([e]):null,Tc(4,4,Dg.bind(null,t,e),n)}function bf(){}function Vg(e,t){var n=Gn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&pf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function zg(e,t){var n=Gn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&pf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hg(e,t,n){return ea&21?(ds(n,t)||(n=Yx(),ut.lanes|=n,ta|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,gn=!0),e.memoizedState=n)}function g_(e,t){var n=Be;Be=n!==0&&4>n?n:4,e(!0);var r=Cu.transition;Cu.transition={};try{e(!1),t()}finally{Be=n,Cu.transition=r}}function Ug(){return Gn().memoizedState}function v_(e,t,n){var r=vr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Bg(e))Wg(t,n);else if(n=Sg(e,t,n,r),n!==null){var a=cn();cs(n,e,r,a),Gg(n,t,r)}}function b_(e,t,n){var r=vr(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Bg(e))Wg(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var o=t.lastRenderedState,c=l(o,n);if(a.hasEagerState=!0,a.eagerState=c,ds(c,o)){var i=t.interleaved;i===null?(a.next=a,uf(t)):(a.next=i.next,i.next=a),t.interleaved=a;return}}catch{}finally{}n=Sg(e,t,a,r),n!==null&&(a=cn(),cs(n,e,r,a),Gg(n,t,r))}}function Bg(e){var t=e.alternate;return e===ut||t!==null&&t===ut}function Wg(e,t){Dl=Zi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Xm(e,n)}}var Ji={readContext:Wn,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useInsertionEffect:Xt,useLayoutEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useMutableSource:Xt,useSyncExternalStore:Xt,useId:Xt,unstable_isNewReconciler:!1},y_={readContext:Wn,useCallback:function(e,t){return js().memoizedState=[e,t===void 0?null:t],e},useContext:Wn,useEffect:qh,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,_i(4194308,4,Dg.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _i(4194308,4,e,t)},useInsertionEffect:function(e,t){return _i(4,2,e,t)},useMemo:function(e,t){var n=js();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=js();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=v_.bind(null,ut,e),[r.memoizedState,e]},useRef:function(e){var t=js();return e={current:e},t.memoizedState=e},useState:Yh,useDebugValue:bf,useDeferredValue:function(e){return js().memoizedState=e},useTransition:function(){var e=Yh(!1),t=e[0];return e=g_.bind(null,e[1]),js().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ut,a=js();if(at){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=t(),It===null)throw Error(ie(349));ea&30||Rg(r,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,qh(Pg.bind(null,r,l,e),[e]),r.flags|=2048,ao(9,Mg.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=js(),t=It.identifierPrefix;if(at){var n=zs,r=Vs;n=(r&~(1<<32-is(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=so++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=x_++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},N_={readContext:Wn,useCallback:Vg,useContext:Wn,useEffect:vf,useImperativeHandle:Fg,useInsertionEffect:Lg,useLayoutEffect:$g,useMemo:zg,useReducer:ku,useRef:Ig,useState:function(){return ku(ro)},useDebugValue:bf,useDeferredValue:function(e){var t=Gn();return Hg(t,St.memoizedState,e)},useTransition:function(){var e=ku(ro)[0],t=Gn().memoizedState;return[e,t]},useMutableSource:Eg,useSyncExternalStore:Ag,useId:Ug,unstable_isNewReconciler:!1},j_={readContext:Wn,useCallback:Vg,useContext:Wn,useEffect:vf,useImperativeHandle:Fg,useInsertionEffect:Lg,useLayoutEffect:$g,useMemo:zg,useReducer:Eu,useRef:Ig,useState:function(){return Eu(ro)},useDebugValue:bf,useDeferredValue:function(e){var t=Gn();return St===null?t.memoizedState=e:Hg(t,St.memoizedState,e)},useTransition:function(){var e=Eu(ro)[0],t=Gn().memoizedState;return[e,t]},useMutableSource:Eg,useSyncExternalStore:Ag,useId:Ug,unstable_isNewReconciler:!1};function Zn(e,t){if(e&&e.defaultProps){t=dt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function $d(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:dt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Oc={isMounted:function(e){return(e=e._reactInternals)?da(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cn(),a=vr(e),l=Us(r,a);l.payload=t,n!=null&&(l.callback=n),t=xr(e,l,a),t!==null&&(cs(t,e,a,r),Ni(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cn(),a=vr(e),l=Us(r,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=xr(e,l,a),t!==null&&(cs(t,e,a,r),Ni(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cn(),r=vr(e),a=Us(n,r);a.tag=2,t!=null&&(a.callback=t),t=xr(e,a,r),t!==null&&(cs(t,e,r,n),Ni(t,e,r))}};function Xh(e,t,n,r,a,l,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,o):t.prototype&&t.prototype.isPureReactComponent?!Kl(n,r)||!Kl(a,l):!0}function Yg(e,t,n){var r=!1,a=_r,l=t.contextType;return typeof l=="object"&&l!==null?l=Wn(l):(a=Nn(t)?Zr:Jt.current,r=t.contextTypes,l=(r=r!=null)?Ha(e,a):_r),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Oc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function Qh(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Oc.enqueueReplaceState(t,t.state,null)}function Dd(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},df(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=Wn(l):(l=Nn(t)?Zr:Jt.current,a.context=Ha(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&($d(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Oc.enqueueReplaceState(a,a.state,null),Qi(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ga(e,t){try{var n="",r=t;do n+=QN(r),r=r.return;while(r);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function Au(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Fd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var __=typeof WeakMap=="function"?WeakMap:Map;function qg(e,t,n){n=Us(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){tc||(tc=!0,Xd=r),Fd(e,t)},n}function Xg(e,t,n){n=Us(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Fd(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Fd(e,t),typeof r!="function"&&(gr===null?gr=new Set([this]):gr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Kh(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new __;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=$_.bind(null,e,t,n),t.then(e,e))}function Zh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jh(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Us(-1,1),t.tag=2,xr(n,t,1))),n.lanes|=1),e)}var w_=Ks.ReactCurrentOwner,gn=!1;function an(e,t,n,r){t.child=e===null?wg(t,null,n,r):Ba(t,e.child,n,r)}function ep(e,t,n,r,a){n=n.render;var l=t.ref;return $a(t,a),r=xf(e,t,n,r,l,a),n=gf(),e!==null&&!gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qs(e,t,a)):(at&&n&&sf(t),t.flags|=1,an(e,t,r,a),t.child)}function tp(e,t,n,r,a){if(e===null){var l=n.type;return typeof l=="function"&&!kf(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Qg(e,t,l,r,a)):(e=ki(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var o=l.memoizedProps;if(n=n.compare,n=n!==null?n:Kl,n(o,r)&&e.ref===t.ref)return qs(e,t,a)}return t.flags|=1,e=br(l,r),e.ref=t.ref,e.return=t,t.child=e}function Qg(e,t,n,r,a){if(e!==null){var l=e.memoizedProps;if(Kl(l,r)&&e.ref===t.ref)if(gn=!1,t.pendingProps=r=l,(e.lanes&a)!==0)e.flags&131072&&(gn=!0);else return t.lanes=e.lanes,qs(e,t,a)}return Vd(e,t,n,r,a)}function Kg(e,t,n){var r=t.pendingProps,a=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(ka,Sn),Sn|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Xe(ka,Sn),Sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,Xe(ka,Sn),Sn|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,Xe(ka,Sn),Sn|=r;return an(e,t,a,n),t.child}function Zg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Vd(e,t,n,r,a){var l=Nn(n)?Zr:Jt.current;return l=Ha(t,l),$a(t,a),n=xf(e,t,n,r,l,a),r=gf(),e!==null&&!gn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,qs(e,t,a)):(at&&r&&sf(t),t.flags|=1,an(e,t,n,a),t.child)}function np(e,t,n,r,a){if(Nn(n)){var l=!0;Wi(t)}else l=!1;if($a(t,a),t.stateNode===null)wi(e,t),Yg(t,n,r),Dd(t,n,r,a),r=!0;else if(e===null){var o=t.stateNode,c=t.memoizedProps;o.props=c;var i=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Wn(u):(u=Nn(n)?Zr:Jt.current,u=Ha(t,u));var m=n.getDerivedStateFromProps,h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||i!==u)&&Qh(t,o,r,u),lr=!1;var f=t.memoizedState;o.state=f,Qi(t,r,o,a),i=t.memoizedState,c!==r||f!==i||yn.current||lr?(typeof m=="function"&&($d(t,n,m,r),i=t.memoizedState),(c=lr||Xh(t,n,c,r,f,i,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=i),o.props=r,o.state=i,o.context=u,r=c):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Cg(e,t),c=t.memoizedProps,u=t.type===t.elementType?c:Zn(t.type,c),o.props=u,h=t.pendingProps,f=o.context,i=n.contextType,typeof i=="object"&&i!==null?i=Wn(i):(i=Nn(n)?Zr:Jt.current,i=Ha(t,i));var g=n.getDerivedStateFromProps;(m=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==h||f!==i)&&Qh(t,o,r,i),lr=!1,f=t.memoizedState,o.state=f,Qi(t,r,o,a);var b=t.memoizedState;c!==h||f!==b||yn.current||lr?(typeof g=="function"&&($d(t,n,g,r),b=t.memoizedState),(u=lr||Xh(t,n,u,r,f,b,i)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,i),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,i)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=b),o.props=r,o.state=b,o.context=i,r=u):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return zd(e,t,n,r,l,a)}function zd(e,t,n,r,a,l){Zg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return a&&zh(t,n,!1),qs(e,t,l);r=t.stateNode,w_.current=t;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ba(t,e.child,null,l),t.child=Ba(t,null,c,l)):an(e,t,c,l),t.memoizedState=r.state,a&&zh(t,n,!0),t.child}function Jg(e){var t=e.stateNode;t.pendingContext?Vh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Vh(e,t.context,!1),mf(e,t.containerInfo)}function sp(e,t,n,r,a){return Ua(),af(a),t.flags|=256,an(e,t,n,r),t.child}var Hd={dehydrated:null,treeContext:null,retryLane:0};function Ud(e){return{baseLanes:e,cachePool:null,transitions:null}}function ev(e,t,n){var r=t.pendingProps,a=ct.current,l=!1,o=(t.flags&128)!==0,c;if((c=o)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Xe(ct,a&1),e===null)return Id(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,l?(r=t.mode,l=t.child,o={mode:"hidden",children:o},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=$c(o,r,0,null),e=Yr(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=Ud(n),t.memoizedState=Hd,e):yf(t,o));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return S_(e,t,o,r,c,a,n);if(l){l=r.fallback,o=t.mode,a=e.child,c=a.sibling;var i={mode:"hidden",children:r.children};return!(o&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=i,t.deletions=null):(r=br(a,i),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?l=br(c,l):(l=Yr(l,o,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,o=e.child.memoizedState,o=o===null?Ud(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~n,t.memoizedState=Hd,r}return l=e.child,e=l.sibling,r=br(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function yf(e,t){return t=$c({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Jo(e,t,n,r){return r!==null&&af(r),Ba(t,e.child,null,n),e=yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function S_(e,t,n,r,a,l,o){if(n)return t.flags&256?(t.flags&=-257,r=Au(Error(ie(422))),Jo(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,a=t.mode,r=$c({mode:"visible",children:r.children},a,0,null),l=Yr(l,a,o,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&Ba(t,e.child,null,o),t.child.memoizedState=Ud(o),t.memoizedState=Hd,l);if(!(t.mode&1))return Jo(e,t,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,l=Error(ie(419)),r=Au(l,r,void 0),Jo(e,t,o,r)}if(c=(o&e.childLanes)!==0,gn||c){if(r=It,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Ys(e,a),cs(r,e,a,-1))}return Cf(),r=Au(Error(ie(421))),Jo(e,t,o,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=D_.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,kn=pr(a.nextSibling),En=t,at=!0,ts=null,e!==null&&(Dn[Fn++]=Vs,Dn[Fn++]=zs,Dn[Fn++]=Jr,Vs=e.id,zs=e.overflow,Jr=t),t=yf(t,r.children),t.flags|=4096,t)}function rp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ld(e.return,t,n)}function Ru(e,t,n,r,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=a)}function tv(e,t,n){var r=t.pendingProps,a=r.revealOrder,l=r.tail;if(an(e,t,r.children,n),r=ct.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rp(e,n,t);else if(e.tag===19)rp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Xe(ct,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&Ki(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ru(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ki(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ru(t,!0,n,null,l);break;case"together":Ru(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function wi(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ta|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ie(153));if(t.child!==null){for(e=t.child,n=br(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=br(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function C_(e,t,n){switch(t.tag){case 3:Jg(t),Ua();break;case 5:kg(t);break;case 1:Nn(t.type)&&Wi(t);break;case 4:mf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Xe(qi,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Xe(ct,ct.current&1),t.flags|=128,null):n&t.child.childLanes?ev(e,t,n):(Xe(ct,ct.current&1),e=qs(e,t,n),e!==null?e.sibling:null);Xe(ct,ct.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return tv(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Xe(ct,ct.current),r)break;return null;case 22:case 23:return t.lanes=0,Kg(e,t,n)}return qs(e,t,n)}var nv,Bd,sv,rv;nv=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Bd=function(){};sv=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Hr(ks.current);var l=null;switch(n){case"input":a=md(e,a),r=md(e,r),l=[];break;case"select":a=dt({},a,{value:void 0}),r=dt({},r,{value:void 0}),l=[];break;case"textarea":a=pd(e,a),r=pd(e,r),l=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ui)}gd(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var c=a[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Bl.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var i=r[u];if(c=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&i!==c&&(i!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||i&&i.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in i)i.hasOwnProperty(o)&&c[o]!==i[o]&&(n||(n={}),n[o]=i[o])}else n||(l||(l=[]),l.push(u,n)),n=i;else u==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,c=c?c.__html:void 0,i!=null&&c!==i&&(l=l||[]).push(u,i)):u==="children"?typeof i!="string"&&typeof i!="number"||(l=l||[]).push(u,""+i):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Bl.hasOwnProperty(u)?(i!=null&&u==="onScroll"&&Ze("scroll",e),l||c===i||(l=[])):(l=l||[]).push(u,i))}n&&(l=l||[]).push("style",n);var u=l;(t.updateQueue=u)&&(t.flags|=4)}};rv=function(e,t,n,r){n!==r&&(t.flags|=4)};function gl(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Qt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function k_(e,t,n){var r=t.pendingProps;switch(rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(t),null;case 1:return Nn(t.type)&&Bi(),Qt(t),null;case 3:return r=t.stateNode,Wa(),et(yn),et(Jt),hf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ko(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ts!==null&&(Zd(ts),ts=null))),Bd(e,t),Qt(t),null;case 5:ff(t);var a=Hr(no.current);if(n=t.type,e!==null&&t.stateNode!=null)sv(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ie(166));return Qt(t),null}if(e=Hr(ks.current),Ko(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[ws]=t,r[eo]=l,e=(t.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(a=0;a<El.length;a++)Ze(El[a],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":fh(r,l),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},Ze("invalid",r);break;case"textarea":ph(r,l),Ze("invalid",r)}gd(n,l),a=null;for(var o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="children"?typeof c=="string"?r.textContent!==c&&(l.suppressHydrationWarning!==!0&&Qo(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(l.suppressHydrationWarning!==!0&&Qo(r.textContent,c,e),a=["children",""+c]):Bl.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Ho(r),hh(r,l,!0);break;case"textarea":Ho(r),xh(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=Ui)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Px(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[ws]=t,e[eo]=r,nv(e,t,!1,!1),t.stateNode=e;e:{switch(o=vd(n,r),n){case"dialog":Ze("cancel",e),Ze("close",e),a=r;break;case"iframe":case"object":case"embed":Ze("load",e),a=r;break;case"video":case"audio":for(a=0;a<El.length;a++)Ze(El[a],e);a=r;break;case"source":Ze("error",e),a=r;break;case"img":case"image":case"link":Ze("error",e),Ze("load",e),a=r;break;case"details":Ze("toggle",e),a=r;break;case"input":fh(e,r),a=md(e,r),Ze("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=dt({},r,{value:void 0}),Ze("invalid",e);break;case"textarea":ph(e,r),a=pd(e,r),Ze("invalid",e);break;default:a=r}gd(n,a),c=a;for(l in c)if(c.hasOwnProperty(l)){var i=c[l];l==="style"?Ix(e,i):l==="dangerouslySetInnerHTML"?(i=i?i.__html:void 0,i!=null&&Tx(e,i)):l==="children"?typeof i=="string"?(n!=="textarea"||i!=="")&&Wl(e,i):typeof i=="number"&&Wl(e,""+i):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Bl.hasOwnProperty(l)?i!=null&&l==="onScroll"&&Ze("scroll",e):i!=null&&Um(e,l,i,o))}switch(n){case"input":Ho(e),hh(e,r,!1);break;case"textarea":Ho(e),xh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+jr(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?Ta(e,!!r.multiple,l,!1):r.defaultValue!=null&&Ta(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ui)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qt(t),null;case 6:if(e&&t.stateNode!=null)rv(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ie(166));if(n=Hr(no.current),Hr(ks.current),Ko(t)){if(r=t.stateNode,n=t.memoizedProps,r[ws]=t,(l=r.nodeValue!==n)&&(e=En,e!==null))switch(e.tag){case 3:Qo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Qo(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ws]=t,t.stateNode=r}return Qt(t),null;case 13:if(et(ct),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(at&&kn!==null&&t.mode&1&&!(t.flags&128))jg(),Ua(),t.flags|=98560,l=!1;else if(l=Ko(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(ie(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ie(317));l[ws]=t}else Ua(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qt(t),l=!1}else ts!==null&&(Zd(ts),ts=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ct.current&1?At===0&&(At=3):Cf())),t.updateQueue!==null&&(t.flags|=4),Qt(t),null);case 4:return Wa(),Bd(e,t),e===null&&Zl(t.stateNode.containerInfo),Qt(t),null;case 10:return cf(t.type._context),Qt(t),null;case 17:return Nn(t.type)&&Bi(),Qt(t),null;case 19:if(et(ct),l=t.memoizedState,l===null)return Qt(t),null;if(r=(t.flags&128)!==0,o=l.rendering,o===null)if(r)gl(l,!1);else{if(At!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ki(e),o!==null){for(t.flags|=128,gl(l,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,e=o.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Xe(ct,ct.current&1|2),t.child}e=e.sibling}l.tail!==null&&pt()>Ya&&(t.flags|=128,r=!0,gl(l,!1),t.lanes=4194304)}else{if(!r)if(e=Ki(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),gl(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!at)return Qt(t),null}else 2*pt()-l.renderingStartTime>Ya&&n!==1073741824&&(t.flags|=128,r=!0,gl(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(n=l.last,n!==null?n.sibling=o:t.child=o,l.last=o)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=pt(),t.sibling=null,n=ct.current,Xe(ct,r?n&1|2:n&1),t):(Qt(t),null);case 22:case 23:return Sf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Sn&1073741824&&(Qt(t),t.subtreeFlags&6&&(t.flags|=8192)):Qt(t),null;case 24:return null;case 25:return null}throw Error(ie(156,t.tag))}function E_(e,t){switch(rf(t),t.tag){case 1:return Nn(t.type)&&Bi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Wa(),et(yn),et(Jt),hf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ff(t),null;case 13:if(et(ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ie(340));Ua()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return et(ct),null;case 4:return Wa(),null;case 10:return cf(t.type._context),null;case 22:case 23:return Sf(),null;case 24:return null;default:return null}}var ei=!1,Kt=!1,A_=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Ca(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(e,t,r)}else n.current=null}function Wd(e,t,n){try{n()}catch(r){ht(e,t,r)}}var ap=!1;function R_(e,t){if(Ed=Vi,e=cg(),nf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var o=0,c=-1,i=-1,u=0,m=0,h=e,f=null;t:for(;;){for(var g;h!==n||a!==0&&h.nodeType!==3||(c=o+a),h!==l||r!==0&&h.nodeType!==3||(i=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(g=h.firstChild)!==null;)f=h,h=g;for(;;){if(h===e)break t;if(f===n&&++u===a&&(c=o),f===l&&++m===r&&(i=o),(g=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=g}n=c===-1||i===-1?null:{start:c,end:i}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ad={focusedElem:e,selectionRange:n},Vi=!1,xe=t;xe!==null;)if(t=xe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,xe=e;else for(;xe!==null;){t=xe;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var w=b.memoizedProps,x=b.memoizedState,d=t.stateNode,p=d.getSnapshotBeforeUpdate(t.elementType===t.type?w:Zn(t.type,w),x);d.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(N){ht(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,xe=e;break}xe=t.return}return b=ap,ap=!1,b}function Fl(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&Wd(t,n,l)}a=a.next}while(a!==r)}}function Ic(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Gd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function av(e){var t=e.alternate;t!==null&&(e.alternate=null,av(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ws],delete t[eo],delete t[Pd],delete t[m_],delete t[f_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lv(e){return e.tag===5||e.tag===3||e.tag===4}function lp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Yd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ui));else if(r!==4&&(e=e.child,e!==null))for(Yd(e,t,n),e=e.sibling;e!==null;)Yd(e,t,n),e=e.sibling}function qd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(qd(e,t,n),e=e.sibling;e!==null;)qd(e,t,n),e=e.sibling}var zt=null,Jn=!1;function nr(e,t,n){for(n=n.child;n!==null;)ov(e,t,n),n=n.sibling}function ov(e,t,n){if(Cs&&typeof Cs.onCommitFiberUnmount=="function")try{Cs.onCommitFiberUnmount(kc,n)}catch{}switch(n.tag){case 5:Kt||Ca(n,t);case 6:var r=zt,a=Jn;zt=null,nr(e,t,n),zt=r,Jn=a,zt!==null&&(Jn?(e=zt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):zt.removeChild(n.stateNode));break;case 18:zt!==null&&(Jn?(e=zt,n=n.stateNode,e.nodeType===8?_u(e.parentNode,n):e.nodeType===1&&_u(e,n),Xl(e)):_u(zt,n.stateNode));break;case 4:r=zt,a=Jn,zt=n.stateNode.containerInfo,Jn=!0,nr(e,t,n),zt=r,Jn=a;break;case 0:case 11:case 14:case 15:if(!Kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var l=a,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&Wd(n,t,o),a=a.next}while(a!==r)}nr(e,t,n);break;case 1:if(!Kt&&(Ca(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){ht(n,t,c)}nr(e,t,n);break;case 21:nr(e,t,n);break;case 22:n.mode&1?(Kt=(r=Kt)||n.memoizedState!==null,nr(e,t,n),Kt=r):nr(e,t,n);break;default:nr(e,t,n)}}function op(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new A_),t.forEach(function(r){var a=F_.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Qn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var l=e,o=t,c=o;e:for(;c!==null;){switch(c.tag){case 5:zt=c.stateNode,Jn=!1;break e;case 3:zt=c.stateNode.containerInfo,Jn=!0;break e;case 4:zt=c.stateNode.containerInfo,Jn=!0;break e}c=c.return}if(zt===null)throw Error(ie(160));ov(l,o,a),zt=null,Jn=!1;var i=a.alternate;i!==null&&(i.return=null),a.return=null}catch(u){ht(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)iv(t,e),t=t.sibling}function iv(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Qn(t,e),Ns(e),r&4){try{Fl(3,e,e.return),Ic(3,e)}catch(w){ht(e,e.return,w)}try{Fl(5,e,e.return)}catch(w){ht(e,e.return,w)}}break;case 1:Qn(t,e),Ns(e),r&512&&n!==null&&Ca(n,n.return);break;case 5:if(Qn(t,e),Ns(e),r&512&&n!==null&&Ca(n,n.return),e.flags&32){var a=e.stateNode;try{Wl(a,"")}catch(w){ht(e,e.return,w)}}if(r&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,o=n!==null?n.memoizedProps:l,c=e.type,i=e.updateQueue;if(e.updateQueue=null,i!==null)try{c==="input"&&l.type==="radio"&&l.name!=null&&Rx(a,l),vd(c,o);var u=vd(c,l);for(o=0;o<i.length;o+=2){var m=i[o],h=i[o+1];m==="style"?Ix(a,h):m==="dangerouslySetInnerHTML"?Tx(a,h):m==="children"?Wl(a,h):Um(a,m,h,u)}switch(c){case"input":fd(a,l);break;case"textarea":Mx(a,l);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var g=l.value;g!=null?Ta(a,!!l.multiple,g,!1):f!==!!l.multiple&&(l.defaultValue!=null?Ta(a,!!l.multiple,l.defaultValue,!0):Ta(a,!!l.multiple,l.multiple?[]:"",!1))}a[eo]=l}catch(w){ht(e,e.return,w)}}break;case 6:if(Qn(t,e),Ns(e),r&4){if(e.stateNode===null)throw Error(ie(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(w){ht(e,e.return,w)}}break;case 3:if(Qn(t,e),Ns(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Xl(t.containerInfo)}catch(w){ht(e,e.return,w)}break;case 4:Qn(t,e),Ns(e);break;case 13:Qn(t,e),Ns(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(_f=pt())),r&4&&op(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(Kt=(u=Kt)||m,Qn(t,e),Kt=u):Qn(t,e),Ns(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!m&&e.mode&1)for(xe=e,m=e.child;m!==null;){for(h=xe=m;xe!==null;){switch(f=xe,g=f.child,f.tag){case 0:case 11:case 14:case 15:Fl(4,f,f.return);break;case 1:Ca(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(w){ht(r,n,w)}}break;case 5:Ca(f,f.return);break;case 22:if(f.memoizedState!==null){cp(h);continue}}g!==null?(g.return=f,xe=g):cp(h)}m=m.sibling}e:for(m=null,h=e;;){if(h.tag===5){if(m===null){m=h;try{a=h.stateNode,u?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(c=h.stateNode,i=h.memoizedProps.style,o=i!=null&&i.hasOwnProperty("display")?i.display:null,c.style.display=Ox("display",o))}catch(w){ht(e,e.return,w)}}}else if(h.tag===6){if(m===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(w){ht(e,e.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;m===h&&(m=null),h=h.return}m===h&&(m=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Qn(t,e),Ns(e),r&4&&op(e);break;case 21:break;default:Qn(t,e),Ns(e)}}function Ns(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(lv(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(Wl(a,""),r.flags&=-33);var l=lp(e);qd(e,l,a);break;case 3:case 4:var o=r.stateNode.containerInfo,c=lp(e);Yd(e,c,o);break;default:throw Error(ie(161))}}catch(i){ht(e,e.return,i)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function M_(e,t,n){xe=e,cv(e)}function cv(e,t,n){for(var r=(e.mode&1)!==0;xe!==null;){var a=xe,l=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||ei;if(!o){var c=a.alternate,i=c!==null&&c.memoizedState!==null||Kt;c=ei;var u=Kt;if(ei=o,(Kt=i)&&!u)for(xe=a;xe!==null;)o=xe,i=o.child,o.tag===22&&o.memoizedState!==null?up(a):i!==null?(i.return=o,xe=i):up(a);for(;l!==null;)xe=l,cv(l),l=l.sibling;xe=a,ei=c,Kt=u}ip(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,xe=l):ip(e)}}function ip(e){for(;xe!==null;){var t=xe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Kt||Ic(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Kt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Zn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Gh(t,l,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Gh(t,o,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var i=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":i.autoFocus&&n.focus();break;case"img":i.src&&(n.src=i.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var h=m.dehydrated;h!==null&&Xl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Kt||t.flags&512&&Gd(t)}catch(f){ht(t,t.return,f)}}if(t===e){xe=null;break}if(n=t.sibling,n!==null){n.return=t.return,xe=n;break}xe=t.return}}function cp(e){for(;xe!==null;){var t=xe;if(t===e){xe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,xe=n;break}xe=t.return}}function up(e){for(;xe!==null;){var t=xe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ic(4,t)}catch(i){ht(t,n,i)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(i){ht(t,a,i)}}var l=t.return;try{Gd(t)}catch(i){ht(t,l,i)}break;case 5:var o=t.return;try{Gd(t)}catch(i){ht(t,o,i)}}}catch(i){ht(t,t.return,i)}if(t===e){xe=null;break}var c=t.sibling;if(c!==null){c.return=t.return,xe=c;break}xe=t.return}}var P_=Math.ceil,ec=Ks.ReactCurrentDispatcher,Nf=Ks.ReactCurrentOwner,Hn=Ks.ReactCurrentBatchConfig,Fe=0,It=null,Nt=null,Ht=0,Sn=0,ka=Rr(0),At=0,lo=null,ta=0,Lc=0,jf=0,Vl=null,pn=null,_f=0,Ya=1/0,$s=null,tc=!1,Xd=null,gr=null,ti=!1,ur=null,nc=0,zl=0,Qd=null,Si=-1,Ci=0;function cn(){return Fe&6?pt():Si!==-1?Si:Si=pt()}function vr(e){return e.mode&1?Fe&2&&Ht!==0?Ht&-Ht:p_.transition!==null?(Ci===0&&(Ci=Yx()),Ci):(e=Be,e!==0||(e=window.event,e=e===void 0?16:eg(e.type)),e):1}function cs(e,t,n,r){if(50<zl)throw zl=0,Qd=null,Error(ie(185));Co(e,n,r),(!(Fe&2)||e!==It)&&(e===It&&(!(Fe&2)&&(Lc|=n),At===4&&ir(e,Ht)),jn(e,r),n===1&&Fe===0&&!(t.mode&1)&&(Ya=pt()+500,Pc&&Mr()))}function jn(e,t){var n=e.callbackNode;pj(e,t);var r=Fi(e,e===It?Ht:0);if(r===0)n!==null&&bh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&bh(n),t===1)e.tag===0?h_(dp.bind(null,e)):bg(dp.bind(null,e)),u_(function(){!(Fe&6)&&Mr()}),n=null;else{switch(qx(r)){case 1:n=qm;break;case 4:n=Wx;break;case 16:n=Di;break;case 536870912:n=Gx;break;default:n=Di}n=gv(n,uv.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function uv(e,t){if(Si=-1,Ci=0,Fe&6)throw Error(ie(327));var n=e.callbackNode;if(Da()&&e.callbackNode!==n)return null;var r=Fi(e,e===It?Ht:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=sc(e,r);else{t=r;var a=Fe;Fe|=2;var l=mv();(It!==e||Ht!==t)&&($s=null,Ya=pt()+500,Gr(e,t));do try{I_();break}catch(c){dv(e,c)}while(!0);of(),ec.current=l,Fe=a,Nt!==null?t=0:(It=null,Ht=0,t=At)}if(t!==0){if(t===2&&(a=_d(e),a!==0&&(r=a,t=Kd(e,a))),t===1)throw n=lo,Gr(e,0),ir(e,r),jn(e,pt()),n;if(t===6)ir(e,r);else{if(a=e.current.alternate,!(r&30)&&!T_(a)&&(t=sc(e,r),t===2&&(l=_d(e),l!==0&&(r=l,t=Kd(e,l))),t===1))throw n=lo,Gr(e,0),ir(e,r),jn(e,pt()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(ie(345));case 2:Dr(e,pn,$s);break;case 3:if(ir(e,r),(r&130023424)===r&&(t=_f+500-pt(),10<t)){if(Fi(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){cn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Md(Dr.bind(null,e,pn,$s),t);break}Dr(e,pn,$s);break;case 4:if(ir(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-is(r);l=1<<o,o=t[o],o>a&&(a=o),r&=~l}if(r=a,r=pt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*P_(r/1960))-r,10<r){e.timeoutHandle=Md(Dr.bind(null,e,pn,$s),r);break}Dr(e,pn,$s);break;case 5:Dr(e,pn,$s);break;default:throw Error(ie(329))}}}return jn(e,pt()),e.callbackNode===n?uv.bind(null,e):null}function Kd(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(Gr(e,t).flags|=256),e=sc(e,t),e!==2&&(t=pn,pn=n,t!==null&&Zd(t)),e}function Zd(e){pn===null?pn=e:pn.push.apply(pn,e)}function T_(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],l=a.getSnapshot;a=a.value;try{if(!ds(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ir(e,t){for(t&=~jf,t&=~Lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-is(t),r=1<<n;e[n]=-1,t&=~r}}function dp(e){if(Fe&6)throw Error(ie(327));Da();var t=Fi(e,0);if(!(t&1))return jn(e,pt()),null;var n=sc(e,t);if(e.tag!==0&&n===2){var r=_d(e);r!==0&&(t=r,n=Kd(e,r))}if(n===1)throw n=lo,Gr(e,0),ir(e,t),jn(e,pt()),n;if(n===6)throw Error(ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dr(e,pn,$s),jn(e,pt()),null}function wf(e,t){var n=Fe;Fe|=1;try{return e(t)}finally{Fe=n,Fe===0&&(Ya=pt()+500,Pc&&Mr())}}function na(e){ur!==null&&ur.tag===0&&!(Fe&6)&&Da();var t=Fe;Fe|=1;var n=Hn.transition,r=Be;try{if(Hn.transition=null,Be=1,e)return e()}finally{Be=r,Hn.transition=n,Fe=t,!(Fe&6)&&Mr()}}function Sf(){Sn=ka.current,et(ka)}function Gr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,c_(n)),Nt!==null)for(n=Nt.return;n!==null;){var r=n;switch(rf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bi();break;case 3:Wa(),et(yn),et(Jt),hf();break;case 5:ff(r);break;case 4:Wa();break;case 13:et(ct);break;case 19:et(ct);break;case 10:cf(r.type._context);break;case 22:case 23:Sf()}n=n.return}if(It=e,Nt=e=br(e.current,null),Ht=Sn=t,At=0,lo=null,jf=Lc=ta=0,pn=Vl=null,zr!==null){for(t=0;t<zr.length;t++)if(n=zr[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,l=n.pending;if(l!==null){var o=l.next;l.next=a,r.next=o}n.pending=r}zr=null}return e}function dv(e,t){do{var n=Nt;try{if(of(),ji.current=Ji,Zi){for(var r=ut.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Zi=!1}if(ea=0,Tt=St=ut=null,Dl=!1,so=0,Nf.current=null,n===null||n.return===null){At=1,lo=t,Nt=null;break}e:{var l=e,o=n.return,c=n,i=t;if(t=Ht,c.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){var u=i,m=c,h=m.tag;if(!(m.mode&1)&&(h===0||h===11||h===15)){var f=m.alternate;f?(m.updateQueue=f.updateQueue,m.memoizedState=f.memoizedState,m.lanes=f.lanes):(m.updateQueue=null,m.memoizedState=null)}var g=Zh(o);if(g!==null){g.flags&=-257,Jh(g,o,c,l,t),g.mode&1&&Kh(l,u,t),t=g,i=u;var b=t.updateQueue;if(b===null){var w=new Set;w.add(i),t.updateQueue=w}else b.add(i);break e}else{if(!(t&1)){Kh(l,u,t),Cf();break e}i=Error(ie(426))}}else if(at&&c.mode&1){var x=Zh(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Jh(x,o,c,l,t),af(Ga(i,c));break e}}l=i=Ga(i,c),At!==4&&(At=2),Vl===null?Vl=[l]:Vl.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var d=qg(l,i,t);Wh(l,d);break e;case 1:c=i;var p=l.type,v=l.stateNode;if(!(l.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(gr===null||!gr.has(v)))){l.flags|=65536,t&=-t,l.lanes|=t;var N=Xg(l,c,t);Wh(l,N);break e}}l=l.return}while(l!==null)}hv(n)}catch(C){t=C,Nt===n&&n!==null&&(Nt=n=n.return);continue}break}while(!0)}function mv(){var e=ec.current;return ec.current=Ji,e===null?Ji:e}function Cf(){(At===0||At===3||At===2)&&(At=4),It===null||!(ta&268435455)&&!(Lc&268435455)||ir(It,Ht)}function sc(e,t){var n=Fe;Fe|=2;var r=mv();(It!==e||Ht!==t)&&($s=null,Gr(e,t));do try{O_();break}catch(a){dv(e,a)}while(!0);if(of(),Fe=n,ec.current=r,Nt!==null)throw Error(ie(261));return It=null,Ht=0,At}function O_(){for(;Nt!==null;)fv(Nt)}function I_(){for(;Nt!==null&&!lj();)fv(Nt)}function fv(e){var t=xv(e.alternate,e,Sn);e.memoizedProps=e.pendingProps,t===null?hv(e):Nt=t,Nf.current=null}function hv(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=E_(n,t),n!==null){n.flags&=32767,Nt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{At=6,Nt=null;return}}else if(n=k_(n,t,Sn),n!==null){Nt=n;return}if(t=t.sibling,t!==null){Nt=t;return}Nt=t=e}while(t!==null);At===0&&(At=5)}function Dr(e,t,n){var r=Be,a=Hn.transition;try{Hn.transition=null,Be=1,L_(e,t,n,r)}finally{Hn.transition=a,Be=r}return null}function L_(e,t,n,r){do Da();while(ur!==null);if(Fe&6)throw Error(ie(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ie(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(xj(e,l),e===It&&(Nt=It=null,Ht=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ti||(ti=!0,gv(Di,function(){return Da(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Hn.transition,Hn.transition=null;var o=Be;Be=1;var c=Fe;Fe|=4,Nf.current=null,R_(e,n),iv(n,e),n_(Ad),Vi=!!Ed,Ad=Ed=null,e.current=n,M_(n),oj(),Fe=c,Be=o,Hn.transition=l}else e.current=n;if(ti&&(ti=!1,ur=e,nc=a),l=e.pendingLanes,l===0&&(gr=null),uj(n.stateNode),jn(e,pt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(tc)throw tc=!1,e=Xd,Xd=null,e;return nc&1&&e.tag!==0&&Da(),l=e.pendingLanes,l&1?e===Qd?zl++:(zl=0,Qd=e):zl=0,Mr(),null}function Da(){if(ur!==null){var e=qx(nc),t=Hn.transition,n=Be;try{if(Hn.transition=null,Be=16>e?16:e,ur===null)var r=!1;else{if(e=ur,ur=null,nc=0,Fe&6)throw Error(ie(331));var a=Fe;for(Fe|=4,xe=e.current;xe!==null;){var l=xe,o=l.child;if(xe.flags&16){var c=l.deletions;if(c!==null){for(var i=0;i<c.length;i++){var u=c[i];for(xe=u;xe!==null;){var m=xe;switch(m.tag){case 0:case 11:case 15:Fl(8,m,l)}var h=m.child;if(h!==null)h.return=m,xe=h;else for(;xe!==null;){m=xe;var f=m.sibling,g=m.return;if(av(m),m===u){xe=null;break}if(f!==null){f.return=g,xe=f;break}xe=g}}}var b=l.alternate;if(b!==null){var w=b.child;if(w!==null){b.child=null;do{var x=w.sibling;w.sibling=null,w=x}while(w!==null)}}xe=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,xe=o;else e:for(;xe!==null;){if(l=xe,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Fl(9,l,l.return)}var d=l.sibling;if(d!==null){d.return=l.return,xe=d;break e}xe=l.return}}var p=e.current;for(xe=p;xe!==null;){o=xe;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,xe=v;else e:for(o=p;xe!==null;){if(c=xe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Ic(9,c)}}catch(C){ht(c,c.return,C)}if(c===o){xe=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,xe=N;break e}xe=c.return}}if(Fe=a,Mr(),Cs&&typeof Cs.onPostCommitFiberRoot=="function")try{Cs.onPostCommitFiberRoot(kc,e)}catch{}r=!0}return r}finally{Be=n,Hn.transition=t}}return!1}function mp(e,t,n){t=Ga(n,t),t=qg(e,t,1),e=xr(e,t,1),t=cn(),e!==null&&(Co(e,1,t),jn(e,t))}function ht(e,t,n){if(e.tag===3)mp(e,e,n);else for(;t!==null;){if(t.tag===3){mp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gr===null||!gr.has(r))){e=Ga(n,e),e=Xg(t,e,1),t=xr(t,e,1),e=cn(),t!==null&&(Co(t,1,e),jn(t,e));break}}t=t.return}}function $_(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=cn(),e.pingedLanes|=e.suspendedLanes&n,It===e&&(Ht&n)===n&&(At===4||At===3&&(Ht&130023424)===Ht&&500>pt()-_f?Gr(e,0):jf|=n),jn(e,t)}function pv(e,t){t===0&&(e.mode&1?(t=Wo,Wo<<=1,!(Wo&130023424)&&(Wo=4194304)):t=1);var n=cn();e=Ys(e,t),e!==null&&(Co(e,t,n),jn(e,n))}function D_(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),pv(e,n)}function F_(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(t),pv(e,n)}var xv;xv=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||yn.current)gn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return gn=!1,C_(e,t,n);gn=!!(e.flags&131072)}else gn=!1,at&&t.flags&1048576&&yg(t,Yi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;wi(e,t),e=t.pendingProps;var a=Ha(t,Jt.current);$a(t,n),a=xf(null,t,r,e,a,n);var l=gf();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nn(r)?(l=!0,Wi(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,df(t),a.updater=Oc,t.stateNode=a,a._reactInternals=t,Dd(t,r,e,n),t=zd(null,t,r,!0,l,n)):(t.tag=0,at&&l&&sf(t),an(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(wi(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=z_(r),e=Zn(r,e),a){case 0:t=Vd(null,t,r,e,n);break e;case 1:t=np(null,t,r,e,n);break e;case 11:t=ep(null,t,r,e,n);break e;case 14:t=tp(null,t,r,Zn(r.type,e),n);break e}throw Error(ie(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Zn(r,a),Vd(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Zn(r,a),np(e,t,r,a,n);case 3:e:{if(Jg(t),e===null)throw Error(ie(387));r=t.pendingProps,l=t.memoizedState,a=l.element,Cg(e,t),Qi(t,r,null,n);var o=t.memoizedState;if(r=o.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=Ga(Error(ie(423)),t),t=sp(e,t,r,n,a);break e}else if(r!==a){a=Ga(Error(ie(424)),t),t=sp(e,t,r,n,a);break e}else for(kn=pr(t.stateNode.containerInfo.firstChild),En=t,at=!0,ts=null,n=wg(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ua(),r===a){t=qs(e,t,n);break e}an(e,t,r,n)}t=t.child}return t;case 5:return kg(t),e===null&&Id(t),r=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,o=a.children,Rd(r,a)?o=null:l!==null&&Rd(r,l)&&(t.flags|=32),Zg(e,t),an(e,t,o,n),t.child;case 6:return e===null&&Id(t),null;case 13:return ev(e,t,n);case 4:return mf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ba(t,null,r,n):an(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Zn(r,a),ep(e,t,r,a,n);case 7:return an(e,t,t.pendingProps,n),t.child;case 8:return an(e,t,t.pendingProps.children,n),t.child;case 12:return an(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,l=t.memoizedProps,o=a.value,Xe(qi,r._currentValue),r._currentValue=o,l!==null)if(ds(l.value,o)){if(l.children===a.children&&!yn.current){t=qs(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var c=l.dependencies;if(c!==null){o=l.child;for(var i=c.firstContext;i!==null;){if(i.context===r){if(l.tag===1){i=Us(-1,n&-n),i.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i}}l.lanes|=n,i=l.alternate,i!==null&&(i.lanes|=n),Ld(l.return,n,t),c.lanes|=n;break}i=i.next}}else if(l.tag===10)o=l.type===t.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(ie(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Ld(o,n,t),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===t){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}an(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,$a(t,n),a=Wn(a),r=r(a),t.flags|=1,an(e,t,r,n),t.child;case 14:return r=t.type,a=Zn(r,t.pendingProps),a=Zn(r.type,a),tp(e,t,r,a,n);case 15:return Qg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Zn(r,a),wi(e,t),t.tag=1,Nn(r)?(e=!0,Wi(t)):e=!1,$a(t,n),Yg(t,r,a),Dd(t,r,a,n),zd(null,t,r,!0,e,n);case 19:return tv(e,t,n);case 22:return Kg(e,t,n)}throw Error(ie(156,t.tag))};function gv(e,t){return Bx(e,t)}function V_(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(e,t,n,r){return new V_(e,t,n,r)}function kf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function z_(e){if(typeof e=="function")return kf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wm)return 11;if(e===Gm)return 14}return 2}function br(e,t){var n=e.alternate;return n===null?(n=zn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ki(e,t,n,r,a,l){var o=2;if(r=e,typeof e=="function")kf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ga:return Yr(n.children,a,l,t);case Bm:o=8,a|=8;break;case id:return e=zn(12,n,t,a|2),e.elementType=id,e.lanes=l,e;case cd:return e=zn(13,n,t,a),e.elementType=cd,e.lanes=l,e;case ud:return e=zn(19,n,t,a),e.elementType=ud,e.lanes=l,e;case kx:return $c(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Sx:o=10;break e;case Cx:o=9;break e;case Wm:o=11;break e;case Gm:o=14;break e;case ar:o=16,r=null;break e}throw Error(ie(130,e==null?e:typeof e,""))}return t=zn(o,n,t,a),t.elementType=e,t.type=r,t.lanes=l,t}function Yr(e,t,n,r){return e=zn(7,e,r,t),e.lanes=n,e}function $c(e,t,n,r){return e=zn(22,e,r,t),e.elementType=kx,e.lanes=n,e.stateNode={isHidden:!1},e}function Mu(e,t,n){return e=zn(6,e,null,t),e.lanes=n,e}function Pu(e,t,n){return t=zn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function H_(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mu(0),this.expirationTimes=mu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mu(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ef(e,t,n,r,a,l,o,c,i){return e=new H_(e,t,n,c,i),t===1?(t=1,l===!0&&(t|=8)):t=0,l=zn(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},df(l),e}function U_(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xa,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function vv(e){if(!e)return _r;e=e._reactInternals;e:{if(da(e)!==e||e.tag!==1)throw Error(ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ie(171))}if(e.tag===1){var n=e.type;if(Nn(n))return vg(e,n,t)}return t}function bv(e,t,n,r,a,l,o,c,i){return e=Ef(n,r,!0,e,a,l,o,c,i),e.context=vv(null),n=e.current,r=cn(),a=vr(n),l=Us(r,a),l.callback=t??null,xr(n,l,a),e.current.lanes=a,Co(e,a,r),jn(e,r),e}function Dc(e,t,n,r){var a=t.current,l=cn(),o=vr(a);return n=vv(n),t.context===null?t.context=n:t.pendingContext=n,t=Us(l,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=xr(a,t,o),e!==null&&(cs(e,a,o,l),Ni(e,a,o)),o}function rc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Af(e,t){fp(e,t),(e=e.alternate)&&fp(e,t)}function B_(){return null}var yv=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rf(e){this._internalRoot=e}Fc.prototype.render=Rf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ie(409));Dc(e,t,null,null)};Fc.prototype.unmount=Rf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;na(function(){Dc(null,e,null,null)}),t[Gs]=null}};function Fc(e){this._internalRoot=e}Fc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Kx();e={blockedOn:null,target:e,priority:t};for(var n=0;n<or.length&&t!==0&&t<or[n].priority;n++);or.splice(n,0,e),n===0&&Jx(e)}};function Mf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Vc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hp(){}function W_(e,t,n,r,a){if(a){if(typeof r=="function"){var l=r;r=function(){var u=rc(o);l.call(u)}}var o=bv(t,r,e,0,null,!1,!1,"",hp);return e._reactRootContainer=o,e[Gs]=o.current,Zl(e.nodeType===8?e.parentNode:e),na(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var u=rc(i);c.call(u)}}var i=Ef(e,0,!1,null,null,!1,!1,"",hp);return e._reactRootContainer=i,e[Gs]=i.current,Zl(e.nodeType===8?e.parentNode:e),na(function(){Dc(t,i,n,r)}),i}function zc(e,t,n,r,a){var l=n._reactRootContainer;if(l){var o=l;if(typeof a=="function"){var c=a;a=function(){var i=rc(o);c.call(i)}}Dc(t,o,e,a)}else o=W_(n,t,e,a,r);return rc(o)}Xx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=kl(t.pendingLanes);n!==0&&(Xm(t,n|1),jn(t,pt()),!(Fe&6)&&(Ya=pt()+500,Mr()))}break;case 13:na(function(){var r=Ys(e,1);if(r!==null){var a=cn();cs(r,e,1,a)}}),Af(e,1)}};Qm=function(e){if(e.tag===13){var t=Ys(e,134217728);if(t!==null){var n=cn();cs(t,e,134217728,n)}Af(e,134217728)}};Qx=function(e){if(e.tag===13){var t=vr(e),n=Ys(e,t);if(n!==null){var r=cn();cs(n,e,t,r)}Af(e,t)}};Kx=function(){return Be};Zx=function(e,t){var n=Be;try{return Be=e,t()}finally{Be=n}};yd=function(e,t,n){switch(t){case"input":if(fd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Mc(r);if(!a)throw Error(ie(90));Ax(r),fd(r,a)}}}break;case"textarea":Mx(e,n);break;case"select":t=n.value,t!=null&&Ta(e,!!n.multiple,t,!1)}};Dx=wf;Fx=na;var G_={usingClientEntryPoint:!1,Events:[Eo,Na,Mc,Lx,$x,wf]},vl={findFiberByHostInstance:Vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Y_={bundleType:vl.bundleType,version:vl.version,rendererPackageName:vl.rendererPackageName,rendererConfig:vl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ks.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Hx(e),e===null?null:e.stateNode},findFiberByHostInstance:vl.findFiberByHostInstance||B_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ni=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ni.isDisabled&&ni.supportsFiber)try{kc=ni.inject(Y_),Cs=ni}catch{}}Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G_;Pn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mf(t))throw Error(ie(200));return U_(e,t,null,n)};Pn.createRoot=function(e,t){if(!Mf(e))throw Error(ie(299));var n=!1,r="",a=yv;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Ef(e,1,!1,null,null,n,!1,r,a),e[Gs]=t.current,Zl(e.nodeType===8?e.parentNode:e),new Rf(t)};Pn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ie(188)):(e=Object.keys(e).join(","),Error(ie(268,e)));return e=Hx(t),e=e===null?null:e.stateNode,e};Pn.flushSync=function(e){return na(e)};Pn.hydrate=function(e,t,n){if(!Vc(t))throw Error(ie(200));return zc(null,e,t,!0,n)};Pn.hydrateRoot=function(e,t,n){if(!Mf(e))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,a=!1,l="",o=yv;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=bv(t,null,e,1,n??null,a,!1,l,o),e[Gs]=t.current,Zl(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Fc(t)};Pn.render=function(e,t,n){if(!Vc(t))throw Error(ie(200));return zc(null,e,t,!1,n)};Pn.unmountComponentAtNode=function(e){if(!Vc(e))throw Error(ie(40));return e._reactRootContainer?(na(function(){zc(null,null,e,!1,function(){e._reactRootContainer=null,e[Gs]=null})}),!0):!1};Pn.unstable_batchedUpdates=wf;Pn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Vc(n))throw Error(ie(200));if(e==null||e._reactInternals===void 0)throw Error(ie(38));return zc(e,t,n,!1,r)};Pn.version="18.3.1-next-f1338f8080-20240426";function Nv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Nv)}catch(e){console.error(e)}}Nv(),Nx.exports=Pn;var q_=Nx.exports,pp=q_;ld.createRoot=pp.createRoot,ld.hydrateRoot=pp.hydrateRoot;const X_={},xp=e=>{let t;const n=new Set,r=(m,h)=>{const f=typeof m=="function"?m(t):m;if(!Object.is(f,t)){const g=t;t=h??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(b=>b(t,g))}},a=()=>t,i={setState:r,getState:a,getInitialState:()=>u,subscribe:m=>(n.add(m),()=>n.delete(m)),destroy:()=>{(X_?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,a,i);return i},jv=e=>e?xp(e):xp;var _v={exports:{}},wv={},Sv={exports:{}},Cv={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qa=M;function Q_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var K_=typeof Object.is=="function"?Object.is:Q_,Z_=qa.useState,J_=qa.useEffect,ew=qa.useLayoutEffect,tw=qa.useDebugValue;function nw(e,t){var n=t(),r=Z_({inst:{value:n,getSnapshot:t}}),a=r[0].inst,l=r[1];return ew(function(){a.value=n,a.getSnapshot=t,Tu(a)&&l({inst:a})},[e,n,t]),J_(function(){return Tu(a)&&l({inst:a}),e(function(){Tu(a)&&l({inst:a})})},[e]),tw(n),n}function Tu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!K_(e,n)}catch{return!0}}function sw(e,t){return t()}var rw=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?sw:nw;Cv.useSyncExternalStore=qa.useSyncExternalStore!==void 0?qa.useSyncExternalStore:rw;Sv.exports=Cv;var aw=Sv.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hc=M,lw=aw;function ow(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var iw=typeof Object.is=="function"?Object.is:ow,cw=lw.useSyncExternalStore,uw=Hc.useRef,dw=Hc.useEffect,mw=Hc.useMemo,fw=Hc.useDebugValue;wv.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var l=uw(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=mw(function(){function i(g){if(!u){if(u=!0,m=g,g=r(g),a!==void 0&&o.hasValue){var b=o.value;if(a(b,g))return h=b}return h=g}if(b=h,iw(m,g))return b;var w=r(g);return a!==void 0&&a(b,w)?(m=g,b):(m=g,h=w)}var u=!1,m,h,f=n===void 0?null:n;return[function(){return i(t())},f===null?void 0:function(){return i(f())}]},[t,n,r,a]);var c=cw(e,l[0],l[1]);return dw(function(){o.hasValue=!0,o.value=c},[c]),fw(c),c};_v.exports=wv;var hw=_v.exports;const kv=cx(hw),Ev={},{useDebugValue:pw}=Vm,{useSyncExternalStoreWithSelector:xw}=kv;let gp=!1;const gw=e=>e;function vw(e,t=gw,n){(Ev?"production":void 0)!=="production"&&n&&!gp&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),gp=!0);const r=xw(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return pw(r),r}const vp=e=>{(Ev?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?jv(e):e,n=(r,a)=>vw(t,r,a);return Object.assign(n,t),n},cl=e=>e?vp(e):vp,bp={variables:{},schemas:{},resources:{llms:{},vector_stores:{},genie_rooms:{},tables:{},volumes:{},functions:{},warehouses:{},databases:{},connections:{}},retrievers:{},tools:{},guardrails:{},prompts:{},agents:{},app:void 0},We=cl(e=>({config:bp,setConfig:t=>e({config:t}),updateConfig:t=>e(n=>({config:{...n.config,...t}})),addVariable:(t,n)=>e(r=>({config:{...r.config,variables:{...r.config.variables,[t]:n}}})),updateVariable:(t,n)=>e(r=>({config:{...r.config,variables:{...r.config.variables,[t]:n}}})),removeVariable:t=>e(n=>{const r={...n.config.variables};return r==null||delete r[t],{config:{...n.config,variables:r}}}),updateMemory:t=>e(n=>({config:{...n.config,memory:t}})),addDatabase:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,databases:{...(a=r.config.resources)==null?void 0:a.databases,[t]:n}}}}}),updateDatabase:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.databases};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,databases:a||{}}}}}),removeDatabase:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.databases};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,databases:r||{}}}}}),addSchema:(t,n)=>e(r=>({config:{...r.config,schemas:{...r.config.schemas,[t]:n}}})),updateSchema:(t,n)=>e(r=>{const a={...r.config.schemas};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,schemas:a}}}),removeSchema:t=>e(n=>{const r={...n.config.schemas};return r==null||delete r[t],{config:{...n.config,schemas:r}}}),addLLM:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,llms:{...(a=r.config.resources)==null?void 0:a.llms,[t]:n}}}}}),updateLLM:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.llms};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,llms:a||{}}}}}),removeLLM:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.llms};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,llms:r||{}}}}}),addGenieRoom:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,genie_rooms:{...(a=r.config.resources)==null?void 0:a.genie_rooms,[t]:n}}}}}),updateGenieRoom:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.genie_rooms};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,genie_rooms:a||{}}}}}),removeGenieRoom:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.genie_rooms};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,genie_rooms:r||{}}}}}),addTable:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,tables:{...(a=r.config.resources)==null?void 0:a.tables,[t]:n}}}}}),updateTable:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.tables};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,tables:a||{}}}}}),removeTable:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.tables};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,tables:r||{}}}}}),addVolume:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,volumes:{...(a=r.config.resources)==null?void 0:a.volumes,[t]:n}}}}}),updateVolume:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.volumes};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,volumes:a||{}}}}}),removeVolume:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.volumes};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,volumes:r||{}}}}}),addFunction:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,functions:{...(a=r.config.resources)==null?void 0:a.functions,[t]:n}}}}}),updateFunction:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.functions};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,functions:a||{}}}}}),removeFunction:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.functions};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,functions:r||{}}}}}),addWarehouse:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,warehouses:{...(a=r.config.resources)==null?void 0:a.warehouses,[t]:n}}}}}),updateWarehouse:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.warehouses};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,warehouses:a||{}}}}}),removeWarehouse:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.warehouses};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,warehouses:r||{}}}}}),addConnection:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,connections:{...(a=r.config.resources)==null?void 0:a.connections,[t]:n}}}}}),updateConnection:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.connections};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,connections:a||{}}}}}),removeConnection:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.connections};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,connections:r||{}}}}}),addServicePrincipal:(t,n)=>e(r=>({config:{...r.config,service_principals:{...r.config.service_principals,[t]:n}}})),updateServicePrincipal:(t,n)=>e(r=>{const a={...r.config.service_principals};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,service_principals:a}}}),removeServicePrincipal:t=>e(n=>{const r={...n.config.service_principals};return r==null||delete r[t],{config:{...n.config,service_principals:r}}}),addVectorStore:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,vector_stores:{...(a=r.config.resources)==null?void 0:a.vector_stores,[t]:n}}}}}),updateVectorStore:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.vector_stores};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,vector_stores:a||{}}}}}),removeVectorStore:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.vector_stores};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,vector_stores:r||{}}}}}),addRetriever:(t,n)=>e(r=>({config:{...r.config,retrievers:{...r.config.retrievers,[t]:n}}})),updateRetriever:(t,n)=>e(r=>{const a={...r.config.retrievers};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,retrievers:a}}}),removeRetriever:t=>e(n=>{const r={...n.config.retrievers};return r==null||delete r[t],{config:{...n.config,retrievers:r}}}),addTool:(t,n)=>e(r=>({config:{...r.config,tools:{...r.config.tools,[t]:n}}})),updateTool:(t,n)=>e(r=>{const a={...r.config.tools};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,tools:a}}}),removeTool:t=>e(n=>{const r={...n.config.tools};return r==null||delete r[t],{config:{...n.config,tools:r}}}),addGuardrail:(t,n)=>e(r=>({config:{...r.config,guardrails:{...r.config.guardrails,[t]:n}}})),updateGuardrail:(t,n)=>e(r=>{const a={...r.config.guardrails};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,guardrails:a}}}),removeGuardrail:t=>e(n=>{const r={...n.config.guardrails};return r==null||delete r[t],{config:{...n.config,guardrails:r}}}),addPrompt:(t,n)=>e(r=>({config:{...r.config,prompts:{...r.config.prompts,[t]:n}}})),updatePrompt:(t,n)=>e(r=>{const a={...r.config.prompts};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,prompts:a}}}),removePrompt:t=>e(n=>{const r={...n.config.prompts};return r==null||delete r[t],{config:{...n.config,prompts:r}}}),addAgent:(t,n)=>e(r=>{var o;const a={...r.config.agents,[t]:n},l=[...((o=r.config.app)==null?void 0:o.agents)||[],n];return{config:{...r.config,agents:a,app:r.config.app?{...r.config.app,agents:l}:void 0}}}),updateAgent:(t,n)=>e(r=>{var l,o;const a={...r.config.agents};if(a!=null&&a[t]){a[t]={...a[t],...n};const c=((o=(l=r.config.app)==null?void 0:l.agents)==null?void 0:o.map(i=>i.name===t?{...i,...n}:i))||[];return{config:{...r.config,agents:a,app:r.config.app?{...r.config.app,agents:c}:void 0}}}return{config:r.config}}),removeAgent:t=>e(n=>{var l,o;const r={...n.config.agents};r==null||delete r[t];const a=((o=(l=n.config.app)==null?void 0:l.agents)==null?void 0:o.filter(c=>c.name!==t))||[];return{config:{...n.config,agents:r,app:n.config.app?{...n.config.app,agents:a}:void 0}}}),updateApp:t=>e(n=>{var r,a,l;return{config:{...n.config,app:{name:((r=n.config.app)==null?void 0:r.name)||"",registered_model:((a=n.config.app)==null?void 0:a.registered_model)||{name:""},agents:((l=n.config.app)==null?void 0:l.agents)||[],...n.config.app,...t}}}}),reset:()=>e({config:bp})}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),fe=(e,t)=>{const n=M.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:c="",children:i,...u},m)=>M.createElement("svg",{ref:m,...bw,width:a,height:a,stroke:r,strokeWidth:o?Number(l)*24/Number(a):l,className:["lucide",`lucide-${yw(e)}`,c].join(" "),...u},[...t.map(([h,f])=>M.createElement(h,f)),...Array.isArray(i)?i:[i]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=fe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=fe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yp=fe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=fe("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=fe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=fe("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jw=fe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=fe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=fe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=fe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=fe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=fe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=fe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=fe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=fe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=fe("CloudCog",[["circle",{cx:"12",cy:"17",r:"3",key:"1spfwm"}],["path",{d:"M4.2 15.1A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.2",key:"zaobp"}],["path",{d:"m15.7 18.4-.9-.3",key:"4qxpbn"}],["path",{d:"m9.2 15.9-.9-.3",key:"17q7o2"}],["path",{d:"m10.6 20.7.3-.9",key:"1pf4s2"}],["path",{d:"m13.1 14.2.3-.9",key:"1mnuqm"}],["path",{d:"m13.6 20.7-.4-1",key:"1jpd1m"}],["path",{d:"m10.8 14.3-.4-1",key:"17ugyy"}],["path",{d:"m8.3 18.6 1-.4",key:"s42vdx"}],["path",{d:"m14.7 15.8 1-.4",key:"2wizun"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jd=fe("Code2",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=fe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=fe("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=fe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=fe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cw=fe("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=fe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=fe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=fe("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=fe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=fe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=fe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aw=fe("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=fe("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=fe("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=fe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=fe("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=fe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=fe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=fe("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=fe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=fe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=fe("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=fe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=fe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=fe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=fe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=fe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=fe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=fe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=fe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=fe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=fe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const am=fe("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=fe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=fe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=fe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=fe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=fe("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=fe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=fe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=fe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lm=fe("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const om=fe("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=fe("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=fe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=fe("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=fe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=fe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=fe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=fe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=fe("Variable",[["path",{d:"M8 21s-4-3-4-9 4-9 4-9",key:"uto9ud"}],["path",{d:"M16 3s4 3 4 9-4 9-4 9",key:"4w2vsq"}],["line",{x1:"15",x2:"9",y1:"9",y2:"15",key:"f7djnv"}],["line",{x1:"9",x2:"15",y1:"9",y2:"15",key:"1shsy8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=fe("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=fe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=fe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oc=fe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function Tv(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=Tv(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Ye(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=Tv(e))&&(r&&(r+=" "),r+=t);return r}const qn=cl(e=>({targetSection:null,targetAsset:null,scrollTimestamp:0,scrollToSection:t=>e({targetSection:t,targetAsset:null,scrollTimestamp:Date.now()}),scrollToAsset:t=>e({targetSection:null,targetAsset:t,scrollTimestamp:Date.now()}),clearTarget:()=>e({targetSection:null,targetAsset:null})})),Iu=[{id:"overview",label:"Overview",icon:Mw,description:"Getting started"},{id:"variables",label:"Variables",icon:Un,description:"Config variables"},{id:"service_principals",label:"Service Principals",icon:Cr,description:"OAuth credentials"},{id:"schemas",label:"Schemas",icon:on,description:"Unity Catalog schemas",required:!0},{id:"resources",label:"Resources",icon:Mv,description:"Databricks resources",required:!0},{id:"retrievers",label:"Retrievers",icon:sa,description:"Vector search retrievers"},{id:"tools",label:"Tools",icon:Rs,description:"Agent tools"},{id:"guardrails",label:"Guardrails",icon:Sr,description:"Safety checks"},{id:"memory",label:"Memory",icon:tm,description:"Persistence & storage"},{id:"prompts",label:"Prompts",icon:Qa,description:"MLflow prompts"},{id:"agents",label:"Agents",icon:Zt,description:"AI agents",required:!0},{id:"app",label:"Application",icon:Ss,description:"App settings & orchestration",required:!0}];function Dw({activeSection:e,onSectionChange:t,config:n}){const{scrollToSection:r}=qn(),a=c=>{t(c),c!=="overview"&&r(c)},l=c=>{var i,u,m,h,f,g,b,w,x,d;switch(c){case"overview":return 0;case"variables":return Object.keys(n.variables||{}).length;case"service_principals":return Object.keys(n.service_principals||{}).length;case"schemas":return Object.keys(n.schemas||{}).length;case"resources":return Object.keys(((i=n.resources)==null?void 0:i.llms)||{}).length+Object.keys(((u=n.resources)==null?void 0:u.genie_rooms)||{}).length+Object.keys(((m=n.resources)==null?void 0:m.tables)||{}).length+Object.keys(((h=n.resources)==null?void 0:h.volumes)||{}).length+Object.keys(((f=n.resources)==null?void 0:f.functions)||{}).length+Object.keys(((g=n.resources)==null?void 0:g.warehouses)||{}).length+Object.keys(((b=n.resources)==null?void 0:b.connections)||{}).length;case"retrievers":return Object.keys(n.retrievers||{}).length;case"tools":return Object.keys(n.tools||{}).length;case"guardrails":return Object.keys(n.guardrails||{}).length;case"memory":return((w=n.memory)!=null&&w.checkpointer?1:0)+((x=n.memory)!=null&&x.store?1:0);case"prompts":return Object.keys(n.prompts||{}).length;case"agents":return Object.keys(n.agents||{}).length;case"app":return(d=n.app)!=null&&d.name?1:0;default:return 0}},o=c=>{const i=l(c),u=Iu.find(m=>m.id===c);return u!=null&&u.required?i>0:!0};return s.jsxs("aside",{className:"w-64 bg-slate-900 border-r border-slate-800 flex flex-col min-h-0",children:[s.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 p-4",children:[s.jsx("h2",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3",children:"Configuration"}),s.jsx("nav",{className:"space-y-1",children:Iu.map(c=>{const i=c.icon,u=l(c.id),m=o(c.id),h=e===c.id;return s.jsxs("button",{onClick:()=>a(c.id),className:Ye("w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-left transition-all duration-200",h?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"text-slate-400 hover:bg-slate-800 hover:text-slate-200 border border-transparent"),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(i,{className:Ye("w-5 h-5",h?"text-blue-400":"text-slate-500")}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium",children:c.label}),s.jsx("p",{className:"text-xs text-slate-500",children:c.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[u>0&&s.jsx("span",{className:Ye("px-1.5 py-0.5 text-xs rounded",h?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"),children:u}),c.required&&(m?s.jsx(Kn,{className:"w-4 h-4 text-emerald-500"}):s.jsx(_w,{className:"w-4 h-4 text-amber-500"}))]})]},c.id)})})]}),s.jsx("div",{className:"flex-shrink-0 p-4 border-t border-slate-800",children:s.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-slate-400 mb-2",children:"Configuration Status"}),s.jsx("div",{className:"space-y-1.5",children:Iu.filter(c=>c.required).map(c=>{const i=o(c.id);return s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-slate-500",children:c.label}),s.jsx("span",{className:i?"text-emerald-400":"text-amber-400",children:i?" Ready":" Required"})]},c.id)})})]})})]})}const ke=M.forwardRef(({className:e,variant:t="default",children:n,...r},a)=>{const l={default:"bg-slate-800/50 border-slate-700/50",interactive:"bg-slate-800/50 border-slate-700/50 hover:border-slate-600 hover:bg-slate-800/70 cursor-pointer transition-all duration-200",highlight:"bg-gradient-to-br from-blue-500/10 to-purple-500/10 border-blue-500/30"};return s.jsx("div",{ref:a,className:Ye("rounded-xl border p-4",l[t],e),...r,children:n})});ke.displayName="Card";const Q=M.forwardRef(({className:e,variant:t="primary",size:n="md",loading:r,children:a,disabled:l,...o},c)=>{const i="inline-flex items-center justify-center font-medium transition-all duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed",u={primary:"bg-blue-600 text-white hover:bg-blue-500 focus:ring-blue-500 shadow-lg shadow-blue-500/25",secondary:"bg-slate-700 text-slate-200 hover:bg-slate-600 focus:ring-slate-500 border border-slate-600",ghost:"bg-transparent text-slate-300 hover:bg-slate-800 hover:text-white focus:ring-slate-500",danger:"bg-red-600/20 text-red-400 hover:bg-red-600/30 focus:ring-red-500 border border-red-500/30"},m={sm:"px-3 py-1.5 text-sm gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-2"};return s.jsxs("button",{ref:c,className:Ye(i,u[t],m[n],e),disabled:l||r,...o,children:[r&&s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})});Q.displayName="Button";const Ee=M.forwardRef(({className:e,variant:t="default",children:n,...r},a)=>{const l={default:"bg-slate-700 text-slate-300",success:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",warning:"bg-amber-500/20 text-amber-400 border-amber-500/30",danger:"bg-red-500/20 text-red-400 border-red-500/30",info:"bg-blue-500/20 text-blue-400 border-blue-500/30"};return s.jsx("span",{ref:a,className:Ye("inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium border",l[t],e),...r,children:n})});Ee.displayName="Badge";const si=[{id:"schemas",title:"1. Define Schemas",description:"Set up Unity Catalog schemas for your resources",icon:on,color:"text-blue-400",isComplete:e=>Object.keys(e.schemas||{}).length>0},{id:"resources",title:"2. Configure Resources",description:"Add LLMs, Genie rooms, tables, and other Databricks resources",icon:Mv,color:"text-emerald-400",isComplete:e=>{const t=e.resources||{};return Object.keys(t.llms||{}).length>0}},{id:"tools",title:"3. Create Tools",description:"Define tools that agents can use to perform tasks",icon:Rs,color:"text-amber-400",isComplete:e=>Object.keys(e.tools||{}).length>0},{id:"agents",title:"4. Build Agents",description:"Create AI agents with models, tools, and prompts",icon:Zt,color:"text-violet-400",isComplete:e=>Object.keys(e.agents||{}).length>0},{id:"app",title:"5. Configure Application",description:"Set up your application and deployment settings",icon:Ss,color:"text-rose-400",isComplete:e=>{var t,n,r;return((t=e.app)==null?void 0:t.name)&&((r=(n=e.app)==null?void 0:n.registered_model)==null?void 0:r.name)}}];function Fw({onNavigate:e}){var c;const{config:t}=We(),n={schemas:Object.keys(t.schemas||{}).length,llms:Object.keys(((c=t.resources)==null?void 0:c.llms)||{}).length,tools:Object.keys(t.tools||{}).length,agents:Object.keys(t.agents||{}).length,prompts:Object.keys(t.prompts||{}).length},r=si.filter(i=>i.isComplete(t)).length,a=si.length,l=Math.round(r/a*100),o=r===0;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"DAO AI Configuration Builder"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Build and configure multi-agent AI systems for Databricks"})]}),s.jsxs(ke,{className:"bg-gradient-to-br from-slate-800/80 to-slate-900/80 border-slate-700/50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center",children:s.jsx(kt,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-white",children:o?"Get Started":"Configuration Progress"}),s.jsx("p",{className:"text-sm text-slate-400",children:o?"Follow the steps below to build your agent configuration":`${r} of ${a} steps completed`})]})]}),!o&&s.jsxs("div",{className:"text-right",children:[s.jsxs("span",{className:"text-2xl font-bold text-white",children:[l,"%"]}),s.jsx("p",{className:"text-xs text-slate-500",children:"complete"})]})]}),s.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2 mb-4",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-violet-500 h-2 rounded-full transition-all duration-500",style:{width:`${l}%`}})}),!o&&s.jsxs("div",{className:"grid grid-cols-5 gap-4 pt-2",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.schemas}),s.jsx("p",{className:"text-xs text-slate-500",children:"Schemas"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.llms}),s.jsx("p",{className:"text-xs text-slate-500",children:"LLMs"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.tools}),s.jsx("p",{className:"text-xs text-slate-500",children:"Tools"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.agents}),s.jsx("p",{className:"text-xs text-slate-500",children:"Agents"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.prompts}),s.jsx("p",{className:"text-xs text-slate-500",children:"Prompts"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:o?"Getting Started":"Configuration Steps"}),si.map((i,u)=>{const m=i.icon,h=i.isComplete(t),f=!h&&si.slice(0,u).every(g=>g.isComplete(t));return s.jsx(ke,{variant:f?"highlight":"default",className:`transition-all duration-200 ${f?"ring-1 ring-blue-500/50":""}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${h?"bg-emerald-500/20":f?"bg-blue-500/20":"bg-slate-700/50"}`,children:h?s.jsx(Kn,{className:"w-5 h-5 text-emerald-400"}):s.jsx(m,{className:`w-5 h-5 ${f?i.color:"text-slate-500"}`})}),s.jsxs("div",{children:[s.jsx("h4",{className:`font-medium ${h?"text-slate-400":"text-white"}`,children:i.title}),s.jsx("p",{className:"text-sm text-slate-500",children:i.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[h&&s.jsx(Ee,{variant:"success",children:"Complete"}),f&&s.jsx(Ee,{variant:"info",children:"Next Step"}),s.jsxs(Q,{variant:f?"primary":"secondary",size:"sm",onClick:()=>e(i.id),children:[h?"Edit":f?"Start":"Configure",s.jsx(Nw,{className:"w-4 h-4 ml-1"})]})]})]})},i.id)})]}),s.jsxs(ke,{children:[s.jsx("h3",{className:"font-semibold text-white mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("button",{onClick:()=>e("prompts"),className:"flex items-center space-x-3 p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg transition-colors text-left",children:[s.jsx(Qa,{className:"w-5 h-5 text-violet-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Manage Prompts"}),s.jsx("p",{className:"text-xs text-slate-500",children:"MLflow registry"})]})]}),s.jsxs("button",{onClick:()=>e("memory"),className:"flex items-center space-x-3 p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg transition-colors text-left",children:[s.jsx(on,{className:"w-5 h-5 text-cyan-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Configure Memory"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Persistence options"})]})]}),s.jsxs("button",{onClick:()=>e("app"),className:"flex items-center space-x-3 p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg transition-colors text-left",children:[s.jsx(Zt,{className:"w-5 h-5 text-amber-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Configure Application"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Orchestration & deployment"})]})]})]})]}),s.jsx("div",{className:"text-center text-sm text-slate-500 py-4",children:s.jsx("p",{children:" Tip: Use the YAML preview on the right to see your configuration in real-time"})})]})}const re=M.forwardRef(({className:e,label:t,error:n,hint:r,id:a,...l},o)=>{const c=a||(t==null?void 0:t.toLowerCase().replace(/\s+/g,"-"));return s.jsxs("div",{className:"space-y-1.5",children:[t&&s.jsxs("label",{htmlFor:c,className:"block text-sm font-medium text-slate-300",children:[t,l.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("input",{ref:o,id:c,className:Ye("w-full px-3 py-2 bg-slate-800/50 border rounded-lg text-slate-200 placeholder-slate-500","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200",n?"border-red-500/50":"border-slate-700",e),...l}),r&&!n&&s.jsx("p",{className:"text-xs text-slate-500",children:r}),n&&s.jsx("p",{className:"text-xs text-red-400",children:n})]})});re.displayName="Input";const le=M.forwardRef(({className:e,label:t,error:n,hint:r,options:a,placeholder:l,id:o,...c},i)=>{const u=o||(t==null?void 0:t.toLowerCase().replace(/\s+/g,"-")),m=a.length===0;return s.jsxs("div",{className:"space-y-1.5",children:[t&&s.jsxs("label",{htmlFor:u,className:"block text-sm font-medium text-slate-300",children:[t,c.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("div",{className:"relative",children:m?s.jsxs("div",{className:Ye("w-full px-3 py-2 bg-slate-800/50 border rounded-lg appearance-none","transition-all duration-200","border-slate-700 text-sm text-slate-500",e),children:["No options available",s.jsx(rs,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("select",{ref:i,id:u,className:Ye("w-full px-3 py-2 bg-slate-800/50 border rounded-lg text-slate-200 appearance-none","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200",n?"border-red-500/50":"border-slate-700",c.disabled?"opacity-50 cursor-not-allowed text-slate-500":"cursor-pointer",e),...c,children:[l&&s.jsx("option",{value:"",className:"text-slate-500",children:l}),a.map(h=>s.jsx("option",{value:h.value,className:"bg-slate-800",children:h.label},h.value))]}),s.jsx(rs,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none"})]})}),r&&!n&&s.jsx("p",{className:"text-xs text-slate-500",children:r}),n&&s.jsx("p",{className:"text-xs text-red-400",children:n})]})});le.displayName="Select";/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function Ov(e){return typeof e>"u"||e===null}function Vw(e){return typeof e=="object"&&e!==null}function zw(e){return Array.isArray(e)?e:Ov(e)?[]:[e]}function Hw(e,t){var n,r,a,l;if(t)for(l=Object.keys(t),n=0,r=l.length;n<r;n+=1)a=l[n],e[a]=t[a];return e}function Uw(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function Bw(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var Ww=Ov,Gw=Vw,Yw=zw,qw=Uw,Xw=Bw,Qw=Hw,Et={isNothing:Ww,isObject:Gw,toArray:Yw,repeat:qw,isNegativeZero:Xw,extend:Qw};function Iv(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function co(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Iv(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}co.prototype=Object.create(Error.prototype);co.prototype.constructor=co;co.prototype.toString=function(t){return this.name+": "+Iv(this,t)};var ln=co;function Lu(e,t,n,r,a){var l="",o="",c=Math.floor(a/2)-1;return r-t>c&&(l=" ... ",t=r-c+l.length),n-r>c&&(o=" ...",n=r+c-o.length),{str:l+e.slice(t,n).replace(/\t/g,"")+o,pos:r-t+l.length}}function $u(e,t){return Et.repeat(" ",t-e.length)+e}function Kw(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],a=[],l,o=-1;l=n.exec(e.buffer);)a.push(l.index),r.push(l.index+l[0].length),e.position<=l.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var c="",i,u,m=Math.min(e.line+t.linesAfter,a.length).toString().length,h=t.maxLength-(t.indent+m+3);for(i=1;i<=t.linesBefore&&!(o-i<0);i++)u=Lu(e.buffer,r[o-i],a[o-i],e.position-(r[o]-r[o-i]),h),c=Et.repeat(" ",t.indent)+$u((e.line-i+1).toString(),m)+" | "+u.str+`
`+c;for(u=Lu(e.buffer,r[o],a[o],e.position,h),c+=Et.repeat(" ",t.indent)+$u((e.line+1).toString(),m)+" | "+u.str+`
`,c+=Et.repeat("-",t.indent+m+3+u.pos)+`^
`,i=1;i<=t.linesAfter&&!(o+i>=a.length);i++)u=Lu(e.buffer,r[o+i],a[o+i],e.position-(r[o]-r[o+i]),h),c+=Et.repeat(" ",t.indent)+$u((e.line+i+1).toString(),m)+" | "+u.str+`
`;return c.replace(/\n$/,"")}var Zw=Kw,Jw=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],e1=["scalar","sequence","mapping"];function t1(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function n1(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(Jw.indexOf(n)===-1)throw new ln('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=t1(t.styleAliases||null),e1.indexOf(this.kind)===-1)throw new ln('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Bt=n1;function Sp(e,t){var n=[];return e[t].forEach(function(r){var a=n.length;n.forEach(function(l,o){l.tag===r.tag&&l.kind===r.kind&&l.multi===r.multi&&(a=o)}),n[a]=r}),n}function s1(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(a){a.multi?(e.multi[a.kind].push(a),e.multi.fallback.push(a)):e[a.kind][a.tag]=e.fallback[a.tag]=a}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function cm(e){return this.extend(e)}cm.prototype.extend=function(t){var n=[],r=[];if(t instanceof Bt)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new ln("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(l){if(!(l instanceof Bt))throw new ln("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(l.loadKind&&l.loadKind!=="scalar")throw new ln("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(l.multi)throw new ln("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(l){if(!(l instanceof Bt))throw new ln("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(cm.prototype);return a.implicit=(this.implicit||[]).concat(n),a.explicit=(this.explicit||[]).concat(r),a.compiledImplicit=Sp(a,"implicit"),a.compiledExplicit=Sp(a,"explicit"),a.compiledTypeMap=s1(a.compiledImplicit,a.compiledExplicit),a};var Lv=cm,$v=new Bt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),Dv=new Bt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),Fv=new Bt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),Vv=new Lv({explicit:[$v,Dv,Fv]});function r1(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function a1(){return null}function l1(e){return e===null}var zv=new Bt("tag:yaml.org,2002:null",{kind:"scalar",resolve:r1,construct:a1,predicate:l1,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function o1(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function i1(e){return e==="true"||e==="True"||e==="TRUE"}function c1(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var Hv=new Bt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:o1,construct:i1,predicate:c1,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function u1(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function d1(e){return 48<=e&&e<=55}function m1(e){return 48<=e&&e<=57}function f1(e){if(e===null)return!1;var t=e.length,n=0,r=!1,a;if(!t)return!1;if(a=e[n],(a==="-"||a==="+")&&(a=e[++n]),a==="0"){if(n+1===t)return!0;if(a=e[++n],a==="b"){for(n++;n<t;n++)if(a=e[n],a!=="_"){if(a!=="0"&&a!=="1")return!1;r=!0}return r&&a!=="_"}if(a==="x"){for(n++;n<t;n++)if(a=e[n],a!=="_"){if(!u1(e.charCodeAt(n)))return!1;r=!0}return r&&a!=="_"}if(a==="o"){for(n++;n<t;n++)if(a=e[n],a!=="_"){if(!d1(e.charCodeAt(n)))return!1;r=!0}return r&&a!=="_"}}if(a==="_")return!1;for(;n<t;n++)if(a=e[n],a!=="_"){if(!m1(e.charCodeAt(n)))return!1;r=!0}return!(!r||a==="_")}function h1(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function p1(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!Et.isNegativeZero(e)}var Uv=new Bt("tag:yaml.org,2002:int",{kind:"scalar",resolve:f1,construct:h1,predicate:p1,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),x1=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function g1(e){return!(e===null||!x1.test(e)||e[e.length-1]==="_")}function v1(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var b1=/^[-+]?[0-9]+e/;function y1(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Et.isNegativeZero(e))return"-0.0";return n=e.toString(10),b1.test(n)?n.replace("e",".e"):n}function N1(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||Et.isNegativeZero(e))}var Bv=new Bt("tag:yaml.org,2002:float",{kind:"scalar",resolve:g1,construct:v1,predicate:N1,represent:y1,defaultStyle:"lowercase"}),Wv=Vv.extend({implicit:[zv,Hv,Uv,Bv]}),Gv=Wv,Yv=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),qv=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function j1(e){return e===null?!1:Yv.exec(e)!==null||qv.exec(e)!==null}function _1(e){var t,n,r,a,l,o,c,i=0,u=null,m,h,f;if(t=Yv.exec(e),t===null&&(t=qv.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,r,a));if(l=+t[4],o=+t[5],c=+t[6],t[7]){for(i=t[7].slice(0,3);i.length<3;)i+="0";i=+i}return t[9]&&(m=+t[10],h=+(t[11]||0),u=(m*60+h)*6e4,t[9]==="-"&&(u=-u)),f=new Date(Date.UTC(n,r,a,l,o,c,i)),u&&f.setTime(f.getTime()-u),f}function w1(e){return e.toISOString()}var Xv=new Bt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:j1,construct:_1,instanceOf:Date,represent:w1});function S1(e){return e==="<<"||e===null}var Qv=new Bt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:S1}),Of=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function C1(e){if(e===null)return!1;var t,n,r=0,a=e.length,l=Of;for(n=0;n<a;n++)if(t=l.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function k1(e){var t,n,r=e.replace(/[\r\n=]/g,""),a=r.length,l=Of,o=0,c=[];for(t=0;t<a;t++)t%4===0&&t&&(c.push(o>>16&255),c.push(o>>8&255),c.push(o&255)),o=o<<6|l.indexOf(r.charAt(t));return n=a%4*6,n===0?(c.push(o>>16&255),c.push(o>>8&255),c.push(o&255)):n===18?(c.push(o>>10&255),c.push(o>>2&255)):n===12&&c.push(o>>4&255),new Uint8Array(c)}function E1(e){var t="",n=0,r,a,l=e.length,o=Of;for(r=0;r<l;r++)r%3===0&&r&&(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]),n=(n<<8)+e[r];return a=l%3,a===0?(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]):a===2?(t+=o[n>>10&63],t+=o[n>>4&63],t+=o[n<<2&63],t+=o[64]):a===1&&(t+=o[n>>2&63],t+=o[n<<4&63],t+=o[64],t+=o[64]),t}function A1(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var Kv=new Bt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:C1,construct:k1,predicate:A1,represent:E1}),R1=Object.prototype.hasOwnProperty,M1=Object.prototype.toString;function P1(e){if(e===null)return!0;var t=[],n,r,a,l,o,c=e;for(n=0,r=c.length;n<r;n+=1){if(a=c[n],o=!1,M1.call(a)!=="[object Object]")return!1;for(l in a)if(R1.call(a,l))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(l)===-1)t.push(l);else return!1}return!0}function T1(e){return e!==null?e:[]}var Zv=new Bt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:P1,construct:T1}),O1=Object.prototype.toString;function I1(e){if(e===null)return!0;var t,n,r,a,l,o=e;for(l=new Array(o.length),t=0,n=o.length;t<n;t+=1){if(r=o[t],O1.call(r)!=="[object Object]"||(a=Object.keys(r),a.length!==1))return!1;l[t]=[a[0],r[a[0]]]}return!0}function L1(e){if(e===null)return[];var t,n,r,a,l,o=e;for(l=new Array(o.length),t=0,n=o.length;t<n;t+=1)r=o[t],a=Object.keys(r),l[t]=[a[0],r[a[0]]];return l}var Jv=new Bt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:I1,construct:L1}),$1=Object.prototype.hasOwnProperty;function D1(e){if(e===null)return!0;var t,n=e;for(t in n)if($1.call(n,t)&&n[t]!==null)return!1;return!0}function F1(e){return e!==null?e:{}}var eb=new Bt("tag:yaml.org,2002:set",{kind:"mapping",resolve:D1,construct:F1}),If=Gv.extend({implicit:[Xv,Qv],explicit:[Kv,Zv,Jv,eb]}),kr=Object.prototype.hasOwnProperty,ic=1,tb=2,nb=3,cc=4,Du=1,V1=2,Cp=3,z1=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,H1=/[\x85\u2028\u2029]/,U1=/[,\[\]\{\}]/,sb=/^(?:!|!!|![a-z\-]+!)$/i,rb=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function kp(e){return Object.prototype.toString.call(e)}function Es(e){return e===10||e===13}function Xr(e){return e===9||e===32}function vn(e){return e===9||e===32||e===10||e===13}function Ea(e){return e===44||e===91||e===93||e===123||e===125}function B1(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function W1(e){return e===120?2:e===117?4:e===85?8:0}function G1(e){return 48<=e&&e<=57?e-48:-1}function Ep(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function Y1(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function ab(e,t,n){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}var lb=new Array(256),ob=new Array(256);for(var fa=0;fa<256;fa++)lb[fa]=Ep(fa)?1:0,ob[fa]=Ep(fa);function q1(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||If,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function ib(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=Zw(n),new ln(t,n)}function _e(e,t){throw ib(e,t)}function uc(e,t){e.onWarning&&e.onWarning.call(null,ib(e,t))}var Ap={YAML:function(t,n,r){var a,l,o;t.version!==null&&_e(t,"duplication of %YAML directive"),r.length!==1&&_e(t,"YAML directive accepts exactly one argument"),a=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),a===null&&_e(t,"ill-formed argument of the YAML directive"),l=parseInt(a[1],10),o=parseInt(a[2],10),l!==1&&_e(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&uc(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var a,l;r.length!==2&&_e(t,"TAG directive accepts exactly two arguments"),a=r[0],l=r[1],sb.test(a)||_e(t,"ill-formed tag handle (first argument) of the TAG directive"),kr.call(t.tagMap,a)&&_e(t,'there is a previously declared suffix for "'+a+'" tag handle'),rb.test(l)||_e(t,"ill-formed tag prefix (second argument) of the TAG directive");try{l=decodeURIComponent(l)}catch{_e(t,"tag prefix is malformed: "+l)}t.tagMap[a]=l}};function yr(e,t,n,r){var a,l,o,c;if(t<n){if(c=e.input.slice(t,n),r)for(a=0,l=c.length;a<l;a+=1)o=c.charCodeAt(a),o===9||32<=o&&o<=1114111||_e(e,"expected valid JSON character");else z1.test(c)&&_e(e,"the stream contains non-printable characters");e.result+=c}}function Rp(e,t,n,r){var a,l,o,c;for(Et.isObject(n)||_e(e,"cannot merge mappings; the provided source object is unacceptable"),a=Object.keys(n),o=0,c=a.length;o<c;o+=1)l=a[o],kr.call(t,l)||(ab(t,l,n[l]),r[l]=!0)}function Aa(e,t,n,r,a,l,o,c,i){var u,m;if(Array.isArray(a))for(a=Array.prototype.slice.call(a),u=0,m=a.length;u<m;u+=1)Array.isArray(a[u])&&_e(e,"nested arrays are not supported inside keys"),typeof a=="object"&&kp(a[u])==="[object Object]"&&(a[u]="[object Object]");if(typeof a=="object"&&kp(a)==="[object Object]"&&(a="[object Object]"),a=String(a),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(l))for(u=0,m=l.length;u<m;u+=1)Rp(e,t,l[u],n);else Rp(e,t,l,n);else!e.json&&!kr.call(n,a)&&kr.call(t,a)&&(e.line=o||e.line,e.lineStart=c||e.lineStart,e.position=i||e.position,_e(e,"duplicated mapping key")),ab(t,a,l),delete n[a];return t}function Lf(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):_e(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function jt(e,t,n){for(var r=0,a=e.input.charCodeAt(e.position);a!==0;){for(;Xr(a);)a===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),a=e.input.charCodeAt(++e.position);if(t&&a===35)do a=e.input.charCodeAt(++e.position);while(a!==10&&a!==13&&a!==0);if(Es(a))for(Lf(e),a=e.input.charCodeAt(e.position),r++,e.lineIndent=0;a===32;)e.lineIndent++,a=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&uc(e,"deficient indentation"),r}function Wc(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||vn(n)))}function $f(e,t){t===1?e.result+=" ":t>1&&(e.result+=Et.repeat(`
`,t-1))}function X1(e,t,n){var r,a,l,o,c,i,u,m,h=e.kind,f=e.result,g;if(g=e.input.charCodeAt(e.position),vn(g)||Ea(g)||g===35||g===38||g===42||g===33||g===124||g===62||g===39||g===34||g===37||g===64||g===96||(g===63||g===45)&&(a=e.input.charCodeAt(e.position+1),vn(a)||n&&Ea(a)))return!1;for(e.kind="scalar",e.result="",l=o=e.position,c=!1;g!==0;){if(g===58){if(a=e.input.charCodeAt(e.position+1),vn(a)||n&&Ea(a))break}else if(g===35){if(r=e.input.charCodeAt(e.position-1),vn(r))break}else{if(e.position===e.lineStart&&Wc(e)||n&&Ea(g))break;if(Es(g))if(i=e.line,u=e.lineStart,m=e.lineIndent,jt(e,!1,-1),e.lineIndent>=t){c=!0,g=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=i,e.lineStart=u,e.lineIndent=m;break}}c&&(yr(e,l,o,!1),$f(e,e.line-i),l=o=e.position,c=!1),Xr(g)||(o=e.position+1),g=e.input.charCodeAt(++e.position)}return yr(e,l,o,!1),e.result?!0:(e.kind=h,e.result=f,!1)}function Q1(e,t){var n,r,a;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=a=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(yr(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,a=e.position;else return!0;else Es(n)?(yr(e,r,a,!0),$f(e,jt(e,!1,t)),r=a=e.position):e.position===e.lineStart&&Wc(e)?_e(e,"unexpected end of the document within a single quoted scalar"):(e.position++,a=e.position);_e(e,"unexpected end of the stream within a single quoted scalar")}function K1(e,t){var n,r,a,l,o,c;if(c=e.input.charCodeAt(e.position),c!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(c=e.input.charCodeAt(e.position))!==0;){if(c===34)return yr(e,n,e.position,!0),e.position++,!0;if(c===92){if(yr(e,n,e.position,!0),c=e.input.charCodeAt(++e.position),Es(c))jt(e,!1,t);else if(c<256&&lb[c])e.result+=ob[c],e.position++;else if((o=W1(c))>0){for(a=o,l=0;a>0;a--)c=e.input.charCodeAt(++e.position),(o=B1(c))>=0?l=(l<<4)+o:_e(e,"expected hexadecimal character");e.result+=Y1(l),e.position++}else _e(e,"unknown escape sequence");n=r=e.position}else Es(c)?(yr(e,n,r,!0),$f(e,jt(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Wc(e)?_e(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}_e(e,"unexpected end of the stream within a double quoted scalar")}function Z1(e,t){var n=!0,r,a,l,o=e.tag,c,i=e.anchor,u,m,h,f,g,b=Object.create(null),w,x,d,p;if(p=e.input.charCodeAt(e.position),p===91)m=93,g=!1,c=[];else if(p===123)m=125,g=!0,c={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=c),p=e.input.charCodeAt(++e.position);p!==0;){if(jt(e,!0,t),p=e.input.charCodeAt(e.position),p===m)return e.position++,e.tag=o,e.anchor=i,e.kind=g?"mapping":"sequence",e.result=c,!0;n?p===44&&_e(e,"expected the node content, but found ','"):_e(e,"missed comma between flow collection entries"),x=w=d=null,h=f=!1,p===63&&(u=e.input.charCodeAt(e.position+1),vn(u)&&(h=f=!0,e.position++,jt(e,!0,t))),r=e.line,a=e.lineStart,l=e.position,Za(e,t,ic,!1,!0),x=e.tag,w=e.result,jt(e,!0,t),p=e.input.charCodeAt(e.position),(f||e.line===r)&&p===58&&(h=!0,p=e.input.charCodeAt(++e.position),jt(e,!0,t),Za(e,t,ic,!1,!0),d=e.result),g?Aa(e,c,b,x,w,d,r,a,l):h?c.push(Aa(e,null,b,x,w,d,r,a,l)):c.push(w),jt(e,!0,t),p=e.input.charCodeAt(e.position),p===44?(n=!0,p=e.input.charCodeAt(++e.position)):n=!1}_e(e,"unexpected end of the stream within a flow collection")}function J1(e,t){var n,r,a=Du,l=!1,o=!1,c=t,i=0,u=!1,m,h;if(h=e.input.charCodeAt(e.position),h===124)r=!1;else if(h===62)r=!0;else return!1;for(e.kind="scalar",e.result="";h!==0;)if(h=e.input.charCodeAt(++e.position),h===43||h===45)Du===a?a=h===43?Cp:V1:_e(e,"repeat of a chomping mode identifier");else if((m=G1(h))>=0)m===0?_e(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?_e(e,"repeat of an indentation width identifier"):(c=t+m-1,o=!0);else break;if(Xr(h)){do h=e.input.charCodeAt(++e.position);while(Xr(h));if(h===35)do h=e.input.charCodeAt(++e.position);while(!Es(h)&&h!==0)}for(;h!==0;){for(Lf(e),e.lineIndent=0,h=e.input.charCodeAt(e.position);(!o||e.lineIndent<c)&&h===32;)e.lineIndent++,h=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>c&&(c=e.lineIndent),Es(h)){i++;continue}if(e.lineIndent<c){a===Cp?e.result+=Et.repeat(`
`,l?1+i:i):a===Du&&l&&(e.result+=`
`);break}for(r?Xr(h)?(u=!0,e.result+=Et.repeat(`
`,l?1+i:i)):u?(u=!1,e.result+=Et.repeat(`
`,i+1)):i===0?l&&(e.result+=" "):e.result+=Et.repeat(`
`,i):e.result+=Et.repeat(`
`,l?1+i:i),l=!0,o=!0,i=0,n=e.position;!Es(h)&&h!==0;)h=e.input.charCodeAt(++e.position);yr(e,n,e.position,!1)}return!0}function Mp(e,t){var n,r=e.tag,a=e.anchor,l=[],o,c=!1,i;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),i=e.input.charCodeAt(e.position);i!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,_e(e,"tab characters must not be used in indentation")),!(i!==45||(o=e.input.charCodeAt(e.position+1),!vn(o))));){if(c=!0,e.position++,jt(e,!0,-1)&&e.lineIndent<=t){l.push(null),i=e.input.charCodeAt(e.position);continue}if(n=e.line,Za(e,t,nb,!1,!0),l.push(e.result),jt(e,!0,-1),i=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&i!==0)_e(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return c?(e.tag=r,e.anchor=a,e.kind="sequence",e.result=l,!0):!1}function eS(e,t,n){var r,a,l,o,c,i,u=e.tag,m=e.anchor,h={},f=Object.create(null),g=null,b=null,w=null,x=!1,d=!1,p;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=h),p=e.input.charCodeAt(e.position);p!==0;){if(!x&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,_e(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),l=e.line,(p===63||p===58)&&vn(r))p===63?(x&&(Aa(e,h,f,g,b,null,o,c,i),g=b=w=null),d=!0,x=!0,a=!0):x?(x=!1,a=!0):_e(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,p=r;else{if(o=e.line,c=e.lineStart,i=e.position,!Za(e,n,tb,!1,!0))break;if(e.line===l){for(p=e.input.charCodeAt(e.position);Xr(p);)p=e.input.charCodeAt(++e.position);if(p===58)p=e.input.charCodeAt(++e.position),vn(p)||_e(e,"a whitespace character is expected after the key-value separator within a block mapping"),x&&(Aa(e,h,f,g,b,null,o,c,i),g=b=w=null),d=!0,x=!1,a=!1,g=e.tag,b=e.result;else if(d)_e(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=u,e.anchor=m,!0}else if(d)_e(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=u,e.anchor=m,!0}if((e.line===l||e.lineIndent>t)&&(x&&(o=e.line,c=e.lineStart,i=e.position),Za(e,t,cc,!0,a)&&(x?b=e.result:w=e.result),x||(Aa(e,h,f,g,b,w,o,c,i),g=b=w=null),jt(e,!0,-1),p=e.input.charCodeAt(e.position)),(e.line===l||e.lineIndent>t)&&p!==0)_e(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return x&&Aa(e,h,f,g,b,null,o,c,i),d&&(e.tag=u,e.anchor=m,e.kind="mapping",e.result=h),d}function tS(e){var t,n=!1,r=!1,a,l,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&_e(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(n=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,a="!!",o=e.input.charCodeAt(++e.position)):a="!",t=e.position,n){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(l=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):_e(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!vn(o);)o===33&&(r?_e(e,"tag suffix cannot contain exclamation marks"):(a=e.input.slice(t-1,e.position+1),sb.test(a)||_e(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);l=e.input.slice(t,e.position),U1.test(l)&&_e(e,"tag suffix cannot contain flow indicator characters")}l&&!rb.test(l)&&_e(e,"tag name cannot contain such characters: "+l);try{l=decodeURIComponent(l)}catch{_e(e,"tag name is malformed: "+l)}return n?e.tag=l:kr.call(e.tagMap,a)?e.tag=e.tagMap[a]+l:a==="!"?e.tag="!"+l:a==="!!"?e.tag="tag:yaml.org,2002:"+l:_e(e,'undeclared tag handle "'+a+'"'),!0}function nS(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&_e(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!vn(n)&&!Ea(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&_e(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function sS(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!vn(r)&&!Ea(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&_e(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),kr.call(e.anchorMap,n)||_e(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],jt(e,!0,-1),!0}function Za(e,t,n,r,a){var l,o,c,i=1,u=!1,m=!1,h,f,g,b,w,x;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,l=o=c=cc===n||nb===n,r&&jt(e,!0,-1)&&(u=!0,e.lineIndent>t?i=1:e.lineIndent===t?i=0:e.lineIndent<t&&(i=-1)),i===1)for(;tS(e)||nS(e);)jt(e,!0,-1)?(u=!0,c=l,e.lineIndent>t?i=1:e.lineIndent===t?i=0:e.lineIndent<t&&(i=-1)):c=!1;if(c&&(c=u||a),(i===1||cc===n)&&(ic===n||tb===n?w=t:w=t+1,x=e.position-e.lineStart,i===1?c&&(Mp(e,x)||eS(e,x,w))||Z1(e,w)?m=!0:(o&&J1(e,w)||Q1(e,w)||K1(e,w)?m=!0:sS(e)?(m=!0,(e.tag!==null||e.anchor!==null)&&_e(e,"alias node should not have any properties")):X1(e,w,ic===n)&&(m=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):i===0&&(m=c&&Mp(e,x))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&_e(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),h=0,f=e.implicitTypes.length;h<f;h+=1)if(b=e.implicitTypes[h],b.resolve(e.result)){e.result=b.construct(e.result),e.tag=b.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(kr.call(e.typeMap[e.kind||"fallback"],e.tag))b=e.typeMap[e.kind||"fallback"][e.tag];else for(b=null,g=e.typeMap.multi[e.kind||"fallback"],h=0,f=g.length;h<f;h+=1)if(e.tag.slice(0,g[h].tag.length)===g[h].tag){b=g[h];break}b||_e(e,"unknown tag !<"+e.tag+">"),e.result!==null&&b.kind!==e.kind&&_e(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+b.kind+'", not "'+e.kind+'"'),b.resolve(e.result,e.tag)?(e.result=b.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):_e(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||m}function rS(e){var t=e.position,n,r,a,l=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(jt(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(l=!0,o=e.input.charCodeAt(++e.position),n=e.position;o!==0&&!vn(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),a=[],r.length<1&&_e(e,"directive name must not be less than one character in length");o!==0;){for(;Xr(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!Es(o));break}if(Es(o))break;for(n=e.position;o!==0&&!vn(o);)o=e.input.charCodeAt(++e.position);a.push(e.input.slice(n,e.position))}o!==0&&Lf(e),kr.call(Ap,r)?Ap[r](e,r,a):uc(e,'unknown document directive "'+r+'"')}if(jt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,jt(e,!0,-1)):l&&_e(e,"directives end mark is expected"),Za(e,e.lineIndent-1,cc,!1,!0),jt(e,!0,-1),e.checkLineBreaks&&H1.test(e.input.slice(t,e.position))&&uc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Wc(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,jt(e,!0,-1));return}if(e.position<e.length-1)_e(e,"end of the stream or a document separator is expected");else return}function cb(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new q1(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,_e(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)rS(n);return n.documents}function aS(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=cb(e,n);if(typeof t!="function")return r;for(var a=0,l=r.length;a<l;a+=1)t(r[a])}function lS(e,t){var n=cb(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new ln("expected a single document in the stream, but found more")}}var oS=aS,iS=lS,ub={loadAll:oS,load:iS},db=Object.prototype.toString,mb=Object.prototype.hasOwnProperty,Df=65279,cS=9,uo=10,uS=13,dS=32,mS=33,fS=34,um=35,hS=37,pS=38,xS=39,gS=42,fb=44,vS=45,dc=58,bS=61,yS=62,NS=63,jS=64,hb=91,pb=93,_S=96,xb=123,wS=124,gb=125,en={};en[0]="\\0";en[7]="\\a";en[8]="\\b";en[9]="\\t";en[10]="\\n";en[11]="\\v";en[12]="\\f";en[13]="\\r";en[27]="\\e";en[34]='\\"';en[92]="\\\\";en[133]="\\N";en[160]="\\_";en[8232]="\\L";en[8233]="\\P";var SS=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],CS=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function kS(e,t){var n,r,a,l,o,c,i;if(t===null)return{};for(n={},r=Object.keys(t),a=0,l=r.length;a<l;a+=1)o=r[a],c=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),i=e.compiledTypeMap.fallback[o],i&&mb.call(i.styleAliases,c)&&(c=i.styleAliases[c]),n[o]=c;return n}function ES(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new ln("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+Et.repeat("0",r-t.length)+t}var AS=1,mo=2;function RS(e){this.schema=e.schema||If,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Et.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=kS(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?mo:AS,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Pp(e,t){for(var n=Et.repeat(" ",t),r=0,a=-1,l="",o,c=e.length;r<c;)a=e.indexOf(`
`,r),a===-1?(o=e.slice(r),r=c):(o=e.slice(r,a+1),r=a+1),o.length&&o!==`
`&&(l+=n),l+=o;return l}function dm(e,t){return`
`+Et.repeat(" ",e.indent*t)}function MS(e,t){var n,r,a;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(a=e.implicitTypes[n],a.resolve(t))return!0;return!1}function mc(e){return e===dS||e===cS}function fo(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Df||65536<=e&&e<=1114111}function Tp(e){return fo(e)&&e!==Df&&e!==uS&&e!==uo}function Op(e,t,n){var r=Tp(e),a=r&&!mc(e);return(n?r:r&&e!==fb&&e!==hb&&e!==pb&&e!==xb&&e!==gb)&&e!==um&&!(t===dc&&!a)||Tp(t)&&!mc(t)&&e===um||t===dc&&a}function PS(e){return fo(e)&&e!==Df&&!mc(e)&&e!==vS&&e!==NS&&e!==dc&&e!==fb&&e!==hb&&e!==pb&&e!==xb&&e!==gb&&e!==um&&e!==pS&&e!==gS&&e!==mS&&e!==wS&&e!==bS&&e!==yS&&e!==xS&&e!==fS&&e!==hS&&e!==jS&&e!==_S}function TS(e){return!mc(e)&&e!==dc}function Al(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function vb(e){var t=/^\n* /;return t.test(e)}var bb=1,mm=2,yb=3,Nb=4,pa=5;function OS(e,t,n,r,a,l,o,c){var i,u=0,m=null,h=!1,f=!1,g=r!==-1,b=-1,w=PS(Al(e,0))&&TS(Al(e,e.length-1));if(t||o)for(i=0;i<e.length;u>=65536?i+=2:i++){if(u=Al(e,i),!fo(u))return pa;w=w&&Op(u,m,c),m=u}else{for(i=0;i<e.length;u>=65536?i+=2:i++){if(u=Al(e,i),u===uo)h=!0,g&&(f=f||i-b-1>r&&e[b+1]!==" ",b=i);else if(!fo(u))return pa;w=w&&Op(u,m,c),m=u}f=f||g&&i-b-1>r&&e[b+1]!==" "}return!h&&!f?w&&!o&&!a(e)?bb:l===mo?pa:mm:n>9&&vb(e)?pa:o?l===mo?pa:mm:f?Nb:yb}function IS(e,t,n,r,a){e.dump=function(){if(t.length===0)return e.quotingType===mo?'""':"''";if(!e.noCompatMode&&(SS.indexOf(t)!==-1||CS.test(t)))return e.quotingType===mo?'"'+t+'"':"'"+t+"'";var l=e.indent*Math.max(1,n),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-l),c=r||e.flowLevel>-1&&n>=e.flowLevel;function i(u){return MS(e,u)}switch(OS(t,c,e.indent,o,i,e.quotingType,e.forceQuotes&&!r,a)){case bb:return t;case mm:return"'"+t.replace(/'/g,"''")+"'";case yb:return"|"+Ip(t,e.indent)+Lp(Pp(t,l));case Nb:return">"+Ip(t,e.indent)+Lp(Pp(LS(t,o),l));case pa:return'"'+$S(t)+'"';default:throw new ln("impossible error: invalid scalar style")}}()}function Ip(e,t){var n=vb(e)?String(t):"",r=e[e.length-1]===`
`,a=r&&(e[e.length-2]===`
`||e===`
`),l=a?"+":r?"":"-";return n+l+`
`}function Lp(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function LS(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,n.lastIndex=u,$p(e.slice(0,u),t)}(),a=e[0]===`
`||e[0]===" ",l,o;o=n.exec(e);){var c=o[1],i=o[2];l=i[0]===" ",r+=c+(!a&&!l&&i!==""?`
`:"")+$p(i,t),a=l}return r}function $p(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,a=0,l,o=0,c=0,i="";r=n.exec(e);)c=r.index,c-a>t&&(l=o>a?o:c,i+=`
`+e.slice(a,l),a=l+1),o=c;return i+=`
`,e.length-a>t&&o>a?i+=e.slice(a,o)+`
`+e.slice(o+1):i+=e.slice(a),i.slice(1)}function $S(e){for(var t="",n=0,r,a=0;a<e.length;n>=65536?a+=2:a++)n=Al(e,a),r=en[n],!r&&fo(n)?(t+=e[a],n>=65536&&(t+=e[a+1])):t+=r||ES(n);return t}function DS(e,t,n){var r="",a=e.tag,l,o,c;for(l=0,o=n.length;l<o;l+=1)c=n[l],e.replacer&&(c=e.replacer.call(n,String(l),c)),(Xs(e,t,c,!1,!1)||typeof c>"u"&&Xs(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=a,e.dump="["+r+"]"}function Dp(e,t,n,r){var a="",l=e.tag,o,c,i;for(o=0,c=n.length;o<c;o+=1)i=n[o],e.replacer&&(i=e.replacer.call(n,String(o),i)),(Xs(e,t+1,i,!0,!0,!1,!0)||typeof i>"u"&&Xs(e,t+1,null,!0,!0,!1,!0))&&((!r||a!=="")&&(a+=dm(e,t)),e.dump&&uo===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=l,e.dump=a||"[]"}function FS(e,t,n){var r="",a=e.tag,l=Object.keys(n),o,c,i,u,m;for(o=0,c=l.length;o<c;o+=1)m="",r!==""&&(m+=", "),e.condenseFlow&&(m+='"'),i=l[o],u=n[i],e.replacer&&(u=e.replacer.call(n,i,u)),Xs(e,t,i,!1,!1)&&(e.dump.length>1024&&(m+="? "),m+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Xs(e,t,u,!1,!1)&&(m+=e.dump,r+=m));e.tag=a,e.dump="{"+r+"}"}function VS(e,t,n,r){var a="",l=e.tag,o=Object.keys(n),c,i,u,m,h,f;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new ln("sortKeys must be a boolean or a function");for(c=0,i=o.length;c<i;c+=1)f="",(!r||a!=="")&&(f+=dm(e,t)),u=o[c],m=n[u],e.replacer&&(m=e.replacer.call(n,u,m)),Xs(e,t+1,u,!0,!0,!0)&&(h=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,h&&(e.dump&&uo===e.dump.charCodeAt(0)?f+="?":f+="? "),f+=e.dump,h&&(f+=dm(e,t)),Xs(e,t+1,m,!0,h)&&(e.dump&&uo===e.dump.charCodeAt(0)?f+=":":f+=": ",f+=e.dump,a+=f));e.tag=l,e.dump=a||"{}"}function Fp(e,t,n){var r,a,l,o,c,i;for(a=n?e.explicitTypes:e.implicitTypes,l=0,o=a.length;l<o;l+=1)if(c=a[l],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof t=="object"&&t instanceof c.instanceOf)&&(!c.predicate||c.predicate(t))){if(n?c.multi&&c.representName?e.tag=c.representName(t):e.tag=c.tag:e.tag="?",c.represent){if(i=e.styleMap[c.tag]||c.defaultStyle,db.call(c.represent)==="[object Function]")r=c.represent(t,i);else if(mb.call(c.represent,i))r=c.represent[i](t,i);else throw new ln("!<"+c.tag+'> tag resolver accepts not "'+i+'" style');e.dump=r}return!0}return!1}function Xs(e,t,n,r,a,l,o){e.tag=null,e.dump=n,Fp(e,n,!1)||Fp(e,n,!0);var c=db.call(e.dump),i=r,u;r&&(r=e.flowLevel<0||e.flowLevel>t);var m=c==="[object Object]"||c==="[object Array]",h,f;if(m&&(h=e.duplicates.indexOf(n),f=h!==-1),(e.tag!==null&&e.tag!=="?"||f||e.indent!==2&&t>0)&&(a=!1),f&&e.usedDuplicates[h])e.dump="*ref_"+h;else{if(m&&f&&!e.usedDuplicates[h]&&(e.usedDuplicates[h]=!0),c==="[object Object]")r&&Object.keys(e.dump).length!==0?(VS(e,t,e.dump,a),f&&(e.dump="&ref_"+h+e.dump)):(FS(e,t,e.dump),f&&(e.dump="&ref_"+h+" "+e.dump));else if(c==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?Dp(e,t-1,e.dump,a):Dp(e,t,e.dump,a),f&&(e.dump="&ref_"+h+e.dump)):(DS(e,t,e.dump),f&&(e.dump="&ref_"+h+" "+e.dump));else if(c==="[object String]")e.tag!=="?"&&IS(e,e.dump,t,l,i);else{if(c==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new ln("unacceptable kind of an object to dump "+c)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function zS(e,t){var n=[],r=[],a,l;for(fm(e,n,r),a=0,l=r.length;a<l;a+=1)t.duplicates.push(n[r[a]]);t.usedDuplicates=new Array(l)}function fm(e,t,n){var r,a,l;if(e!==null&&typeof e=="object")if(a=t.indexOf(e),a!==-1)n.indexOf(a)===-1&&n.push(a);else if(t.push(e),Array.isArray(e))for(a=0,l=e.length;a<l;a+=1)fm(e[a],t,n);else for(r=Object.keys(e),a=0,l=r.length;a<l;a+=1)fm(e[r[a]],t,n)}function HS(e,t){t=t||{};var n=new RS(t);n.noRefs||zS(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Xs(n,0,r,!0,!0)?n.dump+`
`:""}var US=HS,BS={dump:US};function Ff(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var WS=Bt,GS=Lv,YS=Vv,qS=Wv,XS=Gv,QS=If,KS=ub.load,ZS=ub.loadAll,JS=BS.dump,e2=ln,t2={binary:Kv,float:Bv,map:Fv,null:zv,pairs:Jv,set:eb,timestamp:Xv,bool:Hv,int:Uv,merge:Qv,omap:Zv,seq:Dv,str:$v},n2=Ff("safeLoad","load"),s2=Ff("safeLoadAll","loadAll"),r2=Ff("safeDump","dump"),Bs={Type:WS,Schema:GS,FAILSAFE_SCHEMA:YS,JSON_SCHEMA:qS,CORE_SCHEMA:XS,DEFAULT_SCHEMA:QS,load:KS,loadAll:ZS,dump:JS,YAMLException:e2,types:t2,safeLoad:n2,safeLoadAll:s2,safeDump:r2};function jb(e){const t=[],n=[],r={},a={},l={},o={},c={},i=e.split(`
`),u=[],m=new Map;for(let h=0;h<i.length;h++){const f=i[h],g=h+1;if(!f.trim()||f.trim().startsWith("#"))continue;const b=f.search(/\S/);if(b===-1)continue;for(;u.length>0&&u[u.length-1].indent>=b;)u.pop();const w=/^\s*-/.test(f),x=f.match(/<<:\s*\*(\w+)/),d=f.match(/^\s*-?\s*([^:\s]+)\s*:/);if(d&&d[1]!=="<<"){const C=d[1];u.push({indent:b,key:C});const j=u.map(E=>E.key).join(".");m.delete(j)}const p=u.map(C=>C.key).join(".");let v=p;if(w&&!d){const C=m.get(p)||0;v=`${p}.${C}`,m.set(p,C+1)}const N=f.match(/&(\w+)/);if(N){const C=N[1];t.push({name:C,path:p,lineNumber:g}),a[C]=p,d&&d[1]!==C&&(o[p]=C)}if(x){const C=x[1],j=p;c[j]=C;const E=j.split(".");if(E.length>=2){const y=E.slice(-2).join(".");if(c[y]=C,E.length>=3){const R=E.slice(-3).join(".");c[R]=C}}console.log(`[extractYamlReferences] Found merge key at path '${j}': <<: *${C}`)}if(!x){const C=f.matchAll(new RegExp(`(?<!["\\w])\\*(\\w+)(?!["'])`,"g"));for(const j of C){const E=j[1];if(f.includes(`&${E}`))continue;n.push({name:E,path:v,lineNumber:g}),r[E]||(r[E]=[]),r[E].push(v);const y=v.split(".");if(y.length>=2){const R=y.slice(-3).join(".");l[`${R}=${E}`]=E;const $=y.slice(-2).join(".");l[`${$}=${E}`]=E}}}}return{anchors:t,aliases:n,aliasUsage:r,anchorPaths:a,pathSuffixToAnchor:l,keyToAnchorName:o,mergeKeys:c}}let xn=null;function _b(e){xn=e}function wb(){return xn}function a2(){xn=null}function l2(){return!xn||!xn.mergeKeys?[]:[...new Set(Object.values(xn.mergeKeys))]}function o2(e){if(!xn||!xn.mergeKeys)return null;const t=e.toLowerCase().replace(/-/g,"_"),n=e.split(".");for(const[r,a]of Object.entries(xn.mergeKeys)){const l=r.toLowerCase().replace(/-/g,"_");if(t===l)return console.log(`[shouldUseMergeKey] Exact match for '${e}': ${a}`),a}for(const[r,a]of Object.entries(xn.mergeKeys)){const l=r.toLowerCase().replace(/-/g,"_");if(l.split(".").length>=2){if(t.endsWith(l))return console.log(`[shouldUseMergeKey] Path ends with merge path '${e}' -> '${r}': ${a}`),a;if(l.endsWith(t)&&n.length>=2)return console.log(`[shouldUseMergeKey] Merge path ends with path '${r}' -> '${e}': ${a}`),a}}if(n.length>=2){const r=n.slice(-2).join(".").toLowerCase().replace(/-/g,"_"),a=n.length>=3?n.slice(-3).join(".").toLowerCase().replace(/-/g,"_"):"";for(const[l,o]of Object.entries(xn.mergeKeys)){const c=l.toLowerCase().replace(/-/g,"_");if(c===r||a&&c===a)return console.log(`[shouldUseMergeKey] Suffix pattern match for '${e}': ${o}`),o}}return null}function Vp(e){return!xn||!xn.keyToAnchorName?null:xn.keyToAnchorName[e]||null}let Vf={};function i2(e,t){Vf[e]=t}function c2(e){return Vf[e]||null}function hm(){Vf={}}function zp(e,t){return typeof e=="string"&&e.startsWith(t)}function Hp(e){return typeof e=="string"?e:""}function u2(e){const t=["variables","schemas","service_principals","retrievers","tools","guardrails","prompts","agents"],n=["memory"],r=["llms","vector_stores","genie_rooms","tables","volumes","functions","warehouses","connections","databases"],a=["app"],l=e.split(`
`),o=[];for(let c=0;c<l.length;c++){const u=l[c].match(/^(\s*)(\w[\w_-]*):\s*$/);if(u){const m=u[2],h=u[1].length;if(h===0&&t.includes(m))o.push({name:m,startLine:c,indent:h,childIndent:h+2,endLine:-1});else if(h===0&&m==="resources")for(let f=c+1;f<l.length;f++){const b=l[f].match(/^(\s*)(\w[\w_-]*):\s*$/);if(b){const w=b[2],x=b[1].length;if(x===0)break;x===2&&r.includes(w)&&o.push({name:w,startLine:f,indent:x,childIndent:x+2,endLine:-1})}}}}for(let c=0;c<o.length;c++){const i=o[c];for(let u=i.startLine+1;u<l.length;u++){const m=l[u];if(!m.trim())continue;const h=m.search(/\S/);if(h!==-1&&h<=i.indent){i.endLine=u;break}}i.endLine===-1&&(i.endLine=l.length)}for(let c=0;c<l.length;c++){const i=l[c],u=i.match(/^(\w[\w_-]*):\s*$/);if(u){const m=u[1];if(n.includes(m)&&!i.includes("&")){const h=c2(m),f=Vp(m),g=h||f||m;l[c]=`${m}: &${g}`}}}for(const c of o){if(a.includes(c.name))continue;const i=c.indent===0?c.name:`resources.${c.name}`;for(let u=c.startLine+1;u<c.endLine;u++){const m=l[u];if(!m.trim()||m.search(/\S/)!==c.childIndent)continue;const f=m.match(new RegExp(`^( {${c.childIndent}})(\\w[\\w_-]*):\\s*$`));if(f){const g=f[1],b=f[2];if(!m.includes("&")){const w=`${i}.${b}`,x=Vp(w),p=l2().includes(b);x?l[u]=`${g}${b}: &${x}`:p?l[u]=`${g}${b}: &${b}`:["tables","volumes","functions"].includes(c.name)||(l[u]=`${g}${b}: &${b}`)}}}}return l.join(`
`)}function d2(e){let t=e.replace(/__MERGE__: "(\w+)"/g,"<<: *$1");return t=t.replace(/__MERGE__: (\w+)/g,"<<: *$1"),t=t.replace(/"__REF__(\w+)"/g,"*$1"),t=t.replace(/- __REF__(\w+)/g,"- *$1"),t=t.replace(/__REF__(\w+)/g,"*$1"),t}function be(e){return`__REF__${e}`}function m2(e){const t={};for(const[n,r]of Object.entries(e))typeof r=="string"&&r.startsWith("*")?t[n]=be(r.slice(1)):t[n]=String(r);return t}function Ct(e,t){const n=wb();if(!n)return null;const r=e.toLowerCase().replace(/-/g,"_"),a=e.split(".");for(const[c,i]of Object.entries(n.aliasUsage))for(const u of i){const m=u.toLowerCase().replace(/-/g,"_");if(r===m&&n.anchorPaths[c])return c}const l=a[a.length-1];if(/^\d+$/.test(l))for(const[c,i]of Object.entries(n.aliasUsage))for(const u of i){const m=u.toLowerCase().replace(/-/g,"_");if(r===m||m.endsWith(r))return c}if(t&&typeof t=="object"&&"name"in t&&"function"in t){for(const[c,i]of Object.entries(n.anchorPaths))if(i.startsWith("tools.")){const u=n.aliasUsage[c]||[];for(const m of u){const h=m.split("."),f=e.split(".");if(h.includes("tools")&&f.includes("tools")){const g=h.indexOf("agents"),b=f.indexOf("agents");if(g!==-1&&b!==-1){const w=h[g+1],x=f[b+1];if(w===x)return c}}}}}const o=a.slice(-2).join(".");if(n.pathSuffixToAnchor){const c=o.toLowerCase().replace(/-/g,"_");for(const[i,u]of Object.entries(n.pathSuffixToAnchor)){const m=i.toLowerCase().replace(/-/g,"_");if((c===m||c.endsWith("."+m))&&n.anchorPaths[u])return u}}if(t&&typeof t=="object"&&t.catalog_name&&t.schema_name){for(const[c,i]of Object.entries(n.anchorPaths))if(i.includes("schema"))return c}return null}function pm(e,t,n){if(e==null||typeof e!="object")return e;const r=Ct(t,e);if(r)return be(r);if(Array.isArray(e))return e.map((l,o)=>pm(l,`${t}.${o}`));const a={};for(const[l,o]of Object.entries(e)){const c=t?`${t}.${l}`:l,i=Ct(c,o);i?a[l]=be(i):typeof o=="object"&&o!==null?a[l]=pm(o,c):a[l]=o}return a}function fc(e,t,n){if(typeof e=="string")return t[e]?be(e):e;if(e&&typeof e=="object"&&e.name){if(n){const r=Ct(n,e);if(r)return be(r)}for(const[r,a]of Object.entries(t))if(JSON.stringify(a)===JSON.stringify(e))return be(r);return{name:e.name,...e.temperature!==void 0&&{temperature:e.temperature},...e.max_tokens!==void 0&&{max_tokens:e.max_tokens},...e.on_behalf_of_user!==void 0&&{on_behalf_of_user:e.on_behalf_of_user},...e.fallbacks&&e.fallbacks.length>0&&{fallbacks:e.fallbacks}}}return e}function Ir(e,t,n){if(e){if(n){const r=Ct(n,e);if(r)return be(r)}for(const[r,a]of Object.entries(t))if(a.catalog_name===e.catalog_name&&a.schema_name===e.schema_name)return be(r);return{catalog_name:e.catalog_name,schema_name:e.schema_name}}}function Up(e,t){var r,a,l,o;if(!e)return;const n={};if(e.volume)if(typeof e.volume=="string")e.volume.startsWith("*")?n.volume=be(e.volume.substring(1)):n.volume=be(e.volume);else{let c;for(const[i,u]of Object.entries(t))if(u.name===e.volume.name&&((r=u.schema)==null?void 0:r.catalog_name)===((a=e.volume.schema)==null?void 0:a.catalog_name)&&((l=u.schema)==null?void 0:l.schema_name)===((o=e.volume.schema)==null?void 0:o.schema_name)){c=i;break}c?n.volume=be(c):e.volume._schemaRef?n.volume={schema:be(e.volume._schemaRef),name:e.volume.name}:n.volume={...e.volume.schema&&{schema:{catalog_name:e.volume.schema.catalog_name,schema_name:e.volume.schema.schema_name}},name:e.volume.name}}return e.path&&(n.path=e.path),Object.keys(n).length>0?n:void 0}function f2(e,t,n){const r={};if(e.supervisor){let a;e.supervisor.tools&&e.supervisor.tools.length>0&&(a=e.supervisor.tools.map(l=>{const o=typeof l=="string"?l:l.name;if(n[o])return be(o);const c=Object.entries(n).find(([,u])=>u.name===o);if(c)return be(c[0]);const i=typeof l=="object"?l:null;if(i){const u=Object.entries(n).find(([,m])=>JSON.stringify(m)===JSON.stringify(i));if(u)return be(u[0])}return be(o)})),r.supervisor={model:fc(e.supervisor.model,t,"orchestration.supervisor.model"),...a&&a.length>0&&{tools:a},...e.supervisor.prompt&&{prompt:e.supervisor.prompt}}}if(e.swarm){if(r.swarm={model:fc(e.swarm.model,t,"orchestration.swarm.model")},e.swarm.default_agent){const a=e.swarm.default_agent;typeof a=="string"?r.swarm.default_agent=a:"name"in a&&(r.swarm.default_agent=a.name)}e.swarm.handoffs&&Object.keys(e.swarm.handoffs).length>0&&(r.swarm.handoffs={},Object.entries(e.swarm.handoffs).forEach(([a,l])=>{l==null?r.swarm.handoffs[a]=null:Array.isArray(l)&&(l.length===0?r.swarm.handoffs[a]=[]:r.swarm.handoffs[a]=l.map(o=>typeof o=="string"?o:o.name))}))}if(e.memory){const a=e.memory;if(typeof a=="string")a.startsWith("*")?r.memory=be(a.slice(1)):r.memory=be(a);else{const l=Ct("orchestration.memory",a);l?r.memory=be(l):r.memory=be("memory")}}return r}function h2(e){return{review_prompt:e.review_prompt,...e.interrupt_config&&{interrupt_config:e.interrupt_config},...e.decline_message&&{decline_message:e.decline_message},...e.custom_actions&&Object.keys(e.custom_actions).length>0&&{custom_actions:e.custom_actions}}}function p2(e,t){if(typeof e=="string")return e;const n={type:e.type};if("__MERGE__"in e||(n.name=e.name),e.type==="factory"&&"args"in e&&e.args&&Object.keys(e.args).length>0){const r=t?`tools.${t}.function.args`:"function.args";n.args=pm(e.args,r)}if(e.type==="unity_catalog"){const r=t?`tools.${t}.function`:"function",a=o2(r);if(a?(n.__MERGE__=a,delete n.name):"__MERGE__"in e&&e.__MERGE__?(n.__MERGE__=e.__MERGE__,delete n.name):"schema"in e&&e.schema&&(n.schema=e.schema,n.name=e.name),"partial_args"in e&&e.partial_args){const l={};for(const[o,c]of Object.entries(e.partial_args)){const i=t?Ct(`tools.${t}.function.partial_args.${o}`,c):null;i?l[o]=be(i):l[o]=c}n.partial_args=l}}if(e.type==="mcp"){if("transport"in e&&e.transport&&(n.transport=e.transport),"command"in e&&e.command&&(n.command=e.command),"url"in e&&e.url&&(n.url=e.url),"headers"in e&&e.headers&&(n.headers=e.headers),"args"in e&&e.args&&(n.args=e.args),"pat"in e&&e.pat&&(n.pat=ns(e.pat)),"service_principal"in e&&e.service_principal){const r=e.service_principal;typeof r=="string"?r.startsWith("*")?n.service_principal=be(r.slice(1)):n.service_principal=be(r):n.service_principal={client_id:ns(r.client_id),client_secret:ns(r.client_secret)}}else"client_id"in e&&e.client_id&&(n.client_id=ns(e.client_id)),"client_secret"in e&&e.client_secret&&(n.client_secret=ns(e.client_secret)),"workspace_host"in e&&e.workspace_host&&(n.workspace_host=ns(e.workspace_host));if("connection"in e&&e.connection){const r=e.connection;typeof r=="string"&&r.startsWith("*")?n.connection=be(r.slice(1)):n.connection=r}if("functions"in e&&e.functions&&(n.functions=e.functions),"genie_room"in e&&e.genie_room){const r=t?Ct(`tools.${t}.function.genie_room`,e.genie_room):null;n.genie_room=r?be(r):e.genie_room}if("sql"in e&&e.sql&&(n.sql=e.sql),"vector_search"in e&&e.vector_search){const r=t?Ct(`tools.${t}.function.vector_search`,e.vector_search):null;if(r)n.vector_search=be(r);else if("retriever"in e.vector_search){const a=t?Ct(`tools.${t}.function.vector_search.retriever`,e.vector_search.retriever):null;n.vector_search={...e.vector_search,retriever:a?be(a):e.vector_search.retriever}}else n.vector_search=e.vector_search}}return"human_in_the_loop"in e&&e.human_in_the_loop&&(n.human_in_the_loop=h2(e.human_in_the_loop)),n}function Fu(e,t){const n={name:e.name};if(e.instance_name&&(n.instance_name=e.instance_name),e.description&&(n.description=e.description),e.capacity&&(n.capacity=e.capacity),e.max_pool_size&&(n.max_pool_size=e.max_pool_size),e.timeout_seconds&&(n.timeout_seconds=e.timeout_seconds),e.service_principal)if(typeof e.service_principal=="string")e.service_principal.startsWith("*")?n.service_principal=be(e.service_principal.slice(1)):n.service_principal=be(e.service_principal);else{const r=t?`${t}.service_principal`:"service_principal",a=Ct(r,e.service_principal);a?n.service_principal=be(a):n.service_principal={client_id:Lr(e.service_principal.client_id,t?`${t}.service_principal.client_id`:void 0),client_secret:Lr(e.service_principal.client_secret,t?`${t}.service_principal.client_secret`:void 0)}}else e.client_id&&(n.client_id=Lr(e.client_id,t?`${t}.client_id`:void 0)),e.client_secret&&(n.client_secret=Lr(e.client_secret,t?`${t}.client_secret`:void 0)),e.workspace_host&&(n.workspace_host=Lr(e.workspace_host,t?`${t}.workspace_host`:void 0));return e.user&&(n.user=Lr(e.user,t?`${t}.user`:void 0)),e.password&&(n.password=Lr(e.password,t?`${t}.password`:void 0)),n}function Lr(e,t){if(t){const n=Ct(t,e);if(n)return be(n)}return ns(e)}function ns(e){if(typeof e!="string")return e;if(e.startsWith("*"))return be(e.slice(1));if(e.startsWith("env:"))return{env:e.slice(4)};if(e.startsWith("secret:")){const t=e.slice(7).split("/");if(t.length===2)return{scope:t[0],secret:t[1]}}return e}function x2(e){return e.type?e.type:"options"in e&&Array.isArray(e.options)?"composite":"scope"in e&&"secret"in e?"secret":"env"in e?"env":("value"in e,"primitive")}function Sb(e){const t=x2(e),n=e;switch(t){case"primitive":return{value:n.value};case"env":return{env:n.env,...n.default_value!==void 0&&{default_value:n.default_value}};case"secret":return{scope:n.scope,secret:n.secret,...n.default_value!==void 0&&{default_value:n.default_value}};case"composite":return{options:(n.options||[]).map(a=>Sb(a)),...n.default_value!==void 0&&{default_value:n.default_value}};default:return e}}function ra(e){var l,o,c,i,u,m,h,f,g,b,w;const t={};hm(),(l=e.memory)!=null&&l.refName&&i2("memory",e.memory.refName);const n=e.schemas||{};if(e.variables&&Object.keys(e.variables).length>0&&(t.variables={},Object.entries(e.variables).forEach(([x,d])=>{t.variables[x]=Sb(d)})),e.service_principals&&Object.keys(e.service_principals).length>0&&(t.service_principals={},Object.entries(e.service_principals).forEach(([x,d])=>{t.service_principals[x]={client_id:ns(d.client_id),client_secret:ns(d.client_secret)}})),e.schemas&&Object.keys(e.schemas).length>0&&(t.schemas={},Object.entries(e.schemas).forEach(([x,d])=>{t.schemas[x]={catalog_name:d.catalog_name,schema_name:d.schema_name,...d.permissions&&{permissions:d.permissions}}})),e.resources&&(e.resources.llms&&Object.keys(e.resources.llms).length>0||e.resources.vector_stores&&Object.keys(e.resources.vector_stores).length>0||e.resources.genie_rooms&&Object.keys(e.resources.genie_rooms).length>0||e.resources.tables&&Object.keys(e.resources.tables).length>0||e.resources.volumes&&Object.keys(e.resources.volumes).length>0||e.resources.functions&&Object.keys(e.resources.functions).length>0||e.resources.warehouses&&Object.keys(e.resources.warehouses).length>0||e.resources.connections&&Object.keys(e.resources.connections).length>0||e.resources.databases&&Object.keys(e.resources.databases).length>0)){if(t.resources={},e.resources.llms&&Object.keys(e.resources.llms).length>0&&(t.resources.llms={},Object.entries(e.resources.llms).forEach(([x,d])=>{let p;d.fallbacks&&d.fallbacks.length>0&&(p=d.fallbacks.map(v=>typeof v=="string"&&v.startsWith("ref:")?be(v.slice(4)):typeof v=="string"?v:v.name)),t.resources.llms[x]={name:d.name,...d.temperature!==void 0&&{temperature:d.temperature},...d.max_tokens!==void 0&&{max_tokens:d.max_tokens},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user},...p&&p.length>0&&{fallbacks:p}}})),e.resources.vector_stores&&Object.keys(e.resources.vector_stores).length>0){const x=e.resources.volumes||{};t.resources.vector_stores={},Object.entries(e.resources.vector_stores).forEach(([d,p])=>{let v;if(p.source_table){const j=Ir(p.source_table.schema,n,`resources.vector_stores.${d}.source_table.schema`);v={...j&&{schema:j},...p.source_table.name&&{name:p.source_table.name}}}let N;if(p.index&&p.index.name){const j=Ir(p.index.schema,n,`resources.vector_stores.${d}.index.schema`);N={...j&&{schema:j},name:p.index.name}}let C;if(p.embedding_model){const j=Ct(`resources.vector_stores.${d}.embedding_model`,p.embedding_model);j?C=be(j):C=p.embedding_model}t.resources.vector_stores[d]={...v&&{source_table:v},embedding_source_column:p.embedding_source_column,...C&&{embedding_model:C},...N&&{index:N},...p.endpoint&&p.endpoint.name&&{endpoint:p.endpoint},...p.primary_key&&{primary_key:p.primary_key},...p.columns&&p.columns.length>0&&{columns:p.columns},...p.doc_uri&&{doc_uri:p.doc_uri},...p.source_path&&{source_path:Up(p.source_path,x)},...p.checkpoint_path&&{checkpoint_path:Up(p.checkpoint_path,x)},...p.on_behalf_of_user!==void 0&&{on_behalf_of_user:p.on_behalf_of_user}}})}e.resources.genie_rooms&&Object.keys(e.resources.genie_rooms).length>0&&(t.resources.genie_rooms={},Object.entries(e.resources.genie_rooms).forEach(([x,d])=>{const p=Hp(d.space_id);let v=p;zp(p,"*")&&(v=be(p.substring(1))),t.resources.genie_rooms[x]={name:d.name,space_id:v,...d.description&&{description:d.description},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})),e.resources.tables&&Object.keys(e.resources.tables).length>0&&(t.resources.tables={},Object.entries(e.resources.tables).forEach(([x,d])=>{const p=Ir(d.schema,n,`resources.tables.${x}.schema`);t.resources.tables[x]={...p&&{schema:p},...d.name&&{name:d.name},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})),e.resources.volumes&&Object.keys(e.resources.volumes).length>0&&(t.resources.volumes={},Object.entries(e.resources.volumes).forEach(([x,d])=>{const p=Ir(d.schema,n,`resources.volumes.${x}.schema`);t.resources.volumes[x]={name:d.name,...p&&{schema:p},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})),e.resources.functions&&Object.keys(e.resources.functions).length>0&&(t.resources.functions={},Object.entries(e.resources.functions).forEach(([x,d])=>{const p=Ir(d.schema,n,`resources.functions.${x}.schema`);t.resources.functions[x]={...p&&{schema:p},...d.name&&{name:d.name},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})),e.resources.warehouses&&Object.keys(e.resources.warehouses).length>0&&(t.resources.warehouses={},Object.entries(e.resources.warehouses).forEach(([x,d])=>{const p=Hp(d.warehouse_id);let v=p;zp(p,"*")&&(v=be(p.substring(1))),t.resources.warehouses[x]={name:d.name,warehouse_id:v,...d.description&&{description:d.description},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})),e.resources.connections&&Object.keys(e.resources.connections).length>0&&(t.resources.connections={},Object.entries(e.resources.connections).forEach(([x,d])=>{t.resources.connections[x]={name:d.name,...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})),e.resources.databases&&Object.keys(e.resources.databases).length>0&&(t.resources.databases={},Object.entries(e.resources.databases).forEach(([x,d])=>{t.resources.databases[x]=Fu(d,`resources.databases.${x}`)}))}if(e.retrievers&&Object.keys(e.retrievers).length>0&&(t.retrievers={},Object.entries(e.retrievers).forEach(([x,d])=>{var C,j;let p;const v=Ct(`retrievers.${x}.vector_store`,d.vector_store);if(v)p=be(v);else{const E=((C=e.resources)==null?void 0:C.vector_stores)||{},y=(j=Object.entries(E).find(([,R])=>{var $,k,A,D;return R.embedding_source_column===(($=d.vector_store)==null?void 0:$.embedding_source_column)&&((k=R.source_table)==null?void 0:k.name)===((D=(A=d.vector_store)==null?void 0:A.source_table)==null?void 0:D.name)}))==null?void 0:j[0];y&&(p=be(y))}const N={vector_store:p||d.vector_store};if(d.columns&&d.columns.length>0&&(N.columns=d.columns),d.search_parameters){const E={num_results:d.search_parameters.num_results||10,query_type:d.search_parameters.query_type||"ANN"};d.search_parameters.filters&&Object.keys(d.search_parameters.filters).length>0&&(E.filters=d.search_parameters.filters),N.search_parameters=E}d.rerank&&(typeof d.rerank=="boolean"?N.rerank=d.rerank:N.rerank={...d.rerank.model&&{model:d.rerank.model},...d.rerank.top_n!==void 0&&{top_n:d.rerank.top_n},...d.rerank.cache_dir&&{cache_dir:d.rerank.cache_dir},...d.rerank.columns&&d.rerank.columns.length>0&&{columns:d.rerank.columns}}),t.retrievers[x]=N})),e.tools&&Object.keys(e.tools).length>0&&(t.tools={},Object.entries(e.tools).forEach(([x,d])=>{t.tools[x]={name:d.name,function:p2(d.function,x)}})),e.guardrails&&Object.keys(e.guardrails).length>0){const x=((o=e.resources)==null?void 0:o.llms)||{};t.guardrails={},Object.entries(e.guardrails).forEach(([d,p])=>{t.guardrails[d]={name:p.name,model:fc(p.model,x,`guardrails.${d}.model`),prompt:p.prompt,...p.num_retries!==void 0&&{num_retries:p.num_retries}}})}if(e.memory){if(t.memory={},e.memory.checkpointer){let x;if(e.memory.checkpointer.database){const d=Ct("memory.checkpointer.database",e.memory.checkpointer.database);if(d)x=be(d);else{const p=((c=e.resources)==null?void 0:c.databases)||{},v=(i=Object.entries(p).find(([,N])=>{var C,j,E;return N.instance_name===((E=(j=(C=e.memory)==null?void 0:C.checkpointer)==null?void 0:j.database)==null?void 0:E.instance_name)}))==null?void 0:i[0];v?x=be(v):x=Fu(e.memory.checkpointer.database,"memory.checkpointer.database")}}t.memory.checkpointer={name:e.memory.checkpointer.name,type:e.memory.checkpointer.type||"memory",...x&&{database:x}}}if(e.memory.store){let x;if(e.memory.store.database){const p=Ct("memory.store.database",e.memory.store.database);if(p)x=be(p);else{const v=((u=e.resources)==null?void 0:u.databases)||{},N=(m=Object.entries(v).find(([,C])=>{var j,E,y;return C.instance_name===((y=(E=(j=e.memory)==null?void 0:j.store)==null?void 0:E.database)==null?void 0:y.instance_name)}))==null?void 0:m[0];N?x=be(N):x=Fu(e.memory.store.database,"memory.store.database")}}let d;if(e.memory.store.embedding_model){const p=Ct("memory.store.embedding_model",e.memory.store.embedding_model);if(p)d=be(p);else{const v=((h=e.resources)==null?void 0:h.llms)||{},N=(f=Object.entries(v).find(([,C])=>{var j,E,y;return C.name===((y=(E=(j=e.memory)==null?void 0:j.store)==null?void 0:E.embedding_model)==null?void 0:y.name)}))==null?void 0:f[0];N?d=be(N):d=e.memory.store.embedding_model}}t.memory.store={name:e.memory.store.name,type:e.memory.store.type||"memory",...d&&{embedding_model:d},...e.memory.store.dims&&{dims:e.memory.store.dims},...x&&{database:x},...e.memory.store.namespace&&{namespace:e.memory.store.namespace}}}}if(e.prompts&&Object.keys(e.prompts).length>0&&(t.prompts={},Object.entries(e.prompts).forEach(([x,d])=>{const p=d.alias&&d.alias.trim()!=="";t.prompts[x]={name:d.name,...d.schema&&{schema:Ir(d.schema,n,`prompts.${x}.schema`)},...d.description&&{description:d.description},...d.default_template&&{default_template:d.default_template},...p&&{alias:d.alias},...!p&&d.version!==void 0&&{version:d.version},...d.tags&&Object.keys(d.tags).length>0&&{tags:d.tags}}})),e.agents&&Object.keys(e.agents).length>0){const x=((g=e.resources)==null?void 0:g.llms)||{},d=e.prompts||{},p=e.tools||{},v=e.guardrails||{};t.agents={},Object.entries(e.agents).forEach(([N,C])=>{var R;let j=C.prompt;if(C.prompt&&typeof C.prompt=="object"&&"name"in C.prompt){const $=C.prompt,k=(R=Object.entries(d).find(([,A])=>A.name===$.name))==null?void 0:R[0];k&&(j=be(k))}let E;C.tools&&C.tools.length>0&&(E=C.tools.map(($,k)=>{const A=Ct(`agents.${N}.tools.${k}`,$);if(A&&p[A])return be(A);const D=typeof $=="object"?$:null,S=typeof $=="string"?$:$.name;if(p[S])return be(S);if(D){const P=Object.entries(p).find(([,L])=>JSON.stringify(L)===JSON.stringify(D));if(P)return be(P[0])}const T=Object.entries(p).find(([,P])=>P.name===S);if(T)return be(T[0]);if(D&&D.function){const P=Object.entries(p).find(([,L])=>L.function&&JSON.stringify(L.function)===JSON.stringify(D.function));if(P)return be(P[0])}return console.warn(`Could not find tool key for tool with name "${S}". Tool may have been deleted.`),null}).filter($=>$!==null));let y;C.guardrails&&C.guardrails.length>0&&(y=C.guardrails.map(($,k)=>{const A=Ct(`agents.${N}.guardrails.${k}`,$);if(A&&v[A])return be(A);const D=typeof $=="object"?$:null,S=typeof $=="string"?$:$.name;if(v[S])return be(S);if(D){const P=Object.entries(v).find(([,L])=>JSON.stringify(L)===JSON.stringify(D));if(P)return be(P[0])}const T=Object.entries(v).find(([,P])=>P.name===S);return T?be(T[0]):(console.warn(`Could not find guardrail key for guardrail with name "${S}". Guardrail may have been deleted.`),null)}).filter($=>$!==null)),t.agents[N]={name:C.name,model:fc(C.model,x,`agents.${N}.model`),...C.description&&{description:C.description},...E&&E.length>0&&{tools:E},...y&&y.length>0&&{guardrails:y},...j&&{prompt:j},...C.handoff_prompt&&{handoff_prompt:C.handoff_prompt}}})}if(e.app&&e.app.name&&((b=e.app.registered_model)!=null&&b.name)){const x=e.agents||{};let d;e.app.agents&&e.app.agents.length>0&&(d=e.app.agents.map((N,C)=>{const j=Ct(`app.agents.${C}`,N);if(j&&x[j])return be(j);const E=typeof N=="object"?N:null,y=typeof N=="string"?N:N.name;if(x[y])return be(y);if(E){const $=Object.entries(x).find(([,k])=>JSON.stringify(k)===JSON.stringify(E));if($)return be($[0])}const R=Object.entries(x).find(([,$])=>$.name===y);if(R)return be(R[0]);if(E&&E.model){const $=Object.entries(x).find(([,k])=>k.model&&k.name===y&&JSON.stringify(k.model)===JSON.stringify(E.model));if($)return be($[0])}return console.warn(`Could not find agent key for agent with name "${y}". Agent may have been deleted.`),null}).filter(N=>N!==null));let p={name:e.app.registered_model.name};if(e.app.registered_model.schema){const N=Ir(e.app.registered_model.schema,n,"app.registered_model.schema");N&&(p.schema=N)}let v;if(e.app.service_principal)if(typeof e.app.service_principal=="string"){const N=e.app.service_principal.startsWith("*")?e.app.service_principal.slice(1):e.app.service_principal;v=be(N)}else v={client_id:ns(e.app.service_principal.client_id),client_secret:ns(e.app.service_principal.client_secret)};if(t.app={name:e.app.name,registered_model:p,...e.app.description&&{description:e.app.description},...e.app.log_level&&{log_level:e.app.log_level},...v&&{service_principal:v},...e.app.endpoint_name&&{endpoint_name:e.app.endpoint_name},...e.app.workload_size&&{workload_size:e.app.workload_size},...e.app.scale_to_zero!==void 0&&{scale_to_zero:e.app.scale_to_zero},...e.app.environment_vars&&Object.keys(e.app.environment_vars).length>0&&{environment_vars:m2(e.app.environment_vars)},...e.app.tags&&Object.keys(e.app.tags).length>0&&{tags:e.app.tags},...e.app.permissions&&e.app.permissions.length>0&&{permissions:e.app.permissions},...d&&d.length>0&&{agents:d}},e.app.orchestration){const N=((w=e.resources)==null?void 0:w.llms)||{},C=e.tools||{};t.app.orchestration=f2(e.app.orchestration,N,C)}}let a=Bs.dump(t,{indent:2,lineWidth:-1,noRefs:!0,sortKeys:!1,quotingType:'"'});return a=u2(a),a=d2(a),a}function g2(e,t="model_config.yaml"){const n=ra(e),r=new Blob([n],{type:"text/yaml"}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}const Cb=cl(e=>({notifications:[],addNotification:(t,n,r)=>{const a=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,l={id:a,type:t,message:n,details:r,timestamp:Date.now()};e(o=>({notifications:[...o.notifications,l]})),t!=="error"&&setTimeout(()=>{e(o=>({notifications:o.notifications.filter(c=>c.id!==a)}))},1e4)},removeNotification:t=>e(n=>({notifications:n.notifications.filter(r=>r.id!==t)})),clearAll:()=>e({notifications:[]})}));function v2(e){try{const t=ra(e);return Bs.load(t),null}catch(t){if(t instanceof Error){const n=t.message,r=n.match(/undefined alias "([^"]+)"/i);return r?`This component is referenced by "${r[1]}". Remove that reference first.`:`Validation failed: ${n}`}return"Unknown validation error"}}function b2(e,t,n){var a,l,o,c,i,u,m;const r=JSON.parse(JSON.stringify(e));switch(t.toLowerCase()){case"tool":r.tools&&delete r.tools[n];break;case"guardrail":r.guardrails&&delete r.guardrails[n];break;case"schema":r.schemas&&delete r.schemas[n];break;case"variable":r.variables&&delete r.variables[n];break;case"agent":r.agents&&delete r.agents[n];break;case"service principal":r.service_principals&&delete r.service_principals[n];break;case"prompt":r.prompts&&delete r.prompts[n];break;case"retriever":r.retrievers&&delete r.retrievers[n];break;case"llm":(a=r.resources)!=null&&a.llms&&delete r.resources.llms[n];break;case"genie room":(l=r.resources)!=null&&l.genie_rooms&&delete r.resources.genie_rooms[n];break;case"warehouse":(o=r.resources)!=null&&o.warehouses&&delete r.resources.warehouses[n];break;case"function":(c=r.resources)!=null&&c.functions&&delete r.resources.functions[n];break;case"connection":(i=r.resources)!=null&&i.connections&&delete r.resources.connections[n];break;case"database":(u=r.resources)!=null&&u.databases&&delete r.resources.databases[n];break;case"vector store":(m=r.resources)!=null&&m.vector_stores&&delete r.resources.vector_stores[n];break;default:return null}return v2(r)}function tn(e,t,n){const{addNotification:r}=Cb.getState(),a=We.getState().config,l=b2(a,e,t);if(l)return r("error",`Cannot delete ${e} "${t}"`,l),!1;try{return n(),r("success",`${e} "${t}" deleted`),!0}catch(o){return r("error",`Failed to delete ${e} "${t}"`,o instanceof Error?o.message:"Unknown error"),!1}}const Vu={name:"",type:"primitive",primitiveValue:"",envName:"",envDefault:"",secretScope:"",secretKey:"",secretDefault:"",compositeOptions:[],compositeDefault:""},y2=[{value:"primitive",label:"Primitive Value"},{value:"env",label:"Environment Variable"},{value:"secret",label:"Databricks Secret"},{value:"composite",label:"Composite (Fallback Chain)"}],N2=e=>{switch(e){case"primitive":return Pf;case"env":return Un;case"secret":return Tf;case"composite":return dr;default:return Un}},xm=e=>{const t=e;return t.type&&typeof t.type=="string"?t.type:"options"in t&&Array.isArray(t.options)?"composite":"scope"in t&&"secret"in t?"secret":"env"in t?"env":("value"in t,"primitive")},j2=e=>{const t=xm(e),n=e;switch(t){case"primitive":return`Value: ${n.value??""}`;case"env":return`Env: ${n.env??""}`;case"secret":return`Secret: ${n.scope??""}/${n.secret??""}`;case"composite":return`${(n.options||[]).length} fallback option(s)`;default:return""}};function _2(){const{config:e,addVariable:t,updateVariable:n,removeVariable:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState(Vu),m=e.variables||{},{scrollToAsset:h}=qn(),f=(v,N)=>{h(v),c(v);const C=xm(N),j={...Vu,name:v,type:C};switch(C){case"primitive":j.primitiveValue=String(N.value||"");break;case"env":const E=N;j.envName=E.env||"",j.envDefault=E.default_value!==void 0?String(E.default_value):"";break;case"secret":const y=N;j.secretScope=y.scope||"",j.secretKey=y.secret||"",j.secretDefault=y.default_value!==void 0?String(y.default_value):"";break;case"composite":const R=N;j.compositeOptions=(R.options||[]).map($=>{const k=$;return"env"in k?{type:"env",envName:String(k.env||"")}:"scope"in k&&"secret"in k?{type:"secret",scope:String(k.scope||""),secret:String(k.secret||"")}:"value"in k?{type:"primitive",value:String(k.value||"")}:{type:"primitive",value:""}}),j.compositeDefault=R.default_value!==void 0?String(R.default_value):"";break}u(j),l(!0)},g=()=>{u(Vu),c(null),l(!1)},b=()=>{switch(i.type){case"primitive":return{type:"primitive",value:i.primitiveValue};case"env":return{type:"env",env:i.envName,...i.envDefault&&{default_value:i.envDefault}};case"secret":return{type:"secret",scope:i.secretScope,secret:i.secretKey,...i.secretDefault&&{default_value:i.secretDefault}};case"composite":return{type:"composite",options:i.compositeOptions.map(v=>v.type==="env"?{type:"env",env:v.envName||""}:v.type==="secret"?{type:"secret",scope:v.scope||"",secret:v.secret||""}:{type:"primitive",value:v.value||""}),...i.compositeDefault&&{default_value:i.compositeDefault}};default:return{type:"primitive",value:""}}},w=()=>{if(!i.name.trim())return;const v=b();o?o!==i.name?(r(o),t(i.name,v)):n(o,v):t(i.name,v),g()},x=v=>{u({...i,compositeOptions:[...i.compositeOptions,{type:v,envName:"",scope:"",secret:"",value:""}]})},d=(v,N)=>{const C=[...i.compositeOptions];C[v]={...C[v],...N},u({...i,compositeOptions:C})},p=v=>{u({...i,compositeOptions:i.compositeOptions.filter((N,C)=>C!==v)})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-white",children:"Variables"}),s.jsx("p",{className:"text-sm text-slate-400",children:"Define reusable configuration variables (env vars, secrets, or values)"})]}),s.jsxs(Q,{onClick:()=>l(!0),disabled:a,children:[s.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Add Variable"]})]}),a&&s.jsxs(ke,{className:"p-4 space-y-4 border-blue-500/50",children:[s.jsx("h3",{className:"text-lg font-medium text-white",children:o?"Edit Variable":"Add Variable"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Variable Name",placeholder:"e.g., client_id, workspace_host",value:i.name,onChange:v=>u({...i,name:v.target.value})}),s.jsx(le,{label:"Variable Type",value:i.type,onChange:v=>u({...i,type:v.target.value}),options:y2})]}),i.type==="primitive"&&s.jsx(re,{label:"Value",placeholder:"Enter the value",value:i.primitiveValue,onChange:v=>u({...i,primitiveValue:v.target.value})}),i.type==="env"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Environment Variable Name",placeholder:"e.g., DATABRICKS_HOST",value:i.envName,onChange:v=>u({...i,envName:v.target.value})}),s.jsx(re,{label:"Default Value (optional)",placeholder:"Fallback if env var not set",value:i.envDefault,onChange:v=>u({...i,envDefault:v.target.value})})]}),i.type==="secret"&&s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsx(re,{label:"Secret Scope",placeholder:"e.g., retail_ai",value:i.secretScope,onChange:v=>u({...i,secretScope:v.target.value})}),s.jsx(re,{label:"Secret Key",placeholder:"e.g., DATABRICKS_TOKEN",value:i.secretKey,onChange:v=>u({...i,secretKey:v.target.value})}),s.jsx(re,{label:"Default Value (optional)",placeholder:"Fallback if secret not found",value:i.secretDefault,onChange:v=>u({...i,secretDefault:v.target.value})})]}),i.type==="composite"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Fallback Options (tried in order)"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(Q,{size:"sm",variant:"secondary",onClick:()=>x("env"),children:[s.jsx(Un,{className:"w-3 h-3 mr-1"})," Add Env"]}),s.jsxs(Q,{size:"sm",variant:"secondary",onClick:()=>x("secret"),children:[s.jsx(Tf,{className:"w-3 h-3 mr-1"})," Add Secret"]}),s.jsxs(Q,{size:"sm",variant:"secondary",onClick:()=>x("primitive"),children:[s.jsx(Pf,{className:"w-3 h-3 mr-1"})," Add Value"]})]})]}),i.compositeOptions.length===0&&s.jsx("p",{className:"text-sm text-slate-500 italic",children:"Add fallback options. They will be tried in order until one succeeds."}),i.compositeOptions.map((v,N)=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-800/50 rounded-lg",children:[s.jsxs("span",{className:"text-xs text-slate-500 w-6",children:[N+1,"."]}),v.type==="env"&&s.jsx(re,{className:"flex-1",placeholder:"Environment variable name",value:v.envName||"",onChange:C=>d(N,{envName:C.target.value})}),v.type==="secret"&&s.jsxs(s.Fragment,{children:[s.jsx(re,{className:"flex-1",placeholder:"Scope",value:v.scope||"",onChange:C=>d(N,{scope:C.target.value})}),s.jsx(re,{className:"flex-1",placeholder:"Secret key",value:v.secret||"",onChange:C=>d(N,{secret:C.target.value})})]}),v.type==="primitive"&&s.jsx(re,{className:"flex-1",placeholder:"Value",value:v.value||"",onChange:C=>d(N,{value:C.target.value})}),s.jsx("span",{className:"text-xs text-slate-500 capitalize",children:v.type}),s.jsx("button",{onClick:()=>p(N),className:"text-slate-400 hover:text-red-400",children:s.jsx(Qe,{className:"w-4 h-4"})})]},N)),s.jsx(re,{label:"Default Value (optional)",placeholder:"Final fallback if all options fail",value:i.compositeDefault,onChange:v=>u({...i,compositeDefault:v.target.value})})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(Q,{variant:"secondary",onClick:g,children:"Cancel"}),s.jsx(Q,{onClick:w,disabled:!i.name.trim(),children:o?"Save Changes":"Add Variable"})]})]}),Object.keys(m).length===0&&!a?s.jsxs(ke,{className:"p-8 text-center",children:[s.jsx("div",{className:"text-slate-400 mb-4",children:s.jsx(Un,{className:"w-12 h-12 mx-auto opacity-50"})}),s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Variables Defined"}),s.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Variables let you configure values from environment variables, Databricks secrets, or fallback chains. Use them to keep sensitive data out of your config."}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Add Your First Variable"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(m).map(([v,N])=>{const C=xm(N),j=N2(C);return s.jsx(ke,{className:"p-4 cursor-pointer hover:border-blue-500/50 transition-colors",onClick:()=>f(v,N),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-slate-700/50 rounded-lg",children:s.jsx(j,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-white",children:v}),s.jsx("p",{className:"text-sm text-slate-400",children:j2(N)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs px-2 py-1 bg-slate-700/50 rounded text-slate-300 capitalize",children:C}),s.jsx("button",{onClick:E=>{E.stopPropagation(),f(v,N)},className:"text-slate-400 hover:text-blue-400 p-1",title:"Edit variable",children:s.jsx(Bc,{className:"w-4 h-4"})}),s.jsx("button",{onClick:E=>{E.stopPropagation(),tn("Variable",v,()=>r(v))},className:"text-slate-400 hover:text-red-400 p-1",title:"Delete variable",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]})},v)})}),Object.keys(m).length>0&&s.jsxs(ke,{className:"p-4 bg-slate-800/30 border-slate-700/50",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-2",children:"Usage in YAML"}),s.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Reference variables using YAML anchors:"}),s.jsx("pre",{className:"text-xs bg-slate-900/50 p-2 rounded overflow-x-auto",children:s.jsx("code",{className:"text-green-400",children:`variables:
  ${Object.keys(m)[0]||"my_var"}: &${Object.keys(m)[0]||"my_var"}
    ...

# Use in config:
tools:
  my_tool:
    function:
      client_id: *${Object.keys(m)[0]||"my_var"}`})})]})]})}function Mo(e){return e.trim().replace(/[\s-]+/g,"_").replace(/_+/g,"_").replace(/[^a-zA-Z0-9_]/g,"").replace(/^_+|_+$/g,"")}function Lt(e){const t=e.endsWith(" ");let n=e.replace(/[\s-]+/g,"_").replace(/[^a-zA-Z0-9_]/g,"").replace(/_+/g,"_").replace(/^_+/,"");return t&&!n.endsWith("_")&&n.length>0&&(n+="_"),n}function Bp(e,t){return typeof e=="string"&&e.startsWith(t)}function ri(e){return typeof e=="string"?e:""}function Wp(e,t,n){if(!e)return!1;const r=t.resources||{},a=["llms","genie_rooms","tables","volumes","functions","warehouses","connections","databases","vector_stores"];for(const m of a){const h=r[m]||{};if(e in h&&e!==n)return!0}const l=t.service_principals||{};if(e in l&&e!==n)return!0;const o=t.agents||{};if(e in o&&e!==n)return!0;const c=t.tools||{};if(e in c&&e!==n)return!0;const i=t.schemas||{};if(e in i&&e!==n)return!0;const u=t.variables||{};return e in u&&e!==n}const ai={refName:"",clientIdSource:"variable",clientSecretSource:"variable",client_id:"",client_secret:"",clientIdVariable:"",clientSecretVariable:""};function w2(){const{config:e,addServicePrincipal:t,updateServicePrincipal:n,removeServicePrincipal:r}=We(),a=e.service_principals||{},l=e.variables||{},o=Object.keys(l),[c,i]=M.useState(!1),[u,m]=M.useState(null),[h,f]=M.useState(ai),{scrollToAsset:g}=qn(),b=N=>{g(N);const C=a[N];if(C){const j=y=>Bp(y,"*"),E=y=>{const R=ri(y);return R.startsWith("*")?R.slice(1):""};f({refName:N,clientIdSource:j(C.client_id)?"variable":"manual",clientSecretSource:j(C.client_secret)?"variable":"manual",client_id:j(C.client_id)?"":ri(C.client_id),client_secret:j(C.client_secret)?"":ri(C.client_secret),clientIdVariable:j(C.client_id)?E(C.client_id):"",clientSecretVariable:j(C.client_secret)?E(C.client_secret):""}),m(N),i(!0)}},w=()=>{const N={client_id:h.clientIdSource==="variable"&&h.clientIdVariable?`*${h.clientIdVariable}`:h.client_id,client_secret:h.clientSecretSource==="variable"&&h.clientSecretVariable?`*${h.clientSecretVariable}`:h.client_secret};u?u!==h.refName?(r(u),t(h.refName,N)):n(h.refName,N):t(h.refName,N),f(ai),i(!1),m(null)},x=()=>{f(ai),i(!1),m(null)},d=N=>{tn("Service Principal",N,()=>r(N))},p=h.clientIdSource==="variable"?!!h.clientIdVariable:!!h.client_id,v=h.clientSecretSource==="variable"?!!h.clientSecretVariable:!!h.client_secret;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Service Principals"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure OAuth credentials for database connections, MCP tools, and other services that require authentication."})]}),s.jsx(ke,{className:"p-4 bg-blue-500/10 border-blue-500/30",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Un,{className:"w-5 h-5 text-blue-400 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-200",children:[s.jsx("p",{className:"font-medium",children:"About Service Principals"}),s.jsxs("p",{className:"text-blue-300 mt-1",children:["Service principals provide OAuth client credentials (client_id and client_secret) that can be referenced throughout your configuration using ",s.jsx("code",{className:"bg-blue-900/50 px-1 rounded",children:"*reference_name"})," syntax. They're commonly used for database connections, external API authentication, and MCP tool configuration."]})]})]})}),s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Un,{className:"w-5 h-5 text-amber-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Configured Service Principals"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{f(ai),m(null),i(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Service Principal"]})]}),Object.keys(a).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(a).map(([N,C])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Un,{className:"w-4 h-4 text-amber-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:N}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Client ID: ",Bp(C.client_id,"*")?`Variable (${ri(C.client_id).slice(1)})`:""]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>b(N),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>d(N),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},N))}),Object.keys(a).length===0&&!c&&s.jsx("p",{className:"text-slate-500 text-sm",children:'No service principals configured. Click "Add Service Principal" to create one.'}),c&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[u?"Edit":"New"," Service Principal"]}),s.jsx(re,{label:"Reference Name",value:h.refName,onChange:N=>f({...h,refName:Lt(N.target.value)}),placeholder:"My Service Principal",hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client ID *"}),s.jsx("div",{className:"flex space-x-2",children:s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>f({...h,clientIdSource:"variable",client_id:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${h.clientIdSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>f({...h,clientIdSource:"manual",clientIdVariable:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${h.clientIdSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})})]}),h.clientIdSource==="variable"?s.jsx(le,{value:h.clientIdVariable,onChange:N=>f({...h,clientIdVariable:N.target.value}),options:[{value:"",label:"Select a variable..."},...o.map(N=>({value:N,label:N}))],hint:"Reference a configured variable for the client ID"}):s.jsx(re,{type:"password",value:h.client_id,onChange:N=>f({...h,client_id:N.target.value}),placeholder:"Enter client ID...",hint:"OAuth client ID for the service principal"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client Secret *"}),s.jsx("div",{className:"flex space-x-2",children:s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>f({...h,clientSecretSource:"variable",client_secret:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${h.clientSecretSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>f({...h,clientSecretSource:"manual",clientSecretVariable:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${h.clientSecretSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})})]}),h.clientSecretSource==="variable"?s.jsx(le,{value:h.clientSecretVariable,onChange:N=>f({...h,clientSecretVariable:N.target.value}),options:[{value:"",label:"Select a variable..."},...o.map(N=>({value:N,label:N}))],hint:"Reference a configured variable for the client secret"}):s.jsx(re,{type:"password",value:h.client_secret,onChange:N=>f({...h,client_secret:N.target.value}),placeholder:"Enter client secret...",hint:"OAuth client secret for the service principal"})]}),h.refName&&Wp(h.refName,e,u)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',h.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:x,children:"Cancel"}),s.jsx(Q,{onClick:w,disabled:!h.refName||!p||!v||Wp(h.refName,e,u),children:u?"Update":"Add"})]})]})]}),s.jsxs(ke,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-slate-200 mb-3",children:"Usage Examples"}),s.jsxs("div",{className:"text-sm text-slate-400 space-y-2",children:[s.jsx("p",{children:"Once configured, reference service principals in your YAML using the asterisk notation:"}),s.jsx("pre",{className:"bg-slate-800 p-3 rounded text-xs overflow-x-auto",children:`databases:
  my_database:
    service_principal: *my_service_principal
    host: ...

tools:
  mcp_tool:
    function:
      type: mcp
      service_principal: *my_service_principal
      ...`})]})]})]})}function An({isOpen:e,onClose:t,title:n,description:r,children:a,size:l="md"}){if(M.useEffect(()=>{const c=i=>{i.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",c),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",c),document.body.style.overflow="unset"}},[e,t]),!e)return null;const o={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[90vw]"};return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),s.jsxs("div",{className:Ye("relative w-full bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl animate-fade-in",o[l]),children:[s.jsxs("div",{className:"flex items-start justify-between p-6 border-b border-slate-800",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:n}),r&&s.jsx("p",{className:"mt-1 text-sm text-slate-400",children:r})]}),s.jsx("button",{onClick:t,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(qr,{className:"w-5 h-5"})})]}),s.jsx("div",{className:Ye("p-6 overflow-y-auto",l==="full"?"max-h-[80vh]":"max-h-[70vh]"),children:a})]})]})}let Ra=null;const zf="databricks_config";function S2(){const e=window.location.hostname;return e.includes(".databricks")||e.includes(".azuredatabricks.")||e.endsWith(".databricks.com")||e.endsWith(".gcp.databricks.com")||e.endsWith(".cloud.databricks.com")}function C2(){return window.location.origin}let ho=null;function k2(e){ho=e}function Rl(e){console.log("[Config] Setting config:",{host:e.host,source:e.source,isAutoDetected:e.isAutoDetected}),Ra=e;try{localStorage.setItem(zf,JSON.stringify(e)),console.log("[Config] Saved to localStorage")}catch(t){console.error("[Config] Failed to save to localStorage:",t)}ho?(console.log("[Config] Notifying listeners of config change"),ho()):console.warn("[Config] No config change callback registered")}function Br(){if(Ra)return Ra;try{const e=localStorage.getItem(zf);if(e)return Ra=JSON.parse(e),Ra}catch{}return null}function kb(){Ra=null;try{localStorage.removeItem(zf)}catch{}ho&&ho()}function Pr(){return Br()!==null}async function E2(e){const t=e?`/api/auth/login?host=${encodeURIComponent(e)}`:"/api/auth/login";return(await fetch(t,{credentials:"include"})).json()}async function A2(){await fetch("/api/auth/logout",{credentials:"include"}),kb()}async function R2(){var n;const e=S2(),t=Br();if(t)return console.log("[AutoDetect] Already configured, returning existing config"),{success:!0,host:t.host,hasToken:!0,inDatabricksApp:e,source:t.source};try{console.log("[AutoDetect] Fetching /api/auth/context...");const r=await fetch("/api/auth/context",{credentials:"include"});if(console.log("[AutoDetect] Response status:",r.status,r.ok),r.ok){const a=await r.json();if(console.log("[AutoDetect] Auth context data:",a),a.host&&a.has_token){const l=a.auth_method;return Rl({host:a.host,token:`__${l.toUpperCase()}_TOKEN__`,isAutoDetected:!0,source:l}),{success:!0,host:a.host,hasToken:!0,inDatabricksApp:a.is_databricks_app,user:a.user,source:l,oauth:a.oauth}}return a.host&&!a.has_token?{success:!1,host:a.host,hasToken:!1,inDatabricksApp:a.is_databricks_app,user:a.user,source:null,oauth:a.oauth,error:(n=a.oauth)!=null&&n.configured?'Not authenticated. Click "Login with Databricks" to authenticate.':a.is_databricks_app?"On-behalf-of-user authentication is not enabled. Please configure manual credentials or enable OBO auth for this app.":"Token not found. Configure credentials manually or set DATABRICKS_TOKEN environment variable."}:{success:!1,host:null,hasToken:!1,inDatabricksApp:a.is_databricks_app,oauth:a.oauth,error:"No Databricks host configured."}}}catch{}return e?{success:!1,host:C2(),hasToken:!1,inDatabricksApp:!0,error:"Could not connect to backend. Please ensure the app is running correctly."}:{success:!1,host:null,hasToken:!1,inDatabricksApp:!1,error:"Configure Databricks credentials manually."}}class Is extends Error{constructor(t,n,r){super(t),this.status=n,this.errorCode=r,this.name="DatabricksApiError"}}const $t={async getConnectionStatus(){const e=Br();if(console.log("[getConnectionStatus] Current config:",e),!e)return console.log("[getConnectionStatus] No config found, returning not connected"),{connected:!1,error:"Not configured"};try{console.log("[getConnectionStatus] Fetching /api/auth/verify...");const t={"Content-Type":"application/json","X-Databricks-Host":e.host};e.token&&!e.token.startsWith("__")&&e.source==="manual"?(console.log("[getConnectionStatus] Using manual token for verification"),t.Authorization=`Bearer ${e.token}`):console.log("[getConnectionStatus] Using auto-detected auth (no Authorization header)");const a=await(await fetch("/api/auth/verify",{credentials:"include",headers:t})).json();return console.log("[getConnectionStatus] Verify response:",a),a.authenticated&&a.user?{connected:!0,user:a.user.userName,display_name:a.user.displayName,host:a.host||e.host,isAutoDetected:e.isAutoDetected,source:a.token_source||e.source}:{connected:!1,error:a.error||a.message||"Authentication failed"}}catch(t){return console.error("[getConnectionStatus] Error:",t),{connected:!1,error:t instanceof Error?t.message:"Unknown error"}}},async listCatalogs(){const e=await fetch("/api/uc/catalogs",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Is(n.error||"Failed to list catalogs")}return(await e.json()).catalogs||[]},async listSchemas(e){const t=await fetch(`/api/uc/schemas?catalog=${encodeURIComponent(e)}`,{credentials:"include"});if(!t.ok){const r=await t.json().catch(()=>({error:t.statusText}));throw new Is(r.error||"Failed to list schemas")}return(await t.json()).schemas||[]},async listTables(e,t){const n=await fetch(`/api/uc/tables?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new Is(a.error||"Failed to list tables")}return(await n.json()).tables||[]},async getTableColumns(e,t,n){const r=await fetch(`/api/uc/table-columns?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}&table=${encodeURIComponent(n)}`,{credentials:"include"});if(!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));throw new Is(l.error||"Failed to get table columns")}return(await r.json()).columns||[]},async listFunctions(e,t){const n=await fetch(`/api/uc/functions?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new Is(a.error||"Failed to list functions")}return(await n.json()).functions||[]},async listVolumes(e,t){const n=await fetch(`/api/uc/volumes?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new Is(a.error||"Failed to list volumes")}return(await n.json()).volumes||[]},async listDatabases(){try{const e=await fetch("/api/uc/databases",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));return console.error("[listDatabases] Error:",n),[]}return(await e.json()).databases||[]}catch(e){return console.error("[listDatabases] Error:",e),[]}},async listServingEndpoints(){try{const e=await fetch("/api/uc/serving-endpoints",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Is(n.error||"Failed to list serving endpoints")}return(await e.json()).endpoints||[]}catch(e){return console.error("[listServingEndpoints] Error:",e),[]}},async listSQLWarehouses(){try{const e=await fetch("/api/uc/sql-warehouses",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Is(n.error||"Failed to list SQL warehouses")}return(await e.json()).warehouses||[]}catch(e){return console.error("[listSQLWarehouses] Error:",e),[]}},async listGenieSpaces(){try{const e=await fetch("/api/uc/genie-spaces",{credentials:"include"});return e.ok?((await e.json()).spaces||[]).map(n=>({space_id:n.id||n.space_id||"",title:n.name||n.title||"",description:n.description,owner:n.owner})):[]}catch{return[]}},async listVectorSearchEndpoints(){try{const e=await fetch("/api/uc/vector-search-endpoints",{credentials:"include"});return e.ok?(await e.json()).endpoints||[]:[]}catch{return[]}},async listVectorSearchIndexes(e){try{const t=e?`/api/uc/vector-search-indexes?endpoint=${encodeURIComponent(e)}`:"/api/uc/vector-search-indexes",n=await fetch(t,{credentials:"include"});return n.ok?(await n.json()).vector_indexes||[]:[]}catch{return[]}},async listUCConnections(){try{const e=await fetch("/api/uc/connections",{credentials:"include"});return e.ok?(await e.json()).connections||[]:[]}catch{return[]}},async listRegisteredModels(){try{const e=await fetch("/api/uc/registered-models",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new Is(n.error||"Failed to list registered models")}return(await e.json()).models||[]}catch(e){return console.error("[listRegisteredModels] Error:",e),[]}},async listPrompts(e,t,n){try{let r;if(n?r=await fetch("/api/uc/prompts",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({catalog:e,schema:t,service_principal:n})}):r=await fetch(`/api/uc/prompts?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"}),!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));return console.error("[listPrompts] Error:",l),[]}return(await r.json()).prompts||[]}catch(r){return console.error("[listPrompts] Error:",r),[]}},async getPromptDetails(e,t){try{let n;if(t?n=await fetch("/api/uc/prompt-details",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,service_principal:t})}):n=await fetch(`/api/uc/prompt-details?name=${encodeURIComponent(e)}`,{credentials:"include"}),!n.ok){const r=await n.json().catch(()=>({error:n.statusText}));return console.error("[getPromptDetails] Error:",r),null}return await n.json()}catch(n){return console.error("[getPromptDetails] Error:",n),null}},async getPromptTemplate(e,t,n,r){try{let a;if(r)a=await fetch("/api/uc/prompt-template",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,version:t||void 0,alias:n||void 0,service_principal:r})});else{let o=`/api/uc/prompt-template?name=${encodeURIComponent(e)}`;t?o+=`&version=${encodeURIComponent(t)}`:n&&(o+=`&alias=${encodeURIComponent(n)}`),a=await fetch(o,{credentials:"include"})}const l=await a.json().catch(()=>({error:a.statusText}));return a.ok?l:(console.error("[getPromptTemplate] Error:",l),{template:"",version:"",error:l.error||"Failed to load template",alias_not_found:l.alias_not_found,version_not_found:l.version_not_found})}catch(a){return console.error("[getPromptTemplate] Error:",a),{template:"",version:"",error:a instanceof Error?a.message:"Unknown error"}}},async registerPrompt(e,t,n,r,a,l,o,c){try{const i=await fetch("/api/uc/register-prompt",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,catalog_name:t,schema_name:n,template:r,description:a||void 0,alias:l||void 0,tags:o||void 0,service_principal:c||void 0})}),u=await i.json().catch(()=>({error:i.statusText}));return i.ok?u:(console.error("[registerPrompt] Error:",u),{success:!1,error:u.error||"Failed to register prompt"})}catch(i){return console.error("[registerPrompt] Error:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}}};let gm=0;const hc=new Set;function M2(){gm++,console.log("[Hooks] Config change notified, new version:",gm,"listeners:",hc.size),hc.forEach(e=>e())}console.log("[Hooks] Registering config change callback");k2(M2);function P2(e){return hc.add(e),()=>hc.delete(e)}function T2(){return gm}function Eb(){return M.useSyncExternalStore(P2,T2)}function nn(e,t=[],n=!1){const r=Eb(),[a,l]=M.useState(null),[o,c]=M.useState(!1),[i,u]=M.useState(null),m=JSON.stringify(t),h=M.useRef(!1),f=M.useCallback(async()=>{if(h.current)return;const g=Pr();if(n||!g){c(!1),l(null);return}h.current=!0,c(!0),u(null);try{const b=await e();l(b)}catch(b){console.error("[useAsync] Fetch error:",b),u(b instanceof Error?b:new Error(String(b)))}finally{c(!1),h.current=!1}},[n,r,m]);return M.useEffect(()=>{f()},[f]),{data:a,loading:o,error:i,refetch:f}}function O2(){const[e,t]=M.useState(!0),[n,r]=M.useState(!1),[a,l]=M.useState(null),[o,c]=M.useState(!1),[i,u]=M.useState(!1),[m,h]=M.useState(null),[f,g]=M.useState(void 0),[b,w]=M.useState(0),x=M.useCallback(()=>{w(d=>d+1)},[]);return M.useEffect(()=>{(async()=>{console.log("[useAutoDetectConfig] Starting detection..."),t(!0);const p=await R2();console.log("[useAutoDetectConfig] Detection result:",p),r(p.success),l(p.host),c(p.hasToken),u(p.inDatabricksApp),h(p.error||null),g(p.oauth),t(!1)})()},[b]),{detecting:e,detected:n,autoDetectedHost:a,hasToken:o,inDatabricksApp:i,error:m,oauthInfo:f,redetect:x}}function I2(){const e=Eb(),t=Pr();console.log("[useConnectionStatus] configured:",t,"configVer:",e);const n=nn(async()=>{console.log("[useConnectionStatus] Calling getConnectionStatus...");const r=await $t.getConnectionStatus();return console.log("[useConnectionStatus] Got status:",r),r},[t,e],!1);return console.log("[useConnectionStatus] Returning:",{...n,configured:t}),{...n,configured:t}}function Tr(){return nn(()=>$t.listCatalogs(),[])}function as(e){return nn(async()=>e?$t.listSchemas(e):[],[e],!e)}function vm(e,t){return nn(async()=>!e||!t?[]:$t.listTables(e,t),[e,t],!e||!t)}function L2(e,t,n){return nn(async()=>!e||!t||!n?[]:$t.getTableColumns(e,t,n),[e,t,n],!e||!t||!n)}function Ab(e,t){return nn(async()=>!e||!t?[]:$t.listFunctions(e,t),[e,t],!e||!t)}function bm(e,t){return nn(async()=>!e||!t?[]:$t.listVolumes(e,t),[e,t],!e||!t)}function $2(){return nn(()=>$t.listServingEndpoints(),[])}function D2(){return nn(()=>$t.listDatabases(),[])}function F2(){return nn(()=>$t.listSQLWarehouses(),[])}function Rb(){return nn(()=>$t.listGenieSpaces(),[])}function Mb(){return nn(()=>$t.listUCConnections(),[])}function Pb(){return nn(()=>$t.listVectorSearchEndpoints(),[])}function ym(e){return nn(async()=>$t.listVectorSearchIndexes(e),[e])}function V2(e,t,n){return nn(async()=>!e||!t?[]:$t.listPrompts(e,t,n),[e,t,n],!e||!t)}function z2(e,t){return nn(async()=>e?$t.getPromptDetails(e,t):null,[e,t],!e)}function Ei({label:e="Catalog",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select a catalog"}){const{data:c,loading:i,error:u}=Tr(),m=Pr(),h=[{value:"",label:o},...(c||[]).map(f=>({value:f.name,label:f.name}))];return s.jsx(le,{label:e,value:t,onChange:f=>n(f.target.value),options:h,hint:m?i?"Loading catalogs...":u?"Failed to load catalogs":r:"Connect to Databricks first",required:a,disabled:l||i||!m})}function Ai({label:e="Schema",value:t,onChange:n,catalog:r,hint:a,required:l,disabled:o,placeholder:c="Select a schema"}){const{data:i,loading:u,error:m}=as(r),h=Pr();M.useEffect(()=>{t&&i&&!i.find(g=>g.name===t)&&n("")},[r,i,t,n]);const f=[{value:"",label:c},...(i||[]).map(g=>({value:g.name,label:g.name}))];return s.jsx(le,{label:e,value:t,onChange:g=>n(g.target.value),options:f,hint:h?r?u?"Loading schemas...":m?"Failed to load schemas":a:"Select a catalog first":"Connect to Databricks first",required:l,disabled:o||u||!r||!h})}function Gp({label:e="Genie Space",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select a Genie space"}){const{data:c,loading:i,error:u}=Rb(),m=Pr(),h=g=>{let b=g.title;if(g.description){const w=g.description.length>50?g.description.substring(0,50)+"...":g.description;b+=` - ${w}`}return b},f=[{value:"",label:o},...(c||[]).map(g=>({value:g.space_id,label:h(g)}))];return s.jsx(le,{label:e,value:t,onChange:g=>n(g.target.value),options:f,hint:m?i?"Loading Genie spaces...":u?"Failed to load Genie spaces":r:"Connect to Databricks first",required:a,disabled:l||i||!m})}function Yp({label:e="Vector Search Endpoint",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select an endpoint"}){const{data:c,loading:i,error:u}=Pb(),m=Pr(),h=[{value:"",label:o},...(c||[]).map(f=>{var g;return{value:f.name,label:`${f.name}${(g=f.endpoint_status)!=null&&g.state?` (${f.endpoint_status.state})`:""}`}})];return s.jsx(le,{label:e,value:t,onChange:f=>n(f.target.value),options:h,hint:m?i?"Loading endpoints...":u?"Failed to load endpoints":r:"Connect to Databricks first",required:a,disabled:l||i||!m})}function H2({label:e="UC Connection",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select a connection"}){const{data:c,loading:i,error:u}=Mb(),m=Pr(),h=[{value:"",label:o},...(c||[]).map(f=>({value:f.name,label:`${f.name}${f.connection_type?` (${f.connection_type})`:""}`}))];return s.jsx(le,{label:e,value:t,onChange:f=>n(f.target.value),options:h,hint:m?i?"Loading connections...":u?"Failed to load connections":(c==null?void 0:c.length)===0?"No UC connections found":r:"Connect to Databricks first",required:a,disabled:l||i||!m})}function zu(e,t){const n=`${e}_${t}`;return Mo(n)}function U2(){const{config:e,addSchema:t,removeSchema:n,updateSchema:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState("select"),[m,h]=M.useState({name:"",catalogName:"",schemaName:""}),f=e.schemas||{},g=Pr(),{data:b,loading:w,refetch:x}=Tr(),{data:d}=as(m.catalogName||null),p=()=>{h({name:"",catalogName:"",schemaName:""}),u("select"),c(null)},{scrollToAsset:v}=qn(),N=(y,R)=>{v(y),c(y),h({name:y,catalogName:R.catalog_name,schemaName:R.schema_name});const $=b==null?void 0:b.some(k=>k.name===R.catalog_name);u($?"select":"create"),l(!0)},C=y=>{if(y.preventDefault(),m.name&&m.catalogName&&m.schemaName){const R={catalog_name:m.catalogName,schema_name:m.schemaName};o?r(o,R):t(m.name,R),p(),l(!1)}},j=y=>{h({...m,catalogName:y,schemaName:""})},E=i==="create"&&m.catalogName&&m.schemaName&&(d==null?void 0:d.some(y=>y.name===m.schemaName));return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Schemas"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Define Unity Catalog schemas for your data and resources"})]}),s.jsxs(Q,{onClick:()=>{p(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Schema"]})]}),Object.keys(f).length===0?s.jsxs(ke,{className:"text-center py-12",children:[s.jsx(on,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No schemas configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Schemas define where your data and resources are stored in Unity Catalog."}),s.jsxs(Q,{onClick:()=>{p(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Schema"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(f).map(([y,R])=>{const $=b==null?void 0:b.some(k=>k.name===R.catalog_name);return s.jsx(ke,{variant:"interactive",className:"group cursor-pointer",onClick:()=>N(y,R),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center",children:s.jsx(on,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:y}),s.jsxs("p",{className:"text-sm text-slate-400",children:[R.catalog_name,".",R.schema_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[$?s.jsx(Ee,{variant:"success",children:"Exists"}):s.jsx(Ee,{variant:"warning",children:"New"}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:k=>{k.stopPropagation(),N(y,R)},children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:k=>{k.stopPropagation(),tn("Schema",y,()=>n(y))},children:s.jsx(Qe,{className:"w-4 h-4"})})]})]})},y)})}),s.jsx(An,{isOpen:a,onClose:()=>{l(!1),p()},title:o?"Edit Schema":"Add Schema",description:"Configure a Unity Catalog schema reference",children:s.jsxs("form",{onSubmit:C,className:"space-y-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., Retail Schema",value:m.name,onChange:y=>h({...m,name:Lt(y.target.value)}),hint:"Type naturally - spaces become underscores",required:!0,disabled:!!o}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsxs("button",{type:"button",onClick:()=>u("select"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 flex items-center justify-center gap-1.5 ${i==="select"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/40":"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:text-slate-300 hover:border-slate-600"}`,children:[s.jsx(on,{className:"w-3.5 h-3.5"}),"Use Existing"]}),s.jsxs("button",{type:"button",onClick:()=>u("create"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 flex items-center justify-center gap-1.5 ${i==="create"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/40":"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:text-slate-300 hover:border-slate-600"}`,children:[s.jsx(Pe,{className:"w-3.5 h-3.5"}),"Create New"]})]})]}),i==="select"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-slate-400",children:"Select from existing Unity Catalog"}),s.jsxs("button",{type:"button",onClick:()=>x(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:w,children:[s.jsx(Ut,{className:`w-3 h-3 ${w?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),!g&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 text-amber-400 text-sm",children:"Connect to Databricks first to browse existing catalogs and schemas."}),s.jsx(Ei,{label:"Catalog Name",value:m.catalogName,onChange:j,hint:"Select a Unity Catalog catalog",required:!0}),s.jsx(Ai,{label:"Schema Name",value:m.schemaName,onChange:y=>h({...m,schemaName:y,name:m.name||zu(m.catalogName,y)}),catalog:m.catalogName||null,hint:"Select a schema within the catalog",required:!0})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:s.jsxs("p",{className:"text-sm text-green-400",children:[s.jsx("strong",{children:"Note:"})," When you deploy your dao-ai agent, it will create these Unity Catalog resources if they don't exist. Make sure you have the appropriate permissions."]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:["Catalog Name ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:m.catalogName,onChange:y=>h({...m,catalogName:y.target.value}),placeholder:"e.g., retail_catalog",className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),b&&b.length>0&&s.jsxs("select",{value:"",onChange:y=>{y.target.value&&h({...m,catalogName:y.target.value})},className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-400 cursor-pointer hover:border-slate-600",children:[s.jsx("option",{value:"",children:"Pick existing..."}),b.map(y=>s.jsx("option",{value:y.name,children:y.name},y.name))]})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter a new catalog name or pick an existing one"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:["Schema Name ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:m.schemaName,onChange:y=>{const R=y.target.value;h({...m,schemaName:R,name:m.name||zu(m.catalogName,R)})},placeholder:"e.g., hardware_store",className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),m.catalogName&&d&&d.length>0&&s.jsxs("select",{value:"",onChange:y=>{y.target.value&&h({...m,schemaName:y.target.value,name:m.name||zu(m.catalogName,y.target.value)})},className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-400 cursor-pointer hover:border-slate-600",children:[s.jsx("option",{value:"",children:"Pick existing..."}),d.map(y=>s.jsx("option",{value:y.name,children:y.name},y.name))]})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter a new schema name or pick an existing one"})]}),E&&s.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20",children:s.jsx("p",{className:"text-sm text-blue-400",children:" This schema already exists in Unity Catalog"})})]})]}),m.catalogName&&m.schemaName&&s.jsxs("div",{className:"p-3 rounded-lg bg-slate-800/50 border border-slate-700",children:[s.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Full schema path:"}),s.jsxs("code",{className:"text-sm text-white font-mono",children:[m.catalogName,".",m.schemaName]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{l(!1),p()},children:"Cancel"}),s.jsx(Q,{type:"submit",children:o?"Save Changes":"Add Schema"})]})]})})]})}const qp={ready:"bg-green-500",transitioning:"bg-yellow-500",stopped:"bg-red-500",unknown:"bg-slate-500"};function Po({value:e,onChange:t,options:n,placeholder:r="Select...",disabled:a=!1,className:l=""}){const[o,c]=M.useState(!1),i=M.useRef(null),u=n.find(g=>g.value===e);M.useEffect(()=>{const g=b=>{i.current&&!i.current.contains(b.target)&&c(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),M.useEffect(()=>{const g=b=>{b.key==="Escape"&&c(!1)};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[]);const m=g=>{g&&!g.startsWith("__header")&&(t(g),c(!1))},h=[];let f="";return n.forEach(g=>{g.value.startsWith("__header")?(f=g.label,h.push({group:f,items:[]})):h.length>0?h[h.length-1].items.push(g):(h.length===0&&h.push({group:"",items:[]}),h[0].items.push(g))}),s.jsxs("div",{ref:i,className:`relative ${l}`,children:[s.jsxs("button",{type:"button",onClick:()=>!a&&c(!o),disabled:a,className:`
          w-full flex items-center justify-between px-3 py-2
          bg-slate-800 border border-slate-700 rounded-lg
          text-left text-sm
          ${a?"opacity-50 cursor-not-allowed":"hover:border-slate-600 cursor-pointer"}
          focus:outline-none focus:ring-2 focus:ring-blue-500
          transition-colors
        `,children:[s.jsxs("span",{className:"flex items-center gap-2 truncate",children:[(u==null?void 0:u.status)&&s.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${qp[u.status]}`}),s.jsx("span",{className:u?"text-white":"text-slate-400",children:(u==null?void 0:u.label)||r})]}),s.jsx(rs,{className:`w-4 h-4 text-slate-400 transition-transform ${o?"rotate-180":""}`})]}),o&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-60 overflow-auto",children:h.map((g,b)=>s.jsxs("div",{children:[g.group&&s.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-slate-500 bg-slate-900/50 sticky top-0",children:g.group.replace(/^\s*/,"").replace(/\s*$/,"")}),g.items.map(w=>s.jsxs("button",{type:"button",onClick:()=>m(w.value),disabled:w.disabled,className:`
                    w-full flex items-center gap-2 px-3 py-2 text-sm text-left
                    ${w.disabled?"opacity-50 cursor-not-allowed":"hover:bg-slate-700/50 cursor-pointer"}
                    ${w.value===e?"bg-blue-500/20 text-blue-400":"text-slate-200"}
                    transition-colors
                  `,children:[w.status&&s.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${qp[w.status]}`}),s.jsx("span",{className:"truncate flex-1",children:w.label}),w.value===e&&s.jsx(ac,{className:"w-4 h-4 text-blue-400 flex-shrink-0"})]},w.value))]},b))})]})}const B2=e=>`*${e}`,W2=e=>e?typeof e=="string"||typeof e=="number"||typeof e=="boolean"?`value: ${String(e)}`:"env"in e?`env: ${e.env}`:"scope"in e&&"secret"in e?`secret: ${e.scope}/${e.secret}`:"value"in e?`value: ${String(e.value)}`:"options"in e?`composite (${e.options.length} options)`:"unknown":"unknown";function bl({label:e,source:t,onSourceChange:n,manualValue:r,onManualChange:a,variableValue:l,onVariableChange:o,placeholder:c,isPassword:i=!1,hint:u,variableNames:m,variables:h,disabled:f=!1}){return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>!f&&n("variable"),disabled:f,className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 flex items-center gap-1 ${t==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"} ${f?"opacity-50 cursor-not-allowed":""}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>!f&&n("manual"),disabled:f,className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${t==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"} ${f?"opacity-50 cursor-not-allowed":""}`,children:"Manual"})]})]}),t==="variable"?s.jsx(le,{value:l,onChange:g=>o(g.target.value),options:[{value:"",label:"Select a variable..."},...m.map(g=>({value:g,label:`${g} (${W2(h[g])})`}))],hint:m.length===0?"Define variables in the Variables section first":u,disabled:f}):s.jsx(re,{value:r,onChange:g=>a(g.target.value),placeholder:c,type:i?"password":"text",hint:u,disabled:f})]})}const G2=[{value:"default",label:"Use Ambient/Default Credentials"},{value:"service_principal",label:"Configured Service Principal"},{value:"oauth",label:"OAuth2 / M2M Credentials"},{value:"pat",label:"Personal Access Token"}];function Gc({formData:e,setFormData:t,servicePrincipals:n,variables:r,variableNames:a}){const l=(e==null?void 0:e.on_behalf_of_user)||!1;return s.jsxs("div",{className:"space-y-4 p-4 bg-slate-900/30 rounded-lg border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-sm font-semibold text-slate-200",children:"Authentication"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:e.on_behalf_of_user,onChange:o=>t({...e,on_behalf_of_user:o.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Yn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]})]}),l&&s.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg text-blue-300 text-xs",children:"When enabled, the resource will use the calling user's credentials for authentication. Other authentication options are disabled."}),s.jsx(le,{label:"Authentication Method",value:(e==null?void 0:e.authMethod)||"default",onChange:o=>t({...e,authMethod:o.target.value}),options:G2,disabled:l,hint:l?'Disabled when "On Behalf of User" is enabled':void 0}),!l&&((e==null?void 0:e.authMethod)==="default"||!(e!=null&&e.authMethod))&&s.jsx("div",{className:"p-3 bg-slate-800/50 rounded border border-slate-600 text-slate-300 text-xs",children:"Will use ambient credentials from the environment (DATABRICKS_HOST, DATABRICKS_TOKEN, etc.) or the default Databricks SDK configuration."}),!l&&(e==null?void 0:e.authMethod)==="service_principal"&&s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Select Configured Service Principal"}),s.jsx(le,{label:"Service Principal",value:(e==null?void 0:e.servicePrincipalRef)||"",onChange:o=>t({...e,servicePrincipalRef:o.target.value}),options:[{value:"",label:"Select a service principal..."},...Object.keys(n).map(o=>({value:o,label:o}))],hint:"Reference a pre-configured service principal"}),Object.keys(n).length===0&&s.jsx("div",{className:"p-2 bg-amber-500/10 border border-amber-500/30 rounded text-amber-400 text-xs",children:"No service principals configured. Add one in the Service Principals section first."})]}),!l&&(e==null?void 0:e.authMethod)==="oauth"&&s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"OAuth2 / M2M Credentials"}),s.jsx(bl,{label:"Client ID",source:(e==null?void 0:e.clientIdSource)||"variable",onSourceChange:o=>t({...e,clientIdSource:o}),manualValue:(e==null?void 0:e.client_id)||"",onManualChange:o=>t({...e,client_id:o}),variableValue:(e==null?void 0:e.clientIdVariable)||"",onVariableChange:o=>t({...e,clientIdVariable:o}),placeholder:"your-service-principal-client-id",variableNames:a,variables:r}),s.jsx(bl,{label:"Client Secret",source:(e==null?void 0:e.clientSecretSource)||"variable",onSourceChange:o=>t({...e,clientSecretSource:o}),manualValue:(e==null?void 0:e.client_secret)||"",onManualChange:o=>t({...e,client_secret:o}),variableValue:(e==null?void 0:e.clientSecretVariable)||"",onVariableChange:o=>t({...e,clientSecretVariable:o}),placeholder:"your-client-secret",isPassword:!0,variableNames:a,variables:r}),s.jsx(bl,{label:"Workspace Host (Optional)",source:e.workspaceHostSource,onSourceChange:o=>t({...e,workspaceHostSource:o}),manualValue:e.workspace_host,onManualChange:o=>t({...e,workspace_host:o}),variableValue:e.workspaceHostVariable,onVariableChange:o=>t({...e,workspaceHostVariable:o}),placeholder:"https://your-workspace.cloud.databricks.com",hint:"Only required if connecting from outside the workspace",variableNames:a,variables:r})]}),!l&&(e==null?void 0:e.authMethod)==="pat"&&s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Personal Access Token"}),s.jsx(bl,{label:"PAT Token",source:(e==null?void 0:e.patSource)||"variable",onSourceChange:o=>t({...e,patSource:o}),manualValue:(e==null?void 0:e.pat)||"",onManualChange:o=>t({...e,pat:o}),variableValue:(e==null?void 0:e.patVariable)||"",onVariableChange:o=>t({...e,patVariable:o}),placeholder:"dapi...",isPassword:!0,hint:"Databricks Personal Access Token",variableNames:a,variables:r}),s.jsx(bl,{label:"Workspace Host (Optional)",source:(e==null?void 0:e.workspaceHostSource)||"variable",onSourceChange:o=>t({...e,workspaceHostSource:o}),manualValue:(e==null?void 0:e.workspace_host)||"",onManualChange:o=>t({...e,workspace_host:o}),variableValue:(e==null?void 0:e.workspaceHostVariable)||"",onVariableChange:o=>t({...e,workspaceHostVariable:o}),placeholder:"https://your-workspace.cloud.databricks.com",hint:"Only required if connecting from outside the workspace",variableNames:a,variables:r})]})]})}const yl=(e,t,n)=>{if(!(!t&&!n))return e==="variable"&&n?B2(n):t||void 0},Yc=(e,t,n)=>{const r=o=>t(o,"*"),a=o=>{const c=n(o);return c.startsWith("*")?c.slice(1):""};let l="default";return e.service_principal?l="service_principal":e.client_id&&e.client_secret?l="oauth":e.pat&&(l="pat"),{authMethod:l,servicePrincipalRef:t(e.service_principal,"*")?n(e.service_principal).slice(1):"",clientIdSource:r(e.client_id)?"variable":"manual",clientSecretSource:r(e.client_secret)?"variable":"manual",workspaceHostSource:r(e.workspace_host)?"variable":"manual",patSource:r(e.pat)?"variable":"manual",client_id:r(e.client_id)?"":n(e.client_id),client_secret:r(e.client_secret)?"":n(e.client_secret),workspace_host:r(e.workspace_host)?"":n(e.workspace_host),pat:r(e.pat)?"":n(e.pat),clientIdVariable:a(e.client_id),clientSecretVariable:a(e.client_secret),workspaceHostVariable:a(e.workspace_host),patVariable:a(e.pat),on_behalf_of_user:e.on_behalf_of_user||!1}},qc=(e,t)=>{if(t.on_behalf_of_user){e.on_behalf_of_user=!0;return}if(t.authMethod==="service_principal"&&t.servicePrincipalRef)e.service_principal=`*${t.servicePrincipalRef}`;else if(t.authMethod==="oauth"){const n=yl(t.clientIdSource,t.client_id,t.clientIdVariable),r=yl(t.clientSecretSource,t.client_secret,t.clientSecretVariable),a=yl(t.workspaceHostSource,t.workspace_host,t.workspaceHostVariable);n&&(e.client_id=n),r&&(e.client_secret=r),a&&(e.workspace_host=a)}else if(t.authMethod==="pat"){const n=yl(t.patSource,t.pat,t.patVariable),r=yl(t.workspaceHostSource,t.workspace_host,t.workspaceHostVariable);n&&(e.pat=n),r&&(e.workspace_host=r)}},Zs=e=>{qn.getState().scrollToAsset(e)};function Bn(e,t){return typeof e=="string"&&e.startsWith(t)}function Ot(e){return typeof e=="string"?e:""}const Y2=[{id:"llms",label:"LLMs",icon:oo,description:"Language models"},{id:"genie_rooms",label:"Genie Rooms",icon:wr,description:"AI-powered data assistants"},{id:"warehouses",label:"SQL Warehouses",icon:on,description:"SQL compute resources"},{id:"tables",label:"Tables",icon:lm,description:"Unity Catalog tables"},{id:"volumes",label:"Volumes",icon:em,description:"Unity Catalog volumes"},{id:"functions",label:"Functions",icon:Jd,description:"Unity Catalog functions"},{id:"connections",label:"Connections",icon:sm,description:"External connections"},{id:"databases",label:"Databases",icon:io,description:"Lakebase/PostgreSQL backends"},{id:"vector_stores",label:"Vector Stores",icon:dr,description:"Vector search indexes"}],Xp=[{value:"databricks-claude-3-7-sonnet",label:"Claude 3.7 Sonnet"},{value:"databricks-claude-sonnet-4",label:"Claude Sonnet 4"},{value:"databricks-meta-llama-3-3-70b-instruct",label:"Llama 3.3 70B Instruct"},{value:"databricks-meta-llama-3-1-405b-instruct",label:"Llama 3.1 405B Instruct"},{value:"databricks-meta-llama-3-1-8b-instruct",label:"Llama 3.1 8B Instruct"},{value:"databricks-dbrx-instruct",label:"DBRX Instruct"},{value:"databricks-gte-large-en",label:"GTE Large (Embeddings)"}];function Je(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function Dt(e,t,n){if(!e)return!1;const r=t.resources||{},a=["llms","genie_rooms","tables","volumes","functions","warehouses","connections","databases","vector_stores"];for(const g of a){const b=r[g]||{};if(e in b&&e!==n)return!0}const l=t.service_principals||{};if(e in l&&e!==n)return!0;const o=t.agents||{};if(e in o&&e!==n)return!0;const c=t.tools||{};if(e in c&&e!==n)return!0;const i=t.guardrails||{};if(e in i&&e!==n)return!0;const u=t.retrievers||{};if(e in u&&e!==n)return!0;const m=t.schemas||{};if(e in m&&e!==n)return!0;const h=t.prompts||{};if(e in h&&e!==n)return!0;const f=t.variables||{};return e in f&&e!==n}function q2(){const{config:e}=We(),t=e.resources,[n,r]=M.useState("llms"),[a,l]=M.useState(!1),[o,c]=M.useState(null),i=()=>{l(!1),c(null)},u=()=>{switch(n){case"llms":return s.jsx(Q2,{});case"genie_rooms":return s.jsx(K2,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"warehouses":return s.jsx(Z2,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"tables":return s.jsx(J2,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"volumes":return s.jsx(eC,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"functions":return s.jsx(tC,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"connections":return s.jsx(nC,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"databases":return s.jsx(oC,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});case"vector_stores":return s.jsx(cC,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:c,onClose:i});default:return null}},m=h=>{switch(h){case"llms":return Object.keys((t==null?void 0:t.llms)||{}).length;case"genie_rooms":return Object.keys((t==null?void 0:t.genie_rooms)||{}).length;case"tables":return Object.keys((t==null?void 0:t.tables)||{}).length;case"volumes":return Object.keys((t==null?void 0:t.volumes)||{}).length;case"functions":return Object.keys((t==null?void 0:t.functions)||{}).length;case"warehouses":return Object.keys((t==null?void 0:t.warehouses)||{}).length;case"connections":return Object.keys((t==null?void 0:t.connections)||{}).length;case"databases":return Object.keys((t==null?void 0:t.databases)||{}).length;case"vector_stores":return Object.keys((t==null?void 0:t.vector_stores)||{}).length;default:return 0}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Resources"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure Databricks resources that can be referenced in tools, agents, and other parts of your configuration."})]}),s.jsx(ke,{className:"p-4 bg-blue-900/20 border-blue-500/30",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Ka,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-300",children:[s.jsx("p",{className:"font-medium",children:"Resource References"}),s.jsxs("p",{className:"mt-1 text-blue-400/80",children:["Resources defined here can be referenced by their ",s.jsx("strong",{children:"reference name"}),' (the key) in tools and other configuration sections. For example, a Genie room named "retail_genie" can be used in tools to create Genie-powered assistants.']})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-2 border-b border-slate-700 pb-4",children:Y2.map(h=>{const f=h.icon,g=m(h.id);return s.jsxs("button",{onClick:()=>{r(h.id),l(!1),c(null)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${n===h.id?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-300"}`,children:[s.jsx(f,{className:"w-4 h-4"}),s.jsx("span",{children:h.label}),g>0&&s.jsx(Ee,{variant:"default",className:"ml-1",children:g})]},h.id)})}),s.jsx("div",{children:u()})]})}function X2({index:e,fallback:t,isReference:n,refKey:r,hasConfiguredLLMs:a,llms:l,endpoints:o,editingKey:c,formDataName:i,onUpdate:u,onRemove:m,getEndpointStatus:h}){const[f,g]=M.useState(n?"reference":"endpoint"),b=Object.entries(l).filter(([d])=>d!==c&&d!==i).map(([d,p])=>({value:`ref:${d}`,label:`*${d}  ${p.name}`})),w=o.map(d=>({value:d.name,label:d.name,status:h(d.state)})),x=d=>{g(d),u("")};return s.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg border border-slate-700 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["Fallback #",e+1]}),s.jsx(Q,{variant:"ghost",size:"sm",type:"button",onClick:m,children:s.jsx(Qe,{className:"w-3 h-3 text-red-400"})})]}),a&&s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>x("reference"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>x("endpoint"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="endpoint"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Endpoint"})]}),f==="reference"&&a?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:t,onChange:d=>u(d.target.value),options:[{value:"",label:"Select a configured LLM..."},...b]}),n&&r&&l[r]&&s.jsxs("div",{className:"p-2 bg-slate-800/50 rounded text-xs",children:[s.jsx("span",{className:"text-blue-400",children:"YAML output:"})," ",s.jsxs("code",{className:"text-slate-300",children:["*",r]}),s.jsxs("span",{className:"text-slate-500 ml-2",children:[" ",l[r].name]})]})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsx(Po,{value:Bn(t,"ref:")?"":Ot(t),onChange:u,options:[{value:"",label:"Select an endpoint..."},...w],placeholder:"Select an endpoint..."}),t&&!Bn(t,"ref:")&&s.jsxs("div",{className:"p-2 bg-slate-800/50 rounded text-xs",children:[s.jsx("span",{className:"text-green-400",children:"YAML output:"})," ",s.jsx("code",{className:"text-slate-300",children:t})]})]})]})}function Q2(){var $;const{config:e,addLLM:t,removeLLM:n,updateLLM:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState("preset"),[m,h]=M.useState(!1),[f,g]=M.useState({name:"",modelName:"",customModelName:"",temperature:"0.1",maxTokens:"8192",onBehalfOfUser:!1,fallbacks:[],authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),{data:b,loading:w,refetch:x}=$2(),d=(($=e.resources)==null?void 0:$.llms)||{},p=()=>{g({name:"",modelName:"",customModelName:"",temperature:"0.1",maxTokens:"8192",onBehalfOfUser:!1,fallbacks:[],authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),u("preset"),h(!1),c(null)},v=(k,A)=>{Zs(k),c(k);const D=(A.fallbacks||[]).map(P=>{const L=typeof P=="string"?P:P.name;return Object.keys(d).includes(L)&&L!==k?`ref:${L}`:L}),S=Yc(A,Bn,Ot);g({name:k,modelName:A.name,customModelName:A.name,temperature:String(A.temperature??.1),maxTokens:String(A.max_tokens??8192),onBehalfOfUser:A.on_behalf_of_user??!1,fallbacks:D,...S}),Xp.some(P=>P.value===A.name)?u("preset"):b!=null&&b.some(P=>P.name===A.name)?u("endpoint"):u("custom");const T=S.authMethod!=="default";h(!!(A.on_behalf_of_user||A.fallbacks&&A.fallbacks.length>0||T)),l(!0)},N=k=>{k.preventDefault();let A="";switch(i){case"preset":A=f.modelName;break;case"endpoint":A=f.modelName;break;case"custom":A=f.customModelName;break}if(f.name&&A){const D={name:A,temperature:parseFloat(f.temperature),max_tokens:parseInt(f.maxTokens)};f.onBehalfOfUser&&(D.on_behalf_of_user=!0),f.fallbacks.length>0&&(D.fallbacks=f.fallbacks),qc(D,f),o?o!==f.name?(n(o),t(f.name,D)):r(o,D):t(f.name,D),p(),l(!1)}},C=()=>{g({...f,fallbacks:[...f.fallbacks,""]})},j=(k,A)=>{const D=[...f.fallbacks];D[k]=A,g({...f,fallbacks:D})},E=k=>{g({...f,fallbacks:f.fallbacks.filter((A,D)=>D!==k)})},y=k=>{var D;switch((D=k==null?void 0:k.ready)==null?void 0:D.toUpperCase()){case"READY":return"ready";case"NOT_READY":return"transitioning";default:return"unknown"}},R=[{value:"",label:w?"Loading endpoints...":"Select an endpoint..."},...(b||[]).map(k=>({value:k.name,label:k.name,status:y(k.state)}))];return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(oo,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Language Models"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add LLM"]})]}),Object.keys(d).length>0?s.jsx("div",{className:"space-y-2",children:Object.entries(d).map(([k,A])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700 cursor-pointer hover:bg-slate-800/70 transition-colors",onClick:()=>v(k,A),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(oo,{className:"w-4 h-4 text-purple-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:k}),s.jsx("p",{className:"text-xs text-slate-500",children:A.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[A.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),A.fallbacks&&A.fallbacks.length>0&&s.jsxs(Ee,{variant:"warning",title:`${A.fallbacks.length} fallback(s)`,children:[s.jsx(dr,{className:"w-3 h-3 mr-1"}),A.fallbacks.length]}),s.jsxs(Ee,{variant:"info",children:["temp: ",A.temperature??.1]}),s.jsxs(Ee,{variant:"default",children:["tokens: ",A.max_tokens??8192]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:D=>{D.stopPropagation(),tn("LLM",k,()=>n(k))},children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},k))}):s.jsx("p",{className:"text-slate-500 text-sm",children:"No LLMs configured. Add language models that will power your AI agents."}),s.jsx(An,{isOpen:a,onClose:()=>{l(!1),p()},title:o?"Edit Language Model":"Add Language Model",description:"Configure an LLM for your agents to use",children:s.jsxs("form",{onSubmit:N,className:"space-y-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., Default LLM",value:f.name,onChange:k=>g({...f,name:Lt(k.target.value)}),hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Model Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>u("preset"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i==="preset"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Preset"}),s.jsx("button",{type:"button",onClick:()=>u("endpoint"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i==="endpoint"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Endpoint"}),s.jsx("button",{type:"button",onClick:()=>u("custom"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i==="custom"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Custom"})]})]}),i==="preset"&&s.jsx(le,{label:"Model",options:[{value:"",label:"Select a model..."},...Xp],value:f.modelName,onChange:k=>g({...f,modelName:k.target.value,name:f.name||Je(k.target.value)}),required:!0}),i==="endpoint"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Serving Endpoint"}),s.jsxs("button",{type:"button",onClick:()=>x(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:w,children:[s.jsx(Ut,{className:`w-3 h-3 ${w?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(Po,{options:R,value:f.modelName,onChange:k=>g({...f,modelName:k,name:f.name||Je(k)}),disabled:w,placeholder:"Select an endpoint..."}),w&&s.jsx("p",{className:"text-xs text-slate-500",children:"Loading endpoints from Databricks..."})]}),i==="custom"&&s.jsx(re,{label:"Custom Model Name",placeholder:"e.g., my-custom-endpoint",value:f.customModelName,onChange:k=>g({...f,customModelName:k.target.value}),hint:"Enter the name of your custom model endpoint",required:!0}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Temperature",type:"number",step:"0.1",min:"0",max:"2",value:f.temperature,onChange:k=>g({...f,temperature:k.target.value}),hint:"0.0 = deterministic, 2.0 = creative"}),s.jsx(re,{label:"Max Tokens",type:"number",min:"1",max:"128000",value:f.maxTokens,onChange:k=>g({...f,maxTokens:k.target.value}),hint:"Maximum response length"})]}),s.jsxs("button",{type:"button",onClick:()=>h(!m),className:"flex items-center space-x-2 text-sm text-slate-400 hover:text-white transition-colors",children:[m?s.jsx(Ur,{className:"w-4 h-4"}):s.jsx(rs,{className:"w-4 h-4"}),s.jsx("span",{children:"Advanced Options"}),(f.onBehalfOfUser||f.fallbacks.length>0||f.authMethod!=="default")&&s.jsxs(Ee,{variant:"info",className:"ml-2",children:[(f.onBehalfOfUser?1:0)+(f.fallbacks.length>0?1:0)+(f.authMethod!=="default"?1:0)," configured"]})]}),m&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx(Gc,{formData:f,setFormData:k=>g({...f,...k}),servicePrincipals:e.service_principals||{},variables:e.variables||{},variableNames:Object.keys(e.variables||{})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Fallback Models"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Alternative models to try if the primary model fails."})]}),s.jsxs(Q,{variant:"secondary",size:"sm",type:"button",onClick:C,children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Fallback"]})]}),f.fallbacks.length>0?s.jsx("div",{className:"space-y-3",children:f.fallbacks.map((k,A)=>{const D=Ot(k),S=Bn(D,"ref:"),T=S?D.slice(4):null,P=Object.keys(d).filter(L=>L!==o&&L!==f.name).length>0;return s.jsx(X2,{index:A,fallback:k,isReference:S,refKey:T,hasConfiguredLLMs:P,llms:d,endpoints:b||[],editingKey:o,formDataName:f.name,onUpdate:L=>j(A,L),onRemove:()=>E(A),getEndpointStatus:y},A)})}):s.jsx("p",{className:"text-xs text-slate-500 italic",children:"No fallbacks configured."})]})]}),f.name&&Dt(f.name,e,o)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',f.name,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{l(!1),p()},children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:Dt(f.name,e,o),children:o?"Save Changes":"Add LLM"})]})]})})]})}function K2({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var j;const{config:l,addGenieRoom:o,updateGenieRoom:c,removeGenieRoom:i}=We(),u=((j=l.resources)==null?void 0:j.genie_rooms)||{},m=l.variables||{},{data:h,loading:f,refetch:g}=Rb(),[b,w]=M.useState("select"),[x,d]=M.useState({refName:"",name:"",description:"",space_id:"",space_id_variable:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),p=E=>{Zs(E);const y=u[E],R=Ot(y.space_id),$=Bn(R,"*"),k=h==null?void 0:h.some(D=>D.space_id===R),A=Yc(y,Bn,Ot);w($?"variable":k?"select":"manual"),d({refName:E,name:y.name,description:y.description||"",space_id:$?"":R,space_id_variable:$?R.substring(1):"",...A}),r(E),t(!0)},v=()=>{let E=x.space_id;b==="variable"&&x.space_id_variable&&(E=`*${x.space_id_variable}`);const y={name:x.name,description:x.description||void 0,space_id:E,on_behalf_of_user:x.on_behalf_of_user};qc(y,x),n?n!==x.refName?(i(n),o(x.refName,y)):c(x.refName,y):o(x.refName,y),w("select"),d({refName:"",name:"",description:"",space_id:"",space_id_variable:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),a()},N=E=>{tn("Genie Room",E,()=>i(E))},C=[{value:"",label:f?"Loading Genie spaces...":"Select a Genie space..."},...(h||[]).map(E=>({value:E.space_id,label:`${E.title}${E.description?` - ${E.description.substring(0,50)}${E.description.length>50?"...":""}`:""}`}))];return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(wr,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Genie Rooms"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{w("select"),d({refName:"",name:"",description:"",space_id:"",space_id_variable:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Genie Room"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([E,y])=>{var R;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(wr,{className:"w-4 h-4 text-purple-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:E}),s.jsxs("p",{className:"text-xs text-slate-500",children:[y.name,"  Space ID: ",(R=y.space_id)==null?void 0:R.substring(0,12),"..."]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[y.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>p(E),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>N(E),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},E)})}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No Genie rooms configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Genie Room"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:E=>d({...x,refName:Lt(E.target.value)}),placeholder:"Retail Genie",hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Genie Space"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>{w("select"),d({...x,space_id:"",space_id_variable:"",name:"",description:""})},className:`px-2 py-1 text-xs rounded ${b==="select"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"}),s.jsx("button",{type:"button",onClick:()=>{w("manual"),d({...x,space_id:"",space_id_variable:"",name:"",description:""})},className:`px-2 py-1 text-xs rounded ${b==="manual"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Manual"}),s.jsxs("button",{type:"button",onClick:()=>{w("variable"),d({...x,space_id:"",space_id_variable:"",name:"",description:""})},className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${b==="variable"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(Un,{className:"w-3 h-3"}),s.jsx("span",{children:"Variable"})]})]})]}),b==="select"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(le,{value:x.space_id,onChange:E=>{const y=E.target.value,R=h==null?void 0:h.find(A=>A.space_id===y),$=(R==null?void 0:R.title)||"",k=(R==null?void 0:R.description)||"";d({...x,space_id:y,space_id_variable:"",refName:n?x.refName:Je($),name:$,description:k})},options:C})}),s.jsx("button",{type:"button",onClick:()=>g(),className:"p-2 text-slate-400 hover:text-white",disabled:f,children:s.jsx(Ut,{className:`w-4 h-4 ${f?"animate-spin":""}`})})]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select from ",(h==null?void 0:h.length)||0," available Genie spaces. Display Name and Description will auto-fill."]})]}),b==="manual"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(re,{value:x.space_id,onChange:E=>{const y=E.target.value;d({...x,space_id:y,space_id_variable:"",refName:n?x.refName:Je(y)})},placeholder:"01f0d05d42ed11eeae85802c1d5bcccd"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Enter the Genie space ID directly. You can find this in the Genie room URL."})]}),b==="variable"&&s.jsxs("div",{className:"space-y-2",children:[Object.keys(m).length>0?s.jsx(le,{value:x.space_id_variable,onChange:E=>{const y=E.target.value;d({...x,space_id_variable:y,space_id:"",refName:n?x.refName:Je(y||"genie")})},options:[{value:"",label:"Select a variable..."},...Object.keys(m).map(E=>({value:E,label:E}))]}):s.jsx(re,{value:x.space_id_variable,onChange:E=>{const y=E.target.value;d({...x,space_id_variable:y,space_id:"",refName:n?x.refName:Je(y||"genie")})},placeholder:"genie_space_id"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Reference a variable containing the Genie space ID. The value will be resolved at runtime."})]})]}),s.jsx(re,{label:"Display Name",value:x.name,onChange:E=>d({...x,name:E.target.value}),placeholder:"Retail Analytics Genie",required:!0}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Description"}),s.jsx("textarea",{value:x.description,onChange:E=>d({...x,description:E.target.value}),placeholder:"Query retail data using natural language",rows:3,className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),s.jsx(Gc,{formData:x,setFormData:E=>d({...x,...E}),servicePrincipals:l.service_principals||{},variables:l.variables||{},variableNames:Object.keys(l.variables||{})}),x.refName&&Dt(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:v,disabled:!x.refName||!x.name||b==="select"&&!x.space_id||b==="manual"&&!x.space_id||b==="variable"&&!x.space_id_variable||Dt(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function Z2({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var E;const{config:l,addWarehouse:o,updateWarehouse:c,removeWarehouse:i}=We(),u=((E=l.resources)==null?void 0:E.warehouses)||{},m=l.variables||{},{data:h,loading:f,refetch:g}=F2(),[b,w]=M.useState("select"),[x,d]=M.useState({refName:"",name:"",description:"",warehouse_id:"",warehouse_id_variable:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),p=y=>{Zs(y);const R=u[y],$=Ot(R.warehouse_id),k=Bn($,"__REF__"),A=k?$.substring(7):"",D=k?"":$;let S="manual";k?S="variable":h!=null&&h.some(P=>P.id===$)&&(S="select");const T=Yc(R,Bn,Ot);w(S),d({refName:y,name:R.name,description:R.description||"",warehouse_id:D,warehouse_id_variable:A,...T}),r(y),t(!0)},v=()=>{let y=x.warehouse_id;b==="variable"&&x.warehouse_id_variable&&(y=`__REF__${x.warehouse_id_variable}`);const R={name:x.name,description:x.description||void 0,warehouse_id:y,on_behalf_of_user:x.on_behalf_of_user};qc(R,x),n?n!==x.refName?(i(n),o(x.refName,R)):c(x.refName,R):o(x.refName,R),d({refName:"",name:"",description:"",warehouse_id:"",warehouse_id_variable:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),w("select"),a()},N=y=>{tn("Warehouse",y,()=>i(y))},C=y=>{switch(y==null?void 0:y.toUpperCase()){case"RUNNING":return"ready";case"STARTING":case"STOPPING":case"RESTARTING":return"transitioning";case"STOPPED":case"DELETED":case"DELETING":return"stopped";default:return"unknown"}},j=[{value:"",label:f?"Loading...":"Select a SQL warehouse..."},...(h||[]).map(y=>({value:y.id,label:y.name,status:C(y.state)}))];return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(on,{className:"w-5 h-5 text-emerald-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"SQL Warehouses"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{d({refName:"",name:"",description:"",warehouse_id:"",warehouse_id_variable:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),w("select"),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Warehouse"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([y,R])=>{const $=Ot(R.warehouse_id),k=Bn($,"__REF__"),A=k?`$${$.substring(7)}`:`${$==null?void 0:$.substring(0,12)}...`;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(on,{className:"w-4 h-4 text-emerald-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:y}),s.jsxs("p",{className:"text-xs text-slate-500",children:[R.name,"  ",k?"Var: ":"ID: ",A]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[R.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>p(y),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>N(y),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},y)})}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No SQL warehouses configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," SQL Warehouse"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:y=>d({...x,refName:Lt(y.target.value)}),placeholder:"Main Warehouse",hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Warehouse ID"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>{w("select"),d({...x,warehouse_id_variable:""})},className:`px-2 py-1 text-xs rounded ${b==="select"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"}),s.jsx("button",{type:"button",onClick:()=>{w("manual"),d({...x,warehouse_id_variable:""})},className:`px-2 py-1 text-xs rounded ${b==="manual"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Manual"}),s.jsxs("button",{type:"button",onClick:()=>{w("variable"),d({...x,warehouse_id:""})},className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${b==="variable"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(Un,{className:"w-3 h-3"}),s.jsx("span",{children:"Variable"})]})]})]}),b==="select"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Po,{value:x.warehouse_id,onChange:y=>{const R=h==null?void 0:h.find(k=>k.id===y),$=(R==null?void 0:R.name)||"";d({...x,warehouse_id:y,warehouse_id_variable:"",refName:n?x.refName:Je($),name:$||x.name||""})},options:j,placeholder:"Select a SQL warehouse..."})}),s.jsx("button",{type:"button",onClick:()=>g(),className:"p-2 text-slate-400 hover:text-white",disabled:f,children:s.jsx(Ut,{className:`w-4 h-4 ${f?"animate-spin":""}`})})]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select from ",(h==null?void 0:h.length)||0," available SQL warehouses. Display Name will auto-fill."]})]}),b==="manual"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(re,{value:x.warehouse_id,onChange:y=>{const R=y.target.value;d({...x,warehouse_id:R,warehouse_id_variable:"",refName:n?x.refName:Je(R)})},placeholder:"abc123def456"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Enter the warehouse ID directly. You can find this in the SQL warehouse settings."})]}),b==="variable"&&s.jsxs("div",{className:"space-y-2",children:[Object.keys(m).length>0?s.jsx(le,{value:x.warehouse_id_variable,onChange:y=>{const R=y.target.value;d({...x,warehouse_id_variable:R,warehouse_id:"",refName:n?x.refName:Je(R||"warehouse")})},options:[{value:"",label:"Select a variable..."},...Object.keys(m).map(y=>({value:y,label:y}))]}):s.jsx(re,{value:x.warehouse_id_variable,onChange:y=>{const R=y.target.value;d({...x,warehouse_id_variable:R,warehouse_id:"",refName:n?x.refName:Je(R||"warehouse")})},placeholder:"warehouse_id"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Reference a variable containing the warehouse ID. The value will be resolved at runtime."})]})]}),s.jsx(re,{label:"Display Name",value:x.name,onChange:y=>d({...x,name:y.target.value}),placeholder:"Main Analytics Warehouse",required:!0}),s.jsx(re,{label:"Description",value:x.description,onChange:y=>d({...x,description:y.target.value}),placeholder:"Primary warehouse for analytics queries"}),s.jsx(Gc,{formData:x,setFormData:y=>d({...x,...y}),servicePrincipals:l.service_principals||{},variables:l.variables||{},variableNames:Object.keys(l.variables||{})}),x.refName&&Dt(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:v,disabled:!x.refName||!x.name||b==="select"&&!x.warehouse_id||b==="manual"&&!x.warehouse_id||b==="variable"&&!x.warehouse_id_variable||Dt(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function J2({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var k,A,D;const{config:l,addTable:o,updateTable:c,removeTable:i}=We(),u=((k=l.resources)==null?void 0:k.tables)||{},m=l.schemas||{},{data:h}=Tr(),[f,g]=M.useState("reference"),[b,w]=M.useState({schemaRef:"",catalog_name:"",schema_name:"",source:"reference"}),[x,d]=M.useState({refName:"",schemaRef:"",catalog_name:"",schema_name:"",name:"",on_behalf_of_user:!1}),{data:p,loading:v}=as(x.catalog_name||null),{data:N,loading:C}=vm(f==="reference"&&x.schemaRef?(A=m[x.schemaRef])==null?void 0:A.catalog_name:x.catalog_name||null,f==="reference"&&x.schemaRef?(D=m[x.schemaRef])==null?void 0:D.schema_name:x.schema_name||null),j=S=>{var I,O,F;Zs(S);const T=u[S],L=T.schema&&Object.entries(m).some(([,U])=>{var B,Z;return U.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&U.schema_name===((Z=T.schema)==null?void 0:Z.schema_name)})?(I=Object.entries(m).find(([,U])=>{var B,Z;return U.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&U.schema_name===((Z=T.schema)==null?void 0:Z.schema_name)}))==null?void 0:I[0]:"";g(L?"reference":"direct"),d({refName:S,schemaRef:L||"",catalog_name:((O=T.schema)==null?void 0:O.catalog_name)||"",schema_name:((F=T.schema)==null?void 0:F.schema_name)||"",name:T.name||"",on_behalf_of_user:T.on_behalf_of_user||!1}),r(S),t(!0)},E=()=>{const S={name:x.name||void 0,on_behalf_of_user:x.on_behalf_of_user};if(f==="reference"&&x.schemaRef){const T=m[x.schemaRef];T&&(S.schema={catalog_name:T.catalog_name,schema_name:T.schema_name})}else x.catalog_name&&x.schema_name&&(S.schema={catalog_name:x.catalog_name,schema_name:x.schema_name});n?n!==x.refName?(i(n),o(x.refName,S)):c(x.refName,S):o(x.refName,S),w({schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,source:f}),d({refName:"",schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,name:"",on_behalf_of_user:!1}),a()},y=S=>{i(S)},R=Object.keys(m).length>0,$=f==="reference"?!!x.schemaRef:!!x.catalog_name&&!!x.schema_name;return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(lm,{className:"w-5 h-5 text-cyan-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Tables"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{d({refName:"",schemaRef:b.schemaRef,catalog_name:b.catalog_name,schema_name:b.schema_name,name:"",on_behalf_of_user:!1}),g(b.source),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Table"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([S,T])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(lm,{className:"w-4 h-4 text-cyan-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:S}),s.jsx("p",{className:"text-xs text-slate-500",children:T.schema?`${T.schema.catalog_name}.${T.schema.schema_name}${T.name?`.${T.name}`:".*"}`:T.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[T.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>j(S),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>y(S),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},S))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No tables configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Table"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:S=>d({...x,refName:Lt(S.target.value)}),placeholder:"Sales Data",hint:"Type naturally - spaces become underscores",required:!0}),R&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{g("reference"),d({...x,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{g("direct"),d({...x,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),f==="reference"&&R?s.jsx(le,{label:"Schema Reference",value:x.schemaRef,onChange:S=>{const T=S.target.value,P=m[T],L=P?Je(`${P.catalog_name}_${P.schema_name}_tables`):"";d({...x,schemaRef:T,name:"",refName:x.refName||L})},options:[{value:"",label:"Select a configured schema..."},...Object.entries(m).map(([S,T])=>({value:S,label:`${S} (${T.catalog_name}.${T.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:x.catalog_name,onChange:S=>d({...x,catalog_name:S.target.value,schema_name:"",name:""}),options:[{value:"",label:"Select catalog..."},...(h||[]).map(S=>({value:S.name,label:S.name}))]}),s.jsx(le,{label:"Schema",value:x.schema_name,onChange:S=>{const T=S.target.value,P=T?Je(`${x.catalog_name}_${T}_tables`):"";d({...x,schema_name:T,name:"",refName:x.refName||P})},options:[{value:"",label:v?"Loading schemas...":"Select schema..."},...(p||[]).map(S=>({value:S.name,label:S.name}))],disabled:!x.catalog_name||v})]}),f==="reference"&&x.schemaRef&&m[x.schemaRef]&&s.jsxs("div",{className:"p-2 bg-slate-900/50 rounded text-xs text-slate-400",children:["Using schema: ",s.jsxs("span",{className:"text-slate-300",children:[m[x.schemaRef].catalog_name,".",m[x.schemaRef].schema_name]})]}),s.jsx(le,{label:"Table",value:x.name,onChange:S=>{const T=S.target.value;d(P=>{let L="";if(T)L=Je(T);else if(f==="reference"&&P.schemaRef){const O=m[P.schemaRef];O&&(L=Je(`${O.catalog_name}_${O.schema_name}_tables`))}else P.catalog_name&&P.schema_name&&(L=Je(`${P.catalog_name}_${P.schema_name}_tables`));const I=n&&P.refName;return{...P,name:T,refName:I?P.refName:L}})},options:[{value:"",label:C?"Loading tables...":"All tables (*)"},...(N||[]).map(S=>({value:S.name,label:S.name}))],disabled:!$||C,hint:"Leave empty for all tables in schema"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:S=>d({...x,on_behalf_of_user:S.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Cr,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),x.refName&&Dt(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:E,disabled:!x.refName||!$||Dt(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function eC({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var k,A,D;const{config:l,addVolume:o,updateVolume:c,removeVolume:i}=We(),u=((k=l.resources)==null?void 0:k.volumes)||{},m=l.schemas||{},{data:h}=Tr(),[f,g]=M.useState("reference"),[b,w]=M.useState({schemaRef:"",catalog_name:"",schema_name:"",source:"reference"}),[x,d]=M.useState({refName:"",schemaRef:"",catalog_name:"",schema_name:"",name:"",on_behalf_of_user:!1}),{data:p,loading:v}=as(x.catalog_name||null),{data:N,loading:C}=bm(f==="reference"&&x.schemaRef?(A=m[x.schemaRef])==null?void 0:A.catalog_name:x.catalog_name||null,f==="reference"&&x.schemaRef?(D=m[x.schemaRef])==null?void 0:D.schema_name:x.schema_name||null),j=S=>{var I,O,F;Zs(S);const T=u[S],L=T.schema&&Object.entries(m).some(([,U])=>{var B,Z;return U.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&U.schema_name===((Z=T.schema)==null?void 0:Z.schema_name)})?(I=Object.entries(m).find(([,U])=>{var B,Z;return U.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&U.schema_name===((Z=T.schema)==null?void 0:Z.schema_name)}))==null?void 0:I[0]:"";g(L?"reference":"direct"),d({refName:S,schemaRef:L||"",catalog_name:((O=T.schema)==null?void 0:O.catalog_name)||"",schema_name:((F=T.schema)==null?void 0:F.schema_name)||"",name:T.name||"",on_behalf_of_user:T.on_behalf_of_user||!1}),r(S),t(!0)},E=()=>{const S={name:x.name,on_behalf_of_user:x.on_behalf_of_user};if(f==="reference"&&x.schemaRef){const T=m[x.schemaRef];T&&(S.schema={catalog_name:T.catalog_name,schema_name:T.schema_name})}else x.catalog_name&&x.schema_name&&(S.schema={catalog_name:x.catalog_name,schema_name:x.schema_name});n?n!==x.refName?(i(n),o(x.refName,S)):c(x.refName,S):o(x.refName,S),w({schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,source:f}),d({refName:"",schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,name:"",on_behalf_of_user:!1}),a()},y=S=>{i(S)},R=Object.keys(m).length>0,$=f==="reference"?!!x.schemaRef:!!x.catalog_name&&!!x.schema_name;return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(em,{className:"w-5 h-5 text-amber-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Volumes"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{d({refName:"",schemaRef:b.schemaRef,catalog_name:b.catalog_name,schema_name:b.schema_name,name:"",on_behalf_of_user:!1}),g(b.source),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Volume"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([S,T])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(em,{className:"w-4 h-4 text-amber-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:S}),s.jsx("p",{className:"text-xs text-slate-500",children:T.schema?`${T.schema.catalog_name}.${T.schema.schema_name}.${T.name}`:T.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[T.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>j(S),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>y(S),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},S))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No volumes configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Volume"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:S=>d({...x,refName:Lt(S.target.value)}),placeholder:"Data Volume",hint:"Type naturally - spaces become underscores",required:!0}),R&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{g("reference"),d({...x,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{g("direct"),d({...x,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),f==="reference"&&R?s.jsx(le,{label:"Schema Reference",value:x.schemaRef,onChange:S=>{const T=S.target.value;d({...x,schemaRef:T,name:""})},options:[{value:"",label:"Select a configured schema..."},...Object.entries(m).map(([S,T])=>({value:S,label:`${S} (${T.catalog_name}.${T.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:x.catalog_name,onChange:S=>d({...x,catalog_name:S.target.value,schema_name:"",name:""}),options:[{value:"",label:"Select catalog..."},...(h||[]).map(S=>({value:S.name,label:S.name}))]}),s.jsx(le,{label:"Schema",value:x.schema_name,onChange:S=>d({...x,schema_name:S.target.value,name:""}),options:[{value:"",label:v?"Loading schemas...":"Select schema..."},...(p||[]).map(S=>({value:S.name,label:S.name}))],disabled:!x.catalog_name||v})]}),f==="reference"&&x.schemaRef&&m[x.schemaRef]&&s.jsxs("div",{className:"p-2 bg-slate-900/50 rounded text-xs text-slate-400",children:["Using schema: ",s.jsxs("span",{className:"text-slate-300",children:[m[x.schemaRef].catalog_name,".",m[x.schemaRef].schema_name]})]}),s.jsx(le,{label:"Volume",value:x.name,onChange:S=>{const T=S.target.value;d({...x,name:T,refName:x.refName||Je(T)})},options:[{value:"",label:C?"Loading volumes...":"Select volume..."},...(N||[]).map(S=>({value:S.name,label:S.name}))],disabled:!$||C}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:S=>d({...x,on_behalf_of_user:S.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Cr,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),x.refName&&Dt(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:E,disabled:!x.refName||!x.name||!$||Dt(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function tC({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var I;const{config:l,addFunction:o,updateFunction:c,removeFunction:i}=We(),u=((I=l.resources)==null?void 0:I.functions)||{},m=l.schemas||{},{data:h}=Tr(),[f,g]=M.useState("reference"),[b,w]=M.useState({schemaRef:"",catalog_name:"",schema_name:"",source:"reference"}),[x,d]=M.useState({refName:"",schemaRef:"",catalog_name:"",schema_name:"",name:"",on_behalf_of_user:!1}),p=()=>f==="reference"&&x.schemaRef&&m[x.schemaRef]?m[x.schemaRef].catalog_name:x.catalog_name,v=()=>f==="reference"&&x.schemaRef&&m[x.schemaRef]?m[x.schemaRef].schema_name:x.schema_name,N=p(),C=v(),{data:j,loading:E}=as(N||null),{data:y,loading:R,refetch:$}=Ab(N||null,C||null);M.useEffect(()=>{n&&e&&(console.log("[FunctionsPanel] Editing function:",n),console.log("[FunctionsPanel] schemaSource:",f),console.log("[FunctionsPanel] formData:",x),console.log("[FunctionsPanel] currentCatalog:",N),console.log("[FunctionsPanel] currentSchema:",C),console.log("[FunctionsPanel] functionsList:",y),N&&C&&!y&&!R&&(console.log("[FunctionsPanel] Triggering refetch..."),$()))},[n,e,f,x,N,C,y,R,$]);const k=Object.values(u).filter(O=>{var F,U;return((F=O.schema)==null?void 0:F.catalog_name)===N&&((U=O.schema)==null?void 0:U.schema_name)===C}).map(O=>O.name).filter(Boolean),A=(y||[]).filter(O=>{var F;return n?!k.includes(O.name)||O.name===((F=u[n])==null?void 0:F.name):!k.includes(O.name)}),D=O=>{var oe,Y,q;Zs(O);const F=u[O],U=((oe=F.schema)==null?void 0:oe.catalog_name)||"",B=((Y=F.schema)==null?void 0:Y.schema_name)||"",ee=F.schema&&Object.entries(m).some(([,se])=>se.catalog_name===U&&se.schema_name===B)?(q=Object.entries(m).find(([,se])=>se.catalog_name===U&&se.schema_name===B))==null?void 0:q[0]:"";g(ee?"reference":"direct"),d({refName:O,schemaRef:ee||"",catalog_name:U,schema_name:B,name:F.name||"",on_behalf_of_user:F.on_behalf_of_user||!1}),r(O),t(!0)},S=()=>{const O={name:x.name||void 0,on_behalf_of_user:x.on_behalf_of_user};if(f==="reference"&&x.schemaRef){const F=m[x.schemaRef];F&&(O.schema={catalog_name:F.catalog_name,schema_name:F.schema_name})}else x.catalog_name&&x.schema_name&&(O.schema={catalog_name:x.catalog_name,schema_name:x.schema_name});n?n!==x.refName?(i(n),o(x.refName,O)):c(x.refName,O):o(x.refName,O),w({schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,source:f}),d({refName:"",schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,name:"",on_behalf_of_user:!1}),a()},T=O=>{tn("Function",O,()=>i(O))},P=Object.keys(m).length>0,L=f==="reference"?!!x.schemaRef:!!x.catalog_name&&!!x.schema_name;return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Jd,{className:"w-5 h-5 text-pink-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Functions"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{d({refName:"",schemaRef:b.schemaRef,catalog_name:b.catalog_name,schema_name:b.schema_name,name:"",on_behalf_of_user:!1}),g(b.source),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Function"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([O,F])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Jd,{className:"w-4 h-4 text-pink-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:O}),s.jsx("p",{className:"text-xs text-slate-500",children:F.schema?`${F.schema.catalog_name}.${F.schema.schema_name}${F.name?`.${F.name}`:".*"}`:F.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[F.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>D(O),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>T(O),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},O))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No functions configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Function"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:O=>d({...x,refName:Lt(O.target.value)}),placeholder:"UC Functions",hint:"Type naturally - spaces become underscores",required:!0}),P&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{g("reference"),d({...x,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{g("direct"),d({...x,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),f==="reference"&&P?s.jsx(le,{label:"Schema Reference",value:x.schemaRef,onChange:O=>{const F=O.target.value,U=F?m[F]:null,B=U?Je(`${U.catalog_name}_${U.schema_name}_functions`):"";d({...x,schemaRef:F,name:"",refName:x.refName||B})},options:[{value:"",label:"Select a configured schema..."},...Object.entries(m).map(([O,F])=>({value:O,label:`${O} (${F.catalog_name}.${F.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:x.catalog_name,onChange:O=>d({...x,catalog_name:O.target.value,schema_name:"",name:""}),options:[{value:"",label:"Select catalog..."},...(h||[]).map(O=>({value:O.name,label:O.name}))]}),s.jsx(le,{label:"Schema",value:x.schema_name,onChange:O=>{const F=O.target.value,U=F?Je(`${x.catalog_name}_${F}_functions`):"";d({...x,schema_name:F,name:"",refName:x.refName||U})},options:[{value:"",label:E?"Loading schemas...":"Select schema..."},...(j||[]).map(O=>({value:O.name,label:O.name}))],disabled:!x.catalog_name||E})]}),f==="reference"&&x.schemaRef&&m[x.schemaRef]&&s.jsxs("div",{className:"p-2 bg-slate-900/50 rounded text-xs text-slate-400",children:["Using schema: ",s.jsxs("span",{className:"text-slate-300",children:[m[x.schemaRef].catalog_name,".",m[x.schemaRef].schema_name]})]}),s.jsx(le,{label:"Function",value:x.name,onChange:O=>{const F=O.target.value;d(U=>{let B="";if(F)B=Je(F);else if(f==="reference"&&U.schemaRef){const ee=m[U.schemaRef];ee&&(B=Je(`${ee.catalog_name}_${ee.schema_name}_functions`))}else U.catalog_name&&U.schema_name&&(B=Je(`${U.catalog_name}_${U.schema_name}_functions`));const Z=n&&U.refName;return{...U,name:F,refName:Z?U.refName:B}})},options:[{value:"",label:R?"Loading functions...":"All functions (*)"},...A.map(O=>({value:O.name,label:O.name}))],disabled:!L||R,hint:"Leave empty for all functions in schema"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:O=>d({...x,on_behalf_of_user:O.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Cr,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),x.refName&&Dt(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:S,disabled:!x.refName||!L||Dt(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function nC({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var d;const{config:l,addConnection:o,updateConnection:c,removeConnection:i}=We(),u=((d=l.resources)==null?void 0:d.connections)||{},{data:m,loading:h}=Mb(),[f,g]=M.useState({refName:"",name:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),b=p=>{Zs(p);const v=u[p],N=Yc(v,Bn,Ot);g({refName:p,name:v.name,...N}),r(p),t(!0)},w=()=>{const p={name:f.name,on_behalf_of_user:f.on_behalf_of_user};qc(p,f),n?n!==f.refName?(i(n),o(f.refName,p)):c(f.refName,p):o(f.refName,p),g({refName:"",name:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),a()},x=p=>{tn("Connection",p,()=>i(p))};return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(sm,{className:"w-5 h-5 text-indigo-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Connections"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{g({refName:"",name:"",on_behalf_of_user:!1,authMethod:"default",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",patSource:"variable",client_id:"",client_secret:"",workspace_host:"",pat:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",patVariable:""}),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Connection"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([p,v])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(sm,{className:"w-4 h-4 text-indigo-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:p}),s.jsxs("p",{className:"text-xs text-slate-500",children:["UC Connection: ",v.name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[v.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>b(p),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>x(p),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},p))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No connections configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Connection"]}),s.jsx(re,{label:"Reference Name",value:f.refName,onChange:p=>g({...f,refName:Lt(p.target.value)}),placeholder:"External API",hint:"Type naturally - spaces become underscores",required:!0}),s.jsx(le,{label:"Unity Catalog Connection",value:f.name,onChange:p=>{g({...f,name:p.target.value,refName:f.refName||Je(p.target.value)})},options:[{value:"",label:h?"Loading connections...":"Select a connection..."},...(m||[]).map(p=>({value:p.name,label:`${p.name}${p.connection_type?` (${p.connection_type})`:""}`}))],hint:"Select from available Unity Catalog connections",required:!0}),s.jsx(Gc,{formData:f,setFormData:p=>g({...f,...p}),servicePrincipals:l.service_principals||{},variables:l.variables||{},variableNames:Object.keys(l.variables||{})}),f.refName&&Dt(f.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',f.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:w,disabled:!f.refName||!f.name||Dt(f.refName,l,n),children:n?"Update":"Add"})]})]})]})}const Hu={refName:"",name:"",instanceSource:"existing",instance_name:"",description:"",capacity:"CU_2",max_pool_size:10,timeout_seconds:10,authMethod:"service_principal",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",client_id:"",client_secret:"",workspace_host:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",userSource:"manual",passwordSource:"variable",user:"",password:"",userVariable:"",passwordVariable:"",on_behalf_of_user:!1},sC=[{value:"CU_1",label:"CU_1 (Small)"},{value:"CU_2",label:"CU_2 (Large)"}],rC=[{value:"service_principal",label:"Configured Service Principal"},{value:"oauth",label:"Manual OAuth2 Credentials"},{value:"user",label:"User/Password"}],aC=e=>`*${e}`,lC=e=>"env"in e?`env: ${e.env}`:"scope"in e&&"secret"in e?`secret: ${e.scope}/${e.secret}`:"value"in e?`value: ${String(e.value)}`:"options"in e?`composite (${e.options.length} options)`:"unknown";function Nl({label:e,source:t,onSourceChange:n,manualValue:r,onManualChange:a,variableValue:l,onVariableChange:o,placeholder:c,isPassword:i=!1,hint:u,variableNames:m,variables:h}){return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>n("variable"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 flex items-center gap-1 ${t==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>n("manual"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${t==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),t==="variable"?s.jsx(le,{value:l,onChange:f=>o(f.target.value),options:[{value:"",label:"Select a variable..."},...m.map(f=>({value:f,label:`${f} (${lC(h[f])})`}))],hint:m.length===0?"Define variables in the Variables section first":u}):s.jsx(re,{value:r,onChange:f=>a(f.target.value),placeholder:c,type:i?"password":"text",hint:u})]})}function oC({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var E;const{config:l,addDatabase:o,updateDatabase:c,removeDatabase:i}=We(),u=((E=l.resources)==null?void 0:E.databases)||{},m=l.variables||{},h=Object.keys(m),{data:f,loading:g,refetch:b}=D2(),w=y=>{switch(y==null?void 0:y.toUpperCase()){case"AVAILABLE":case"RUNNING":return"ready";case"CREATING":case"STARTING":case"STOPPING":case"PROVISIONING":case"UPDATING":return"transitioning";case"STOPPED":case"FAILED":case"DELETED":case"DELETING":return"stopped";default:return"unknown"}},x=[{value:"",label:g?"Loading...":"Select an instance..."},...(f||[]).map(y=>({value:y.name,label:y.name,status:w(y.state)}))],[d,p]=M.useState(Hu),v=y=>{Zs(y);const R=u[y];if(R){const $=A=>Bn(A,"*"),k=A=>{const D=Ot(A);return D.startsWith("*")?D.slice(1):""};p({refName:y,name:R.name,instanceSource:"existing",instance_name:R.instance_name||"",description:R.description||"",capacity:R.capacity||"CU_2",max_pool_size:R.max_pool_size||10,timeout_seconds:R.timeout_seconds||10,authMethod:R.service_principal?"service_principal":R.client_id?"oauth":"user",servicePrincipalRef:Bn(R.service_principal,"*")?Ot(R.service_principal).slice(1):"",clientIdSource:$(R.client_id)?"variable":"manual",clientSecretSource:$(R.client_secret)?"variable":"manual",workspaceHostSource:$(R.workspace_host)?"variable":"manual",client_id:$(R.client_id)?"":Ot(R.client_id),client_secret:$(R.client_secret)?"":Ot(R.client_secret),workspace_host:$(R.workspace_host)?"":Ot(R.workspace_host),clientIdVariable:k(R.client_id),clientSecretVariable:k(R.client_secret),workspaceHostVariable:k(R.workspace_host),userSource:$(R.user)?"variable":"manual",passwordSource:$(R.password)?"variable":"manual",user:$(R.user)?"":Ot(R.user),password:$(R.password)?"":Ot(R.password),userVariable:k(R.user),passwordVariable:k(R.password),on_behalf_of_user:R.on_behalf_of_user||!1}),r(y),t(!0)}},N=y=>{tn("Database",y,()=>i(y))},C=(y,R,$)=>y==="variable"&&$?aC($):R,j=()=>{const y={name:d.name,instance_name:d.instance_name||void 0,description:d.description||void 0,capacity:d.capacity,max_pool_size:d.max_pool_size,timeout_seconds:d.timeout_seconds,on_behalf_of_user:d.on_behalf_of_user||void 0};if(d.authMethod==="service_principal")d.servicePrincipalRef&&(y.service_principal=`*${d.servicePrincipalRef}`);else if(d.authMethod==="oauth"){const R=C(d.clientIdSource,d.client_id,d.clientIdVariable),$=C(d.clientSecretSource,d.client_secret,d.clientSecretVariable),k=C(d.workspaceHostSource,d.workspace_host,d.workspaceHostVariable);R&&(y.client_id=R),$&&(y.client_secret=$),k&&(y.workspace_host=k)}else{const R=C(d.userSource,d.user,d.userVariable),$=C(d.passwordSource,d.password,d.passwordVariable);R&&(y.user=R),$&&(y.password=$)}n?n!==d.refName?(i(n),o(d.refName,y)):c(n,y):o(d.refName,y),t(!1),r(null),p(Hu),a()};return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(io,{className:"w-5 h-5 text-emerald-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Databases (Lakebase/PostgreSQL)"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{p(Hu),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Database"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([y,R])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(io,{className:"w-4 h-4 text-emerald-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:y}),s.jsxs("p",{className:"text-xs text-slate-500",children:[R.instance_name||R.name||"Default instance","  ",R.capacity||"CU_2",R.client_id?"  OAuth":R.user?"  User auth":""]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[R.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>v(y),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>N(y),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},y))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No databases configured. Add a database for PostgreSQL/Lakebase memory storage."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Database"]}),s.jsx(re,{label:"Reference Name",value:d.refName,onChange:y=>p({...d,refName:Lt(y.target.value)}),placeholder:"Retail Database",hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium flex items-center",children:[s.jsx(ww,{className:"w-4 h-4 mr-2 text-emerald-400"}),"Lakebase Instance"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>p({...d,instanceSource:"existing"}),className:`px-2 py-1 text-xs rounded ${d.instanceSource==="existing"?"bg-emerald-500/30 text-emerald-300":"bg-slate-700 text-slate-400"}`,children:"Use Existing"}),s.jsx("button",{type:"button",onClick:()=>p({...d,instanceSource:"new"}),className:`px-2 py-1 text-xs rounded ${d.instanceSource==="new"?"bg-emerald-500/30 text-emerald-300":"bg-slate-700 text-slate-400"}`,children:"Create New"})]})]}),d.instanceSource==="existing"?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Select Lakebase Instance"}),s.jsx(Po,{value:d.instance_name,onChange:y=>{p({...d,instance_name:y,name:y||d.name,refName:n?d.refName:Je(y)})},options:x,placeholder:"Select an instance..."})]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>b(),disabled:g,className:"mt-6",children:g?s.jsx(xt,{className:"w-4 h-4 animate-spin"}):s.jsx(Ut,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Or enter instance name manually:"}),s.jsx(re,{value:d.instance_name,onChange:y=>p({...d,instance_name:y.target.value}),placeholder:"my-lakebase-instance"})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsx(re,{label:"New Instance Name",value:d.instance_name,onChange:y=>{const R=y.target.value;p({...d,instance_name:R,name:R||d.name,refName:n?d.refName:Je(R)})},placeholder:"my-new-lakebase",hint:"Name for the new Lakebase instance to create"}),s.jsx(le,{label:"Capacity",value:d.capacity,onChange:y=>p({...d,capacity:y.target.value}),options:sC,hint:"CU_1 = Small (dev/test), CU_2 = Large (production)"}),s.jsx("p",{className:"text-xs text-amber-400",children:"Note: Instance will be created when the agent is deployed with this configuration."})]})]}),s.jsx(re,{label:"Display Name",value:d.name,onChange:y=>p({...d,name:y.target.value}),placeholder:"Retail Database"}),s.jsx(re,{label:"Description",value:d.description,onChange:y=>p({...d,description:y.target.value}),placeholder:"Database for agent memory and checkpoints"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Max Pool Size",type:"number",value:d.max_pool_size,onChange:y=>p({...d,max_pool_size:parseInt(y.target.value)||10})}),s.jsx(re,{label:"Timeout (seconds)",type:"number",value:d.timeout_seconds,onChange:y=>p({...d,timeout_seconds:parseInt(y.target.value)||10})})]}),s.jsx(le,{label:"Authentication Method",value:d.authMethod,onChange:y=>p({...d,authMethod:y.target.value}),options:rC}),d.authMethod==="service_principal"?s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Select Configured Service Principal"}),s.jsx(le,{label:"Service Principal",value:d.servicePrincipalRef,onChange:y=>p({...d,servicePrincipalRef:y.target.value}),options:[{value:"",label:"Select a service principal..."},...Object.keys(l.service_principals||{}).map(y=>({value:y,label:y}))],hint:"Reference a pre-configured service principal"}),Object.keys(l.service_principals||{}).length===0&&s.jsx("div",{className:"p-2 bg-amber-500/10 border border-amber-500/30 rounded text-amber-400 text-xs",children:"No service principals configured. Add one in the Service Principals tab first."})]}):d.authMethod==="oauth"?s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"OAuth2 / Service Principal Credentials"}),s.jsx(Nl,{label:"Client ID",source:d.clientIdSource,onSourceChange:y=>p({...d,clientIdSource:y}),manualValue:d.client_id,onManualChange:y=>p({...d,client_id:y}),variableValue:d.clientIdVariable,onVariableChange:y=>p({...d,clientIdVariable:y}),placeholder:"your-service-principal-client-id",variableNames:h,variables:m}),s.jsx(Nl,{label:"Client Secret",source:d.clientSecretSource,onSourceChange:y=>p({...d,clientSecretSource:y}),manualValue:d.client_secret,onManualChange:y=>p({...d,client_secret:y}),variableValue:d.clientSecretVariable,onVariableChange:y=>p({...d,clientSecretVariable:y}),placeholder:"your-client-secret",isPassword:!0,variableNames:h,variables:m}),s.jsx(Nl,{label:"Workspace Host (Optional)",source:d.workspaceHostSource,onSourceChange:y=>p({...d,workspaceHostSource:y}),manualValue:d.workspace_host,onManualChange:y=>p({...d,workspace_host:y}),variableValue:d.workspaceHostVariable,onVariableChange:y=>p({...d,workspaceHostVariable:y}),placeholder:"https://your-workspace.cloud.databricks.com",hint:"Only required if connecting from outside the workspace",variableNames:h,variables:m})]}):s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"User/Password Credentials"}),s.jsx(Nl,{label:"Username",source:d.userSource,onSourceChange:y=>p({...d,userSource:y}),manualValue:d.user,onManualChange:y=>p({...d,user:y}),variableValue:d.userVariable,onVariableChange:y=>p({...d,userVariable:y}),placeholder:"postgres",variableNames:h,variables:m}),s.jsx(Nl,{label:"Password",source:d.passwordSource,onSourceChange:y=>p({...d,passwordSource:y}),manualValue:d.password,onManualChange:y=>p({...d,password:y}),variableValue:d.passwordVariable,onVariableChange:y=>p({...d,passwordVariable:y}),placeholder:"your-password",isPassword:!0,variableNames:h,variables:m})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:d.on_behalf_of_user,onChange:y=>p({...d,on_behalf_of_user:y.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Cr,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),d.refName&&Dt(d.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',d.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:j,disabled:!d.refName||!d.name||Dt(d.refName,l,n),children:n?"Update":"Add"})]})]})]})}const Uu={refName:"",endpoint_name:"",endpoint_type:"STANDARD",indexSchemaSource:"direct",indexSchemaRefName:"",index_catalog:"",index_schema:"",indexNameSource:"select",index_name:"",sourceSchemaSource:"direct",sourceSchemaRefName:"",source_catalog:"",source_schema:"",source_table:"",primary_key:"",embedding_source_column:"",columns:[],doc_uri:"",embedding_model:"databricks-gte-large-en",sourcePathEnabled:!1,sourcePathSchemaSource:"direct",sourcePathSchemaRef:"",sourcePathVolumeCatalog:"",sourcePathVolumeSchema:"",sourcePathVolumeName:"",sourcePathPath:"",checkpointPathEnabled:!1,checkpointPathSchemaSource:"direct",checkpointPathSchemaRef:"",checkpointPathVolumeCatalog:"",checkpointPathVolumeSchema:"",checkpointPathVolumeName:"",checkpointPathPath:"",on_behalf_of_user:!1};function iC({formData:e,setFormData:t,configuredSchemas:n,configuredSchemaOptions:r,catalogs:a,sourcePathSchemas:l,sourcePathVolumes:o,sourcePathVolumesLoading:c,checkpointPathSchemas:i,checkpointPathVolumes:u,checkpointPathVolumesLoading:m}){const h=Object.keys(n).length>0;return s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium",children:["Volume Paths ",s.jsx("span",{className:"text-slate-500 font-normal",children:"(Optional)"})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-800/30 rounded border border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Source Path"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:e.sourcePathEnabled,onChange:f=>t(g=>({...g,sourcePathEnabled:f.target.checked,sourcePathSchemaSource:h?"reference":"direct"})),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-xs text-slate-400",children:"Enable"})]})]}),e.sourcePathEnabled&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-xs text-slate-400",children:"Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[h&&s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,sourcePathSchemaSource:"reference",sourcePathVolumeCatalog:"",sourcePathVolumeSchema:"",sourcePathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.sourcePathSchemaSource==="reference"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,sourcePathSchemaSource:"direct",sourcePathSchemaRef:"",sourcePathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.sourcePathSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),e.sourcePathSchemaSource==="reference"?s.jsx(le,{value:e.sourcePathSchemaRef,onChange:f=>{const g=f.target.value,b=n[g];t(w=>({...w,sourcePathSchemaRef:g,sourcePathVolumeCatalog:(b==null?void 0:b.catalog_name)||"",sourcePathVolumeSchema:(b==null?void 0:b.schema_name)||"",sourcePathVolumeName:""}))},options:[{value:"",label:"Select configured schema..."},...r],hint:"Select a previously configured schema"}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx(le,{value:e.sourcePathVolumeCatalog,onChange:f=>t(g=>({...g,sourcePathVolumeCatalog:f.target.value,sourcePathVolumeSchema:"",sourcePathVolumeName:""})),options:[{value:"",label:"Catalog..."},...(a||[]).map(f=>({value:f.name,label:f.name}))]}),s.jsx(le,{value:e.sourcePathVolumeSchema,onChange:f=>t(g=>({...g,sourcePathVolumeSchema:f.target.value,sourcePathVolumeName:""})),options:[{value:"",label:"Schema..."},...(l||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.sourcePathVolumeCatalog})]}),s.jsx(le,{label:"Volume",value:e.sourcePathVolumeName,onChange:f=>t(g=>({...g,sourcePathVolumeName:f.target.value})),options:[{value:"",label:c?"Loading volumes...":"Select volume..."},...(o||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.sourcePathVolumeSchema||c,hint:"Select a volume from the schema"}),s.jsx(re,{label:"Path",value:e.sourcePathPath,onChange:f=>t(g=>({...g,sourcePathPath:f.target.value})),placeholder:"/path/to/source/data",hint:"Path within the volume for source data files"})]})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-800/30 rounded border border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Checkpoint Path"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:e.checkpointPathEnabled,onChange:f=>t(g=>({...g,checkpointPathEnabled:f.target.checked,checkpointPathSchemaSource:h?"reference":"direct"})),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-xs text-slate-400",children:"Enable"})]})]}),e.checkpointPathEnabled&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-xs text-slate-400",children:"Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[h&&s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,checkpointPathSchemaSource:"reference",checkpointPathVolumeCatalog:"",checkpointPathVolumeSchema:"",checkpointPathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.checkpointPathSchemaSource==="reference"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,checkpointPathSchemaSource:"direct",checkpointPathSchemaRef:"",checkpointPathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.checkpointPathSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),e.checkpointPathSchemaSource==="reference"?s.jsx(le,{value:e.checkpointPathSchemaRef,onChange:f=>{const g=f.target.value,b=n[g];t(w=>({...w,checkpointPathSchemaRef:g,checkpointPathVolumeCatalog:(b==null?void 0:b.catalog_name)||"",checkpointPathVolumeSchema:(b==null?void 0:b.schema_name)||"",checkpointPathVolumeName:""}))},options:[{value:"",label:"Select configured schema..."},...r],hint:"Select a previously configured schema"}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx(le,{value:e.checkpointPathVolumeCatalog,onChange:f=>t(g=>({...g,checkpointPathVolumeCatalog:f.target.value,checkpointPathVolumeSchema:"",checkpointPathVolumeName:""})),options:[{value:"",label:"Catalog..."},...(a||[]).map(f=>({value:f.name,label:f.name}))]}),s.jsx(le,{value:e.checkpointPathVolumeSchema,onChange:f=>t(g=>({...g,checkpointPathVolumeSchema:f.target.value,checkpointPathVolumeName:""})),options:[{value:"",label:"Schema..."},...(i||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.checkpointPathVolumeCatalog})]}),s.jsx(le,{label:"Volume",value:e.checkpointPathVolumeName,onChange:f=>t(g=>({...g,checkpointPathVolumeName:f.target.value})),options:[{value:"",label:m?"Loading volumes...":"Select volume..."},...(u||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.checkpointPathVolumeSchema||m,hint:"Select a volume from the schema"}),s.jsx(re,{label:"Path",value:e.checkpointPathPath,onChange:f=>t(g=>({...g,checkpointPathPath:f.target.value})),placeholder:"/path/to/checkpoints",hint:"Path within the volume for vector index checkpoints"})]})]})]})}function cC({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var Y,q,se;const{config:l,addVectorStore:o,updateVectorStore:c,removeVectorStore:i}=We(),u=((Y=l.resources)==null?void 0:Y.vector_stores)||{},m=((q=l.resources)==null?void 0:q.llms)||{},h=l.schemas||{},f=((se=l.resources)==null?void 0:se.volumes)||{},{data:g,loading:b,refetch:w}=Pb(),{data:x}=Tr(),[d,p]=M.useState(Uu),[v,N]=M.useState(""),{data:C}=as(d.index_catalog||null),{data:j}=as(d.source_catalog||null),{data:E,loading:y}=vm(d.source_catalog||null,d.source_schema||null),{data:R,loading:$}=vm(d.index_catalog||null,d.index_schema||null),{data:k,loading:A,refetch:D}=L2(d.source_catalog||null,d.source_schema||null,d.source_table||null),S=(k||[]).map(z=>({value:z.name,label:`${z.name}${z.type_text?` (${z.type_text})`:""}`}));ym(d.endpoint_name||null);const{data:T}=as(d.sourcePathVolumeCatalog||null),{data:P,loading:L}=bm(d.sourcePathVolumeCatalog||null,d.sourcePathVolumeSchema||null),{data:I}=as(d.checkpointPathVolumeCatalog||null),{data:O,loading:F}=bm(d.checkpointPathVolumeCatalog||null,d.checkpointPathVolumeSchema||null),U=Object.entries(h).map(([z,G])=>({value:z,label:`${z} (${G.catalog_name}.${G.schema_name})`})),B=z=>{var J,ae,je,Ne,Ce,Me,He,ze,$e,Ve,tt,gt,Ft,ge,Rt,wt,nt,de,vt,Mt,Pt,sn,In,mn,fn,Gt,Vt;Zs(z);const G=u[z];if(G){const Yt=Object.entries(h).find(([Oe,Ie])=>{var Ke,st,Ge,Ue;return Ie.catalog_name===((st=(Ke=G.index)==null?void 0:Ke.schema)==null?void 0:st.catalog_name)&&Ie.schema_name===((Ue=(Ge=G.index)==null?void 0:Ge.schema)==null?void 0:Ue.schema_name)}),X=Object.entries(h).find(([Oe,Ie])=>{var Ke,st,Ge,Ue;return Ie.catalog_name===((st=(Ke=G.source_table)==null?void 0:Ke.schema)==null?void 0:st.catalog_name)&&Ie.schema_name===((Ue=(Ge=G.source_table)==null?void 0:Ge.schema)==null?void 0:Ue.schema_name)}),ne=G.source_path;let ve=!1,pe="direct",H="",te="",_="",V="",W="";if(ne!=null&&ne.volume){ve=!0,W=ne.path||"";let Oe="",Ie="",Ke="";if(typeof ne.volume=="string"){const Ge=Ot(ne.volume),Ue=Ge.startsWith("*")?Ge.slice(1):Ge,ft=f[Ue];ft&&(Oe=((J=ft.schema)==null?void 0:J.catalog_name)||"",Ie=((ae=ft.schema)==null?void 0:ae.schema_name)||"",Ke=ft.name)}else Oe=((Ne=(je=ne.volume)==null?void 0:je.schema)==null?void 0:Ne.catalog_name)||"",Ie=((Me=(Ce=ne.volume)==null?void 0:Ce.schema)==null?void 0:Me.schema_name)||"",Ke=((He=ne.volume)==null?void 0:He.name)||"";const st=Object.entries(h).find(([Ge,Ue])=>Ue.catalog_name===Oe&&Ue.schema_name===Ie);st?(pe="reference",H=st[0]):pe="direct",te=Oe,_=Ie,V=Ke}const K=G.checkpoint_path;let me=!1,he="direct",Se="",ue="",Ae="",mt="",bt="";if(K!=null&&K.volume){me=!0,bt=K.path||"";let Oe="",Ie="",Ke="";if(typeof K.volume=="string"){const Ge=Ot(K.volume),Ue=Ge.startsWith("*")?Ge.slice(1):Ge,ft=f[Ue];ft&&(Oe=((ze=ft.schema)==null?void 0:ze.catalog_name)||"",Ie=(($e=ft.schema)==null?void 0:$e.schema_name)||"",Ke=ft.name)}else Oe=((tt=(Ve=K.volume)==null?void 0:Ve.schema)==null?void 0:tt.catalog_name)||"",Ie=((Ft=(gt=K.volume)==null?void 0:gt.schema)==null?void 0:Ft.schema_name)||"",Ke=((ge=K.volume)==null?void 0:ge.name)||"";const st=Object.entries(h).find(([Ge,Ue])=>Ue.catalog_name===Oe&&Ue.schema_name===Ie);st?(he="reference",Se=st[0]):he="direct",ue=Oe,Ae=Ie,mt=Ke}p({refName:z,endpoint_name:((Rt=G.endpoint)==null?void 0:Rt.name)||"",endpoint_type:((wt=G.endpoint)==null?void 0:wt.type)||"STANDARD",indexSchemaSource:Yt?"reference":"direct",indexSchemaRefName:Yt?Yt[0]:"",index_catalog:((de=(nt=G.index)==null?void 0:nt.schema)==null?void 0:de.catalog_name)||"",index_schema:((Mt=(vt=G.index)==null?void 0:vt.schema)==null?void 0:Mt.schema_name)||"",indexNameSource:"select",index_name:((Pt=G.index)==null?void 0:Pt.name)||"",sourceSchemaSource:X?"reference":"direct",sourceSchemaRefName:X?X[0]:"",source_catalog:((In=(sn=G.source_table)==null?void 0:sn.schema)==null?void 0:In.catalog_name)||"",source_schema:((fn=(mn=G.source_table)==null?void 0:mn.schema)==null?void 0:fn.schema_name)||"",source_table:((Gt=G.source_table)==null?void 0:Gt.name)||"",primary_key:G.primary_key||"",embedding_source_column:G.embedding_source_column||"",columns:G.columns||[],doc_uri:G.doc_uri||"",embedding_model:((Vt=G.embedding_model)==null?void 0:Vt.name)||"databricks-gte-large-en",sourcePathEnabled:ve,sourcePathSchemaSource:pe,sourcePathSchemaRef:H,sourcePathVolumeCatalog:te,sourcePathVolumeSchema:_,sourcePathVolumeName:V,sourcePathPath:W,checkpointPathEnabled:me,checkpointPathSchemaSource:he,checkpointPathSchemaRef:Se,checkpointPathVolumeCatalog:ue,checkpointPathVolumeSchema:Ae,checkpointPathVolumeName:mt,checkpointPathPath:bt,on_behalf_of_user:G.on_behalf_of_user||!1}),N((G.columns||[]).join(", ")),r(z),t(!0)}},Z=z=>{tn("Vector Store",z,()=>i(z))},ee=()=>{const z=v.split(",").map(J=>J.trim()).filter(J=>J),G={embedding_source_column:d.embedding_source_column,primary_key:d.primary_key||void 0,columns:z.length>0?z:void 0,doc_uri:d.doc_uri||void 0,on_behalf_of_user:d.on_behalf_of_user||void 0};if(d.source_table&&d.source_catalog&&d.source_schema&&(G.source_table={schema:{catalog_name:d.source_catalog,schema_name:d.source_schema},name:d.source_table}),d.endpoint_name&&(G.endpoint={name:d.endpoint_name,type:d.endpoint_type}),(d.index_name||d.index_catalog||d.index_schema)&&(G.index={schema:{catalog_name:d.index_catalog||d.source_catalog,schema_name:d.index_schema||d.source_schema},name:d.index_name||`${d.source_table}_index`}),d.embedding_model&&(G.embedding_model={name:d.embedding_model}),d.sourcePathEnabled&&d.sourcePathVolumeName){const J={volume:{...d.sourcePathSchemaSource==="reference"&&d.sourcePathSchemaRef?{_schemaRef:d.sourcePathSchemaRef}:{schema:{catalog_name:d.sourcePathVolumeCatalog,schema_name:d.sourcePathVolumeSchema}},name:d.sourcePathVolumeName}};d.sourcePathPath&&(J.path=d.sourcePathPath),G.source_path=J}if(d.checkpointPathEnabled&&d.checkpointPathVolumeName){const J={volume:{...d.checkpointPathSchemaSource==="reference"&&d.checkpointPathSchemaRef?{_schemaRef:d.checkpointPathSchemaRef}:{schema:{catalog_name:d.checkpointPathVolumeCatalog,schema_name:d.checkpointPathVolumeSchema}},name:d.checkpointPathVolumeName}};d.checkpointPathPath&&(J.path=d.checkpointPathPath),G.checkpoint_path=J}n?n!==d.refName?(i(n),o(d.refName,G)):c(n,G):o(d.refName,G),t(!1),r(null),p(Uu),N(""),a()},ce=[{value:"",label:b?"Loading...":"Select an endpoint..."},...(g||[]).map(z=>{var ae;const G=(ae=z.endpoint_status)==null?void 0:ae.state;let J="unknown";return G==="ONLINE"?J="ready":G==="PROVISIONING"||G==="SCALING"?J="transitioning":(G==="OFFLINE"||G==="FAILED")&&(J="stopped"),{value:z.name,label:z.name,status:J}})],oe=[{value:"",label:"Select embedding model..."},{value:"databricks-gte-large-en",label:"GTE Large (Embeddings)"},{value:"databricks-bge-large-en",label:"BGE Large (Embeddings)"},...Object.entries(m).map(([z,G])=>({value:G.name,label:`${z} (${G.name})`}))];return s.jsxs(ke,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(dr,{className:"w-5 h-5 text-violet-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Vector Stores"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{const z=Object.keys(h).length>0;p({...Uu,indexSchemaSource:z?"reference":"direct",sourceSchemaSource:z?"reference":"direct",sourcePathSchemaSource:z?"reference":"direct",checkpointPathSchemaSource:z?"reference":"direct"}),N(""),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Vector Store"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([z,G])=>{var J,ae;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(dr,{className:"w-4 h-4 text-violet-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:z}),s.jsxs("p",{className:"text-xs text-slate-500",children:[((J=G.endpoint)==null?void 0:J.name)||"No endpoint","  ",((ae=G.index)==null?void 0:ae.name)||"No index"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[G.on_behalf_of_user&&s.jsxs(Ee,{variant:"success",title:"On Behalf of User",children:[s.jsx(Yn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>B(z),children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>Z(z),children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]})]},z)})}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No vector stores configured. Add a vector store to enable semantic search."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Vector Store"]}),s.jsx(re,{label:"Reference Name",value:d.refName,onChange:z=>p({...d,refName:Lt(z.target.value)}),placeholder:"Products Vector Store",hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium",children:["Vector Search Endpoint ",s.jsx("span",{className:"text-slate-500 font-normal",children:"(Optional)"})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Auto-detected if not specified"})]}),s.jsxs("button",{type:"button",onClick:()=>w(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:b,children:[s.jsx(Ut,{className:`w-3 h-3 ${b?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(Po,{options:ce,value:d.endpoint_name,onChange:z=>{const G=g==null?void 0:g.find(ae=>ae.name===z),J=(G==null?void 0:G.endpoint_type)==="OPTIMIZED_STORAGE"?"OPTIMIZED_STORAGE":"STANDARD";p({...d,endpoint_name:z,endpoint_type:z?J:d.endpoint_type})},placeholder:"Select an endpoint (or leave empty for auto-detection)..."}),s.jsx(le,{label:"Endpoint Type",value:d.endpoint_type,onChange:z=>p({...d,endpoint_type:z.target.value}),options:[{value:"STANDARD",label:"Standard"},{value:"OPTIMIZED_STORAGE",label:"Optimized Storage"}],hint:d.endpoint_name?"Auto-detected from selected endpoint":"Only used if endpoint is specified",disabled:!!d.endpoint_name})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Index Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>p({...d,indexSchemaSource:"reference"}),className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${d.indexSchemaSource==="reference"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(dr,{className:"w-3 h-3"}),s.jsx("span",{children:"Configured"})]}),s.jsx("button",{type:"button",onClick:()=>p({...d,indexSchemaSource:"direct"}),className:`px-2 py-1 text-xs rounded ${d.indexSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),d.indexSchemaSource==="reference"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:d.indexSchemaRefName,onChange:z=>{const G=z.target.value,J=h[G];p({...d,indexSchemaRefName:G,index_catalog:(J==null?void 0:J.catalog_name)||"",index_schema:(J==null?void 0:J.schema_name)||""})},options:[{value:"",label:"Select configured schema..."},...U]}),U.length===0&&s.jsx("p",{className:"text-xs text-amber-400",children:'No schemas configured. Add one in Schemas section or switch to "Select".'})]}):s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(le,{label:"Catalog",value:d.index_catalog,onChange:z=>p({...d,index_catalog:z.target.value,index_schema:"",indexSchemaRefName:""}),options:[{value:"",label:"Select catalog..."},...(x||[]).map(z=>({value:z.name,label:z.name}))]}),s.jsx(le,{label:"Schema",value:d.index_schema,onChange:z=>p({...d,index_schema:z.target.value,indexSchemaRefName:""}),options:[{value:"",label:"Select schema..."},...(C||[]).map(z=>({value:z.name,label:z.name}))],disabled:!d.index_catalog})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Index Name"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>p({...d,indexNameSource:"select",index_name:""}),className:`px-2 py-1 text-xs rounded ${d.indexNameSource==="select"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"}),s.jsx("button",{type:"button",onClick:()=>p({...d,indexNameSource:"manual"}),className:`px-2 py-1 text-xs rounded ${d.indexNameSource==="manual"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Manual"})]})]}),d.indexNameSource==="select"?s.jsx(le,{value:d.index_name,onChange:z=>{const G=z.target.value;p(J=>({...J,index_name:G,refName:n?J.refName:G?Je(G):J.refName}))},options:[{value:"",label:$?"Loading tables...":"Select a table..."},...(R||[]).map(z=>({value:z.name,label:z.name}))],disabled:!d.index_catalog||!d.index_schema||$,hint:"Select a table from the index schema"}):s.jsx(re,{value:d.index_name,onChange:z=>p({...d,index_name:z.target.value}),placeholder:"products_index",hint:"Enter a custom index name"})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium",children:["Source Table ",s.jsx("span",{className:"text-red-400 font-normal",children:"(Required for new index)"})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"The table containing data to be indexed"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Source Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>p({...d,sourceSchemaSource:"reference"}),className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${d.sourceSchemaSource==="reference"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(dr,{className:"w-3 h-3"}),s.jsx("span",{children:"Configured"})]}),s.jsx("button",{type:"button",onClick:()=>p({...d,sourceSchemaSource:"direct"}),className:`px-2 py-1 text-xs rounded ${d.sourceSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),d.sourceSchemaSource==="reference"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:d.sourceSchemaRefName,onChange:z=>{const G=z.target.value,J=h[G];p({...d,sourceSchemaRefName:G,source_catalog:(J==null?void 0:J.catalog_name)||"",source_schema:(J==null?void 0:J.schema_name)||"",source_table:"",embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),N("")},options:[{value:"",label:"Select configured schema..."},...U]}),U.length===0&&s.jsx("p",{className:"text-xs text-amber-400",children:'No schemas configured. Add one in Schemas section or switch to "Select".'})]}):s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(le,{label:"Catalog",value:d.source_catalog,onChange:z=>{p({...d,source_catalog:z.target.value,source_schema:"",source_table:"",sourceSchemaRefName:"",embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),N("")},options:[{value:"",label:"Select catalog..."},...(x||[]).map(z=>({value:z.name,label:z.name}))]}),s.jsx(le,{label:"Schema",value:d.source_schema,onChange:z=>{p({...d,source_schema:z.target.value,source_table:"",sourceSchemaRefName:"",embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),N("")},options:[{value:"",label:"Select schema..."},...(j||[]).map(z=>({value:z.name,label:z.name}))],disabled:!d.source_catalog})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(le,{label:"Table",value:d.source_table,onChange:z=>{p({...d,source_table:z.target.value,embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),N("")},options:[{value:"",label:y?"Loading...":"Select table..."},...(E||[]).map(z=>({value:z.name,label:z.name}))],disabled:!d.source_schema&&!d.sourceSchemaRefName||y})}),d.source_table&&s.jsxs("button",{type:"button",onClick:()=>D(),className:"mt-6 text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:A,children:[s.jsx(Ut,{className:`w-3 h-3 ${A?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-slate-300 font-medium",children:"Embedding Configuration"}),A&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[s.jsx(xt,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:"Loading columns..."})]})]}),s.jsx(le,{label:"Embedding Model",value:d.embedding_model,onChange:z=>p({...d,embedding_model:z.target.value}),options:oe,hint:"Model used to create embeddings"}),s.jsx(le,{label:"Embedding Source Column",value:d.embedding_source_column,onChange:z=>p({...d,embedding_source_column:z.target.value}),options:[{value:"",label:A?"Loading columns...":S.length>0?"Select column...":"Select a table first..."},...S],hint:"Column containing text to embed (typically text/string columns)",disabled:!d.source_table||A}),s.jsx(le,{label:"Primary Key",value:d.primary_key,onChange:z=>p({...d,primary_key:z.target.value}),options:[{value:"",label:A?"Loading columns...":S.length>0?"Select primary key column...":"Select a table first..."},...S],hint:"Primary key column for the source table",disabled:!d.source_table||A})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-sm text-slate-300 font-medium",children:"Columns to Include"}),d.source_table&&S.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2 max-h-40 overflow-y-auto p-2 bg-slate-800/50 rounded border border-slate-700",children:S.map(z=>{const G=v.split(",").map(J=>J.trim()).includes(z.value);return s.jsx("button",{type:"button",onClick:()=>{const J=v.split(",").map(ae=>ae.trim()).filter(ae=>ae);N(G?J.filter(ae=>ae!==z.value).join(", "):[...J,z.value].join(", "))},className:`px-2 py-1 text-xs rounded transition-colors ${G?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:z.value},z.value)})}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Click columns to select/deselect. Selected: ",v.split(",").filter(z=>z.trim()).length||0]})]}):s.jsx(re,{label:"",value:v,onChange:z=>N(z.target.value),placeholder:"id, name, description, category",hint:"Select a table to see available columns, or enter comma-separated column names"})]}),s.jsx(le,{label:"Document URI Column (Optional)",value:d.doc_uri,onChange:z=>p({...d,doc_uri:z.target.value}),options:[{value:"",label:S.length>0?"None (no document URIs)":"Select a table first..."},...S],hint:"Column containing document URIs for linking",disabled:!d.source_table||A}),s.jsx(iC,{formData:d,setFormData:p,configuredSchemas:h,configuredSchemaOptions:U,catalogs:x,sourcePathSchemas:T,sourcePathVolumes:P,sourcePathVolumesLoading:L,checkpointPathSchemas:I,checkpointPathVolumes:O,checkpointPathVolumesLoading:F}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:d.on_behalf_of_user,onChange:z=>p({...d,on_behalf_of_user:z.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Cr,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),d.refName&&Dt(d.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',d.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:ee,disabled:!d.refName||!d.embedding_source_column||Dt(d.refName,l,n),children:n?"Update":"Add"})]})]})]})}const uC=[{value:"",label:"= (equals)"},{value:" NOT",label:"!= (not equals)"},{value:" <",label:"< (less than)"},{value:" <=",label:"<= (less or equal)"},{value:" >",label:"> (greater than)"},{value:" >=",label:">= (greater or equal)"},{value:" LIKE",label:"LIKE (pattern match)"}];function Qp(){return`filter_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}const dC=[{value:"ms-marco-TinyBERT-L-2-v2",label:"TinyBERT L-2 (fastest)"},{value:"ms-marco-MiniLM-L-6-v2",label:"MiniLM L-6"},{value:"ms-marco-MiniLM-L-12-v2",label:"MiniLM L-12 (balanced)"},{value:"rank-T5-flan",label:"T5-flan (most accurate)"}],mC=[{value:"ANN",label:"ANN (Approximate Nearest Neighbor)"},{value:"HYBRID",label:"Hybrid"}];function fC(){var $;const{config:e,addRetriever:t,updateRetriever:n,removeRetriever:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState({refName:"",vectorStoreRef:"",columns:"",numResults:"10",queryType:"ANN",filters:[],enableRerank:!1,rerankModel:"ms-marco-MiniLM-L-12-v2",rerankTopN:"",rerankCacheDir:"/tmp/flashrank_cache",rerankColumns:""}),m=e.retrievers||{},h=(($=e.resources)==null?void 0:$.vector_stores)||{},f=Object.keys(h).length>0,g=Object.entries(h).map(([k,A])=>({value:k,label:`${k} (${A.embedding_source_column||"no column"})`})),b=()=>{u({refName:"",vectorStoreRef:"",columns:"",numResults:"10",queryType:"ANN",filters:[],enableRerank:!1,rerankModel:"ms-marco-MiniLM-L-12-v2",rerankTopN:"",rerankCacheDir:"/tmp/flashrank_cache",rerankColumns:""}),c(null)},{scrollToAsset:w}=qn(),x=k=>{var B,Z,ee,ce,oe,Y,q;w(k);const A=m[k];let D="";if(A.vector_store){const se=Object.entries(h).find(([,z])=>{var G,J;return z.embedding_source_column===A.vector_store.embedding_source_column&&((G=z.source_table)==null?void 0:G.name)===((J=A.vector_store.source_table)==null?void 0:J.name)});se&&(D=se[0])}let S=!1,T="ms-marco-MiniLM-L-12-v2",P="",L="/tmp/flashrank_cache",I="";A.rerank&&(S=!0,typeof A.rerank=="object"&&(T=A.rerank.model||T,P=((B=A.rerank.top_n)==null?void 0:B.toString())||"",L=A.rerank.cache_dir||L,I=((Z=A.rerank.columns)==null?void 0:Z.join(", "))||""));const O=D?h[D]:null,F=new Set;O&&(O.columns&&Array.isArray(O.columns)&&O.columns.forEach(se=>F.add(se)),O.embedding_source_column&&F.add(O.embedding_source_column),O.primary_key&&F.add(O.primary_key),O.doc_uri&&F.add(O.doc_uri));const U=[];(ee=A.search_parameters)!=null&&ee.filters&&Object.entries(A.search_parameters.filters).forEach(([se,z])=>{let G=se,J="";const ae=[" NOT"," <="," >="," <"," >"," LIKE"];for(const Ne of ae)if(se.endsWith(Ne)){G=se.slice(0,-Ne.length),J=Ne;break}const je=F.has(G)?"select":"manual";U.push({id:Qp(),columnSource:je,column:G,operator:J,value:String(z)})}),u({refName:k,vectorStoreRef:D,columns:((ce=A.columns)==null?void 0:ce.join(", "))||"",numResults:((Y=(oe=A.search_parameters)==null?void 0:oe.num_results)==null?void 0:Y.toString())||"10",queryType:((q=A.search_parameters)==null?void 0:q.query_type)||"ANN",filters:U,enableRerank:S,rerankModel:T,rerankTopN:P,rerankCacheDir:L,rerankColumns:I}),c(k),l(!0)},d=k=>{if(k.preventDefault(),!i.refName||!i.vectorStoreRef)return;const A=h[i.vectorStoreRef];if(!A)return;const D=i.columns.split(",").map(I=>I.trim()).filter(I=>I.length>0),S={};i.filters.forEach(I=>{if(I.column&&I.value){const O=I.operator?`${I.column}${I.operator}`:I.column;let F=I.value;I.value==="true"?F=!0:I.value==="false"?F=!1:!isNaN(Number(I.value))&&I.value.trim()!==""&&(F=Number(I.value)),S[O]=F}});const T={num_results:parseInt(i.numResults)||10,filters:Object.keys(S).length>0?S:void 0,query_type:i.queryType};let P;if(i.enableRerank){const I=i.rerankColumns.split(",").map(O=>O.trim()).filter(O=>O.length>0);P={model:i.rerankModel,top_n:i.rerankTopN?parseInt(i.rerankTopN):void 0,cache_dir:i.rerankCacheDir||void 0,columns:I.length>0?I:void 0}}const L={vector_store:A,columns:D.length>0?D:void 0,search_parameters:T,rerank:P};o&&o!==i.refName?(r(o),t(i.refName,L)):o?n(i.refName,L):t(i.refName,L),b(),l(!1)},p=k=>{const{name:A,value:D,type:S}=k.target;u(S==="checkbox"?T=>({...T,[A]:k.target.checked}):T=>({...T,[A]:D}))},v=k=>{u(A=>{var S;const D={...A,vectorStoreRef:k};return!A.columns&&((S=h[k])!=null&&S.columns)&&(D.columns=h[k].columns.join(", ")),!A.refName&&k&&(D.refName=`${Mo(k)}_retriever`),D})},C=(()=>{if(!i.vectorStoreRef)return[];const k=h[i.vectorStoreRef];if(!k)return[];const A=new Set;return k.columns&&Array.isArray(k.columns)&&k.columns.forEach(D=>A.add(D)),k.embedding_source_column&&A.add(k.embedding_source_column),k.primary_key&&A.add(k.primary_key),k.doc_uri&&A.add(k.doc_uri),Array.from(A).sort()})(),j=C.length>0,E=()=>{u(k=>({...k,filters:[...k.filters,{id:Qp(),columnSource:j?"select":"manual",column:"",operator:"",value:""}]}))},y=(k,A,D)=>{u(S=>({...S,filters:S.filters.map(T=>T.id!==k?T:A==="columnSource"?{...T,columnSource:D,column:""}:{...T,[A]:D})}))},R=k=>{u(A=>({...A,filters:A.filters.filter(D=>D.id!==k)}))};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-slate-100 flex items-center gap-2",children:[s.jsx(sa,{className:"w-5 h-5 text-blue-400"}),"Retrievers"]}),s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Configure vector search retrievers for semantic search and information retrieval"})]})}),!f&&s.jsx(ke,{className:"bg-amber-500/10 border-amber-500/30",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center",children:s.jsx(dr,{className:"w-4 h-4 text-amber-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-amber-200",children:"No Vector Stores Configured"}),s.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Retrievers require a vector store. Configure at least one vector store in the Resources section first."})]})]})}),s.jsxs(Q,{onClick:()=>{b(),l(!0)},variant:"primary",size:"sm",disabled:!f,className:"self-start",children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Retriever"]}),s.jsxs("div",{className:"space-y-3",children:[Object.entries(m).map(([k,A])=>{var D,S,T,P;return s.jsx(ke,{className:"hover:border-slate-700 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-200",children:k}),s.jsxs(Ee,{variant:"info",children:[s.jsx(_p,{className:"w-3 h-3 mr-1"}),((D=A.search_parameters)==null?void 0:D.num_results)||10," results"]}),((S=A.search_parameters)==null?void 0:S.filters)&&Object.keys(A.search_parameters.filters).length>0&&s.jsxs(Ee,{variant:"warning",children:[Object.keys(A.search_parameters.filters).length," filter",Object.keys(A.search_parameters.filters).length!==1?"s":""]}),A.rerank&&s.jsxs(Ee,{variant:"success",children:[s.jsx(Ut,{className:"w-3 h-3 mr-1"}),"Reranking"]})]}),s.jsxs("div",{className:"mt-2 space-y-1 text-xs text-slate-400",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Query Type:"})," ",((T=A.search_parameters)==null?void 0:T.query_type)||"ANN"]}),A.columns&&A.columns.length>0&&s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Columns:"})," ",A.columns.slice(0,3).join(", "),A.columns.length>3&&` +${A.columns.length-3} more`]}),((P=A.search_parameters)==null?void 0:P.filters)&&Object.keys(A.search_parameters.filters).length>0&&s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Filters:"})," ",Object.entries(A.search_parameters.filters).slice(0,2).map(([L,I])=>`${L}=${I}`).join(", "),Object.keys(A.search_parameters.filters).length>2&&` +${Object.keys(A.search_parameters.filters).length-2} more`]}),A.rerank&&typeof A.rerank=="object"&&s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Rerank Model:"})," ",A.rerank.model,A.rerank.top_n&&` (top ${A.rerank.top_n})`]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>x(k),children:[s.jsx(On,{className:"w-4 h-4 mr-1"}),"Edit"]}),s.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>{tn("Retriever",k,()=>r(k))},className:"text-red-400 hover:text-red-300",children:[s.jsx(Qe,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]})},k)}),Object.keys(m).length===0&&f&&s.jsxs("div",{className:"text-center py-8 text-slate-500",children:[s.jsx(sa,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{children:"No retrievers configured yet"}),s.jsx("p",{className:"text-xs mt-1",children:"Add a retriever to enable semantic search capabilities for your agents"})]})]}),s.jsx(An,{isOpen:a,onClose:()=>{b(),l(!1)},title:o?"Edit Retriever":"Add Retriever",size:"lg",children:s.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-300 border-b border-slate-700 pb-2",children:"Basic Configuration"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Reference Name",name:"refName",value:i.refName,onChange:k=>u(A=>({...A,refName:Lt(k.target.value)})),placeholder:"Products Retriever",hint:"Type naturally - spaces become underscores",required:!0}),s.jsx(le,{label:"Vector Store",value:i.vectorStoreRef,onChange:k=>v(k.target.value),options:[{value:"",label:"Select a vector store..."},...g],hint:"Select a configured vector store",required:!0})]}),s.jsx(re,{label:"Return Columns",name:"columns",value:i.columns,onChange:p,placeholder:"product_id, name, description",hint:"Comma-separated list of columns to return in search results"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-300 border-b border-slate-700 pb-2",children:"Search Parameters"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Number of Results",name:"numResults",type:"number",value:i.numResults,onChange:p,placeholder:"10",hint:"Maximum number of results to return"}),s.jsx(le,{label:"Query Type",value:i.queryType,onChange:k=>u(A=>({...A,queryType:k.target.value})),options:mC,hint:"Search algorithm to use"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-2",children:[s.jsxs("h3",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[s.jsx(_p,{className:"w-4 h-4"}),"Filters (Optional)"]}),s.jsxs(Q,{type:"button",variant:"ghost",size:"sm",onClick:E,children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Filter"]})]}),i.filters.length===0?s.jsx("div",{className:"text-xs text-slate-500 italic py-2",children:"No filters configured. Add filters to narrow down search results based on column values."}):s.jsx("div",{className:"space-y-3",children:i.filters.map(k=>s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between h-5 mb-1",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Column"}),s.jsxs("div",{className:"flex",children:[s.jsx("button",{type:"button",onClick:()=>y(k.id,"columnSource","select"),className:`px-2 py-0.5 text-[10px] rounded-l border transition-colors ${k.columnSource==="select"?"bg-blue-600 border-blue-600 text-white":"bg-slate-800 border-slate-600 text-slate-400 hover:bg-slate-700"} ${j?"":"opacity-50 cursor-not-allowed"}`,disabled:!j,title:j?"Select from available columns":"No columns available",children:"Select"}),s.jsx("button",{type:"button",onClick:()=>y(k.id,"columnSource","manual"),className:`px-2 py-0.5 text-[10px] rounded-r border-t border-r border-b transition-colors ${k.columnSource==="manual"?"bg-blue-600 border-blue-600 text-white":"bg-slate-800 border-slate-600 text-slate-400 hover:bg-slate-700"}`,children:"Manual"})]})]}),k.columnSource==="select"&&j?s.jsxs("select",{value:k.column,onChange:A=>y(k.id,"column",A.target.value),className:"w-full h-[38px] px-3 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select column..."}),C.map(A=>s.jsx("option",{value:A,children:A},A))]}):s.jsx("input",{type:"text",value:k.column,onChange:A=>y(k.id,"column",A.target.value),placeholder:"column_name",className:"w-full h-[38px] px-3 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"flex items-center justify-between h-5 mb-1",children:s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Operator"})}),s.jsx("select",{value:k.operator,onChange:A=>y(k.id,"operator",A.target.value),className:"w-full h-[38px] px-3 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:uC.map(A=>s.jsx("option",{value:A.value,children:A.label},A.value))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Value"}),s.jsx("input",{type:"text",value:k.value,onChange:A=>y(k.id,"value",A.target.value),placeholder:"filter value",className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Strings, numbers, or booleans (true/false)"})]})]}),s.jsx("button",{type:"button",onClick:()=>R(k.id),className:"mt-4 p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-400/10 rounded transition-colors",title:"Remove filter",children:s.jsx(qr,{className:"w-4 h-4"})})]},k.id))}),s.jsx("p",{className:"text-xs text-slate-500",children:"Filters restrict search results to rows matching the specified conditions. Use column names from your source table. Values are automatically parsed as numbers or booleans when applicable."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-2",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-300",children:"Reranking (Optional)"}),s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",name:"enableRerank",checked:i.enableRerank,onChange:p,className:"rounded border-slate-600 bg-slate-700 text-blue-500 focus:ring-blue-500 focus:ring-offset-slate-800"}),s.jsx("span",{className:"text-slate-400",children:"Enable reranking"})]})]}),i.enableRerank&&s.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-slate-700",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Rerank Model",value:i.rerankModel,onChange:k=>u(A=>({...A,rerankModel:k.target.value})),options:dC,hint:"FlashRank model for reranking"}),s.jsx(re,{label:"Top N Results",name:"rerankTopN",type:"number",value:i.rerankTopN,onChange:p,placeholder:"5",hint:"Number of results after reranking (leave empty to use search num_results)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Columns to Rerank"}),C.length>0?s.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto p-3 bg-slate-900/50 rounded-lg border border-slate-600",children:C.map(k=>{const A=i.rerankColumns.split(",").map(S=>S.trim()).filter(S=>S),D=A.includes(k);return s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:D,onChange:S=>{let T;S.target.checked?T=[...A,k]:T=A.filter(P=>P!==k),u(P=>({...P,rerankColumns:T.join(", ")}))},className:"w-4 h-4 rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0"}),s.jsx("span",{className:"text-sm text-slate-300",children:k})]},k)})}):s.jsx("div",{className:"p-3 bg-slate-900/50 rounded-lg border border-slate-600 text-slate-500 text-sm",children:i.vectorStoreRef?"No columns found in selected vector store":"Select a vector store to see available columns"}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select columns from the vector store to use for reranking.",i.rerankColumns&&` Selected: ${i.rerankColumns}`]})]}),s.jsx(re,{label:"Cache Directory",name:"rerankCacheDir",value:i.rerankCacheDir,onChange:p,placeholder:"/tmp/flashrank_cache",hint:"Directory to cache downloaded model weights"})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-700",children:[s.jsx(Q,{type:"button",variant:"ghost",onClick:()=>{b(),l(!1)},children:"Cancel"}),s.jsxs(Q,{type:"submit",variant:"primary",children:[o?"Update":"Add"," Retriever"]})]})]})})]})}const us=M.forwardRef(({className:e,label:t,error:n,hint:r,id:a,...l},o)=>{const c=a||(t==null?void 0:t.toLowerCase().replace(/\s+/g,"-"));return s.jsxs("div",{className:"space-y-1.5",children:[t&&s.jsxs("label",{htmlFor:c,className:"block text-sm font-medium text-slate-300",children:[t,l.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("textarea",{ref:o,id:c,className:Ye("w-full px-3 py-2 bg-slate-800/50 border rounded-lg text-slate-200 placeholder-slate-500","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200 resize-none font-mono text-sm",n?"border-red-500/50":"border-slate-700",e),...l}),r&&!n&&s.jsx("p",{className:"text-xs text-slate-500",children:r}),n&&s.jsx("p",{className:"text-xs text-red-400",children:n})]})});us.displayName="Textarea";function $n({label:e,resourceType:t,configuredOptions:n,configuredValue:r,onConfiguredChange:a,source:l,onSourceChange:o,children:c,hint:i}){return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>o("configured"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${l==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>o("select"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${l==="select"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),l==="configured"?s.jsxs("div",{className:"space-y-1",children:[s.jsx(le,{options:[{value:"",label:`Select configured ${t}...`},...n],value:r,onChange:u=>a(u.target.value)}),n.length===0&&s.jsxs("p",{className:"text-xs text-amber-400",children:["No ",t,'s configured. Add one in Resources section or switch to "Select".']})]}):c,i&&s.jsx("p",{className:"text-xs text-slate-500",children:i})]})}const hC=[{value:"factory",label:"Factory Function"},{value:"python",label:"Python Function"},{value:"unity_catalog",label:"Unity Catalog Function"},{value:"mcp",label:"MCP Server"}],Bu=[{value:"dao_ai.tools.create_genie_tool",label:"Genie Tool",description:"Query data using natural language via Databricks Genie",icon:wr},{value:"dao_ai.tools.create_vector_search_tool",label:"Vector Search Tool",description:"Semantic search over documents using vector embeddings",icon:sa},{value:"dao_ai.tools.create_send_slack_message_tool",label:"Slack Message Tool",description:"Send messages to Slack channels",icon:wr},{value:"dao_ai.tools.create_agent_endpoint_tool",label:"Agent Endpoint Tool",description:"Call another deployed agent endpoint",icon:Zt},{value:"custom",label:"Custom Factory...",description:"Specify a custom factory function path",icon:Rs}],Wu=[{value:"dao_ai.tools.current_time_tool",label:"Current Time Tool",description:"Get the current date and time",icon:lc},{value:"dao_ai.tools.time_in_timezone_tool",label:"Time in Timezone Tool",description:"Get time in a specific timezone",icon:lc},{value:"dao_ai.tools.search_tool",label:"Web Search Tool",description:"Search the web using DuckDuckGo",icon:sa},{value:"custom",label:"Custom Python Function...",description:"Specify a custom Python function path",icon:Rs}],pC=[{value:"url",label:"Direct URL",description:"Connect to any MCP server via URL"},{value:"genie",label:"Genie Room",description:"Databricks Genie MCP server"},{value:"vector_search",label:"Vector Search",description:"Databricks Vector Search MCP server"},{value:"functions",label:"UC Functions",description:"Unity Catalog Functions MCP server"},{value:"sql",label:"SQL (DBSQL)",description:"Databricks SQL MCP server"},{value:"connection",label:"UC Connection",description:"External MCP server via UC Connection"}],Kp={sourceType:"url",url:"",genieSource:"select",genieRefName:"",genieSpaceId:"",genieName:"",genieDescription:"",vectorStoreSource:"select",vectorStoreRefName:"",vectorEndpoint:"",vectorIndex:"",vectorCatalog:"",vectorSchema:"",schemaSource:"select",schemaRefName:"",functionsCatalog:"",functionsSchema:"",connectionSource:"select",connectionRefName:"",connectionName:"",warehouseSource:"select",warehouseRefName:"",warehouseId:"",useCredentials:!0,credentialsMode:"service_principal",servicePrincipalRef:"",clientIdSource:"variable",clientIdVar:"",clientIdManual:"",clientSecretSource:"variable",clientSecretVar:"",clientSecretManual:"",workspaceHostSource:"variable",workspaceHostVar:"",workspaceHostManual:""},Zp={enabled:!1,reviewPrompt:"Please review the tool call",allowAccept:!0,allowEdit:!0,allowRespond:!0,allowDecline:!0,declineMessage:"Tool call declined by user",customActions:[]};function jl(e){const t=e.split(".");let n=t[t.length-1];n=n.replace(/^create_/,"").replace(/_tool$/,"");const r=n.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"");return r?`${r}_tool`:""}function xC(){var Yt,X,ne,ve,pe,H,te;const{config:e,addTool:t,updateTool:n,removeTool:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState({refName:"",name:"",type:"factory",functionName:"",customFunctionName:"",args:"{}",genieSource:"configured",genieRefName:"",genieSpaceId:"",geniePersistConversation:!0,genieTruncateResults:!1,genieLruCacheEnabled:!1,genieLruCacheCapacity:1e3,genieLruCacheTtl:86400,genieLruCacheTtlNeverExpires:!1,genieLruCacheWarehouseSource:"configured",genieLruCacheWarehouseRefName:"",genieLruCacheWarehouseId:"",genieSemanticCacheEnabled:!1,genieSemanticCacheTtl:86400,genieSemanticCacheTtlNeverExpires:!1,genieSemanticCacheSimilarityThreshold:.85,genieSemanticCacheEmbeddingModelSource:"configured",genieSemanticCacheEmbeddingModelRefName:"",genieSemanticCacheEmbeddingModelManual:"databricks-gte-large-en",genieSemanticCacheTableName:"genie_semantic_cache",genieSemanticCacheDatabaseSource:"configured",genieSemanticCacheDatabaseRefName:"",genieSemanticCacheWarehouseSource:"configured",genieSemanticCacheWarehouseRefName:"",genieSemanticCacheWarehouseId:"",warehouseSource:"configured",warehouseRefName:"",warehouseId:"",retrieverSource:"configured",retrieverRefName:"",vectorEndpoint:"",vectorIndex:"",schemaSource:"configured",schemaRefName:"",ucCatalog:"",ucSchema:"",functionSource:"configured",functionRefName:"",ucFunction:"",slackConnectionSource:"configured",slackConnectionRefName:"",slackChannelId:"",slackChannelName:"",agentLlmSource:"configured",agentLlmRefName:"",vectorSearchDescription:"",ucPartialArgs:[]}),[m,h]=M.useState(Kp),[f,g]=M.useState(Zp),[b,w]=M.useState(!1),[x,d]=M.useState(!1),[p,v]=M.useState(!1),N=((Yt=e.resources)==null?void 0:Yt.genie_rooms)||{},C=((X=e.resources)==null?void 0:X.vector_stores)||{},j=e.retrievers||{},E=e.schemas||{},y=((ne=e.resources)==null?void 0:ne.functions)||{},R=((ve=e.resources)==null?void 0:ve.connections)||{},$=((pe=e.resources)==null?void 0:pe.llms)||{},k=((H=e.resources)==null?void 0:H.warehouses)||{},A=((te=e.resources)==null?void 0:te.databases)||{},D=_=>{for(const[V,W]of Object.entries(N))if(_.space_id&&W.space_id===_.space_id||_.name&&W.name===_.name)return V;return null},S=_=>{for(const[V,W]of Object.entries(j))if(JSON.stringify(W)===JSON.stringify(_))return V;return null},T=_=>{for(const[V,W]of Object.entries(R))if(_.name&&W.name===_.name)return V;return null},P=_=>{for(const[V,W]of Object.entries($))if(_.name&&W.name===_.name)return V;return null},L=_=>{for(const[V,W]of Object.entries(k))if(_.warehouse_id&&W.warehouse_id===_.warehouse_id)return V;return null},I=_=>{for(const[V,W]of Object.entries(A))if(_.name&&W.name===_.name)return V;return null},O=_=>{const V=wb();if(!V)return null;const W=_.toLowerCase().replace(/-/g,"_");for(const[K,me]of Object.entries(V.aliasUsage))for(const he of me){const Se=he.toLowerCase().replace(/-/g,"_");if(W===Se||W.endsWith(Se)||Se.endsWith(W))return K}return null},F=_=>{for(const[V,W]of Object.entries(y))if(_.name&&W.name===_.name)if(_.schema&&W.schema){const K=_.schema,me=W.schema;if(K.catalog_name===me.catalog_name&&K.schema_name===me.schema_name)return V}else return V;return null},U=Object.entries(N).map(([_,V])=>({value:_,label:`${_} (${V.name||V.space_id})`})),B=Object.entries(C).map(([_,V])=>({value:_,label:`${_} (${V.embedding_source_column||_})`})),Z=Object.entries(j).map(([_,V])=>{var W;return{value:_,label:`${_} (${((W=V.search_parameters)==null?void 0:W.num_results)||10} results)`}}),ee=Object.entries(E).map(([_,V])=>({value:_,label:`${_} (${V.catalog_name}.${V.schema_name})`})),ce=Object.entries(y).map(([_,V])=>({value:_,label:`${_} (${V.name})`})),oe=Object.entries(R).map(([_,V])=>({value:_,label:`${_} (${V.name})`})),Y=Object.entries($).map(([_,V])=>({value:_,label:`${_} (${V.name||_})`})),q=Object.entries(k).map(([_,V])=>({value:_,label:`${_} (${V.name||_})`})),se=Object.entries(A).map(([_,V])=>({value:_,label:`${_} (${V.name||_})`})),z=e.tools||{},G=e.variables||{},J=e.service_principals||{},ae=Object.keys(G),je=Object.keys(J),Ne=[{value:"",label:"Select a variable..."},...ae.map(_=>({value:_,label:_}))],Ce=[{value:"",label:"Select a service principal..."},...je.map(_=>({value:_,label:_}))],{data:Me,loading:He,refetch:ze}=Ab(i.ucCatalog||null,i.ucSchema||null),{data:$e,loading:Ve,refetch:tt}=ym(i.vectorEndpoint||null),{data:gt,loading:Ft,refetch:ge}=ym(m.vectorEndpoint||null),Rt=()=>{if(!f.enabled)return;const _={review_prompt:f.reviewPrompt,interrupt_config:{allow_accept:f.allowAccept,allow_edit:f.allowEdit,allow_respond:f.allowRespond,allow_decline:f.allowDecline},decline_message:f.declineMessage};return f.customActions.length>0&&(_.custom_actions={},f.customActions.forEach(V=>{V.key&&V.value&&(_.custom_actions[V.key]=V.value)})),_},wt=()=>{const _={type:"mcp",name:i.name};switch(m.useCredentials&&(m.credentialsMode==="service_principal"&&m.servicePrincipalRef?_.service_principal=`*${m.servicePrincipalRef}`:m.credentialsMode==="manual"&&(m.clientIdSource==="variable"&&m.clientIdVar?_.client_id=`*${m.clientIdVar}`:m.clientIdSource==="manual"&&m.clientIdManual&&(_.client_id=m.clientIdManual),m.clientSecretSource==="variable"&&m.clientSecretVar?_.client_secret=`*${m.clientSecretVar}`:m.clientSecretSource==="manual"&&m.clientSecretManual&&(_.client_secret=m.clientSecretManual),m.workspaceHostSource==="variable"&&m.workspaceHostVar?_.workspace_host=`*${m.workspaceHostVar}`:m.workspaceHostSource==="manual"&&m.workspaceHostManual&&(_.workspace_host=m.workspaceHostManual))),m.sourceType){case"url":_.url=m.url;break;case"genie":_.genie_room={name:m.genieName||"Genie Room",space_id:m.genieSpaceId,description:m.genieDescription||void 0};break;case"vector_search":_.vector_search={source_table:{schema:{catalog_name:m.vectorCatalog,schema_name:m.vectorSchema}},embedding_source_column:"content",index:{name:m.vectorIndex},endpoint:{name:m.vectorEndpoint}};break;case"functions":_.functions={catalog_name:m.functionsCatalog,schema_name:m.functionsSchema};break;case"sql":_.sql=!0;break;case"connection":m.connectionSource==="configured"&&m.connectionRefName?_.connection=`*${m.connectionRefName}`:m.connectionName&&(_.connection={name:m.connectionName});break}return _},nt=_=>{_.preventDefault();const V=i.functionName==="custom"?i.customFunctionName:i.functionName;if(!i.refName.trim()||!i.name.trim())return;let W;const K=Rt();if(i.type==="factory"){let Se={};if(i.functionName==="dao_ai.tools.create_genie_tool"){const ue={name:i.name,description:"Tool for querying via Genie",persist_conversation:i.geniePersistConversation,truncate_results:i.genieTruncateResults};if(i.genieSource==="configured"&&i.genieRefName?ue.genie_room=`__REF__${i.genieRefName}`:ue.genie_room={space_id:i.genieSpaceId},i.genieLruCacheEnabled){const Ae={capacity:i.genieLruCacheCapacity,time_to_live_seconds:i.genieLruCacheTtlNeverExpires?null:i.genieLruCacheTtl};i.genieLruCacheWarehouseSource==="configured"&&i.genieLruCacheWarehouseRefName?Ae.warehouse=`__REF__${i.genieLruCacheWarehouseRefName}`:i.genieLruCacheWarehouseId&&(Ae.warehouse={name:"lru_cache_warehouse",warehouse_id:i.genieLruCacheWarehouseId}),ue.lru_cache_parameters=Ae}if(i.genieSemanticCacheEnabled){const Ae={time_to_live_seconds:i.genieSemanticCacheTtlNeverExpires?null:i.genieSemanticCacheTtl,similarity_threshold:i.genieSemanticCacheSimilarityThreshold,table_name:i.genieSemanticCacheTableName};i.genieSemanticCacheEmbeddingModelSource==="configured"&&i.genieSemanticCacheEmbeddingModelRefName?Ae.embedding_model=`__REF__${i.genieSemanticCacheEmbeddingModelRefName}`:i.genieSemanticCacheEmbeddingModelManual&&(Ae.embedding_model=i.genieSemanticCacheEmbeddingModelManual),i.genieSemanticCacheDatabaseSource==="configured"&&i.genieSemanticCacheDatabaseRefName&&(Ae.database=`__REF__${i.genieSemanticCacheDatabaseRefName}`),i.genieSemanticCacheWarehouseSource==="configured"&&i.genieSemanticCacheWarehouseRefName?Ae.warehouse=`__REF__${i.genieSemanticCacheWarehouseRefName}`:i.genieSemanticCacheWarehouseId&&(Ae.warehouse={name:"semantic_cache_warehouse",warehouse_id:i.genieSemanticCacheWarehouseId}),ue.semantic_cache_parameters=Ae}Se=ue}else if(i.functionName==="dao_ai.tools.create_vector_search_tool")i.retrieverSource==="configured"&&i.retrieverRefName?Se={name:i.name,...i.vectorSearchDescription&&{description:i.vectorSearchDescription},retriever:`__REF__${i.retrieverRefName}`}:Se={name:i.name,...i.vectorSearchDescription&&{description:i.vectorSearchDescription},index_name:i.vectorIndex};else if(i.functionName==="dao_ai.tools.create_send_slack_message_tool"){const ue={name:i.name};i.slackConnectionSource==="configured"&&i.slackConnectionRefName&&(ue.connection=`__REF__${i.slackConnectionRefName}`),i.slackChannelId?ue.channel_id=i.slackChannelId:i.slackChannelName&&(ue.channel_name=i.slackChannelName),Se=ue}else if(i.functionName==="dao_ai.tools.create_agent_endpoint_tool"){const ue={name:i.name};i.agentLlmSource==="configured"&&i.agentLlmRefName&&(ue.llm=`__REF__${i.agentLlmRefName}`),Se=ue}else try{Se=JSON.parse(i.args||"{}")}catch{}W={type:"factory",name:V||i.functionName,args:Se,...K&&{human_in_the_loop:K}}}else if(i.type==="python")W={type:"python",name:V,...K&&{human_in_the_loop:K}};else if(i.type==="unity_catalog"){let Se;if(i.ucPartialArgs.length>0){Se={};for(const ue of i.ucPartialArgs)ue.name&&ue.value&&(ue.source==="manual"?Se[ue.name]=ue.value:Se[ue.name]=`__REF__${ue.value}`);Object.keys(Se).length===0&&(Se=void 0)}i.functionSource==="configured"&&i.functionRefName?W={type:"unity_catalog",__MERGE__:i.functionRefName,...Se&&{partial_args:Se},...K&&{human_in_the_loop:K}}:W={type:"unity_catalog",schema:{catalog_name:i.ucCatalog,schema_name:i.ucSchema},name:i.ucFunction.split(".").pop()||i.ucFunction,...Se&&{partial_args:Se},...K&&{human_in_the_loop:K}}}else if(i.type==="mcp"){if(m.sourceType==="connection"&&!(m.connectionSource==="configured"&&m.connectionRefName||m.connectionSource==="select"&&m.connectionName))return;W=wt(),K&&(W.human_in_the_loop=K)}else W=V;const me={name:i.name,function:W},he=i.refName.trim()||i.name;o?o!==he?(r(o),t(he,me)):n(he,me):t(he,me),de(),l(!1)},de=()=>{u({refName:"",name:"",type:"factory",functionName:"",customFunctionName:"",args:"{}",genieSource:"configured",genieRefName:"",genieSpaceId:"",geniePersistConversation:!0,genieTruncateResults:!1,genieLruCacheEnabled:!1,genieLruCacheCapacity:1e3,genieLruCacheTtl:86400,genieLruCacheTtlNeverExpires:!1,genieLruCacheWarehouseSource:"configured",genieLruCacheWarehouseRefName:"",genieLruCacheWarehouseId:"",genieSemanticCacheEnabled:!1,genieSemanticCacheTtl:86400,genieSemanticCacheTtlNeverExpires:!1,genieSemanticCacheSimilarityThreshold:.85,genieSemanticCacheEmbeddingModelSource:"configured",genieSemanticCacheEmbeddingModelRefName:"",genieSemanticCacheEmbeddingModelManual:"databricks-gte-large-en",genieSemanticCacheTableName:"genie_semantic_cache",genieSemanticCacheDatabaseSource:"configured",genieSemanticCacheDatabaseRefName:"",genieSemanticCacheWarehouseSource:"configured",genieSemanticCacheWarehouseRefName:"",genieSemanticCacheWarehouseId:"",warehouseSource:"configured",warehouseRefName:"",warehouseId:"",retrieverSource:"configured",retrieverRefName:"",vectorEndpoint:"",vectorIndex:"",schemaSource:"configured",schemaRefName:"",ucCatalog:"",ucSchema:"",functionSource:"configured",functionRefName:"",ucFunction:"",slackConnectionSource:"configured",slackConnectionRefName:"",slackChannelId:"",slackChannelName:"",agentLlmSource:"configured",agentLlmRefName:"",vectorSearchDescription:"",ucPartialArgs:[]});const _=Object.keys(R).length>0,V=Object.keys(E).length>0,W=Object.keys(N).length>0,K=Object.keys(C).length>0;h({...Kp,connectionSource:_?"configured":"select",schemaSource:V?"configured":"select",genieSource:W?"configured":"select",vectorStoreSource:K?"configured":"select"}),g(Zp),w(!1),d(!1),v(!1),c(null)},{scrollToAsset:vt}=qn(),Mt=(_,V)=>{vt(_),c(_),d(!0),v(!0);const W=V.function;if(typeof W=="string"){const K=Wu.some(he=>he.value===W),me=Bu.some(he=>he.value===W);u(he=>({...he,refName:_,name:V.name,type:K?"python":me?"factory":"python",functionName:K||me?W:"custom",customFunctionName:K||me?"":W}))}else if(typeof W=="object"){const K=W.type||"factory";if(W.human_in_the_loop){const me=W.human_in_the_loop,he=me.interrupt_config;w(!0),g({enabled:!0,reviewPrompt:me.review_prompt||"Please review the tool call",allowAccept:(he==null?void 0:he.allow_accept)??!0,allowEdit:(he==null?void 0:he.allow_edit)??!0,allowRespond:(he==null?void 0:he.allow_respond)??!0,allowDecline:(he==null?void 0:he.allow_decline)??!0,declineMessage:me.decline_message||"Tool call declined by user",customActions:me.custom_actions?Object.entries(me.custom_actions).map(([Se,ue])=>({key:Se,value:ue})):[]})}if(K==="factory"&&"args"in W){const me=W,he=me.name||"",Se=Bu.some(we=>we.value===he),ue=me.args||{};let Ae="configured",mt="",bt="";if(ue.genie_room){if(typeof ue.genie_room=="string"&&ue.genie_room.startsWith("__REF__"))mt=ue.genie_room.replace("__REF__",""),Ae="configured";else if(typeof ue.genie_room=="object"&&ue.genie_room!==null){const we=ue.genie_room,er=D(we);er?(mt=er,Ae="configured"):we.space_id&&(bt=we.space_id,Ae="select")}}let Oe="configured",Ie="",Ke="";if(ue.retriever){if(typeof ue.retriever=="string"&&ue.retriever.startsWith("__REF__"))Ie=ue.retriever.replace("__REF__",""),Oe="configured";else if(typeof ue.retriever=="object"&&ue.retriever!==null){const we=S(ue.retriever);we?(Ie=we,Oe="configured"):Oe="select"}}ue.index_name&&!Ie&&(Ke=ue.index_name,Oe="select");let st="configured",Ge="";if(ue.connection){if(typeof ue.connection=="string"&&ue.connection.startsWith("__REF__"))Ge=ue.connection.replace("__REF__",""),st="configured";else if(typeof ue.connection=="object"&&ue.connection!==null){const we=T(ue.connection);we?(Ge=we,st="configured"):st="select"}}let Ue="configured",ft="";if(ue.llm){if(typeof ue.llm=="string"&&ue.llm.startsWith("__REF__"))ft=ue.llm.replace("__REF__",""),Ue="configured";else if(typeof ue.llm=="object"&&ue.llm!==null){const we=P(ue.llm);we?(ft=we,Ue="configured"):Ue="select"}}let fs=!1,hs=1e3,ps=86400,xs=!1,_n="configured",Ln="",Xn="";if(ue.lru_cache_parameters){fs=!0;const we=ue.lru_cache_parameters;hs=we.capacity??1e3,we.time_to_live_seconds===null?xs=!0:ps=we.time_to_live_seconds??86400;const er=`tools.${_}.function.args.lru_cache_parameters.warehouse`,Ts=O(er);if(Ts&&k[Ts])Ln=Ts,_n="configured";else if(typeof we.warehouse=="string"&&we.warehouse.startsWith("__REF__"))Ln=we.warehouse.replace("__REF__",""),_n="configured";else if(typeof we.warehouse=="object"&&we.warehouse!==null){const Os=we.warehouse,tr=L(Os);tr?(Ln=tr,_n="configured"):(Xn=Os.warehouse_id||"",_n="select")}}let gs=!1,vs=86400,bs=!1,ys=.85,rn="configured",qe="",De="databricks-gte-large-en",Re="genie_semantic_cache",rt="configured",yt="",it="configured",qt="",Or="";if(ue.semantic_cache_parameters){gs=!0;const we=ue.semantic_cache_parameters;we.time_to_live_seconds===null?bs=!0:vs=we.time_to_live_seconds??86400,ys=we.similarity_threshold??.85,Re=we.table_name??"genie_semantic_cache";const er=`tools.${_}.function.args.semantic_cache_parameters.embedding_model`,Ts=O(er);if(Ts&&$[Ts])qe=Ts,rn="configured";else if(typeof we.embedding_model=="string")if(we.embedding_model.startsWith("__REF__"))qe=we.embedding_model.replace("__REF__",""),rn="configured";else{const wn=Object.entries($).find(([,hn])=>hn.name===we.embedding_model);wn?(qe=wn[0],rn="configured"):(De=we.embedding_model,rn="select")}else if(typeof we.embedding_model=="object"&&we.embedding_model!==null){const wn=we.embedding_model,hn=P(wn);hn?(qe=hn,rn="configured"):wn.name&&(De=wn.name,rn="select")}const Os=`tools.${_}.function.args.semantic_cache_parameters.database`,tr=O(Os);if(tr&&A[tr])yt=tr,rt="configured";else if(typeof we.database=="string"&&we.database.startsWith("__REF__"))yt=we.database.replace("__REF__",""),rt="configured";else if(typeof we.database=="object"&&we.database!==null){const wn=we.database,hn=I(wn);hn&&(yt=hn,rt="configured")}const Fo=`tools.${_}.function.args.semantic_cache_parameters.warehouse`,ul=O(Fo);if(ul&&k[ul])qt=ul,it="configured";else if(typeof we.warehouse=="string"&&we.warehouse.startsWith("__REF__"))qt=we.warehouse.replace("__REF__",""),it="configured";else if(typeof we.warehouse=="object"&&we.warehouse!==null){const wn=we.warehouse,hn=L(wn);hn?(qt=hn,it="configured"):(Or=wn.warehouse_id||"",it="select")}}u(we=>({...we,refName:_,name:V.name,type:"factory",functionName:Se?he:"custom",customFunctionName:Se?"":he,genieSource:Ae,genieRefName:mt,genieSpaceId:bt,geniePersistConversation:ue.persist_conversation??!0,genieTruncateResults:ue.truncate_results??!1,genieLruCacheEnabled:fs,genieLruCacheCapacity:hs,genieLruCacheTtl:ps,genieLruCacheTtlNeverExpires:xs,genieLruCacheWarehouseSource:_n,genieLruCacheWarehouseRefName:Ln,genieLruCacheWarehouseId:Xn,genieSemanticCacheEnabled:gs,genieSemanticCacheTtl:vs,genieSemanticCacheTtlNeverExpires:bs,genieSemanticCacheSimilarityThreshold:ys,genieSemanticCacheEmbeddingModelSource:rn,genieSemanticCacheEmbeddingModelRefName:qe,genieSemanticCacheEmbeddingModelManual:De,genieSemanticCacheTableName:Re,genieSemanticCacheDatabaseSource:rt,genieSemanticCacheDatabaseRefName:yt,genieSemanticCacheWarehouseSource:it,genieSemanticCacheWarehouseRefName:qt,genieSemanticCacheWarehouseId:Or,retrieverSource:Oe,retrieverRefName:Ie,vectorIndex:Ke,vectorSearchDescription:ue.description||"",slackConnectionSource:st,slackConnectionRefName:Ge,slackChannelId:ue.channel_id||"",slackChannelName:ue.channel_name||"",agentLlmSource:Ue,agentLlmRefName:ft}))}else if(K==="python"){const me=W.name||"",he=Wu.some(Se=>Se.value===me);u(Se=>({...Se,refName:_,name:V.name,type:"python",functionName:he?me:"custom",customFunctionName:he?"":me}))}else if(K==="unity_catalog"){const me=W,he=me.__MERGE__,Se=me.partial_args||{},ue=Object.entries(Se).map(([Ae,mt])=>{let bt="manual",Oe=String(mt);if(typeof mt=="string"&&mt.startsWith("__REF__")){const Ie=mt.replace("__REF__","");(e.service_principals||{})[Ie]?(bt="service_principal",Oe=Ie):(bt="variable",Oe=Ie)}return{id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:Ae,source:bt,value:Oe}});if(he)u(Ae=>({...Ae,refName:_,name:V.name,type:"unity_catalog",functionSource:"configured",functionRefName:he,ucPartialArgs:ue}));else{const Ae=me.schema,mt=me.name||"",bt=F({name:mt,schema:Ae});if(bt)u(Oe=>({...Oe,refName:_,name:V.name,type:"unity_catalog",functionSource:"configured",functionRefName:bt,ucPartialArgs:ue}));else{let Oe=mt;Ae&&typeof Ae=="object"&&"catalog_name"in Ae&&"schema_name"in Ae&&(Oe=`${Ae.catalog_name}.${Ae.schema_name}.${mt}`),u(Ie=>({...Ie,refName:_,name:V.name,type:"unity_catalog",functionSource:"select",ucFunction:Oe,ucPartialArgs:ue}))}}}else if(K==="mcp"){const me=W;u(he=>({...he,refName:_,name:V.name,type:"mcp"})),me.url&&h(he=>({...he,sourceType:"url",url:me.url||""}))}}l(!0)},Pt=_=>{var V;return typeof _.function=="string"?"string":((V=_.function)==null?void 0:V.type)||"unknown"},sn=_=>{var V;return typeof _.function=="string"?!1:!!((V=_.function)!=null&&V.human_in_the_loop)},In=_=>{const V=Pt(_);if(V==="mcp")return Pw;if(V==="unity_catalog")return on;if(typeof _.function=="object"&&_.function.name){if(_.function.name.includes("genie"))return wr;if(_.function.name.includes("vector")||_.function.name.includes("search"))return sa;if(_.function.name.includes("time"))return lc;if(_.function.name.includes("agent"))return Zt}return Rs},mn=[{value:"",label:"Select a function..."},...(Me||[]).map(_=>({value:_.full_name,label:`${_.name}${_.comment?` - ${_.comment}`:""}`}))],fn=[{value:"",label:"Select an index..."},...($e||[]).map(_=>({value:_.name,label:`${_.name}${_.index_type?` (${_.index_type})`:""}`}))],Gt=[{value:"",label:"Select an index..."},...(gt||[]).map(_=>({value:_.name,label:`${_.name}${_.index_type?` (${_.index_type})`:""}`}))],Vt=_=>_?"env"in _?`env: ${_.env}`:"scope"in _&&"secret"in _?`secret: ${_.scope}/${_.secret}`:"value"in _?`value: ${String(_.value)}`:"options"in _?`composite (${_.options.length} options)`:"unknown":"unknown";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Tools"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure tools that agents can use to perform tasks"})]}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Tool"]})]}),Object.keys(z).length===0?s.jsxs(ke,{className:"text-center py-12",children:[s.jsx(Rs,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No tools configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Tools enable agents to interact with external systems and data."}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Tool"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(z).map(([_,V])=>{const W=In(V);return s.jsx(ke,{variant:"interactive",className:"group cursor-pointer",onClick:()=>Mt(_,V),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center",children:s.jsx(W,{className:"w-5 h-5 text-amber-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:_}),_!==V.name&&s.jsxs("p",{className:"text-xs text-slate-500",children:["name: ",V.name]}),s.jsx("p",{className:"text-sm text-slate-400 font-mono",children:typeof V.function=="object"?V.function.name:V.function})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[sn(V)&&s.jsxs(Ee,{variant:"success",title:"Human In The Loop Enabled",children:[s.jsx(Cr,{className:"w-3 h-3 mr-1"}),"HITL"]}),s.jsx(Ee,{variant:"warning",children:Pt(V)}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:K=>{K.stopPropagation(),Mt(_,V)},title:"Edit tool",children:s.jsx(Bc,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:K=>{K.stopPropagation(),tn("Tool",_,()=>r(_))},title:"Delete tool",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]})},_)})}),s.jsx(An,{isOpen:a,onClose:()=>{l(!1),de()},title:o?"Edit Tool":"Add Tool",description:o?"Modify the tool configuration":"Configure a tool for your agents",size:"lg",children:s.jsxs("form",{onSubmit:nt,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., find_product_by_sku_tool",value:i.refName,onChange:_=>{u({...i,refName:Lt(_.target.value)}),v(!0)},hint:"YAML key (spaces become underscores)",required:!0}),s.jsx(le,{label:"Tool Type",options:hC,value:i.type,onChange:_=>u({...i,type:_.target.value})})]}),s.jsx(re,{label:"Tool Name",placeholder:"e.g., find_product_by_sku_uc",value:i.name,onChange:_=>{u({...i,name:_.target.value}),d(!0)},hint:"The name property inside the tool config (can differ from reference name)",required:!0}),i.type==="factory"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Factory Function"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:Bu.map(_=>{const V=_.icon,W=i.functionName===_.value;return s.jsxs("button",{type:"button",onClick:()=>{const K=jl(_.value);u({...i,functionName:_.value,name:x?i.name:K,refName:p?i.refName:K})},className:`p-3 rounded-lg border text-left transition-all ${W?"border-blue-500 bg-blue-500/10":"border-slate-700 hover:border-slate-600 bg-slate-800/50"}`,children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(V,{className:`w-4 h-4 ${W?"text-blue-400":"text-slate-400"}`}),s.jsx("span",{className:`text-sm font-medium ${W?"text-white":"text-slate-300"}`,children:_.label})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:_.description})]},_.value)})})]}),i.functionName==="dao_ai.tools.create_genie_tool"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Genie Tool Configuration"}),s.jsx($n,{label:"Genie Room",resourceType:"Genie room",configuredOptions:U,configuredValue:i.genieRefName,onConfiguredChange:_=>u({...i,genieRefName:_,genieSpaceId:""}),source:i.genieSource,onSourceChange:_=>u({...i,genieSource:_}),children:s.jsx(Gp,{value:i.genieSpaceId,onChange:_=>u({...i,genieSpaceId:_,genieRefName:""}),required:!0})}),s.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-700",children:[s.jsx("h5",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Options"}),s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[s.jsx("input",{type:"checkbox",checked:i.geniePersistConversation,onChange:_=>u({...i,geniePersistConversation:_.target.checked}),className:"mt-0.5 w-4 h-4 rounded border-slate-600 bg-slate-800 text-violet-500 focus:ring-violet-500 focus:ring-offset-slate-900"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-slate-200 group-hover:text-white",children:"Persist Conversation"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Keep conversation context across tool calls for multi-turn conversations within the same Genie space"})]})]}),s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[s.jsx("input",{type:"checkbox",checked:i.genieTruncateResults,onChange:_=>u({...i,genieTruncateResults:_.target.checked}),className:"mt-0.5 w-4 h-4 rounded border-slate-600 bg-slate-800 text-violet-500 focus:ring-violet-500 focus:ring-offset-slate-900"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-slate-200 group-hover:text-white",children:"Truncate Results"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Truncate large query results to fit within token limits"})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[s.jsx("input",{type:"checkbox",checked:i.genieLruCacheEnabled,onChange:_=>u({...i,genieLruCacheEnabled:_.target.checked}),className:"mt-0.5 w-4 h-4 rounded border-slate-600 bg-slate-800 text-violet-500 focus:ring-violet-500 focus:ring-offset-slate-900"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-slate-200 group-hover:text-white",children:"Enable LRU Cache"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Cache query results using Least Recently Used eviction policy"})]})]}),i.genieLruCacheEnabled&&s.jsxs("div",{className:"ml-7 space-y-3 p-3 bg-slate-900/50 rounded-lg border border-slate-700/50",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(re,{label:"Capacity",type:"number",value:i.genieLruCacheCapacity.toString(),onChange:_=>u({...i,genieLruCacheCapacity:parseInt(_.target.value)||1e3}),hint:"Max cached entries"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"TTL (seconds)"}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("input",{type:"number",value:i.genieLruCacheTtlNeverExpires?"":i.genieLruCacheTtl,onChange:_=>u({...i,genieLruCacheTtl:parseInt(_.target.value)||86400}),disabled:i.genieLruCacheTtlNeverExpires,className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 disabled:opacity-50"})}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:i.genieLruCacheTtlNeverExpires,onChange:_=>u({...i,genieLruCacheTtlNeverExpires:_.target.checked}),className:"w-3 h-3 rounded border-slate-600 bg-slate-800 text-violet-500"}),s.jsx("span",{className:"text-xs text-slate-400",children:"Never expires"})]})]})]}),s.jsx($n,{label:"Warehouse",resourceType:"Warehouse",configuredOptions:q,configuredValue:i.genieLruCacheWarehouseRefName,onConfiguredChange:_=>u({...i,genieLruCacheWarehouseRefName:_,genieLruCacheWarehouseId:""}),source:i.genieLruCacheWarehouseSource,onSourceChange:_=>u({...i,genieLruCacheWarehouseSource:_}),hint:"SQL warehouse for cache operations",children:s.jsx(re,{label:"Warehouse ID",placeholder:"Enter warehouse ID",value:i.genieLruCacheWarehouseId,onChange:_=>u({...i,genieLruCacheWarehouseId:_.target.value,genieLruCacheWarehouseRefName:""})})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[s.jsx("input",{type:"checkbox",checked:i.genieSemanticCacheEnabled,onChange:_=>u({...i,genieSemanticCacheEnabled:_.target.checked}),className:"mt-0.5 w-4 h-4 rounded border-slate-600 bg-slate-800 text-violet-500 focus:ring-violet-500 focus:ring-offset-slate-900"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-slate-200 group-hover:text-white",children:"Enable Semantic Cache"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Cache results using vector similarity matching (requires Lakebase database)"})]})]}),i.genieSemanticCacheEnabled&&s.jsxs("div",{className:"ml-7 space-y-3 p-3 bg-slate-900/50 rounded-lg border border-slate-700/50",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(re,{label:"Similarity Threshold",type:"number",step:"0.01",min:"0",max:"1",value:i.genieSemanticCacheSimilarityThreshold.toString(),onChange:_=>u({...i,genieSemanticCacheSimilarityThreshold:parseFloat(_.target.value)||.85}),hint:"Min similarity for cache hit (0-1)"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"TTL (seconds)"}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("input",{type:"number",value:i.genieSemanticCacheTtlNeverExpires?"":i.genieSemanticCacheTtl,onChange:_=>u({...i,genieSemanticCacheTtl:parseInt(_.target.value)||86400}),disabled:i.genieSemanticCacheTtlNeverExpires,className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-violet-500 focus:ring-1 focus:ring-violet-500 disabled:opacity-50"})}),s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:i.genieSemanticCacheTtlNeverExpires,onChange:_=>u({...i,genieSemanticCacheTtlNeverExpires:_.target.checked}),className:"w-3 h-3 rounded border-slate-600 bg-slate-800 text-violet-500"}),s.jsx("span",{className:"text-xs text-slate-400",children:"Never expires"})]})]})]}),s.jsx($n,{label:"Embedding Model",resourceType:"LLM",configuredOptions:Y,configuredValue:i.genieSemanticCacheEmbeddingModelRefName,onConfiguredChange:_=>u({...i,genieSemanticCacheEmbeddingModelRefName:_,genieSemanticCacheEmbeddingModelManual:""}),source:i.genieSemanticCacheEmbeddingModelSource,onSourceChange:_=>u({...i,genieSemanticCacheEmbeddingModelSource:_}),hint:"Model for computing embeddings",children:s.jsx(re,{label:"Model Name",placeholder:"databricks-gte-large-en",value:i.genieSemanticCacheEmbeddingModelManual,onChange:_=>u({...i,genieSemanticCacheEmbeddingModelManual:_.target.value,genieSemanticCacheEmbeddingModelRefName:""}),hint:"Enter embedding model name manually"})}),s.jsx(re,{label:"Cache Table Name",placeholder:"genie_semantic_cache",value:i.genieSemanticCacheTableName,onChange:_=>u({...i,genieSemanticCacheTableName:_.target.value}),hint:"Table to store cache entries"}),s.jsx(le,{label:"Database (Lakebase)",value:i.genieSemanticCacheDatabaseRefName,onChange:_=>u({...i,genieSemanticCacheDatabaseRefName:_.target.value,genieSemanticCacheDatabaseSource:"configured"}),hint:"Lakebase database for semantic cache storage",options:se,placeholder:"Select configured database..."}),s.jsx($n,{label:"Warehouse",resourceType:"Warehouse",configuredOptions:q,configuredValue:i.genieSemanticCacheWarehouseRefName,onConfiguredChange:_=>u({...i,genieSemanticCacheWarehouseRefName:_,genieSemanticCacheWarehouseId:""}),source:i.genieSemanticCacheWarehouseSource,onSourceChange:_=>u({...i,genieSemanticCacheWarehouseSource:_}),hint:"SQL warehouse for cache operations",children:s.jsx(re,{label:"Warehouse ID",placeholder:"Enter warehouse ID",value:i.genieSemanticCacheWarehouseId,onChange:_=>u({...i,genieSemanticCacheWarehouseId:_.target.value,genieSemanticCacheWarehouseRefName:""})})})]})]})]})]}),i.functionName==="dao_ai.tools.create_vector_search_tool"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Vector Search Configuration"}),s.jsx($n,{label:"Retriever",resourceType:"Retriever",configuredOptions:Z,configuredValue:i.retrieverRefName,onConfiguredChange:_=>u({...i,retrieverRefName:_,vectorEndpoint:"",vectorIndex:""}),source:i.retrieverSource,onSourceChange:_=>u({...i,retrieverSource:_}),hint:i.retrieverSource==="configured"?"Use a pre-configured retriever from the Retrievers section":void 0,children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(Yp,{label:"Vector Search Endpoint",value:i.vectorEndpoint,onChange:_=>u({...i,vectorEndpoint:_,vectorIndex:"",retrieverRefName:""}),required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Vector Index"}),i.vectorEndpoint&&s.jsxs("button",{type:"button",onClick:()=>tt(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:Ve,children:[s.jsx(Ut,{className:`w-3 h-3 ${Ve?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(le,{options:fn,value:i.vectorIndex,onChange:_=>u({...i,vectorIndex:_.target.value}),disabled:!i.vectorEndpoint||Ve,required:!0})]})]})}),s.jsx("div",{className:"pt-2 border-t border-slate-700",children:s.jsx(re,{label:"Description",placeholder:"e.g., Search product documentation for answers",value:i.vectorSearchDescription,onChange:_=>u({...i,vectorSearchDescription:_.target.value}),hint:"Optional description for the tool (defaults to generic description)"})})]}),i.functionName==="dao_ai.tools.create_send_slack_message_tool"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Slack Message Tool Configuration"}),s.jsx($n,{label:"Slack Connection",resourceType:"Connection",configuredOptions:oe,configuredValue:i.slackConnectionRefName,onConfiguredChange:_=>u({...i,slackConnectionRefName:_}),source:i.slackConnectionSource,onSourceChange:_=>u({...i,slackConnectionSource:_}),hint:"Unity Catalog connection to Slack",children:s.jsx("p",{className:"text-sm text-slate-400",children:"Select a configured connection or create one in the Resources section"})}),s.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-700",children:[s.jsx("h5",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Channel Configuration"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Provide either a Channel ID or Channel Name. Channel ID is preferred if known."}),s.jsx(re,{label:"Channel ID",placeholder:"e.g., C1234567890",value:i.slackChannelId,onChange:_=>u({...i,slackChannelId:_.target.value}),hint:"Slack channel ID (e.g., C1234567890). Takes precedence over channel name."}),s.jsx(re,{label:"Channel Name",placeholder:"e.g., general or #general",value:i.slackChannelName,onChange:_=>u({...i,slackChannelName:_.target.value}),hint:"Slack channel name. Used to lookup channel ID if not provided above."})]})]}),i.functionName==="dao_ai.tools.create_agent_endpoint_tool"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Agent Endpoint Tool Configuration"}),s.jsx($n,{label:"LLM / Agent Endpoint",resourceType:"LLM",configuredOptions:Y,configuredValue:i.agentLlmRefName,onConfiguredChange:_=>u({...i,agentLlmRefName:_}),source:i.agentLlmSource,onSourceChange:_=>u({...i,agentLlmSource:_}),hint:"Select the LLM or agent endpoint to call",children:s.jsx("p",{className:"text-sm text-slate-400",children:"Configure an LLM in the Resources section, then select it here"})})]}),i.functionName==="custom"&&s.jsx(re,{label:"Custom Factory Function",placeholder:"e.g., my_package.tools.my_factory",value:i.customFunctionName,onChange:_=>u({...i,customFunctionName:_.target.value}),required:!0}),i.functionName==="custom"&&s.jsx(us,{label:"Arguments (JSON)",placeholder:'{"key": "value"}',value:i.args,onChange:_=>u({...i,args:_.target.value}),rows:6,hint:"JSON object passed to the factory function"})]}),i.type==="python"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Python Tool Function"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Python functions decorated with @tool that can be used directly as tools"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:Wu.map(_=>{const V=_.icon,W=i.functionName===_.value;return s.jsx("button",{type:"button",onClick:()=>{const K=_.value!=="custom"?jl(_.value):"";u({...i,functionName:_.value,customFunctionName:"",name:x?i.name:K,refName:p?i.refName:K})},className:`p-3 rounded-lg border text-left transition-all ${W?"border-violet-500 bg-violet-500/10":"border-slate-700 bg-slate-800/50 hover:border-slate-600"}`,children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(V,{className:`w-4 h-4 mt-0.5 ${W?"text-violet-400":"text-slate-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:`text-sm font-medium ${W?"text-violet-400":"text-slate-300"}`,children:_.label}),s.jsx("div",{className:"text-xs text-slate-500",children:_.description})]})]})},_.value)})})]}),i.functionName==="custom"&&s.jsx(re,{label:"Custom Python Function Path",placeholder:"e.g., my_package.tools.my_function",value:i.customFunctionName,onChange:_=>{const V=_.target.value,W=jl(V);u({...i,customFunctionName:V,name:x?i.name:W,refName:p?i.refName:W})},hint:"Fully qualified path to a Python function decorated with @tool",required:!0})]}),i.type==="unity_catalog"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Unity Catalog Function"}),s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Function Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>u({...i,functionSource:"configured",ucCatalog:"",ucSchema:"",ucFunction:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.functionSource==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>u({...i,functionSource:"select",functionRefName:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.functionSource==="select"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]})}),i.functionSource==="configured"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{options:[{value:"",label:"Select a configured function..."},...ce],value:i.functionRefName,onChange:_=>{const V=_.target.value,W=y[V],K=jl((W==null?void 0:W.name)||V);u({...i,functionRefName:V,ucFunction:"",ucCatalog:"",ucSchema:"",name:x?i.name:K,refName:p?i.refName:K})}}),ce.length===0&&s.jsx("p",{className:"text-xs text-amber-400",children:'No functions configured. Add one in Resources  Functions or switch to "Select".'}),s.jsx("p",{className:"text-xs text-slate-500",children:"Select a pre-configured function from the Resources section"})]}),i.functionSource==="select"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx($n,{label:"Schema",resourceType:"schema",configuredOptions:ee,configuredValue:i.schemaRefName,onConfiguredChange:_=>{const V=E[_];u({...i,schemaRefName:_,ucCatalog:(V==null?void 0:V.catalog_name)||"",ucSchema:(V==null?void 0:V.schema_name)||"",ucFunction:""})},source:i.schemaSource,onSourceChange:_=>u({...i,schemaSource:_}),children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Ei,{label:"Catalog",value:i.ucCatalog,onChange:_=>u({...i,ucCatalog:_,ucSchema:"",ucFunction:"",schemaRefName:""}),required:!0}),s.jsx(Ai,{label:"Schema",value:i.ucSchema,onChange:_=>u({...i,ucSchema:_,ucFunction:"",schemaRefName:""}),catalog:i.ucCatalog||null,required:!0})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Function"}),i.ucCatalog&&i.ucSchema||i.schemaRefName?s.jsxs("button",{type:"button",onClick:()=>ze(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:He,children:[s.jsx(Ut,{className:`w-3 h-3 ${He?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]}):null]}),s.jsx(le,{options:mn,value:i.ucFunction,onChange:_=>{const V=_.target.value,W=jl(V);u({...i,ucFunction:V,functionRefName:"",name:x?i.name:W,refName:p?i.refName:W})},disabled:(!i.ucCatalog||!i.ucSchema)&&!i.schemaRefName||He,required:!0}),He&&s.jsx("p",{className:"text-xs text-slate-500",children:"Loading functions..."}),!i.ucCatalog&&!i.ucSchema&&!i.schemaRefName&&s.jsx("p",{className:"text-xs text-slate-500",children:"Select a schema first to browse functions"})]})]}),s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"text-sm font-medium text-slate-300",children:"Partial Arguments"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Pre-fill function parameters with static values or variable references"})]}),s.jsxs("button",{type:"button",onClick:()=>u({...i,ucPartialArgs:[...i.ucPartialArgs,{id:`arg_${Date.now()}`,name:"",source:"manual",value:""}]}),className:"flex items-center space-x-1 text-xs text-violet-400 hover:text-violet-300 transition-colors",children:[s.jsx(Pe,{className:"w-3 h-3"}),s.jsx("span",{children:"Add Argument"})]})]}),i.ucPartialArgs.length===0?s.jsx("p",{className:"text-xs text-slate-500 italic",children:'No partial arguments configured. Click "Add Argument" to pre-fill function parameters.'}):s.jsx("div",{className:"space-y-3",children:i.ucPartialArgs.map((_,V)=>s.jsx("div",{className:"p-3 bg-slate-900/50 rounded-lg border border-slate-600 space-y-2",children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[s.jsx(re,{label:"Parameter Name",value:_.name,onChange:W=>{const K=[...i.ucPartialArgs];K[V]={..._,name:W.target.value},u({...i,ucPartialArgs:K})},placeholder:"e.g., host, client_id"}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Value Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-800 p-0.5 text-xs",children:[s.jsx("button",{type:"button",onClick:()=>{const W=[...i.ucPartialArgs];W[V]={..._,source:"manual",value:""},u({...i,ucPartialArgs:W})},className:`px-2 py-1 rounded font-medium transition-all ${_.source==="manual"?"bg-violet-500/20 text-violet-400":"text-slate-400 hover:text-slate-300"}`,children:"Manual"}),s.jsx("button",{type:"button",onClick:()=>{const W=[...i.ucPartialArgs];W[V]={..._,source:"variable",value:""},u({...i,ucPartialArgs:W})},className:`px-2 py-1 rounded font-medium transition-all ${_.source==="variable"?"bg-violet-500/20 text-violet-400":"text-slate-400 hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>{const W=[...i.ucPartialArgs];W[V]={..._,source:"service_principal",value:""},u({...i,ucPartialArgs:W})},className:`px-2 py-1 rounded font-medium transition-all ${_.source==="service_principal"?"bg-violet-500/20 text-violet-400":"text-slate-400 hover:text-slate-300"}`,children:"SP"})]})]}),_.source==="manual"&&s.jsx(re,{value:_.value,onChange:W=>{const K=[...i.ucPartialArgs];K[V]={..._,value:W.target.value},u({...i,ucPartialArgs:K})},placeholder:"Enter value..."}),_.source==="variable"&&s.jsx(le,{value:_.value,onChange:W=>{const K=[...i.ucPartialArgs];K[V]={..._,value:W.target.value},u({...i,ucPartialArgs:K})},options:Ne}),_.source==="service_principal"&&s.jsx(le,{value:_.value,onChange:W=>{const K=[...i.ucPartialArgs];K[V]={..._,value:W.target.value},u({...i,ucPartialArgs:K})},options:Ce})]})]}),s.jsx("button",{type:"button",onClick:()=>{const W=i.ucPartialArgs.filter(K=>K.id!==_.id);u({...i,ucPartialArgs:W})},className:"mt-6 p-1 text-slate-400 hover:text-red-400 transition-colors",children:s.jsx(Qe,{className:"w-4 h-4"})})]})},_.id))})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{type:"button",onClick:()=>w(!b),className:"flex items-center space-x-2 text-sm text-slate-400 hover:text-white transition-colors w-full",children:[b?s.jsx(Ur,{className:"w-4 h-4"}):s.jsx(rs,{className:"w-4 h-4"}),s.jsx(Cr,{className:"w-4 h-4"}),s.jsx("span",{children:"Human In The Loop"}),f.enabled&&s.jsx(Ee,{variant:"success",className:"ml-2",children:"Enabled"})]}),b&&s.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("input",{type:"checkbox",id:"hitlEnabled",checked:f.enabled,onChange:_=>g({...f,enabled:_.target.checked}),className:"mt-1 rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"hitlEnabled",className:"block text-sm font-medium text-slate-300 cursor-pointer",children:"Require Human Approval"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Pause execution and request human review before this tool runs."})]})]}),f.enabled&&s.jsxs(s.Fragment,{children:[s.jsx(re,{label:"Review Prompt",value:f.reviewPrompt,onChange:_=>g({...f,reviewPrompt:_.target.value}),placeholder:"Please review the tool call",hint:"Message shown to the reviewer"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Allowed Actions"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.allowAccept,onChange:_=>g({...f,allowAccept:_.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-green-500 focus:ring-green-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Accept"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.allowEdit,onChange:_=>g({...f,allowEdit:_.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Edit"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.allowRespond,onChange:_=>g({...f,allowRespond:_.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-yellow-500 focus:ring-yellow-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Respond"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.allowDecline,onChange:_=>g({...f,allowDecline:_.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Decline"})]})]})]}),s.jsx(re,{label:"Decline Message",value:f.declineMessage,onChange:_=>g({...f,declineMessage:_.target.value}),placeholder:"Tool call declined by user",hint:"Message returned when the user declines"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Custom Actions"}),s.jsxs(Q,{variant:"secondary",size:"sm",type:"button",onClick:()=>g({...f,customActions:[...f.customActions,{key:"",value:""}]}),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Action"]})]}),f.customActions.map((_,V)=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(re,{placeholder:"Action key",value:_.key,onChange:W=>{const K=[...f.customActions];K[V].key=W.target.value,g({...f,customActions:K})},className:"flex-1"}),s.jsx(re,{placeholder:"Action description",value:_.value,onChange:W=>{const K=[...f.customActions];K[V].value=W.target.value,g({...f,customActions:K})},className:"flex-1"}),s.jsx(Q,{variant:"ghost",size:"sm",type:"button",onClick:()=>{g({...f,customActions:f.customActions.filter((W,K)=>K!==V)})},children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]},V)),s.jsx("p",{className:"text-xs text-slate-500",children:"Custom actions allow you to define additional buttons/responses for the reviewer."})]})]})]})]}),i.type==="mcp"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"MCP Server Type"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:pC.map(_=>{const V=m.sourceType===_.value;return s.jsxs("button",{type:"button",onClick:()=>h({...m,sourceType:_.value}),className:`p-3 rounded-lg border text-left transition-all ${V?"border-purple-500 bg-purple-500/10":"border-slate-700 hover:border-slate-600 bg-slate-800/50"}`,children:[s.jsx("span",{className:`text-sm font-medium ${V?"text-white":"text-slate-300"}`,children:_.label}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:_.description})]},_.value)})})]}),s.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[m.sourceType==="url"&&s.jsx(re,{label:"MCP Server URL",placeholder:"https://your-workspace.databricks.net/api/2.0/mcp/...",value:m.url,onChange:_=>h({...m,url:_.target.value}),hint:"Full URL to the MCP server endpoint",required:!0}),m.sourceType==="genie"&&s.jsxs(s.Fragment,{children:[s.jsx($n,{label:"Genie Room",resourceType:"Genie room",configuredOptions:U,configuredValue:m.genieRefName,onConfiguredChange:_=>{const V=N[_];h({...m,genieRefName:_,genieSpaceId:"",genieName:(V==null?void 0:V.name)||_,genieDescription:(V==null?void 0:V.description)||""})},source:m.genieSource,onSourceChange:_=>h({...m,genieSource:_}),children:s.jsx(Gp,{value:m.genieSpaceId,onChange:_=>h({...m,genieSpaceId:_,genieRefName:""}),required:!0})}),s.jsx(re,{label:"Display Name",placeholder:"e.g., Retail Genie",value:m.genieName,onChange:_=>h({...m,genieName:_.target.value})}),s.jsx(re,{label:"Description (optional)",placeholder:"Query retail data using natural language",value:m.genieDescription,onChange:_=>h({...m,genieDescription:_.target.value})})]}),m.sourceType==="vector_search"&&s.jsx($n,{label:"Vector Store",resourceType:"Vector store",configuredOptions:B,configuredValue:m.vectorStoreRefName,onConfiguredChange:_=>{h({...m,vectorStoreRefName:_,vectorEndpoint:"",vectorIndex:"",vectorCatalog:"",vectorSchema:""})},source:m.vectorStoreSource,onSourceChange:_=>h({...m,vectorStoreSource:_}),children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Ei,{label:"Catalog",value:m.vectorCatalog,onChange:_=>h({...m,vectorCatalog:_,vectorSchema:"",vectorStoreRefName:""}),required:!0}),s.jsx(Ai,{label:"Schema",value:m.vectorSchema,onChange:_=>h({...m,vectorSchema:_,vectorStoreRefName:""}),catalog:m.vectorCatalog||null,required:!0})]}),s.jsx(Yp,{label:"Vector Search Endpoint",value:m.vectorEndpoint,onChange:_=>h({...m,vectorEndpoint:_,vectorIndex:"",vectorStoreRefName:""}),required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Vector Index"}),m.vectorEndpoint&&s.jsxs("button",{type:"button",onClick:()=>ge(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:Ft,children:[s.jsx(Ut,{className:`w-3 h-3 ${Ft?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(le,{options:Gt,value:m.vectorIndex,onChange:_=>h({...m,vectorIndex:_.target.value}),disabled:!m.vectorEndpoint||Ft,required:!0})]})]})}),m.sourceType==="functions"&&s.jsx($n,{label:"Schema",resourceType:"schema",configuredOptions:ee,configuredValue:m.schemaRefName,onConfiguredChange:_=>{const V=E[_];h({...m,schemaRefName:_,functionsCatalog:(V==null?void 0:V.catalog_name)||"",functionsSchema:(V==null?void 0:V.schema_name)||""})},source:m.schemaSource,onSourceChange:_=>h({...m,schemaSource:_}),children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Ei,{label:"Catalog",value:m.functionsCatalog,onChange:_=>h({...m,functionsCatalog:_,functionsSchema:"",schemaRefName:""}),required:!0}),s.jsx(Ai,{label:"Schema",value:m.functionsSchema,onChange:_=>h({...m,functionsSchema:_,schemaRefName:""}),catalog:m.functionsCatalog||null,required:!0})]})}),m.sourceType==="sql"&&s.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg",children:[s.jsxs("p",{className:"text-sm text-slate-300",children:[s.jsx("strong",{children:"Databricks SQL MCP"})," - Enables serverless SQL execution without requiring a warehouse."]}),s.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"The sql: true flag will be set automatically."})]}),m.sourceType==="connection"&&s.jsx($n,{label:"UC Connection",resourceType:"connection",configuredOptions:oe,configuredValue:m.connectionRefName,onConfiguredChange:_=>{const V=R[_];h({...m,connectionRefName:_,connectionName:(V==null?void 0:V.name)||""})},source:m.connectionSource,onSourceChange:_=>h({...m,connectionSource:_}),children:s.jsx(H2,{label:"Select Connection",value:m.connectionName,onChange:_=>h({...m,connectionName:_,connectionRefName:""}),required:!0})})]}),s.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Authentication"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:m.useCredentials,onChange:_=>h({...m,useCredentials:_.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Use credentials"})]})]}),m.useCredentials&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>h({...m,credentialsMode:"service_principal"}),className:`px-3 py-1.5 text-xs rounded-lg font-medium transition-colors ${m.credentialsMode==="service_principal"?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:"Configured Service Principal"}),s.jsx("button",{type:"button",onClick:()=>h({...m,credentialsMode:"manual"}),className:`px-3 py-1.5 text-xs rounded-lg font-medium transition-colors ${m.credentialsMode==="manual"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:"Manual Credentials"})]}),m.credentialsMode==="service_principal"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{label:"Service Principal",options:[{value:"",label:"Select a service principal..."},...Object.keys(e.service_principals||{}).map(_=>({value:_,label:_}))],value:m.servicePrincipalRef,onChange:_=>h({...m,servicePrincipalRef:_.target.value}),hint:"Reference a pre-configured service principal"}),Object.keys(e.service_principals||{}).length===0&&s.jsx("div",{className:"p-2 bg-amber-500/10 border border-amber-500/30 rounded text-amber-400 text-xs",children:"No service principals configured. Add one in Resources  Service Principals first."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client ID"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>h({...m,clientIdSource:"variable"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${m.clientIdSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>h({...m,clientIdSource:"manual"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${m.clientIdSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),m.clientIdSource==="variable"?s.jsx(le,{options:[{value:"",label:"Select a variable..."},...ae.map(_=>({value:_,label:`${_} (${Vt(G[_])})`}))],value:m.clientIdVar,onChange:_=>h({...m,clientIdVar:_.target.value}),hint:ae.length===0?"Define variables in the Variables section first":void 0}):s.jsx(re,{placeholder:"Enter client ID...",value:m.clientIdManual,onChange:_=>h({...m,clientIdManual:_.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client Secret"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>h({...m,clientSecretSource:"variable"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${m.clientSecretSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>h({...m,clientSecretSource:"manual"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${m.clientSecretSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),m.clientSecretSource==="variable"?s.jsx(le,{options:[{value:"",label:"Select a variable..."},...ae.map(_=>({value:_,label:`${_} (${Vt(G[_])})`}))],value:m.clientSecretVar,onChange:_=>h({...m,clientSecretVar:_.target.value}),hint:ae.length===0?"Define variables in the Variables section first":void 0}):s.jsx(re,{type:"password",placeholder:"Enter client secret...",value:m.clientSecretManual,onChange:_=>h({...m,clientSecretManual:_.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"text-sm font-medium text-slate-300",children:["Workspace Host ",s.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>h({...m,workspaceHostSource:"variable"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${m.workspaceHostSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>h({...m,workspaceHostSource:"manual"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${m.workspaceHostSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),m.workspaceHostSource==="variable"?s.jsx(le,{options:[{value:"",label:"Select a variable..."},...ae.map(_=>({value:_,label:`${_} (${Vt(G[_])})`}))],value:m.workspaceHostVar,onChange:_=>h({...m,workspaceHostVar:_.target.value}),hint:ae.length===0?"Define variables in the Variables section first":void 0}):s.jsx(re,{placeholder:"https://your-workspace.cloud.databricks.com",value:m.workspaceHostManual,onChange:_=>h({...m,workspaceHostManual:_.target.value})})]})]})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{l(!1),de()},children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:!i.name||i.type==="mcp"&&m.sourceType==="connection"&&!(m.connectionSource==="configured"&&m.connectionRefName||m.connectionSource==="select"&&m.connectionName),children:o?"Save Changes":"Add Tool"})]})]})})]})}async function gC(e){const t=await fetch("/api/ai/generate-guardrail-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate guardrail prompt")}return(await t.json()).prompt}const Gu=[{value:"accuracy",label:"Accuracy"},{value:"completeness",label:"Completeness"},{value:"clarity",label:"Clarity"},{value:"helpfulness",label:"Helpfulness"},{value:"safety",label:"Safety"},{value:"relevance",label:"Relevance"},{value:"tone",label:"Professional Tone"},{value:"no_hallucination",label:"No Hallucination"},{value:"pii_protection",label:"PII Protection"},{value:"bias_free",label:"Bias-Free"}],Yu=`You are an expert judge evaluating AI responses. Your task is to critique the AI assistant's latest response in the conversation below.

Evaluate the response based on these criteria:
1. Accuracy - Is the information correct and factual?
2. Completeness - Does it fully address the user's query?
3. Clarity - Is the explanation clear and well-structured?
4. Helpfulness - Does it provide actionable and useful information?
5. Safety - Does it avoid harmful or inappropriate content?

If the response meets ALL criteria satisfactorily, set pass to True.

If you find ANY issues with the response, do NOT set pass to True. Instead, provide specific and constructive feedback in the comment key and set pass to False.

### Inputs:
{inputs}

### Response:
{outputs}`;function vC(){var T;const{config:e,addGuardrail:t,updateGuardrail:n,removeGuardrail:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState({refName:"",name:"",modelKey:"",prompt:Yu,numRetries:"3"}),[m,h]=M.useState(!1),[f,g]=M.useState(!1),[b,w]=M.useState(""),[x,d]=M.useState(!1),[p,v]=M.useState(["accuracy","completeness","clarity","helpfulness","safety"]),[N,C]=M.useState(""),j=async(P=!1)=>{g(!0);try{const L=await gC({context:b||void 0,guardrail_name:i.name||void 0,evaluation_criteria:p.length>0?p:void 0,existing_prompt:P?i.prompt:void 0});u({...i,prompt:L}),d(!1),w("")}catch(L){console.error("Failed to generate guardrail prompt:",L),alert(L instanceof Error?L.message:"Failed to generate guardrail prompt")}finally{g(!1)}},E=()=>{N&&!p.includes(N)&&(v([...p,N]),C(""))},y=e.guardrails||{},R=((T=e.resources)==null?void 0:T.llms)||{},$=()=>{u({refName:"",name:"",modelKey:"",prompt:Yu,numRetries:"3"}),c(null),d(!1),w(""),v(["accuracy","completeness","clarity","helpfulness","safety"]),h(!1)},{scrollToAsset:k}=qn(),A=(P,L)=>{var O;k(P),c(P),h(!0);const I=((O=Object.entries(R).find(([,F])=>F.name===L.model.name))==null?void 0:O[0])||"";u({refName:P,name:L.name,modelKey:I,prompt:L.prompt,numRetries:String(L.num_retries??3)}),l(!0)},D=Object.entries(R).map(([P,L])=>({value:P,label:`${P} (${L.name})`})),S=P=>{if(P.preventDefault(),!(!i.refName.trim()||!i.name.trim())&&i.modelKey&&R[i.modelKey]){const L={name:i.name,model:R[i.modelKey],prompt:i.prompt,num_retries:parseInt(i.numRetries)},I=i.refName.trim();o?o!==I?(r(o),t(I,L)):n(I,L):t(I,L),$(),l(!1)}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Guardrails"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure safety checks and quality controls for agent responses"})]}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Guardrail"]})]}),Object.keys(y).length===0?s.jsxs(ke,{className:"text-center py-12",children:[s.jsx(Sr,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No guardrails configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Guardrails help ensure agent responses are safe, accurate, and helpful."}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Guardrail"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(y).map(([P,L])=>s.jsx(ke,{variant:"interactive",className:"group cursor-pointer",onClick:()=>A(P,L),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center flex-shrink-0",children:s.jsx(Sr,{className:"w-5 h-5 text-emerald-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:P}),P!==L.name&&s.jsxs("p",{className:"text-xs text-slate-500",children:["name: ",L.name]}),s.jsxs("p",{className:"text-sm text-slate-400",children:["Model: ",L.model.name]}),s.jsxs("p",{className:"text-xs text-slate-500 mt-2 line-clamp-2 font-mono",children:[L.prompt.substring(0,100),"..."]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(Ee,{variant:"success",children:["retries: ",L.num_retries??3]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:I=>{I.stopPropagation(),A(P,L)},title:"Edit guardrail",children:s.jsx(Bc,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:I=>{I.stopPropagation(),tn("Guardrail",P,()=>r(P))},title:"Delete guardrail",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]})},P))}),s.jsx(An,{isOpen:a,onClose:()=>{l(!1),$()},title:o?"Edit Guardrail":"Add Guardrail",description:o?"Modify the guardrail configuration":"Configure a safety check for agent responses",size:"lg",children:s.jsxs("form",{onSubmit:S,className:"space-y-4",children:[D.length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 text-amber-400 text-sm",children:"You need to add an LLM first before creating a guardrail."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., llm_judge_guardrail",value:i.refName,onChange:P=>{const L=Lt(P.target.value);u({...i,refName:L,name:!m&&i.name===i.refName?L:i.name}),h(!0)},hint:"YAML key (spaces become underscores)",required:!0}),s.jsx(le,{label:"Judge LLM",options:D,value:i.modelKey,onChange:P=>u({...i,modelKey:P.target.value}),placeholder:"Select an LLM...",required:!0})]}),s.jsx(re,{label:"Guardrail Name",placeholder:"e.g., llm_judge",value:i.name,onChange:P=>u({...i,name:P.target.value}),hint:"The name property inside the guardrail config (can differ from reference name)",required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Evaluation Prompt"})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>d(!x),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:f,children:[s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),i.prompt&&i.prompt!==Yu&&s.jsxs("button",{type:"button",onClick:()=>j(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:f,children:[f?s.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),x&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(kt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Guardrail Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"Describe what this guardrail should evaluate and I'll generate an optimized evaluation prompt."}),s.jsx(us,{value:b,onChange:P=>w(P.target.value),rows:2,placeholder:"e.g., This guardrail should check that responses don't contain harmful content and are factually accurate for a retail customer service agent..."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Evaluation Criteria"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Select what aspects the guardrail should evaluate"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Gu.map(P=>s.jsx("button",{type:"button",onClick:()=>{p.includes(P.value)?v(p.filter(L=>L!==P.value)):v([...p,P.value])},className:`px-2 py-1 text-xs rounded-md transition-all ${p.includes(P.value)?"bg-emerald-500/30 text-emerald-300 border border-emerald-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:P.label},P.value))}),p.filter(P=>!Gu.map(L=>L.value).includes(P)).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:p.filter(P=>!Gu.map(L=>L.value).includes(P)).map(P=>s.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-500/30 text-blue-300 border border-blue-500/50 flex items-center space-x-1",children:[s.jsx("span",{children:P}),s.jsx("button",{type:"button",onClick:()=>v(p.filter(L=>L!==P)),className:"hover:text-red-300",children:""})]},P))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:N,onChange:P=>C(P.target.value.replace(/[^a-z0-9_\s]/gi,"").toLowerCase()),placeholder:"Add custom criterion...",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-700 rounded-md text-slate-300 placeholder-slate-500 focus:border-purple-500 focus:outline-none",onKeyDown:P=>{P.key==="Enter"&&(P.preventDefault(),E())}}),s.jsx("button",{type:"button",onClick:E,disabled:!N,className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded-md hover:bg-slate-600 disabled:opacity-50",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:()=>{d(!1),w("")},disabled:f,children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>j(!1),disabled:f||p.length===0&&!b,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:f?s.jsxs(s.Fragment,{children:[s.jsx(xt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(kt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(us,{value:i.prompt,onChange:P=>u({...i,prompt:P.target.value}),rows:12,hint:"Use {inputs} and {outputs} placeholders for conversation context",required:!0})]}),s.jsx(re,{label:"Number of Retries",type:"number",min:"0",max:"10",value:i.numRetries,onChange:P=>u({...i,numRetries:P.target.value}),hint:"How many times to retry if evaluation fails"}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{l(!1),$()},children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:D.length===0,children:o?"Save Changes":"Add Guardrail"})]})]})})]})}const Jp=[{value:"memory",label:"In-Memory"},{value:"postgres",label:"Lakebase/PostgreSQL"}];function bC(){var se;const{config:e,updateMemory:t}=We(),n=e.memory,r=((se=e.resources)==null?void 0:se.databases)||{},{scrollToAsset:a}=qn(),[l,o]=M.useState(!1),[c,i]=M.useState(!1),u=z=>{if(!z)return"";for(const[G,J]of Object.entries(r))if(z.instance_name&&J.instance_name===z.instance_name||z.name&&J.name===z.name)return G;return""},[m,h]=M.useState("memory"),[f,g]=M.useState(!1),[b,w]=M.useState(!1),[x,d]=M.useState("memory"),[p,v]=M.useState("default_checkpointer"),[N,C]=M.useState(""),[j,E]=M.useState("memory"),[y,R]=M.useState("default_store"),[$,k]=M.useState(""),[A,D]=M.useState(1536),[S,T]=M.useState("{user_id}"),[P,L]=M.useState("databricks-gte-large-en"),I=()=>{h("memory"),g(!1),w(!1),d("memory"),v("default_checkpointer"),C(""),E("memory"),R("default_store"),k(""),D(1536),T("{user_id}"),L("databricks-gte-large-en")},O=z=>{var G;h(z.refName||"memory"),z.checkpointer?(g(!0),d(z.checkpointer.type||"memory"),v(z.checkpointer.name||"default_checkpointer"),C(u(z.checkpointer.database))):(g(!1),d("memory"),v("default_checkpointer"),C("")),z.store?(w(!0),E(z.store.type||"memory"),R(z.store.name||"default_store"),k(u(z.store.database)),D(z.store.dims||1536),T(z.store.namespace||"{user_id}"),L(((G=z.store.embedding_model)==null?void 0:G.name)||"databricks-gte-large-en")):(w(!1),E("memory"),R("default_store"),k(""),D(1536),T("{user_id}"),L("databricks-gte-large-en"))},[F,U]=M.useState(null);M.useEffect(()=>{const z=JSON.stringify(n);z!==F&&U(z)},[n,F]);const B=()=>{const G={refName:Mo(m)||"memory"};if(f){const J={name:p,type:x};if(x==="postgres"&&N){const ae=r[N];ae&&(J.database=ae)}G.checkpointer=J}if(b){const J={name:y,type:j};if(P&&(J.embedding_model={name:P,on_behalf_of_user:!1}),J.dims=A,S&&(J.namespace=S),j==="postgres"&&$){const ae=r[$];ae&&(J.database=ae)}G.store=J}return f||b?G:void 0},Z=()=>{I(),i(!1),o(!0)},ee=()=>{n&&(a(n.refName||"memory"),O(n),i(!0),o(!0))},ce=()=>{n&&tn("Memory",n.refName||"memory",()=>{t(void 0)})},oe=z=>{if(z.preventDefault(),!f&&!b)return;const G=B();t(G),o(!1)},Y=Object.keys(r),q=z=>{const G=[];return z.checkpointer&&G.push(`Checkpointer: ${z.checkpointer.type||"memory"}`),z.store&&G.push(`Store: ${z.store.type||"memory"}`),G.join("  ")||"No components configured"};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Memory Configuration"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure conversation persistence and long-term memory storage"})]}),!n&&s.jsxs(Q,{onClick:Z,children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Memory"]})]}),n?s.jsx(ke,{variant:"interactive",className:"group cursor-pointer",onClick:ee,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center",children:s.jsx(on,{className:"w-5 h-5 text-purple-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:n.refName||"memory"}),s.jsx("p",{className:"text-sm text-slate-400",children:q(n)})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[n.checkpointer&&s.jsxs(Ee,{variant:n.checkpointer.type==="postgres"?"success":"warning",children:[s.jsx(tm,{className:"w-3 h-3 mr-1"}),"Checkpointer"]}),n.store&&s.jsxs(Ee,{variant:n.store.type==="postgres"?"success":"warning",children:[s.jsx(on,{className:"w-3 h-3 mr-1"}),"Store"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:z=>{z.stopPropagation(),ee()},children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:z=>{z.stopPropagation(),ce()},children:s.jsx(Qe,{className:"w-4 h-4"})})]})]})}):s.jsxs(ke,{className:"text-center py-12",children:[s.jsx(on,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No memory configured"}),s.jsx("p",{className:"text-slate-500 mb-4 max-w-md mx-auto",children:"Memory enables conversation persistence and long-term context storage for your agents."}),s.jsxs(Q,{onClick:Z,children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Memory Configuration"]})]}),s.jsx(An,{isOpen:l,onClose:()=>o(!1),title:c?"Edit Memory Configuration":"Add Memory Configuration",description:"Configure conversation persistence and long-term memory storage",size:"lg",children:s.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[s.jsx(re,{label:"Reference Name",value:m,onChange:z=>h(Lt(z.target.value)),placeholder:"memory",hint:`Used as the YAML anchor (e.g., &${m||"memory"}) for referencing this memory configuration`,disabled:c}),s.jsx("div",{className:"p-4 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Ka,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-300",children:[s.jsx("p",{className:"font-medium",children:"Memory Components"}),s.jsxs("ul",{className:"mt-2 space-y-1 text-blue-400/80",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Checkpointer"}),": Saves conversation state for resumable sessions"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Store"}),": Long-term semantic memory with embeddings for context"]})]}),Y.length===0&&s.jsxs("p",{className:"mt-3 text-amber-400",children:[" No databases configured. Add a database in ",s.jsx("strong",{children:"Resources  Databases"})," for persistent storage."]})]})]})}),s.jsxs("div",{className:"p-5 bg-slate-800/50 border border-slate-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(tm,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Checkpointer"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f,onChange:z=>g(z.target.checked),className:"rounded border-slate-600 bg-slate-800 text-purple-500 focus:ring-purple-500"}),s.jsx("span",{className:"text-sm text-slate-300",children:"Enable"})]})]}),f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-400",children:"Saves conversation state between messages for resumable sessions."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Name",value:p,onChange:z=>v(z.target.value),placeholder:"default_checkpointer"}),s.jsx(le,{label:"Storage Type",value:x,onChange:z=>d(z.target.value),options:Jp})]}),x==="memory"&&s.jsx("div",{className:"p-3 bg-amber-900/20 border border-amber-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-amber-300",children:[s.jsx("strong",{children:"In-Memory Storage:"})," Data lost on restart. Best for development."]})}),x==="postgres"&&s.jsxs(s.Fragment,{children:[s.jsx(le,{label:"Database",value:N,onChange:z=>C(z.target.value),options:[{value:"",label:"Select a database..."},...Y.map(z=>({value:z,label:z}))],hint:Y.length===0?"Add a database in Resources  Databases":void 0}),s.jsx("div",{className:"p-3 bg-emerald-900/20 border border-emerald-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-emerald-300",children:[s.jsx("strong",{children:"Persistent Storage:"})," Data persists across restarts. Recommended for production."]})})]})]})]}),s.jsxs("div",{className:"p-5 bg-slate-800/50 border border-slate-700 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(on,{className:"w-5 h-5 text-cyan-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Long-Term Memory Store"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:b,onChange:z=>w(z.target.checked),className:"rounded border-slate-600 bg-slate-800 text-cyan-500 focus:ring-cyan-500"}),s.jsx("span",{className:"text-sm text-slate-300",children:"Enable"})]})]}),b&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-400",children:"Semantic memory storage with embeddings for persistent context."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Name",value:y,onChange:z=>R(z.target.value),placeholder:"default_store"}),s.jsx(le,{label:"Storage Type",value:j,onChange:z=>E(z.target.value),options:Jp})]}),j==="memory"&&s.jsx("div",{className:"p-3 bg-amber-900/20 border border-amber-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-amber-300",children:[s.jsx("strong",{children:"In-Memory Storage:"})," Data lost on restart. Best for development."]})}),j==="postgres"&&s.jsxs(s.Fragment,{children:[s.jsx(le,{label:"Database",value:$,onChange:z=>k(z.target.value),options:[{value:"",label:"Select a database..."},...Y.map(z=>({value:z,label:z}))],hint:Y.length===0?"Add a database in Resources  Databases":void 0}),s.jsx("div",{className:"p-3 bg-emerald-900/20 border border-emerald-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-emerald-300",children:[s.jsx("strong",{children:"Persistent Storage:"})," Data persists across restarts. Recommended for production."]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Embedding Model",value:P,onChange:z=>L(z.target.value),placeholder:"databricks-gte-large-en",hint:"Databricks serving endpoint for embeddings"}),s.jsx(re,{label:"Embedding Dimensions",type:"number",value:A,onChange:z=>D(parseInt(z.target.value)||1536),hint:"Usually 1536 for GTE-Large"})]}),s.jsx(re,{label:"Namespace Template",value:S,onChange:z=>T(z.target.value),placeholder:"{user_id}",hint:"Template for partitioning memories. Use {user_id}, {thread_id}, etc."})]})]}),!f&&!b&&s.jsx("div",{className:"p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:s.jsx("p",{className:"text-sm text-red-400",children:"Please enable at least one memory component (Checkpointer or Store)."})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-slate-700",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>o(!1),children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:!f&&!b,children:c?"Save Changes":"Add Memory"})]})]})})]})}async function yC(e){const t=await fetch("/api/ai/generate-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate prompt")}return(await t.json()).prompt}const qu=[{value:"user_id",label:"User ID"},{value:"store_num",label:"Store Number"},{value:"session_id",label:"Session ID"},{value:"context",label:"Context"},{value:"current_date",label:"Current Date"},{value:"user_name",label:"User Name"},{value:"location",label:"Location"}],Xu=`### User Information
- **User Id**: {user_id}
- **Store Number**: {store_num}

You are a helpful assistant. Your role is to provide accurate and useful information.

#### Response Guidelines
- Be clear and concise
- Provide helpful examples when appropriate
- Always prioritize user safety
`;function e0(e){return Mo(e)}function NC(){const{config:e,addPrompt:t,updatePrompt:n,removePrompt:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),[i,u]=M.useState("new"),[m,h]=M.useState("reference"),[f,g]=M.useState(!1),[b,w]=M.useState("configured"),[x,d]=M.useState(""),[p,v]=M.useState(""),[N,C]=M.useState(""),[j,E]=M.useState({refName:"",name:"",description:"",default_template:Xu,alias:"",version:"",schemaRef:"",catalog_name:"",schema_name:"",tags:{},existingPromptFullName:""}),[y,R]=M.useState(""),[$,k]=M.useState(""),[A,D]=M.useState(!1),[S,T]=M.useState(!0),[P,L]=M.useState(!1),[I,O]=M.useState(null),[F,U]=M.useState(null),[B,Z]=M.useState(!1),[ee,ce]=M.useState(""),[oe,Y]=M.useState(!1),[q,se]=M.useState(["user_id","store_num"]),[z,G]=M.useState(""),J=async(X=!1)=>{Z(!0);try{const ne=await yC({context:ee||void 0,agent_name:j.name||void 0,agent_description:j.description||void 0,existing_prompt:X?j.default_template:void 0,template_parameters:q.length>0?q:void 0});E({...j,default_template:ne}),Y(!1),ce("")}catch(ne){console.error("Failed to generate prompt:",ne),alert(ne instanceof Error?ne.message:"Failed to generate prompt")}finally{Z(!1)}},ae=()=>{z&&!q.includes(z)&&(se([...q,z]),G(""))},je=e.prompts||{},Ne=e.schemas||{},Ce=e.service_principals||{},Me=e.variables||{},{data:He}=Tr(),{data:ze,loading:$e}=as(j.catalog_name||null),Ve=M.useMemo(()=>{const X=ne=>{if(typeof ne!="string"||!ne.startsWith("*"))return ne;const ve=ne.slice(1),pe=Me[ve];return pe||ne};if(b==="configured"&&x&&Ce[x]){const ne=Ce[x];return{client_id:X(ne.client_id),client_secret:X(ne.client_secret)}}return b==="manual"&&p&&N?{client_id:p,client_secret:N}:null},[b,x,Ce,Me,p,N]),{data:tt,loading:gt,refetch:Ft}=V2(j.catalog_name||null,j.schema_name||null,Ve),{data:ge,loading:Rt}=z2(j.existingPromptFullName||null,Ve),[wt,nt]=M.useState(null),de=M.useMemo(()=>{const X=(ge==null?void 0:ge.aliases)||[],ne=(ge==null?void 0:ge.alias_versions)||{};if(X.length===0)return[{value:"",label:"No aliases available"}];const ve=[...X].sort((pe,H)=>{if(pe==="champion")return-1;if(H==="champion")return 1;if(pe==="latest")return-1;if(H==="latest")return 1;const te=parseInt(ne[pe]||"0");return parseInt(ne[H]||"0")-te});return[{value:"",label:"Select an alias..."},...ve.map(pe=>({value:pe,label:pe}))]},[ge==null?void 0:ge.aliases,ge==null?void 0:ge.alias_versions]),vt=M.useMemo(()=>{const X=(ge==null?void 0:ge.versions)||[];if(X.length===0)return[{value:"",label:"No versions available"}];const ne=[...X].sort((ve,pe)=>{const H=parseInt(ve.version)||0;return(parseInt(pe.version)||0)-H});return[{value:"",label:"Select a version..."},...ne.map(ve=>({value:ve.version,label:`v${ve.version}${ve.aliases&&ve.aliases.length>0?` (${ve.aliases.join(", ")})`:""}`}))]},[ge==null?void 0:ge.versions]);M.useEffect(()=>{var te;if(!ge||!j.existingPromptFullName||ge.full_name!==j.existingPromptFullName)return;const X=ge.aliases||[],ne=ge.alias_versions||{},ve=ge.versions||[];let pe="",H="";X.includes("champion")?(pe="champion",H=ne.champion||""):X.includes("latest")?(pe="latest",H=ne.latest||""):ve.length>0&&(H=((te=[...ve].sort((V,W)=>(parseInt(W.version)||0)-(parseInt(V.version)||0))[0])==null?void 0:te.version)||"",pe=""),(pe!==j.alias||H!==j.version)&&E(_=>({..._,alias:pe,version:H}))},[ge,j.existingPromptFullName]),M.useEffect(()=>{if(!j.existingPromptFullName||!ge||ge.full_name!==j.existingPromptFullName||!j.version&&!j.alias)return;(async()=>{D(!0),nt(null);try{const ne=j.version||void 0,ve=!ne&&j.alias?j.alias:void 0,pe=await $t.getPromptTemplate(j.existingPromptFullName,ne,ve,Ve);pe!=null&&pe.error?pe.alias_not_found?nt(`Alias '${j.alias}' does not exist for this prompt. Try 'latest' or select a specific version.`):pe.version_not_found?nt(`Version ${j.version} does not exist for this prompt.`):nt(pe.error):pe!=null&&pe.template?E(H=>({...H,default_template:pe.template,version:pe.version||H.version||""})):nt("No template returned from server")}catch(ne){const ve=ne instanceof Error?ne.message:"Failed to load prompt template";nt(ve),console.error("[PromptsSection] Error loading prompt template:",ne)}finally{D(!1)}})()},[j.existingPromptFullName,j.version,j.alias,ge==null?void 0:ge.full_name]),M.useEffect(()=>{ge&&j.existingPromptFullName&&E(X=>({...X,tags:ge.tags||{},description:ge.description||X.description,version:X.version||"",default_template:ge.template||X.default_template}))},[ge,j.existingPromptFullName]);const Mt=()=>{E({refName:"",name:"",description:"",default_template:Xu,alias:"",version:"",schemaRef:"",catalog_name:"",schema_name:"",tags:{},existingPromptFullName:""}),u("new"),h("reference"),R(""),k(""),c(null),g(!1),O(null),U(null),T(!0)},Pt=X=>{const ne=Ne[X];ne&&E({...j,schemaRef:X,catalog_name:ne.catalog_name,schema_name:ne.schema_name,existingPromptFullName:"",name:"",refName:""})},sn=X=>{const ne=tt==null?void 0:tt.find(ve=>ve.full_name===X);if(ne){const ve=f?j.refName:e0(ne.name);E({...j,existingPromptFullName:X,name:ne.name,refName:ve,description:ne.description||"",alias:"",version:"",tags:ne.tags||{}}),nt(null)}},{scrollToAsset:In}=qn(),mn=X=>{var _;In(X);const ne=je[X];let ve="",pe="",H="",te="direct";if(ne.schema){const V=Object.entries(Ne).find(([,W])=>{var K,me;return W.catalog_name===((K=ne.schema)==null?void 0:K.catalog_name)&&W.schema_name===((me=ne.schema)==null?void 0:me.schema_name)});V?(ve=V[0],te="reference"):(pe=ne.schema.catalog_name||"",H=ne.schema.schema_name||"",te="direct")}u("new"),h(te),g(!0),E({refName:X,name:ne.name,description:ne.description||"",default_template:ne.default_template||"",alias:ne.alias||"",version:((_=ne.version)==null?void 0:_.toString())||"",schemaRef:ve,catalog_name:pe,schema_name:H,tags:ne.tags||{},existingPromptFullName:""}),c(X),l(!0)},fn=async X=>{if(X.preventDefault(),!j.refName||!j.name)return;const ne=Mo(j.name);if(!ne)return;O(null),U(null);let ve,pe="",H="";m==="reference"&&j.schemaRef&&Ne[j.schemaRef]?(ve=Ne[j.schemaRef],pe=ve.catalog_name,H=ve.schema_name):j.catalog_name&&j.schema_name&&(ve={catalog_name:j.catalog_name,schema_name:j.schema_name},pe=j.catalog_name,H=j.schema_name);const te=S&&i==="new"&&!o&&pe&&H&&j.default_template;let _;if(te){L(!0);try{const W=await $t.registerPrompt(ne,pe,H,j.default_template,j.description||void 0,j.alias||void 0,Object.keys(j.tags).length>0?j.tags:void 0,Ve);if(!W.success){O(W.error||"Failed to register prompt in registry"),L(!1);return}_=W.version,U(W.message||`Registered prompt version ${W.version}`)}catch(W){const K=W instanceof Error?W.message:"Unknown error during registration";O(K),L(!1);return}L(!1)}const V={name:ne,schema:ve,description:j.description||void 0,default_template:j.default_template||void 0,...S&&{alias:j.alias||void 0,version:_??(j.version?parseInt(j.version):void 0)},tags:Object.keys(j.tags).length>0?j.tags:void 0};o?(o!==j.refName&&r(o),n(j.refName,V)):t(j.refName,V),Mt(),l(!1)},Gt=()=>{y&&$&&(E({...j,tags:{...j.tags,[y]:$}}),R(""),k(""))},Vt=X=>{const ne={...j.tags};delete ne[X],E({...j,tags:ne})},Yt=Object.keys(Ce).length>0;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Prompts"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure reusable prompts for agents with MLflow Prompt Registry integration"})]}),s.jsxs(Q,{onClick:()=>{Mt(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Prompt"]})]}),s.jsxs(ke,{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-white mb-1",children:"Prompt Registry Authentication"}),s.jsx("p",{className:"text-xs text-slate-400",children:"Service principal used for all prompt registry operations (browsing, fetching templates)"})]}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>w("configured"),className:`px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${b==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>w("manual"),className:`px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${b==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]}),b==="configured"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("select",{value:x,onChange:X=>d(X.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:ring-2 focus:ring-violet-500",children:[s.jsx("option",{value:"",children:"Select a service principal..."}),Object.keys(Ce).map(X=>s.jsx("option",{value:X,children:X},X))]}),!Yt&&s.jsx("p",{className:"text-xs text-amber-400/70",children:"No service principals configured. Add them in Resources  Service Principals."})]}),b==="manual"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Client ID"}),s.jsx("input",{type:"text",value:p,onChange:X=>v(X.target.value),placeholder:"Enter client ID...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Client Secret"}),s.jsx("input",{type:"password",value:N,onChange:X=>C(X.target.value),placeholder:"Enter client secret...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-violet-500"})]})]}),Ve&&s.jsx("p",{className:"text-xs text-emerald-400",children:" Custom authentication configured"})]}),Object.keys(je).length===0?s.jsxs(ke,{className:"text-center py-12",children:[s.jsx(Qa,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No prompts configured"}),s.jsx("p",{className:"text-slate-500 mb-4 max-w-md mx-auto",children:'Prompts define agent behavior and can be version-controlled through MLflow Prompt Registry. Use aliases like "production" or "staging" for environment management.'}),s.jsxs(Q,{onClick:()=>{Mt(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Prompt"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(je).map(([X,ne])=>s.jsx(ke,{variant:"interactive",className:"group cursor-pointer",onClick:()=>mn(X),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-violet-500/20 flex items-center justify-center flex-shrink-0",children:s.jsx(Qa,{className:"w-5 h-5 text-violet-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h3",{className:"font-medium text-white",children:X}),ne.alias&&s.jsxs(Ee,{variant:"info",children:[s.jsx(Ro,{className:"w-3 h-3 mr-1"}),"@",ne.alias]}),ne.version&&s.jsxs(Ee,{variant:"default",children:[s.jsx(nm,{className:"w-3 h-3 mr-1"}),"v",ne.version]})]}),s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:ne.schema?`${ne.schema.catalog_name}.${ne.schema.schema_name}.${ne.name}`:ne.name}),ne.description&&s.jsx("p",{className:"text-xs text-slate-500 mt-1 line-clamp-2",children:ne.description}),ne.tags&&Object.keys(ne.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Object.entries(ne.tags).map(([ve,pe])=>s.jsxs("span",{className:"px-2 py-0.5 bg-slate-700/50 rounded text-xs text-slate-400",children:[s.jsx(om,{className:"w-3 h-3 inline mr-1"}),ve,": ",pe]},ve))})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",onClick:ve=>ve.stopPropagation(),children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>mn(X),title:"Edit prompt",children:s.jsx(On,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:()=>{tn("Prompt",X,()=>r(X))},title:"Delete prompt",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]})},X))}),s.jsx(An,{isOpen:a,onClose:()=>{Mt(),l(!1)},title:o?"Edit Prompt":"Add Prompt",description:"Configure a reusable prompt for agents",size:"xl",children:s.jsxs("form",{onSubmit:fn,className:"space-y-4",children:[!o&&s.jsxs("div",{className:"flex items-center justify-center space-x-4 p-3 bg-slate-800/50 rounded-lg",children:[s.jsxs("button",{type:"button",onClick:()=>{u("new"),E({...j,existingPromptFullName:""})},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${i==="new"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:[s.jsx(Pe,{className:"w-4 h-4"}),s.jsx("span",{children:"New Prompt"})]}),s.jsxs("button",{type:"button",onClick:()=>{u("existing")},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${i==="existing"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:[s.jsx(Rv,{className:"w-4 h-4"}),s.jsx("span",{children:"Existing Prompt"})]})]}),i==="existing"&&!o&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/30 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Select Existing Prompt from MLflow Registry"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema"}),s.jsx("div",{className:"flex space-x-2",children:s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{h("reference"),g(!1),E({...j,catalog_name:"",schema_name:"",existingPromptFullName:"",name:"",refName:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{h("direct"),g(!1),E({...j,schemaRef:"",existingPromptFullName:"",name:"",refName:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})}),m==="reference"?s.jsx(le,{label:"Schema Reference",value:j.schemaRef,onChange:X=>Pt(X.target.value),options:[{value:"",label:"Select a configured schema..."},...Object.entries(Ne).map(([X,ne])=>({value:X,label:`${X} (${ne.catalog_name}.${ne.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:j.catalog_name,onChange:X=>E({...j,catalog_name:X.target.value,schema_name:"",existingPromptFullName:"",name:"",refName:""}),options:[{value:"",label:"Select catalog..."},...(He||[]).map(X=>({value:X.name,label:X.name}))]}),s.jsx(le,{label:"Schema",value:j.schema_name,onChange:X=>E({...j,schema_name:X.target.value,existingPromptFullName:"",name:"",refName:""}),options:[{value:"",label:$e?"Loading...":"Select schema..."},...(ze||[]).map(X=>({value:X.name,label:X.name}))],disabled:!j.catalog_name||$e})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Available Prompts"}),j.catalog_name&&j.schema_name||j.schemaRef?s.jsxs("button",{type:"button",onClick:()=>Ft(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:gt,children:[s.jsx(Ut,{className:`w-3 h-3 ${gt?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]}):null]}),s.jsx(le,{value:j.existingPromptFullName,onChange:X=>sn(X.target.value),options:[{value:"",label:gt?"Loading prompts...":"Select a prompt..."},...(tt||[]).map(X=>({value:X.full_name,label:`${X.name}${X.description?` - ${X.description.substring(0,50)}${X.description.length>50?"...":""}`:""}`}))],disabled:(!j.catalog_name||!j.schema_name)&&!j.schemaRef||gt}),(j.catalog_name&&j.schema_name||j.schemaRef)&&!gt&&(!tt||tt.length===0)&&s.jsx("p",{className:"text-xs text-amber-400",children:"No prompts found in this schema. Try selecting a different schema or create a new prompt."})]}),j.existingPromptFullName&&s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Version & Alias"}),(Rt||A)&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[s.jsx(Ut,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:A?"Loading template...":"Loading details..."})]})]}),wt&&s.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:s.jsx("p",{className:"text-xs text-red-400",children:wt})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Alias",value:j.alias,onChange:X=>{nt(null);const ne=X.target.value,ve=ge==null?void 0:ge.alias_versions;let pe="";ne&&ve&&ve[ne]?pe=ve[ne]:ne==="latest"&&(ge!=null&&ge.latest_version)&&(pe=ge.latest_version),E({...j,alias:ne,version:pe})},options:de,hint:"Select an alias configured for this prompt"}),s.jsx(le,{label:"Version",value:j.version,onChange:X=>{nt(null);const ne=X.target.value,ve=ge==null?void 0:ge.alias_versions;let pe="";if(ne&&ve){for(const[H,te]of Object.entries(ve))if(te===ne){pe=H;break}}E({...j,version:ne,alias:pe})},options:vt,hint:"Pin to a specific version number"})]}),(j.alias||j.version)&&!wt&&!A&&s.jsxs("p",{className:"text-xs text-emerald-400",children:[" Using ",j.alias&&j.version?`alias: ${j.alias} (v${j.version})`:j.alias?`alias: ${j.alias}`:`version: v${j.version}`]})]})]}),s.jsx(re,{label:"Reference Name",placeholder:"e.g., General Prompt",value:j.refName,onChange:X=>{E({...j,refName:Lt(X.target.value)}),g(!0)},hint:"Type naturally - spaces become underscores",required:!0}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(re,{label:"Prompt Name",placeholder:"e.g., My New Prompt",value:j.name,onChange:X=>{const ne=X.target.value,ve=Lt(ne);E({...j,name:ve,refName:!o&&!f?e0(ve):j.refName})},hint:"Type naturally - spaces become underscores",required:!0,disabled:i==="existing"&&!!j.existingPromptFullName}),j.name&&j.name.endsWith("_")&&s.jsx("p",{className:"text-xs text-slate-400",children:"Continue typing to complete the name..."})]}),s.jsx(re,{label:"Description",placeholder:"e.g., General retail store assistant prompt",value:j.description,onChange:X=>E({...j,description:X.target.value}),hint:"Used as commit message when syncing to MLflow registry"}),i==="new"&&!o&&s.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-slate-800/50 rounded-lg",children:[s.jsx("input",{type:"checkbox",id:"saveToRegistry",checked:S,onChange:X=>T(X.target.checked),className:"w-4 h-4 rounded border-slate-600 bg-slate-800 text-violet-500 focus:ring-violet-500 focus:ring-offset-0"}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"saveToRegistry",className:"text-sm font-medium text-slate-300 cursor-pointer",children:"Save to Prompt Registry"}),s.jsx("p",{className:"text-xs text-slate-500",children:S?"Prompt will be registered in MLflow with versioning and the configured alias":"Only the default_template will be saved to YAML (no registry, no alias)"})]})]}),i==="new"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema (Optional)"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{h("reference"),E({...j,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{h("direct"),E({...j,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]}),m==="reference"?s.jsx(le,{label:"Schema Reference",value:j.schemaRef,onChange:X=>E({...j,schemaRef:X.target.value}),options:[{value:"",label:"Select a configured schema..."},...Object.entries(Ne).map(([X,ne])=>({value:X,label:`${X} (${ne.catalog_name}.${ne.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:j.catalog_name,onChange:X=>E({...j,catalog_name:X.target.value,schema_name:""}),options:[{value:"",label:"Select catalog..."},...(He||[]).map(X=>({value:X.name,label:X.name}))]}),s.jsx(le,{label:"Schema",value:j.schema_name,onChange:X=>E({...j,schema_name:X.target.value}),options:[{value:"",label:$e?"Loading schemas...":"Select schema..."},...(ze||[]).map(X=>({value:X.name,label:X.name}))],disabled:!j.catalog_name||$e})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Associate prompt with a Unity Catalog schema for the full name (catalog.schema.prompt_name)"})]})]}),i==="new"&&S&&s.jsxs("div",{children:[s.jsx(re,{label:"Alias (Optional)",placeholder:"e.g., champion, production, staging",value:j.alias,onChange:X=>E({...j,alias:X.target.value}),hint:"Set an alias for this prompt version (e.g., champion, default)"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Version is auto-assigned when registering a new prompt. Use alias to reference specific versions."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:i==="existing"?"Template":"Default Template"}),s.jsx("div",{className:"flex items-center space-x-2",children:A&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[s.jsx(Ut,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:"Loading template..."})]})})]}),i==="new"&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>Y(!oe),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:B,children:[s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),j.default_template&&j.default_template!==Xu&&s.jsxs("button",{type:"button",onClick:()=>J(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:B,children:[B?s.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),i==="new"&&oe&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(kt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"Describe what this prompt should do and I'll generate an optimized template for you."}),s.jsx(us,{value:ee,onChange:X=>ce(X.target.value),rows:3,placeholder:"e.g., This prompt is for a product specialist agent that helps customers find and compare products. It should include instructions for tool usage and customer service best practices..."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Template Parameters"}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select variables to include in the prompt (e.g., ","{user_id}",")"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:qu.map(X=>s.jsx("button",{type:"button",onClick:()=>{q.includes(X.value)?se(q.filter(ne=>ne!==X.value)):se([...q,X.value])},className:`px-2 py-1 text-xs rounded-md transition-all ${q.includes(X.value)?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:X.label},X.value))}),q.filter(X=>!qu.map(ne=>ne.value).includes(X)).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:q.filter(X=>!qu.map(ne=>ne.value).includes(X)).map(X=>s.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-500/30 text-blue-300 border border-blue-500/50 flex items-center space-x-1",children:[s.jsx("span",{children:X}),s.jsx("button",{type:"button",onClick:()=>se(q.filter(ne=>ne!==X)),className:"hover:text-red-300",children:""})]},X))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:z,onChange:X=>G(X.target.value.replace(/[^a-z0-9_]/gi,"_").toLowerCase()),placeholder:"Add custom parameter...",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-700 rounded-md text-slate-300 placeholder-slate-500 focus:border-purple-500 focus:outline-none",onKeyDown:X=>{X.key==="Enter"&&(X.preventDefault(),ae())}}),s.jsx("button",{type:"button",onClick:ae,disabled:!z,className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded-md hover:bg-slate-600 disabled:opacity-50",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:()=>{Y(!1),ce("")},disabled:B,children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>J(!1),disabled:B||!ee&&!j.name&&!j.description,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:B?s.jsxs(s.Fragment,{children:[s.jsx(xt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(kt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(us,{value:j.default_template,onChange:X=>i==="new"&&E({...j,default_template:X.target.value}),rows:10,readOnly:i==="existing",className:i==="existing"?"bg-slate-800/50 cursor-not-allowed":"",hint:i==="existing"?"Template loaded from MLflow registry (read-only).":"Fallback template if MLflow registry is unavailable. Use {variable_name} for substitutions."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Tags"}),Object.keys(j.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(j.tags).map(([X,ne])=>s.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-slate-700/50 rounded text-sm",children:[s.jsx(om,{className:"w-3 h-3 text-slate-400"}),s.jsxs("span",{className:"text-slate-300",children:[X,":"]}),s.jsx("span",{className:"text-slate-400",children:ne}),s.jsx("button",{type:"button",onClick:()=>Vt(X),className:"ml-1 text-slate-500 hover:text-red-400",children:""})]},X))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(re,{placeholder:"Key (e.g., environment)",value:y,onChange:X=>R(X.target.value),className:"flex-1"}),s.jsx(re,{placeholder:"Value (e.g., production)",value:$,onChange:X=>k(X.target.value),className:"flex-1"}),s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:Gt,disabled:!y||!$,children:s.jsx(Pe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Metadata tags for organization and filtering in MLflow"})]}),Ve&&s.jsxs("div",{className:"p-3 bg-violet-500/10 border border-violet-500/20 rounded-lg",children:[s.jsx("p",{className:"text-xs text-violet-300",children:b==="configured"?s.jsxs(s.Fragment,{children:["Using service principal: ",s.jsx("span",{className:"font-medium",children:x})]}):s.jsx(s.Fragment,{children:"Using manual credentials"})}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Change this in the Prompt Registry Authentication section above."})]}),I&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:[s.jsx("p",{className:"text-sm text-red-400 font-medium",children:"Registration Failed"}),s.jsx("p",{className:"text-xs text-red-300 mt-1",children:I})]}),F&&s.jsx("div",{className:"p-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-emerald-400",children:[" ",F]})}),i==="new"&&!o&&(j.catalog_name||j.schemaRef)&&j.name&&j.default_template&&s.jsx("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:s.jsxs("p",{className:"text-xs text-blue-300",children:[s.jsx("span",{className:"font-medium",children:"Registry:"})," This prompt will be registered in MLflow Prompt Registry at"," ",s.jsx("span",{className:"font-mono text-blue-200",children:j.schemaRef&&Ne[j.schemaRef]?`${Ne[j.schemaRef].catalog_name}.${Ne[j.schemaRef].schema_name}.${j.name}`:`${j.catalog_name}.${j.schema_name}.${j.name}`})]})}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{Mt(),l(!1)},disabled:P,children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:!j.refName||!j.name||P,children:P?s.jsxs(s.Fragment,{children:[s.jsx(xt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Registering..."]}):o?"Update Prompt":"Add Prompt"})]})]})})]})}function t0({label:e,options:t,value:n,onChange:r,placeholder:a,hint:l}){const[o,c]=M.useState(!1),i=M.useRef(null);M.useEffect(()=>{const f=g=>{i.current&&!i.current.contains(g.target)&&c(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const u=f=>{n.includes(f)?r(n.filter(g=>g!==f)):r([...n,f])},m=(f,g)=>{g.stopPropagation(),r(n.filter(b=>b!==f))},h=n.map(f=>{var g;return((g=t.find(b=>b.value===f))==null?void 0:g.label)||f});return s.jsxs("div",{className:"space-y-1.5",ref:i,children:[e&&s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{onClick:()=>c(!o),className:Ye("w-full min-h-[42px] px-3 py-2 bg-slate-800/50 border rounded-lg cursor-pointer","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200 flex flex-wrap gap-1.5 items-center",o?"border-blue-500 ring-2 ring-blue-500/50":"border-slate-700"),children:[n.length===0?s.jsx("span",{className:"text-slate-500",children:a||"Select options..."}):h.map((f,g)=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-sm",children:[f,s.jsx(qr,{className:"w-3 h-3 cursor-pointer hover:text-blue-300",onClick:b=>m(n[g],b)})]},n[g])),s.jsx(rs,{className:Ye("w-4 h-4 text-slate-500 ml-auto transition-transform",o&&"rotate-180")})]}),o&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-60 overflow-auto",children:t.length===0?s.jsx("div",{className:"px-3 py-2 text-sm text-slate-500",children:"No options available"}):t.map(f=>s.jsxs("div",{onClick:()=>u(f.value),className:Ye("px-3 py-2 flex items-center justify-between cursor-pointer transition-colors",n.includes(f.value)?"bg-blue-500/20 text-blue-400":"text-slate-300 hover:bg-slate-700"),children:[s.jsx("span",{children:f.label}),n.includes(f.value)&&s.jsx(ac,{className:"w-4 h-4"})]},f.value))})]}),l&&s.jsx("p",{className:"text-xs text-slate-500",children:l})]})}function n0(e,t,n){if(!e)return!1;const r=t.resources||{},a=["llms","genie_rooms","tables","volumes","functions","warehouses","connections","databases","vector_stores"];for(const f of a){const g=r[f]||{};if(e in g&&e!==n)return!0}const l=t.agents||{};if(e in l&&e!==n)return!0;const o=t.tools||{};if(e in o&&e!==n)return!0;const c=t.guardrails||{};if(e in c&&e!==n)return!0;const i=t.retrievers||{};if(e in i&&e!==n)return!0;const u=t.schemas||{};if(e in u&&e!==n)return!0;const m=t.prompts||{};if(e in m&&e!==n)return!0;const h=t.variables||{};return e in h&&e!==n}async function jC(e){const t=await fetch("/api/ai/generate-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate prompt")}return(await t.json()).prompt}async function _C(e){const t=await fetch("/api/ai/generate-handoff-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate handoff prompt")}return(await t.json()).prompt}const Qu=[{value:"user_id",label:"User ID"},{value:"store_num",label:"Store Number"},{value:"session_id",label:"Session ID"},{value:"context",label:"Context"},{value:"current_date",label:"Current Date"},{value:"user_name",label:"User Name"},{value:"location",label:"Location"}];function wC(){var N;const{config:e,addAgent:t,removeAgent:n,updateAgent:r}=We(),[a,l]=M.useState(!1),[o,c]=M.useState(null),i=e.agents||{},u=((N=e.resources)==null?void 0:N.llms)||{},m=e.tools||{},h=e.guardrails||{},f=e.prompts||{},g=Object.entries(u).map(([C,j])=>({value:C,label:`${C} (${j.name})`})),b=Object.entries(m).map(([C,j])=>({value:C,label:j.name})),w=Object.entries(h).map(([C,j])=>({value:C,label:j.name})),x=Object.entries(f).map(([C,j])=>({value:C,label:`${C} (${j.name})`})),{scrollToAsset:d}=qn(),p=C=>{c(C),l(!0)},v=C=>{d(C),p(C)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Agents"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Create and configure your AI agents"})]}),s.jsxs(Q,{onClick:()=>{c(null),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Agent"]})]}),Object.keys(i).length===0?s.jsxs(ke,{className:"text-center py-12",children:[s.jsx(Zt,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No agents configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Agents are the AI assistants that interact with users and use tools."}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Agent"]})]}):s.jsx("div",{className:"space-y-3",children:Object.entries(i).map(([C,j])=>{var E;return s.jsxs(ke,{variant:"interactive",className:"group cursor-pointer",onClick:()=>v(C),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-violet-500/20 flex items-center justify-center",children:s.jsx(Zt,{className:"w-5 h-5 text-violet-400"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:C}),s.jsxs("p",{className:"text-xs text-slate-500",children:[j.name,j.description?`  ${j.description}`:""]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ee,{variant:"info",children:typeof j.model=="object"?j.model.name:j.model}),s.jsxs(Ee,{variant:"default",children:[((E=j.tools)==null?void 0:E.length)||0," tools"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:y=>{y.stopPropagation(),p(C)},title:"Edit agent",children:s.jsx(Bc,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:y=>{y.stopPropagation(),tn("Agent",C,()=>n(C))},title:"Delete agent",children:s.jsx(Qe,{className:"w-4 h-4"})})]})]}),j.description&&s.jsx("p",{className:"mt-2 text-sm text-slate-400 line-clamp-2",children:j.description}),j.tools&&j.tools.length>0&&s.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[j.tools.slice(0,5).map((y,R)=>s.jsx(Ee,{variant:"warning",className:"text-xs",children:y.name},R)),j.tools.length>5&&s.jsxs(Ee,{variant:"default",className:"text-xs",children:["+",j.tools.length-5," more"]})]})]},C)})}),s.jsx(SC,{isOpen:a,onClose:()=>{l(!1),c(null)},editingAgent:o?i[o]:null,editingKey:o,llmOptions:g,toolOptions:b,guardrailOptions:w,promptOptions:x,llms:u,tools:m,guardrails:h,prompts:f,onAdd:t,onUpdate:r,onRemove:n})]})}function s0(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function SC({isOpen:e,onClose:t,editingAgent:n,editingKey:r,llmOptions:a,toolOptions:l,guardrailOptions:o,promptOptions:c,llms:i,tools:u,guardrails:m,prompts:h,onAdd:f,onUpdate:g,onRemove:b}){var ce,oe;const{config:w}=We(),[x,d]=M.useState("inline"),[p,v]=M.useState(!1),[N,C]=M.useState(!1),[j,E]=M.useState(""),[y,R]=M.useState(!1),[$,k]=M.useState(["user_id","store_num"]),[A,D]=M.useState(""),[S,T]=M.useState({refName:"",name:"",description:"",modelKey:"",promptRef:"",prompt:"You are a helpful assistant.",handoffPrompt:"",selectedTools:[],selectedGuardrails:[]}),[P,L]=M.useState(null),[I,O]=M.useState("inline"),F=async(Y=!1)=>{v(!0);try{const q=S.selectedTools.map(z=>{var G;return(G=u[z])==null?void 0:G.name}).filter(Boolean),se=await jC({context:j||void 0,agent_name:S.name||void 0,agent_description:S.description||void 0,tools:q.length>0?q:void 0,existing_prompt:Y?S.prompt:void 0,template_parameters:$.length>0?$:void 0});T({...S,prompt:se}),R(!1),E("")}catch(q){console.error("Failed to generate prompt:",q),alert(q instanceof Error?q.message:"Failed to generate prompt")}finally{v(!1)}},U=async(Y=!1)=>{C(!0);try{const q=Object.values(w.agents||{}).map(z=>z.name).filter(z=>z!==S.name),se=await _C({agent_name:S.name||void 0,agent_description:S.description||void 0,system_prompt:S.prompt||void 0,existing_handoff:Y?S.handoffPrompt:void 0,other_agents:q.length>0?q:void 0});T({...S,handoffPrompt:se})}catch(q){console.error("Failed to generate handoff prompt:",q),alert(q instanceof Error?q.message:"Failed to generate handoff prompt")}finally{C(!1)}},B=()=>{A&&!$.includes(A)&&(k([...$,A]),D(""))};M.useEffect(()=>{var Y,q,se,z;if(e)if(n&&r){const G=((Y=Object.entries(i).find(([,ze])=>{var $e;return ze.name===(($e=n.model)==null?void 0:$e.name)}))==null?void 0:Y[0])||"";let J="inline",ae="",je="";if(typeof n.prompt=="object"&&n.prompt!==null){const ze=n.prompt,$e=(q=Object.entries(h).find(([,Ve])=>Ve.name===ze.name))==null?void 0:q[0];$e&&(J="configured",ae=$e)}else je=typeof n.prompt=="string"?n.prompt:"";const Ne=((se=n.tools)==null?void 0:se.map(ze=>{var $e;return(($e=Object.entries(u).find(([,Ve])=>Ve.name===ze.name))==null?void 0:$e[0])||""}).filter(Boolean))||[],Ce=((z=n.guardrails)==null?void 0:z.map(ze=>{var $e;return(($e=Object.entries(m).find(([,Ve])=>Ve.name===ze.name))==null?void 0:$e[0])||""}).filter(Boolean))||[],Me={refName:r,name:n.name,description:n.description||"",modelKey:G,promptRef:ae,prompt:je,handoffPrompt:n.handoff_prompt||"",selectedTools:Ne,selectedGuardrails:Ce},He={refName:r,name:n.name,description:n.description||"",modelKey:G,promptRef:ae,prompt:je,handoffPrompt:n.handoff_prompt||"",selectedTools:[...Ne],selectedGuardrails:[...Ce]};d(J),T(Me),L(He),O(J)}else{const G={refName:"",name:"",description:"",modelKey:"",promptRef:"",prompt:"You are a helpful assistant.",handoffPrompt:"",selectedTools:[],selectedGuardrails:[]};d("inline"),T(G),L(null),O("inline"),R(!1),E("")}},[e,n,r,i,h,u,m]);const Z=Y=>{if(Y.preventDefault(),!S.refName||!S.name||!S.modelKey||!i[S.modelKey])return;let q;x==="configured"&&S.promptRef&&h[S.promptRef]?q=h[S.promptRef]:q=S.prompt||void 0;const se={name:S.name,description:S.description||void 0,model:i[S.modelKey],prompt:q,handoff_prompt:S.handoffPrompt||void 0,tools:S.selectedTools.map(z=>u[z]).filter(Boolean),guardrails:S.selectedGuardrails.map(z=>m[z]).filter(Boolean)};r?r!==S.refName?(b(r),f(S.refName,se)):g(S.refName,se):f(S.refName,se),t()},ee=M.useMemo(()=>!r||!P||S.refName!==P.refName||S.name!==P.name||S.description!==P.description||S.modelKey!==P.modelKey||S.prompt!==P.prompt||S.handoffPrompt!==P.handoffPrompt||S.promptRef!==P.promptRef||x!==I||S.selectedTools.length!==P.selectedTools.length||!S.selectedTools.every((Y,q)=>Y===P.selectedTools[q])||S.selectedGuardrails.length!==P.selectedGuardrails.length||!S.selectedGuardrails.every((Y,q)=>Y===P.selectedGuardrails[q]),[S,P,x,I,r]);return s.jsx(An,{isOpen:e,onClose:t,title:r?"Edit Agent":"Add Agent",description:"Configure an AI agent with its model, tools, and prompts",size:"xl",children:s.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[a.length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 text-amber-400 text-sm",children:"You need to add an LLM first before creating an agent."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., Customer Service Agent",value:S.refName,onChange:Y=>T({...S,refName:Lt(Y.target.value)}),hint:"Type naturally - spaces become underscores",required:!0}),s.jsx(le,{label:"Model",options:a,value:S.modelKey,onChange:Y=>T({...S,modelKey:Y.target.value}),placeholder:"Select an LLM...",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Display Name",placeholder:"e.g., Customer Service Agent",value:S.name,onChange:Y=>{const q=Y.target.value,se=!r&&(!S.refName||S.refName===s0(S.name));T({...S,name:q,refName:se?s0(q):S.refName})},hint:"Human-readable name for this agent",required:!0}),s.jsx(re,{label:"Description",placeholder:"Brief description of this agent's purpose",value:S.description,onChange:Y=>T({...S,description:Y.target.value})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"System Prompt"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>{d("inline"),T({...S,promptRef:""})},className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${x==="inline"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Inline"}),s.jsx("button",{type:"button",onClick:()=>{d("configured"),T({...S,prompt:""})},className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${x==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"})]})]}),x==="configured"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:S.promptRef,onChange:Y=>T({...S,promptRef:Y.target.value}),options:c,placeholder:"Select a configured prompt..."}),S.promptRef&&h[S.promptRef]&&s.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Qa,{className:"w-4 h-4 text-violet-400"}),s.jsx("span",{className:"text-sm font-medium text-slate-300",children:h[S.promptRef].name})]}),h[S.promptRef].description&&s.jsx("p",{className:"text-xs text-slate-400 mb-2",children:h[S.promptRef].description}),h[S.promptRef].default_template&&s.jsxs("pre",{className:"text-xs text-slate-500 bg-slate-900/50 p-2 rounded overflow-auto max-h-32",children:[(ce=h[S.promptRef].default_template)==null?void 0:ce.substring(0,300),(((oe=h[S.promptRef].default_template)==null?void 0:oe.length)||0)>300?"...":""]})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Reference a prompt defined in the Prompts section. The prompt will be resolved at runtime."})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>R(!y),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:p,children:[s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),S.prompt&&S.prompt!=="You are a helpful assistant."&&s.jsxs("button",{type:"button",onClick:()=>F(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:p,children:[p?s.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]})}),y&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(kt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"Describe what this agent should do and I'll generate an optimized prompt for you."}),s.jsx(us,{value:j,onChange:Y=>E(Y.target.value),rows:3,placeholder:"e.g., This agent helps customers find products in a hardware store. It should be friendly and knowledgeable about tools and home improvement..."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Template Parameters"}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select variables to include in the prompt (e.g., ","{user_id}",")"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Qu.map(Y=>s.jsx("button",{type:"button",onClick:()=>{$.includes(Y.value)?k($.filter(q=>q!==Y.value)):k([...$,Y.value])},className:`px-2 py-1 text-xs rounded-md transition-all ${$.includes(Y.value)?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:Y.label},Y.value))}),$.filter(Y=>!Qu.map(q=>q.value).includes(Y)).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:$.filter(Y=>!Qu.map(q=>q.value).includes(Y)).map(Y=>s.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-500/30 text-blue-300 border border-blue-500/50 flex items-center space-x-1",children:[s.jsx("span",{children:Y}),s.jsx("button",{type:"button",onClick:()=>k($.filter(q=>q!==Y)),className:"hover:text-red-300",children:""})]},Y))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:A,onChange:Y=>D(Y.target.value.replace(/[^a-z0-9_]/gi,"_").toLowerCase()),placeholder:"Add custom parameter...",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-700 rounded-md text-slate-300 placeholder-slate-500 focus:border-purple-500 focus:outline-none",onKeyDown:Y=>{Y.key==="Enter"&&(Y.preventDefault(),B())}}),s.jsx("button",{type:"button",onClick:B,disabled:!A,className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded-md hover:bg-slate-600 disabled:opacity-50",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:()=>{R(!1),E("")},disabled:p,children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>F(!1),disabled:p||!j&&!S.name&&!S.description,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:p?s.jsxs(s.Fragment,{children:[s.jsx(xt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(kt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(us,{value:S.prompt,onChange:Y=>T({...S,prompt:Y.target.value}),rows:8,hint:"The main instructions for this agent",placeholder:"You are a helpful assistant..."})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Handoff Prompt"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>U(!1),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:N||!S.prompt&&!S.description,title:!S.prompt&&!S.description?"Add a system prompt or description first":"Generate handoff prompt with AI",children:[N?s.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),S.handoffPrompt&&s.jsxs("button",{type:"button",onClick:()=>U(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:N,children:[N?s.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),s.jsx(us,{placeholder:"Describe when this agent should be called in a multi-agent system...",value:S.handoffPrompt,onChange:Y=>T({...S,handoffPrompt:Y.target.value}),rows:3,hint:"Used by the supervisor to decide when to route to this agent"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(t0,{label:"Tools",options:l,value:S.selectedTools,onChange:Y=>T({...S,selectedTools:Y}),placeholder:"Select tools...",hint:"Tools this agent can use"}),s.jsx(t0,{label:"Guardrails",options:o,value:S.selectedGuardrails,onChange:Y=>T({...S,selectedGuardrails:Y}),placeholder:"Select guardrails...",hint:"Safety checks for this agent"})]}),S.refName&&n0(S.refName,w,r)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',S.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:t,children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:a.length===0||!!r&&!ee||n0(S.refName,w,r),children:r?"Save Changes":"Add Agent"})]})]})})}async function CC(e){const t=await fetch("/api/ai/generate-supervisor-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate supervisor prompt")}return(await t.json()).prompt}const kC=[{value:"TRACE",label:"TRACE"},{value:"DEBUG",label:"DEBUG"},{value:"INFO",label:"INFO"},{value:"WARNING",label:"WARNING"},{value:"ERROR",label:"ERROR"}],EC=[{value:"Small",label:"Small"},{value:"Medium",label:"Medium"},{value:"Large",label:"Large"}];function AC(e){return e.trim().replace(/[\s-]+/g,"_").replace(/([a-z])([A-Z])/g,"$1_$2").replace(/[^a-zA-Z0-9_]/g,"").toLowerCase().replace(/_+/g,"_").replace(/^_|_$/g,"")}function RC(){var mn,fn,Gt,Vt,Yt,X,ne,ve,pe;const{config:e,updateApp:t}=We(),n=e.app,r=e.schemas||{},a=e.agents||{},l=((mn=e.resources)==null?void 0:mn.llms)||{},o=e.tools||{},c=e.memory,[i,u]=M.useState(()=>{var W,K;let H="",te="",_="";if((W=n==null?void 0:n.registered_model)!=null&&W.schema){const me=n.registered_model.schema,he=Object.entries(r).find(([,Se])=>Se.catalog_name===me.catalog_name&&Se.schema_name===me.schema_name);he?H=he[0]:(te=me.catalog_name||"",_=me.schema_name||"")}let V="";return n!=null&&n.service_principal&&typeof n.service_principal=="string"&&(V=n.service_principal.startsWith("*")?n.service_principal.slice(1):n.service_principal),{name:(n==null?void 0:n.name)||"",description:(n==null?void 0:n.description)||"",logLevel:(n==null?void 0:n.log_level)||"INFO",endpointName:(n==null?void 0:n.endpoint_name)||"",modelName:((K=n==null?void 0:n.registered_model)==null?void 0:K.name)||"",modelSchema:H,directCatalog:te,directSchema:_,workloadSize:(n==null?void 0:n.workload_size)||"Small",scaleToZero:(n==null?void 0:n.scale_to_zero)??!0,servicePrincipalRef:V}}),[m,h]=M.useState(()=>{var te;const H=Object.keys(r).length>0;if((te=n==null?void 0:n.registered_model)!=null&&te.schema){const _=n.registered_model.schema;return Object.entries(r).find(([,W])=>W.catalog_name===_.catalog_name&&W.schema_name===_.schema_name)?"configured":"select"}return H?"configured":"select"}),{data:f}=Tr(),{data:g}=as(i.directCatalog||null),b=f||[],w=g||[],[x,d]=M.useState(""),[p,v]=M.useState(""),[N,C]=M.useState((n==null?void 0:n.tags)||{}),[j,E]=M.useState(""),[y,R]=M.useState(""),$=[{value:"CAN_MANAGE",label:"Can Manage"},{value:"CAN_QUERY",label:"Can Query"},{value:"CAN_VIEW",label:"Can View"},{value:"CAN_REVIEW",label:"Can Review"},{value:"NO_PERMISSIONS",label:"No Permissions"}],[k,A]=M.useState(((fn=n==null?void 0:n.permissions)==null?void 0:fn.map(H=>({principals:H.principals||[],entitlements:H.entitlements||[]})))||[]),[D,S]=M.useState(""),[T,P]=M.useState(()=>{const H=(n==null?void 0:n.environment_vars)||{};return Object.entries(H).map(([te,_])=>typeof _=="string"&&_.startsWith("*")?{name:te,source:"variable",value:"",variableRef:_.slice(1)}:{name:te,source:"manual",value:String(_),variableRef:""})}),[L,I]=M.useState(()=>n!=null&&n.agents&&Array.isArray(n.agents)&&n.agents.length>0?n.agents.map(H=>{var _;return((_=Object.entries(a).find(([,V])=>V.name===H.name))==null?void 0:_[0])||""}).filter(Boolean):Object.keys(a)),[O,F]=M.useState((Vt=(Gt=e.app)==null?void 0:Gt.orchestration)!=null&&Vt.supervisor?"supervisor":(X=(Yt=e.app)==null?void 0:Yt.orchestration)!=null&&X.swarm?"swarm":"none"),[U,B]=M.useState(((pe=(ve=(ne=e.app)==null?void 0:ne.orchestration)==null?void 0:ve.supervisor)==null?void 0:pe.prompt)||""),[Z,ee]=M.useState(!1),[ce,oe]=M.useState(!1),[Y,q]=M.useState(""),[se,z]=M.useState(()=>{var te,_,V,W,K,me,he,Se;const H=((W=(V=(_=(te=e.app)==null?void 0:te.orchestration)==null?void 0:_.supervisor)==null?void 0:V.model)==null?void 0:W.name)||((Se=(he=(me=(K=e.app)==null?void 0:K.orchestration)==null?void 0:me.swarm)==null?void 0:he.model)==null?void 0:Se.name);if(H){const ue=Object.entries(l).find(([,Ae])=>Ae.name===H);return ue?ue[0]:""}return""}),[G,J]=M.useState(()=>{var te,_,V;const H=(V=(_=(te=e.app)==null?void 0:te.orchestration)==null?void 0:_.swarm)==null?void 0:V.default_agent;return typeof H=="string"?H:H&&"name"in H?H.name:""}),[ae,je]=M.useState(()=>{var te,_,V;const H=(V=(_=(te=e.app)==null?void 0:te.orchestration)==null?void 0:_.swarm)==null?void 0:V.handoffs;return H?Object.entries(H).map(([W,K])=>{if(K==null)return{agentName:W,type:"any",targets:[]};if(Array.isArray(K)&&K.length===0)return{agentName:W,type:"none",targets:[]};const me=K.map(he=>typeof he=="string"?he:he.name);return{agentName:W,type:"specific",targets:me}}):[]}),[Ne,Ce]=M.useState(()=>{var te,_,V;const H=(V=(_=(te=e.app)==null?void 0:te.orchestration)==null?void 0:_.supervisor)==null?void 0:V.tools;return!H||!Array.isArray(H)?[]:H.map(W=>{var he;const K=typeof W=="string"?W:W==null?void 0:W.name;return((he=Object.entries(o).find(([,Se])=>Se.name===K))==null?void 0:he[0])||""}).filter(Boolean)}),[Me,He]=M.useState(()=>{var te,_,V;const H=(_=(te=e.app)==null?void 0:te.orchestration)==null?void 0:_.memory;return H?typeof H=="string"&&H.startsWith("*")?H.slice(1):(V=e.memory)!=null&&V.refName?e.memory.refName:"memory":""}),ze=(()=>{var Ae,mt,bt,Oe,Ie,Ke,st,Ge,Ue,ft,fs,hs,ps,xs,_n,Ln,Xn,gs,vs,bs,ys,rn;if(i.name!==((n==null?void 0:n.name)||"")||i.description!==((n==null?void 0:n.description)||"")||i.logLevel!==((n==null?void 0:n.log_level)||"INFO")||i.endpointName!==((n==null?void 0:n.endpoint_name)||"")||i.modelName!==(((Ae=n==null?void 0:n.registered_model)==null?void 0:Ae.name)||"")||i.workloadSize!==((n==null?void 0:n.workload_size)||"Small")||i.scaleToZero!==((n==null?void 0:n.scale_to_zero)??!0))return!0;let H="";if((mt=n==null?void 0:n.registered_model)!=null&&mt.schema){const qe=n.registered_model.schema,De=Object.entries(r).find(([,Re])=>Re.catalog_name===qe.catalog_name&&Re.schema_name===qe.schema_name);H=De?De[0]:""}if(i.modelSchema!==H)return!0;const te=((n==null?void 0:n.agents)||[]).map(qe=>{var Re;return((Re=Object.entries(a).find(([,rt])=>rt.name===qe.name))==null?void 0:Re[0])||""}).filter(Boolean).sort(),_=[...L].sort();if(JSON.stringify(te)!==JSON.stringify(_))return!0;const V=(bt=n==null?void 0:n.orchestration)!=null&&bt.supervisor?"supervisor":(Oe=n==null?void 0:n.orchestration)!=null&&Oe.swarm?"swarm":"none";if(O!==V)return!0;if(O==="supervisor"){const qe=(st=(Ke=(Ie=n==null?void 0:n.orchestration)==null?void 0:Ie.supervisor)==null?void 0:Ke.model)==null?void 0:st.name,De=se?(Ge=l[se])==null?void 0:Ge.name:"";if(qe!==De||U!==(((ft=(Ue=n==null?void 0:n.orchestration)==null?void 0:Ue.supervisor)==null?void 0:ft.prompt)||""))return!0;const Re=(((hs=(fs=n==null?void 0:n.orchestration)==null?void 0:fs.supervisor)==null?void 0:hs.tools)||[]).map(yt=>{var Or;const it=typeof yt=="string"?yt:yt==null?void 0:yt.name;return((Or=Object.entries(o).find(([,we])=>we.name===it))==null?void 0:Or[0])||""}).filter(Boolean).sort(),rt=[...Ne].sort();if(JSON.stringify(Re)!==JSON.stringify(rt))return!0}else if(O==="swarm"){const qe=(_n=(xs=(ps=n==null?void 0:n.orchestration)==null?void 0:ps.swarm)==null?void 0:xs.model)==null?void 0:_n.name,De=se?(Ln=l[se])==null?void 0:Ln.name:"";if(qe!==De)return!0;const Re=(gs=(Xn=n==null?void 0:n.orchestration)==null?void 0:Xn.swarm)==null?void 0:gs.default_agent,rt=typeof Re=="string"?Re:(Re==null?void 0:Re.name)||"";if(G!==rt)return!0;const yt=((bs=(vs=n==null?void 0:n.orchestration)==null?void 0:vs.swarm)==null?void 0:bs.handoffs)||{},it={};if(ae.forEach(qt=>{qt.type==="any"?it[qt.agentName]=null:qt.type==="none"?it[qt.agentName]=[]:it[qt.agentName]=qt.targets}),JSON.stringify(yt)!==JSON.stringify(it))return!0}const W=(ys=n==null?void 0:n.orchestration)==null?void 0:ys.memory;let K="";if(typeof W=="string"&&W.startsWith("*")?K=W.slice(1):(rn=e.memory)!=null&&rn.refName&&W&&(K=e.memory.refName),Me!==K)return!0;const me=(n==null?void 0:n.tags)||{};if(JSON.stringify(me)!==JSON.stringify(N))return!0;const he=(n==null?void 0:n.permissions)||[];if(JSON.stringify(he)!==JSON.stringify(k))return!0;const Se=(n==null?void 0:n.environment_vars)||{},ue={};return T.forEach(qe=>{qe.name&&(ue[qe.name]=qe.source==="variable"&&qe.variableRef?`*${qe.variableRef}`:qe.value)}),JSON.stringify(Se)!==JSON.stringify(ue)})(),$e=[{value:"",label:"Select an LLM..."},...Object.entries(l).map(([H,te])=>({value:H,label:`${H} (${te.name})`}))],Ve=Object.keys(a),tt=L.filter(H=>a[H]),gt=[{value:"",label:L.length===0?"Select agents for app first...":"Select an agent..."},...tt.map(H=>({value:H,label:a[H].name}))],Ft=[{value:"any",label:"Any Agent (can hand off to all)"},{value:"specific",label:"Specific Agents (select targets)"},{value:"none",label:"No Handoffs (terminal agent)"}],ge=tt.filter(H=>!ae.some(te=>te.agentName===H));M.useEffect(()=>{var bt,Oe,Ie,Ke,st,Ge,Ue,ft,fs,hs,ps,xs,_n,Ln,Xn,gs,vs,bs,ys,rn,qe;let H="",te="",_="",V=Object.keys(r).length>0?"configured":"select";if((bt=n==null?void 0:n.registered_model)!=null&&bt.schema){const De=n.registered_model.schema,Re=Object.entries(r).find(([,rt])=>rt.catalog_name===De.catalog_name&&rt.schema_name===De.schema_name);Re?(H=Re[0],V="configured"):(te=De.catalog_name||"",_=De.schema_name||"",V="select")}let W="";if(n!=null&&n.service_principal&&typeof n.service_principal=="string"&&(W=n.service_principal.startsWith("*")?n.service_principal.slice(1):n.service_principal),u({name:(n==null?void 0:n.name)||"",description:(n==null?void 0:n.description)||"",logLevel:(n==null?void 0:n.log_level)||"INFO",endpointName:(n==null?void 0:n.endpoint_name)||"",modelName:((Oe=n==null?void 0:n.registered_model)==null?void 0:Oe.name)||"",modelSchema:H,directCatalog:te,directSchema:_,workloadSize:(n==null?void 0:n.workload_size)||"Small",scaleToZero:(n==null?void 0:n.scale_to_zero)??!0,servicePrincipalRef:W}),h(V),n!=null&&n.agents&&Array.isArray(n.agents)&&n.agents.length>0){const De=n.agents.map(Re=>{var yt;return((yt=Object.entries(a).find(([,it])=>it.name===Re.name))==null?void 0:yt[0])||""}).filter(Boolean);I(De)}else I(Object.keys(a));const K=(Ie=n==null?void 0:n.orchestration)!=null&&Ie.supervisor?"supervisor":(Ke=n==null?void 0:n.orchestration)!=null&&Ke.swarm?"swarm":"none";F(K);const me=((Ue=(Ge=(st=n==null?void 0:n.orchestration)==null?void 0:st.supervisor)==null?void 0:Ge.model)==null?void 0:Ue.name)||((hs=(fs=(ft=n==null?void 0:n.orchestration)==null?void 0:ft.swarm)==null?void 0:fs.model)==null?void 0:hs.name);if(me){const De=Object.entries(l).find(([,Re])=>Re.name===me);z(De?De[0]:"")}else z("");B(((xs=(ps=n==null?void 0:n.orchestration)==null?void 0:ps.supervisor)==null?void 0:xs.prompt)||"");const he=(Ln=(_n=n==null?void 0:n.orchestration)==null?void 0:_n.supervisor)==null?void 0:Ln.tools;if(he&&Array.isArray(he)){const De=he.map(Re=>{var it;const rt=typeof Re=="string"?Re:Re==null?void 0:Re.name;return((it=Object.entries(o).find(([,qt])=>qt.name===rt))==null?void 0:it[0])||""}).filter(Boolean);Ce(De)}else Ce([]);const Se=(gs=(Xn=n==null?void 0:n.orchestration)==null?void 0:Xn.swarm)==null?void 0:gs.default_agent;typeof Se=="string"?J(Se):Se&&"name"in Se?J(Se.name):J("");const ue=(bs=(vs=n==null?void 0:n.orchestration)==null?void 0:vs.swarm)==null?void 0:bs.handoffs;if(ue){const De=Object.entries(ue).map(([Re,rt])=>{if(rt==null)return{agentName:Re,type:"any",targets:[]};if(Array.isArray(rt)&&rt.length===0)return{agentName:Re,type:"none",targets:[]};const yt=rt.map(it=>typeof it=="string"?it:it.name);return{agentName:Re,type:"specific",targets:yt}});je(De)}else je([]);const Ae=(ys=n==null?void 0:n.orchestration)==null?void 0:ys.memory;Ae?typeof Ae=="string"&&Ae.startsWith("*")?He(Ae.slice(1)):(rn=e.memory)!=null&&rn.refName?He(e.memory.refName):He("memory"):He(""),C((n==null?void 0:n.tags)||{}),A(((qe=n==null?void 0:n.permissions)==null?void 0:qe.map(De=>({principals:De.principals||[],entitlements:De.entitlements||[]})))||[]);const mt=(n==null?void 0:n.environment_vars)||{};P(Object.entries(mt).map(([De,Re])=>typeof Re=="string"&&Re.startsWith("*")?{name:De,source:"variable",value:"",variableRef:Re.slice(1)}:{name:De,source:"manual",value:String(Re),variableRef:""}))},[n,a,l,o]),M.useEffect(()=>{L.length<=1?O!=="none"&&F("none"):L.length>1&&O==="none"&&F("supervisor")},[L.length,O]);const Rt=()=>{ge.length>0&&je([...ae,{agentName:ge[0],type:"any",targets:[]}])},wt=H=>{je(ae.filter((te,_)=>_!==H))},nt=(H,te)=>{je(ae.map((_,V)=>V===H?{..._,...te}:_))},de=(H,te)=>{const _=ae[H],V=_.targets.includes(te)?_.targets.filter(W=>W!==te):[..._.targets,te];nt(H,{targets:V})},vt=async(H=!1)=>{ee(!0);try{const te=Object.values(a).map(V=>({name:V.name,description:V.description,handoff_prompt:V.handoff_prompt})),_=await CC({context:Y||void 0,agents:te.length>0?te:void 0,existing_prompt:H?U:void 0});B(_),oe(!1),q("")}catch(te){console.error("Failed to generate supervisor prompt:",te),alert(te instanceof Error?te.message:"Failed to generate supervisor prompt")}finally{ee(!1)}},Mt=()=>{var W;let H;m==="configured"&&i.modelSchema?H=r[i.modelSchema]:m==="select"&&i.directCatalog&&i.directSchema&&(H={catalog_name:i.directCatalog,schema_name:i.directSchema});let te;if(O==="supervisor"&&se&&l[se]){const K=Ne.map(me=>o[me]).filter(Boolean);te={supervisor:{model:l[se],...K.length>0&&{tools:K},...U&&{prompt:U}},...Me&&{memory:`*${Me}`}}}else if(O==="swarm"&&se&&l[se]){const K={};ae.forEach(me=>{me.type==="any"?K[me.agentName]=null:me.type==="none"?K[me.agentName]=[]:K[me.agentName]=me.targets}),te={swarm:{model:l[se],...G&&a[G]&&{default_agent:G},...Object.keys(K).length>0&&{handoffs:K}},...Me&&{memory:`*${Me}`}}}else if(O==="none"&&Me){const K=(W=e.app)==null?void 0:W.orchestration;if(K!=null&&K.supervisor)te={supervisor:K.supervisor,memory:`*${Me}`};else if(K!=null&&K.swarm)te={swarm:K.swarm,memory:`*${Me}`};else{let me;const he=L[0];he&&a[he]&&(me=a[he].model),!me&&(n!=null&&n.agents)&&Array.isArray(n.agents)&&n.agents.length>0&&(me=n.agents[0].model),te={swarm:me?{model:me}:{},memory:`*${Me}`}}}const _=L.map(K=>a[K]).filter(Boolean),V={};T.forEach(K=>{K.name&&(K.source==="variable"&&K.variableRef?V[K.name]=`*${K.variableRef}`:K.source==="manual"&&K.value&&(V[K.name]=K.value))}),t({name:i.name,description:i.description||void 0,log_level:i.logLevel,endpoint_name:i.endpointName||void 0,service_principal:i.servicePrincipalRef?`*${i.servicePrincipalRef}`:void 0,registered_model:{name:i.modelName,...H&&{schema:H}},workload_size:i.workloadSize,scale_to_zero:i.scaleToZero,orchestration:te,agents:_.length>0?_:void 0,tags:Object.keys(N).length>0?N:void 0,permissions:k.length>0?k:void 0,environment_vars:Object.keys(V).length>0?V:void 0})},Pt=H=>{I(te=>te.includes(H)?te.filter(_=>_!==H):[...te,H])},sn=()=>{I(Object.keys(a))},In=()=>{I([])};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Application"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure your application settings, orchestration, and deployment options"})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Ss,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Application Settings"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Application Name",placeholder:"e.g., my_retail_app",value:i.name,onChange:H=>{const te=H.target.value,_=AC(te),V=_?`${_}_endpoint`:"",W=_||"",K={...i,name:te};(!i.endpointName||i.endpointName===x)&&(K.endpointName=V,d(V)),(!i.modelName||i.modelName===p)&&(K.modelName=W,v(W)),u(K)},required:!0}),s.jsx(le,{label:"Log Level",options:kC,value:i.logLevel,onChange:H=>u({...i,logLevel:H.target.value})})]}),s.jsx(re,{label:"Description",placeholder:"Brief description of your application",value:i.description,onChange:H=>u({...i,description:H.target.value})}),s.jsx(re,{label:"Endpoint Name",placeholder:"e.g., my_agent_endpoint",value:i.endpointName,onChange:H=>u({...i,endpointName:H.target.value}),hint:"The name of the model serving endpoint"}),s.jsx(le,{label:"Service Principal (Optional)",value:i.servicePrincipalRef,onChange:H=>u({...i,servicePrincipalRef:H.target.value}),options:[{value:"",label:"None - Use default credentials"},...Object.keys(e.service_principals||{}).map(H=>({value:H,label:H}))],hint:"Optional service principal for application authentication"}),Object.keys(e.service_principals||{}).length===0&&i.servicePrincipalRef===""&&s.jsx("p",{className:"text-xs text-slate-500 -mt-2",children:"Configure service principals in Resources  Service Principals to use them here."})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Zt,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Application Agents"})]}),s.jsx("div",{className:"flex items-center space-x-2",children:Ve.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:sn,disabled:L.length===Ve.length,children:"Select All"}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:In,disabled:L.length===0,children:"Clear"})]})})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Select the agents to include in this application. These agents will be available for orchestration."}),Ve.length===0?s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"No agents configured. Add agents in the Agents section first."}):s.jsx("div",{className:"space-y-2",children:Ve.map(H=>{const te=a[H],_=L.includes(H);return s.jsxs("button",{type:"button",onClick:()=>Pt(H),className:Ye("w-full flex items-center justify-between p-3 rounded-lg border transition-all text-left",_?"bg-blue-500/10 border-blue-500/50 ring-1 ring-blue-500/30":"bg-slate-800/50 border-slate-700 hover:border-slate-600"),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:Ye("w-8 h-8 rounded-lg flex items-center justify-center",_?"bg-blue-500/20":"bg-slate-700"),children:s.jsx(Zt,{className:Ye("w-4 h-4",_?"text-blue-400":"text-slate-400")})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:te.name}),te.description&&s.jsx("p",{className:"text-xs text-slate-500 line-clamp-1",children:te.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[te.tools&&te.tools.length>0&&s.jsxs(Ee,{variant:"default",className:"text-[10px]",children:[te.tools.length," tools"]}),_?s.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-600"})]})]},H)})}),L.length>0&&s.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[s.jsxs("p",{className:"text-xs text-slate-500 mb-2",children:["Selected agents (",L.length,")"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(H=>{var te;return s.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-500/20 text-blue-300 rounded text-xs",children:[((te=a[H])==null?void 0:te.name)||H,s.jsx("button",{type:"button",onClick:_=>{_.stopPropagation(),Pt(H)},className:"ml-1.5 hover:text-white",children:s.jsx(qr,{className:"w-3 h-3"})})]},H)})})]})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Np,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Orchestration"})]}),s.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Configure how agents work together in your multi-agent system"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>F("none"),disabled:L.length>1,className:Ye("p-4 rounded-lg border text-center transition-all",O==="none"?"bg-blue-500/10 border-blue-500 ring-1 ring-blue-500":"bg-slate-800/50 border-slate-700 hover:border-slate-600",L.length>1&&"opacity-50 cursor-not-allowed hover:border-slate-700"),children:[s.jsx("div",{className:"w-10 h-10 mx-auto rounded-lg bg-slate-700 flex items-center justify-center mb-2",children:s.jsx(Ro,{className:"w-5 h-5 text-slate-400"})}),s.jsx("h4",{className:"text-sm font-medium text-white",children:"No Orchestration"}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Single agent mode"})]}),s.jsxs("button",{type:"button",onClick:()=>F("supervisor"),disabled:L.length<=1,className:Ye("p-4 rounded-lg border text-center transition-all",O==="supervisor"?"bg-blue-500/10 border-blue-500 ring-1 ring-blue-500":"bg-slate-800/50 border-slate-700 hover:border-slate-600",L.length<=1&&"opacity-50 cursor-not-allowed hover:border-slate-700"),children:[s.jsx("div",{className:Ye("w-10 h-10 mx-auto rounded-lg flex items-center justify-center mb-2",L.length<=1?"bg-slate-700":"bg-blue-500/20"),children:s.jsx(im,{className:Ye("w-5 h-5",L.length<=1?"text-slate-500":"text-blue-400")})}),s.jsx("h4",{className:"text-sm font-medium text-white",children:"Supervisor"}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Central routing agent"})]}),s.jsxs("button",{type:"button",onClick:()=>F("swarm"),disabled:L.length<=1,className:Ye("p-4 rounded-lg border text-center transition-all",O==="swarm"?"bg-blue-500/10 border-blue-500 ring-1 ring-blue-500":"bg-slate-800/50 border-slate-700 hover:border-slate-600",L.length<=1&&"opacity-50 cursor-not-allowed hover:border-slate-700"),children:[s.jsx("div",{className:Ye("w-10 h-10 mx-auto rounded-lg flex items-center justify-center mb-2",L.length<=1?"bg-slate-700":"bg-purple-500/20"),children:s.jsx(Np,{className:Ye("w-5 h-5",L.length<=1?"text-slate-500":"text-purple-400")})}),s.jsx("h4",{className:"text-sm font-medium text-white",children:"Swarm"}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Peer-to-peer handoffs"})]})]}),L.length<=1&&s.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Supervisor and Swarm orchestration require multiple agents to be selected."}),O!=="none"&&s.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-700",children:[Object.keys(l).length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"Add an LLM in Resources first to configure orchestration."}),s.jsx(le,{label:"Orchestration Model",options:$e,value:se,onChange:H=>z(H.target.value),hint:O==="supervisor"?"The LLM that will route requests to appropriate agents":"The LLM used for agent handoff decisions"}),O==="supervisor"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Supervisor Prompt (Optional)"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[!ce&&s.jsxs("button",{type:"button",onClick:()=>oe(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",children:[s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),U&&!ce&&s.jsxs("button",{type:"button",onClick:()=>vt(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:Z,children:[Z?s.jsx(xt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(kt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),ce&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(kt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Supervisor Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"The AI will use the configured agents' names, descriptions, and handoff prompts to generate a supervisor prompt that effectively routes requests."}),Object.keys(a).length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs text-slate-500",children:"Agents that will be included:"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:Object.values(a).map((H,te)=>s.jsx("span",{className:"px-2 py-0.5 bg-slate-800/50 rounded text-xs text-slate-300",children:H.name},te))})]}),s.jsx(us,{label:"Additional Context (Optional)",placeholder:"Describe any specific routing logic, priorities, or special instructions for the supervisor...",value:Y,onChange:H=>q(H.target.value),rows:3}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>{oe(!1),q("")},children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>vt(!1),disabled:Z||Object.keys(a).length===0,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:Z?s.jsxs(s.Fragment,{children:[s.jsx(xt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(kt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(us,{placeholder:"Custom instructions for the supervisor agent...",value:U,onChange:H=>B(H.target.value),rows:4,hint:"Override the default supervisor prompt"})]}),s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700/50",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-medium text-slate-200 flex items-center gap-2",children:[s.jsx(Rs,{className:"w-4 h-4 text-green-400"}),"Supervisor Tools"]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Assign tools that the supervisor can use directly"})]})}),Object.keys(o).length===0?s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"No tools configured. Add tools in the Tools section first."}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(o).map(([H,te])=>{const _=Ne.includes(H);return s.jsxs("button",{type:"button",onClick:()=>{Ce(V=>_?V.filter(W=>W!==H):[...V,H])},className:Ye("px-3 py-1.5 rounded-lg text-sm transition-colors flex items-center gap-2",_?"bg-green-500/20 text-green-300 border border-green-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"),children:[s.jsx(Rs,{className:"w-3 h-3"}),te.name,_&&s.jsx(qr,{className:"w-3 h-3 ml-1"})]},H)})}),Ne.length>0&&s.jsxs("p",{className:"text-xs text-green-400",children:[" ",Ne.length," tool",Ne.length!==1?"s":""," assigned to supervisor"]})]})]})]}),O==="swarm"&&s.jsxs(s.Fragment,{children:[L.length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"Select agents for the application above before configuring swarm orchestration."}),s.jsx(le,{label:"Default Agent",options:gt,value:G,onChange:H=>J(H.target.value),hint:"The agent that handles initial requests (from selected application agents)",disabled:L.length===0}),s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700/50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-slate-200",children:"Agent Handoff Rules"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Define which agents can hand off to which other agents"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:Rt,disabled:ge.length===0||L.length===0,children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Rule"]})]}),L.length===0&&s.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 text-slate-400 text-sm",children:"Select agents for the application first to configure handoff rules."}),ae.length===0&&L.length>0&&s.jsx("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Ka,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-300",children:[s.jsx("p",{className:"font-medium",children:"No handoff rules defined"}),s.jsxs("p",{className:"text-blue-400/80 mt-1 text-xs",children:["Without explicit rules, agents will use their ",s.jsx("code",{className:"bg-blue-900/50 px-1 rounded",children:"handoff_prompt"})," to determine routing."]})]})]})}),ae.map((H,te)=>{var _;return s.jsxs("div",{className:"bg-slate-800/30 rounded-lg p-3 border border-slate-700/50 space-y-2",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[s.jsx(le,{label:"From Agent",value:H.agentName,onChange:V=>nt(te,{agentName:V.target.value}),options:[{value:H.agentName,label:((_=a[H.agentName])==null?void 0:_.name)||H.agentName},...ge.map(V=>{var W;return{value:V,label:((W=a[V])==null?void 0:W.name)||V}})]}),s.jsx(le,{label:"Can Hand Off To",value:H.type,onChange:V=>nt(te,{type:V.target.value,targets:V.target.value==="specific"?H.targets:[]}),options:Ft})]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>wt(te),className:"ml-2 mt-6",children:s.jsx(Qe,{className:"w-4 h-4 text-red-400"})})]}),H.type==="specific"&&s.jsxs("div",{className:"pt-1",children:[s.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Select target agents:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:tt.filter(V=>V!==H.agentName).map(V=>{var W;return s.jsx("button",{type:"button",onClick:()=>de(te,V),className:Ye("px-2.5 py-1 rounded-lg text-xs transition-colors",H.targets.includes(V)?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"),children:((W=a[V])==null?void 0:W.name)||V},V)})})]}),H.type==="any"&&s.jsx("p",{className:"text-xs text-emerald-400",children:" This agent can hand off to any other agent"}),H.type==="none"&&s.jsx("p",{className:"text-xs text-amber-400",children:" This agent cannot hand off (terminal agent)"})]},te)})]})]})]}),s.jsxs("div",{className:"bg-slate-800/30 rounded-lg p-3 text-xs text-slate-400 space-y-1.5",children:[s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Ee,{variant:"info",className:"text-[10px] px-1.5 py-0",children:"Supervisor"}),s.jsx("span",{children:"Central agent analyzes requests and routes to appropriate specialized agents."})]}),s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Ee,{variant:"info",className:"text-[10px] px-1.5 py-0",children:"Swarm"}),s.jsx("span",{children:"Agents hand off conversations directly to each other based on handoff rules."})]})]}),s.jsxs("div",{className:"space-y-2 pt-4 border-t border-slate-700",children:[s.jsx(le,{label:"Memory",options:c?[{value:"",label:"No memory (stateless)"},...c.refName?[{value:c.refName,label:`*${c.refName}`}]:[{value:"memory",label:"*memory"}]]:[{value:"",label:"No memory configured"}],value:Me,onChange:H=>He(H.target.value),hint:c?"Assign configured memory to enable conversation persistence":"Configure memory in the Memory section first",disabled:!c}),!c&&s.jsxs("p",{className:"text-xs text-amber-400",children:[" Add a memory configuration in the ",s.jsx("strong",{children:"Memory"})," section to enable conversation persistence."]}),Me&&L.length===1&&O==="none"&&s.jsx("p",{className:"text-xs text-cyan-400",children:" With a single agent and memory, swarm orchestration will be used automatically."})]})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsx("h3",{className:"font-medium text-white",children:"Model Registration"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Registered Model Name",placeholder:"e.g., my_agent_model",value:i.modelName,onChange:H=>u({...i,modelName:H.target.value}),required:!0}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Model Schema"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>h("configured"),disabled:Object.keys(r).length===0,className:`px-2 py-0.5 text-[10px] rounded-md font-medium transition-all duration-150 ${m==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300 disabled:opacity-50 disabled:cursor-not-allowed"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>h("select"),className:`px-2 py-0.5 text-[10px] rounded-md font-medium transition-all duration-150 ${m==="select"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),m==="configured"?s.jsx(le,{options:[{value:"",label:"Select a configured schema..."},...Object.keys(r).map(H=>({value:H,label:H}))],value:i.modelSchema,onChange:H=>u({...i,modelSchema:H.target.value})}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx(le,{options:[{value:"",label:"Select Catalog..."},...b.map(H=>({value:H.name,label:H.name}))],value:i.directCatalog,onChange:H=>u({...i,directCatalog:H.target.value,directSchema:""})}),s.jsx(le,{options:[{value:"",label:"Select Schema..."},...w.map(H=>({value:H.name,label:H.name}))],value:i.directSchema,onChange:H=>u({...i,directSchema:H.target.value}),disabled:!i.directCatalog})]})]})]})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsx("h3",{className:"font-medium text-white",children:"Deployment Options"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Workload Size",options:EC,value:i.workloadSize,onChange:H=>u({...i,workloadSize:H.target.value})}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Scale to Zero"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 mt-1",children:[s.jsx("button",{type:"button",onClick:()=>u({...i,scaleToZero:!0}),className:`px-4 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i.scaleToZero?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Enabled"}),s.jsx("button",{type:"button",onClick:()=>u({...i,scaleToZero:!1}),className:`px-4 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i.scaleToZero?"text-slate-400 border border-transparent hover:text-slate-300":"bg-violet-500/20 text-violet-400 border border-violet-500/40"}`,children:"Disabled"})]})]})]})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx($w,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Environment Variables"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>P([...T,{name:"",source:"variable",value:"",variableRef:""}]),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Variable"]})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Configure environment variables for your application. Values can reference configured variables or be set manually."}),T.length===0?s.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 text-slate-400 text-sm",children:"No environment variables configured. Add variables to set runtime configuration."}):s.jsx("div",{className:"space-y-3",children:T.map((H,te)=>s.jsxs("div",{className:"p-3 bg-slate-800/30 rounded-lg border border-slate-700 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[s.jsx(re,{label:"Name",placeholder:"e.g., API_KEY",value:H.name,onChange:_=>{const V=[...T];V[te].name=_.target.value.toUpperCase().replace(/[^A-Z0-9_]/g,"_"),P(V)}}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Value"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>{const _=[...T];_[te].source="variable",_[te].value="",P(_)},className:`px-2 py-0.5 text-[10px] rounded-md font-medium transition-all duration-150 ${H.source==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>{const _=[...T];_[te].source="manual",_[te].variableRef="",P(_)},className:`px-2 py-0.5 text-[10px] rounded-md font-medium transition-all duration-150 ${H.source==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),H.source==="variable"?s.jsx(le,{value:H.variableRef,onChange:_=>{const V=[...T];V[te].variableRef=_.target.value,P(V)},options:[{value:"",label:"Select a variable..."},...Object.keys(e.variables||{}).map(_=>({value:_,label:_}))]}):s.jsx(re,{value:H.value,onChange:_=>{const V=[...T];V[te].value=_.target.value,P(V)},placeholder:"Enter value..."})]})]}),s.jsx("button",{type:"button",onClick:()=>P(T.filter((_,V)=>V!==te)),className:"ml-3 mt-6 text-slate-400 hover:text-red-400",children:s.jsx(Qe,{className:"w-4 h-4"})})]}),H.name&&s.jsxs("div",{className:"text-xs text-slate-500",children:["YAML: ",s.jsxs("code",{className:"bg-slate-900/50 px-1 rounded text-slate-400",children:[H.name,": ",H.source==="variable"&&H.variableRef?`*${H.variableRef}`:H.value||'""']})]})]},te))}),Object.keys(e.variables||{}).length===0&&s.jsx("p",{className:"text-xs text-slate-500",children:"Configure variables in the Variables section to reference them here."})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(om,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Tags"})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Add metadata tags to your application for organization and filtering"}),Object.keys(N).length>0&&s.jsx("div",{className:"space-y-2",children:Object.entries(N).map(([H,te])=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm font-medium text-blue-400",children:H}),s.jsx("span",{className:"text-slate-500",children:"="}),s.jsx("span",{className:"text-sm text-slate-300",children:String(te)})]}),s.jsx("button",{type:"button",onClick:()=>{const _={...N};delete _[H],C(_)},className:"text-slate-400 hover:text-red-400",children:s.jsx(Qe,{className:"w-4 h-4"})})]},H))}),s.jsxs("div",{className:"flex items-end space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(re,{label:"Key",placeholder:"e.g., environment",value:j,onChange:H=>E(H.target.value)})}),s.jsx("div",{className:"flex-1",children:s.jsx(re,{label:"Value",placeholder:"e.g., production",value:y,onChange:H=>R(H.target.value)})}),s.jsxs(Q,{variant:"secondary",onClick:()=>{j&&y&&(C({...N,[j]:y}),E(""),R(""))},disabled:!j||!y,children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add"]})]})]}),s.jsxs(ke,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(im,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Permissions"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>A([...k,{principals:[],entitlements:[]}]),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Permission"]})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Configure who can access this application and with what permissions"}),k.length===0?s.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 text-slate-400 text-sm",children:"No permissions configured. Add permissions to control access to this application."}):s.jsx("div",{className:"space-y-3",children:k.map((H,te)=>s.jsxs("div",{className:"p-3 bg-slate-800/30 rounded-lg border border-slate-700 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium text-slate-300",children:["Permission Rule ",te+1]}),s.jsx("button",{type:"button",onClick:()=>A(k.filter((_,V)=>V!==te)),className:"text-slate-400 hover:text-red-400",children:s.jsx(Qe,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-xs font-medium text-slate-400",children:"Principals (users, groups, service principals)"}),s.jsx("div",{className:"flex flex-wrap gap-2 min-h-[32px]",children:H.principals.map((_,V)=>s.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-500/20 text-blue-300 rounded text-xs",children:[_,s.jsx("button",{type:"button",onClick:()=>{const W=[...k];W[te].principals=H.principals.filter((K,me)=>me!==V),A(W)},className:"ml-1.5 hover:text-white",children:s.jsx(qr,{className:"w-3 h-3"})})]},V))}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(re,{placeholder:"e.g., user@example.com or group_name",value:D,onChange:_=>S(_.target.value),className:"flex-1"}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>{if(D){const _=[...k];_[te].principals=[...H.principals,D],A(_),S("")}},disabled:!D,children:"Add"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-xs font-medium text-slate-400",children:"Entitlements"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:$.map(_=>s.jsx("button",{type:"button",onClick:()=>{const V=[...k];H.entitlements.includes(_.value)?V[te].entitlements=H.entitlements.filter(W=>W!==_.value):V[te].entitlements=[...H.entitlements,_.value],A(V)},className:Ye("px-2.5 py-1 rounded-lg text-xs transition-colors",H.entitlements.includes(_.value)?"bg-green-500/30 text-green-300 border border-green-500/50":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"),children:_.label},_.value))})]})]},te))})]}),s.jsxs(ke,{variant:"highlight",children:[s.jsx("h3",{className:"font-medium text-white mb-3",children:"Configuration Summary"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Application:"}),s.jsx("span",{className:"text-white ml-2",children:i.name||"Not set"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Agents:"}),s.jsxs(Ee,{variant:L.length>0?"success":"warning",className:"ml-2",children:[L.length," selected"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Orchestration:"}),s.jsx(Ee,{variant:O!=="none"?"info":"default",className:"ml-2",children:O==="supervisor"?"Supervisor":O==="swarm"?"Swarm":"None"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Endpoint:"}),s.jsx("span",{className:"text-white ml-2",children:i.endpointName||"Not set"})]})]})]}),s.jsxs("div",{className:"flex justify-end items-center space-x-3",children:[!ze&&s.jsx("span",{className:"text-sm text-slate-500",children:"No unsaved changes"}),s.jsxs(Q,{onClick:Mt,size:"lg",disabled:!ze,children:[s.jsx(Ow,{className:"w-4 h-4"}),"Save Configuration"]})]})]})}function MC({activeSection:e,onNavigate:t}){const n=()=>{switch(e){case"overview":return s.jsx(Fw,{onNavigate:t});case"variables":return s.jsx(_2,{});case"service_principals":return s.jsx(w2,{});case"schemas":return s.jsx(U2,{});case"resources":return s.jsx(q2,{});case"retrievers":return s.jsx(fC,{});case"tools":return s.jsx(xC,{});case"guardrails":return s.jsx(vC,{});case"memory":return s.jsx(bC,{});case"prompts":return s.jsx(NC,{});case"agents":return s.jsx(wC,{});case"app":return s.jsx(RC,{});default:return null}};return s.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-900/50",children:s.jsx("div",{className:"p-6 animate-fade-in",children:n()})})}async function r0(e){try{const t=ra(e);return await PC(t)}catch(t){return{valid:!1,errors:[],schemaError:t instanceof Error?t.message:"Validation failed"}}}async function PC(e){try{const t=await fetch("/api/validate/schema",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({yaml_content:e})});if(!t.ok){const r=await t.json().catch(()=>({error:t.statusText}));return{valid:!1,errors:[],schemaError:r.error||`Validation request failed: ${t.status}`}}const n=await t.json();return{valid:n.valid,errors:(n.errors||[]).map(r=>({path:r.path||"/",message:r.message||"Unknown validation error",keyword:r.type||"validation"})),warnings:(n.warnings||[]).map(r=>({path:r.path||"/",message:r.message||"Unknown warning",keyword:r.type||"warning"}))}}catch(t){return{valid:!1,errors:[],schemaError:t instanceof Error?t.message:"Validation request failed"}}}async function TC(){}function OC(e=500){const{config:t}=We(),[n,r]=M.useState(null),[a,l]=M.useState(!1),[o,c]=M.useState(!1),i=M.useRef(null);M.useEffect(()=>{TC().then(()=>{c(!0)})},[]),M.useEffect(()=>{if(o)return i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{l(!0);try{const m=await r0(t);r(m)}catch(m){r({valid:!1,errors:[],schemaError:m instanceof Error?m.message:"Validation failed"})}finally{l(!1)}},e),()=>{i.current&&clearTimeout(i.current)}},[t,o,e]);const u=M.useCallback(async()=>{l(!0);try{const m=await r0(t);return r(m),m}catch(m){const h={valid:!1,errors:[],schemaError:m instanceof Error?m.message:"Validation failed"};return r(h),h}finally{l(!1)}},[t]);return{validationResult:n,isValidating:a,schemaReady:o,validate:u,isValid:(n==null?void 0:n.valid)??null,errors:(n==null?void 0:n.errors)??[],schemaError:n==null?void 0:n.schemaError}}function IC(){const{config:e,setConfig:t}=We(),[n,r]=M.useState(!1),[a,l]=M.useState(!0),[o,c]=M.useState(!0),[i,u]=M.useState(""),[m,h]=M.useState(null),[f,g]=M.useState(!1),b=M.useRef(null),w=M.useRef(null),{isValid:x,errors:d,schemaError:p,isValidating:v,schemaReady:N}=OC(800),C=ra(e);M.useEffect(()=>{o&&(u(C),h(null),g(!1))},[C,o]),M.useEffect(()=>{i||u(C)},[C,i]);const j=M.useCallback(()=>{b.current&&w.current&&(w.current.scrollTop=b.current.scrollTop,w.current.scrollLeft=b.current.scrollLeft)},[]),{targetSection:E,targetAsset:y,scrollTimestamp:R,clearTarget:$}=qn(),k=o?C:i;M.useEffect(()=>{if(!E&&!y||!w.current)return;const Z=k.split(`
`);let ee=-1;if(E){const oe={schemas:["schemas:"],variables:["variables:"],service_principals:["service_principals:"],resources:["resources:"],retrievers:["retrievers:"],tools:["tools:"],guardrails:["guardrails:"],memory:["memory:"],prompts:["prompts:"],agents:["agents:"],app:["app:"]}[E]||[`${E}:`];for(let Y=0;Y<Z.length;Y++){const q=Z[Y];for(const se of oe)if(q.startsWith(se)){ee=Y;break}if(ee>=0)break}}else if(y){const ce=new RegExp(`^\\s*${y}:\\s*&${y}`),oe=new RegExp(`^\\s*${y}:`);for(let Y=0;Y<Z.length;Y++){const q=Z[Y];if(ce.test(q)){ee=Y;break}oe.test(q)&&(ee=Y)}}if(ee>=0){const oe=ee*24;w.current.scrollTo({top:Math.max(0,oe-48),behavior:"smooth"})}$()},[E,y,R,k,$]);const A=async()=>{await navigator.clipboard.writeText(o?C:i),r(!0),setTimeout(()=>r(!1),2e3)},D=B=>{var Z;u(B),g(B!==C);try{Bs.load(B),h(null)}catch(ee){ee instanceof Bs.YAMLException&&h({line:(Z=ee.mark)!=null&&Z.line?ee.mark.line+1:0,message:ee.message})}},S=()=>{if(!m)try{const B=jb(i);_b(B);const Z=Bs.load(i);t(Z),g(!1),c(!0)}catch(B){console.error("Failed to apply YAML changes:",B)}},T=()=>{u(C),h(null),g(!1)},P=()=>{if(!o&&f){if(!confirm("You have unsaved changes. Discard them?"))return;T()}c(!o)},I=(()=>{const B=new Set;return m!=null&&m.line&&B.add(m.line),B})(),O=B=>B.split(`
`).map((ee,ce)=>{const oe=ce+1,Y=I.has(oe);return s.jsx("div",{className:`text-right pr-3 select-none ${Y?"bg-red-500/20 text-red-400 font-bold":"text-slate-600"}`,style:{height:"1.5rem",lineHeight:"1.5rem"},children:oe},ce)}),F=B=>B.split(`
`).map((Z,ee)=>{const ce=ee+1,oe=I.has(ce);let Y;if(Z.trim().startsWith("#"))Y=s.jsx("span",{className:"text-slate-500",children:Z});else if(Z.match(/^(\s*)([a-zA-Z_][a-zA-Z0-9_]*):(.*)$/)){const q=Z.match(/^(\s*)([a-zA-Z_][a-zA-Z0-9_]*):(.*)$/),[,se,z,G]=q;Y=s.jsxs("span",{children:[se,s.jsx("span",{className:"text-blue-400",children:z}),s.jsx("span",{className:"text-slate-400",children:":"}),s.jsx("span",{className:"text-emerald-400",children:G})]})}else Z.trim().startsWith("-")?Y=s.jsx("span",{className:"text-amber-400",children:Z}):Y=s.jsx("span",{className:"text-slate-300",children:Z});return s.jsx("div",{className:`px-2 -mx-2 ${oe?"bg-red-500/20 border-l-2 border-red-500":"hover:bg-slate-800/30"}`,style:{height:"1.5rem",lineHeight:"1.5rem"},children:Y},ee)}),U=()=>!o&&m?s.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[s.jsx(Vn,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-xs",children:["YAML Error (line ",m.line,")"]})]}):N?v?s.jsxs("div",{className:"flex items-center space-x-2 text-slate-400",children:[s.jsx(xt,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-xs",children:"Validating..."})]}):p?s.jsxs("div",{className:"flex items-center space-x-2 text-amber-400",children:[s.jsx(Xa,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs",title:p,children:"Schema error"})]}):x===!0?s.jsxs("div",{className:"flex items-center space-x-2 text-emerald-400",children:[s.jsx(Av,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs",children:"Valid"})]}):x===!1?s.jsxs("button",{onClick:()=>l(!a),className:"flex items-center space-x-2 text-red-400 hover:text-red-300 transition-colors",children:[s.jsx(Vn,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-xs",children:[d.length," error",d.length!==1?"s":""]}),a?s.jsx(Ur,{className:"w-3 h-3"}):s.jsx(rs,{className:"w-3 h-3"})]}):null:s.jsxs("div",{className:"flex items-center space-x-2 text-slate-400",children:[s.jsx(xt,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-xs",children:"Loading schema..."})]});return s.jsxs("div",{className:"h-full flex flex-col bg-slate-950",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-800",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Pf,{className:"w-4 h-4 text-slate-400"}),s.jsxs("span",{className:"text-sm font-medium text-slate-300",children:["YAML ",o?"Preview":"Editor"]}),!o&&f&&s.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-500/20 text-amber-400 rounded",children:"Modified"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[U(),s.jsx(Q,{variant:"ghost",size:"sm",onClick:P,title:o?"Unlock to edit YAML":"Lock to prevent edits",className:o?"":"text-amber-400 hover:text-amber-300",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Tf,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Locked"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Lw,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Editing"})]})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:A,children:n?s.jsxs(s.Fragment,{children:[s.jsx(ac,{className:"w-4 h-4 text-emerald-400"}),s.jsx("span",{className:"text-emerald-400",children:"Copied!"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Sw,{className:"w-4 h-4"}),"Copy"]})})]})]}),!o&&s.jsx("div",{className:"px-4 py-2 bg-amber-950/30 border-b border-amber-900/50",children:s.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-400",children:[s.jsx(Uc,{className:"w-3 h-3"}),s.jsx("span",{children:"Edit mode: Changes here will update the UI configuration when applied"})]})}),!o&&m&&s.jsx("div",{className:"border-b border-slate-800 bg-red-950/30 px-4 py-2",children:s.jsxs("div",{className:"text-xs flex items-start space-x-2",children:[s.jsxs("span",{className:"text-red-400 font-mono shrink-0",children:["Line ",m.line,":"]}),s.jsx("span",{className:"text-red-300",children:m.message})]})}),x===!1&&a&&d.length>0&&!m&&s.jsx("div",{className:"border-b border-slate-800 bg-red-950/30 max-h-48 overflow-auto",children:s.jsx("div",{className:"px-4 py-2 space-y-1",children:d.map((B,Z)=>s.jsxs("div",{className:"text-xs flex items-start space-x-2",children:[s.jsx("span",{className:"text-red-400 font-mono shrink-0",children:B.path||"/"}),s.jsx("span",{className:"text-red-300",children:B.message})]},Z))})}),p&&s.jsxs("div",{className:"border-b border-slate-800 bg-amber-950/30 px-4 py-2",children:[s.jsxs("p",{className:"text-xs text-amber-400",children:[s.jsx("strong",{children:"Schema Error:"})," ",p]}),s.jsx("p",{className:"text-xs text-amber-500 mt-1",children:"Validation is unavailable. The YAML may still be valid."})]}),s.jsx("div",{className:"flex-1 overflow-auto",ref:w,children:s.jsxs("div",{className:"flex min-h-full",children:[s.jsx("div",{className:"w-12 bg-slate-900/50 border-r border-slate-800 font-mono text-sm flex-shrink-0 sticky left-0",style:{lineHeight:"1.5rem"},children:s.jsx("div",{className:"py-4",children:O(k)})}),s.jsx("div",{className:"flex-1 min-w-0",children:o?s.jsx("pre",{className:"code-block text-sm p-4",style:{lineHeight:"1.5rem"},children:F(k)}):s.jsx("textarea",{ref:b,value:i,onChange:B=>D(B.target.value),onScroll:j,spellCheck:!1,className:"w-full h-full p-4 bg-transparent text-slate-300 font-mono text-sm resize-none focus:outline-none",style:{lineHeight:"1.5rem",tabSize:2,minHeight:"100%"}})})]})}),s.jsx("div",{className:"px-4 py-3 border-t border-slate-800 bg-slate-900/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-xs text-slate-500",children:[k.split(`
`).length," lines  ",o?"Auto-updates as you configure":"Editing manually"]}),!o&&f?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:T,children:"Discard"}),s.jsxs(Q,{variant:"primary",size:"sm",onClick:S,disabled:!!m,children:[s.jsx(ac,{className:"w-4 h-4"}),"Apply Changes"]})]}):N&&!p&&s.jsx("p",{className:"text-xs text-slate-600",children:"Validated against dao-ai schema"})]})})]})}const LC={};function $C(e,t){let n;try{n=e()}catch{return}return{getItem:a=>{var l;const o=i=>i===null?null:JSON.parse(i,void 0),c=(l=n.getItem(a))!=null?l:null;return c instanceof Promise?c.then(o):o(c)},setItem:(a,l)=>n.setItem(a,JSON.stringify(l,void 0)),removeItem:a=>n.removeItem(a)}}const po=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return po(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return po(r)(n)}}}},DC=(e,t)=>(n,r,a)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,d)=>({...d,...x}),...t},o=!1;const c=new Set,i=new Set;let u;try{u=l.getStorage()}catch{}if(!u)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),n(...x)},r,a);const m=po(l.serialize),h=()=>{const x=l.partialize({...r()});let d;const p=m({state:x,version:l.version}).then(v=>u.setItem(l.name,v)).catch(v=>{d=v});if(d)throw d;return p},f=a.setState;a.setState=(x,d)=>{f(x,d),h()};const g=e((...x)=>{n(...x),h()},r,a);let b;const w=()=>{var x;if(!u)return;o=!1,c.forEach(p=>p(r()));const d=((x=l.onRehydrateStorage)==null?void 0:x.call(l,r()))||void 0;return po(u.getItem.bind(u))(l.name).then(p=>{if(p)return l.deserialize(p)}).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==l.version){if(l.migrate)return l.migrate(p.state,p.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return p.state}).then(p=>{var v;return b=l.merge(p,(v=r())!=null?v:g),n(b,!0),h()}).then(()=>{d==null||d(b,void 0),o=!0,i.forEach(p=>p(b))}).catch(p=>{d==null||d(void 0,p)})};return a.persist={setOptions:x=>{l={...l,...x},x.getStorage&&(u=x.getStorage())},clearStorage:()=>{u==null||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:x=>(c.add(x),()=>{c.delete(x)}),onFinishHydration:x=>(i.add(x),()=>{i.delete(x)})},w(),b||g},FC=(e,t)=>(n,r,a)=>{let l={storage:$C(()=>localStorage),partialize:w=>w,version:0,merge:(w,x)=>({...x,...w}),...t},o=!1;const c=new Set,i=new Set;let u=l.storage;if(!u)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),n(...w)},r,a);const m=()=>{const w=l.partialize({...r()});return u.setItem(l.name,{state:w,version:l.version})},h=a.setState;a.setState=(w,x)=>{h(w,x),m()};const f=e((...w)=>{n(...w),m()},r,a);a.getInitialState=()=>f;let g;const b=()=>{var w,x;if(!u)return;o=!1,c.forEach(p=>{var v;return p((v=r())!=null?v:f)});const d=((x=l.onRehydrateStorage)==null?void 0:x.call(l,(w=r())!=null?w:f))||void 0;return po(u.getItem.bind(u))(l.name).then(p=>{if(p)if(typeof p.version=="number"&&p.version!==l.version){if(l.migrate)return[!0,l.migrate(p.state,p.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,p.state];return[!1,void 0]}).then(p=>{var v;const[N,C]=p;if(g=l.merge(C,(v=r())!=null?v:f),n(g,!0),N)return m()}).then(()=>{d==null||d(g,void 0),g=r(),o=!0,i.forEach(p=>p(g))}).catch(p=>{d==null||d(void 0,p)})};return a.persist={setOptions:w=>{l={...l,...w},w.storage&&(u=w.storage)},clearStorage:()=>{u==null||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:w=>(c.add(w),()=>{c.delete(w)}),onFinishHydration:w=>(i.add(w),()=>{i.delete(w)})},l.skipHydration||b(),g||f},VC=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((LC?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),DC(e,t)):FC(e,t),Tb=VC,a0=()=>`conv-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,Ob=cl()(Tb(e=>({conversationId:a0(),messages:[],logs:[],addMessage:(t,n)=>{e(r=>({messages:[...r.messages,{role:t,content:n,timestamp:new Date().toISOString()}]}))},updateLastMessage:t=>{e(n=>{const r=[...n.messages];return r.length>0&&(r[r.length-1]={...r[r.length-1],content:t}),{messages:r}})},addLog:(t,n)=>{e(r=>({logs:[...r.logs,{timestamp:new Date().toISOString(),level:t,message:n}]}))},clearLogs:()=>{e({logs:[]})},startNewSession:()=>{e({conversationId:a0(),messages:[],logs:[]})},removeEmptyMessages:()=>{e(t=>({messages:t.messages.filter(n=>n.content||n.role==="user")}))}}),{name:"dao-chat-storage",partialize:e=>({conversationId:e.conversationId,messages:e.messages})}));function li({isOpen:e,onClose:t,onConfigured:n,autoDetectedHost:r,inDatabricksApp:a=!1,hasOboToken:l=!1,oauthInfo:o}){const[c,i]=M.useState(""),[u,m]=M.useState(""),[h,f]=M.useState(!1),[g,b]=M.useState(!1),[w,x]=M.useState(null),d=Br();M.useEffect(()=>{if(e){const y=Br();y?(i(y.host),m(y.token)):r&&i(r),x(null)}},[e,r]);const p=async()=>{if(u){f(!0),x(null);try{console.log("[DatabricksConfigModal] Testing manual token...");const y=await fetch("/api/auth/verify",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json","X-Databricks-Host":(c||r||"").replace(/\/$/,"")},credentials:"include"}),R=await y.json();if(console.log("[DatabricksConfigModal] Verify response:",R),R.authenticated&&R.user){const $=R.token_source==="manual"?"Personal Access Token":R.token_source==="obo"?"On-Behalf-Of User":R.token_source==="oauth"?"OAuth":R.token_source==="sdk"?"SDK Config":R.token_source==="env"?"Environment Variable":R.token_source;Rl({host:R.host||c||r||"",token:u,source:"manual"}),x({success:!0,message:`Connected as ${R.user.displayName||R.user.userName}`,tokenSource:$})}else{const $=R.error||R.message||R.help||`Connection failed (${y.status}): ${y.statusText||"Unknown error"}`;x({success:!1,message:$,requiredScopes:R.required_scopes})}}catch(y){const R=y instanceof Error?`${y.name}: ${y.message}`:"Connection failed - unknown error";x({success:!1,message:R})}finally{f(!1)}}else{f(!0),x(null);try{const R=await(await fetch("/api/auth/verify",{credentials:"include"})).json();R.authenticated&&R.user?(Rl({host:R.host||r||"",token:`__${(R.token_source||"AUTO").toUpperCase()}_TOKEN__`,isAutoDetected:!0,source:R.token_source}),x({success:!0,message:`Connected as ${R.user.displayName||R.user.userName}`})):x({success:!1,message:R.error||R.help||"Authentication failed",requiredScopes:R.required_scopes})}catch(y){const R=y instanceof Error?`${y.name}: ${y.message}`:"Connection failed - unknown error";x({success:!1,message:R})}finally{f(!1)}}},v=()=>{if(u)Rl({host:c||r||"",token:u,source:"manual"});else if(w!=null&&w.success){const y=Br();y&&Rl(y)}else return;n(),t()},N=async()=>{(d==null?void 0:d.source)==="oauth"&&await A2(),kb(),i(r||""),m(""),x(null),n(),t()},C=async()=>{b(!0),x(null);try{const R=await E2(c||r||void 0);R.auth_url&&R.redirect?window.location.href=R.auth_url:R.error&&x({success:!1,message:R.message||R.error})}catch(y){x({success:!1,message:y instanceof Error?y.message:"OAuth login failed"})}finally{b(!1)}},j=y=>{switch(y){case"oauth":return"OAuth";case"obo":return"On-Behalf-Of User";case"header":return"On-Behalf-Of User Auth";case"sdk":return"Databricks SDK Config";case"env":return"Environment Variables";case"manual":return"Manual Configuration";default:return"Unknown"}},E=y=>{switch(y){case"oauth":return rm;case"obo":case"header":return Sr;case"sdk":case"env":return io;default:return oc}};return s.jsx(An,{isOpen:e,onClose:t,title:"Databricks Connection",description:"Configure your Databricks workspace connection.",children:s.jsxs("div",{className:"space-y-4",children:[a&&l&&(d==null?void 0:d.source)==="obo"&&s.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Sr,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"text-blue-300 font-medium",children:"On-Behalf-Of User Authentication Active"}),s.jsx("p",{className:"text-blue-400/80 mt-1",children:"API calls are authenticated using your Databricks session. No manual token required."})]})]})}),a&&!l&&!d&&s.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Xa,{className:"w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"text-amber-300 font-medium",children:"On-Behalf-Of User Auth Not Enabled"}),s.jsx("p",{className:"text-amber-400/80 mt-1",children:"This app is running in Databricks but OBO auth is not enabled. You can still configure a Personal Access Token manually."})]})]})}),(d==null?void 0:d.isAutoDetected)&&d.source!=="obo"&&s.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[(()=>{const y=E(d.source);return s.jsx(y,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"})})(),s.jsxs("div",{className:"text-sm",children:[s.jsxs("p",{className:"text-green-300 font-medium",children:["Connected via ",j(d.source)]}),s.jsx("p",{className:"text-green-400/80 mt-1",children:d.source==="oauth"?"Authenticated via OAuth. Your session is secure.":d.source==="sdk"?"Using Databricks SDK Config (~/.databrickscfg or environment variables).":d.source==="env"?"Using DATABRICKS_HOST and DATABRICKS_TOKEN environment variables.":"Using X-Forwarded-Access-Token from Databricks App proxy."}),d.host&&s.jsxs("p",{className:"text-green-400/60 mt-1 font-mono text-xs",children:["Host: ",d.host]})]})]})}),(o==null?void 0:o.configured)&&!d&&s.jsx("div",{className:"p-4 rounded-lg bg-gradient-to-r from-blue-600/20 to-purple-600/20 border border-blue-500/30",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(rm,{className:"w-6 h-6 text-blue-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-300 font-medium",children:"Login with Databricks"}),s.jsx("p",{className:"text-blue-400/80 text-sm mt-1",children:"Securely authenticate with OAuth to access Databricks APIs."}),o.scopes&&o.scopes.length>0&&s.jsxs("p",{className:"text-blue-400/60 text-xs mt-2",children:["Scopes: ",o.scopes.slice(0,3).join(", "),o.scopes.length>3&&` +${o.scopes.length-3} more`]})]})]}),s.jsx(Q,{type:"button",onClick:C,disabled:g||!c,className:"flex items-center space-x-2",children:g?"Redirecting...":s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Login"}),s.jsx(Cw,{className:"w-4 h-4"})]})})]})}),r&&!d&&s.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(oc,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"text-blue-300 font-medium",children:"Workspace Detected"}),s.jsxs("p",{className:"text-blue-400/80 mt-1",children:["Host auto-detected. Enter your Personal Access Token or set ",s.jsx("code",{className:"text-xs bg-blue-900/50 px-1 rounded",children:"DATABRICKS_TOKEN"})," env var."]})]})]})}),s.jsx(re,{label:"Workspace URL",placeholder:"https://your-workspace.cloud.databricks.com",value:c,onChange:y=>i(y.target.value),hint:r?"Auto-detected from URL (editable)":"Your Databricks workspace URL",required:!0}),s.jsx(re,{label:"Personal Access Token",type:"password",placeholder:"dapi...",value:u,onChange:y=>m(y.target.value),hint:"Or set DATABRICKS_TOKEN environment variable",required:!0}),!(d!=null&&d.isAutoDetected)&&s.jsx("div",{className:"p-3 rounded-lg bg-slate-800/50 border border-slate-700",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Xa,{className:"w-5 h-5 text-slate-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-slate-400",children:[s.jsx("p",{className:"font-medium text-slate-300",children:"Authentication Options"}),s.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-xs",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"On-behalf-of-user auth"})," - Automatic in Databricks Apps"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Personal Access Token"})," - Enter manually below"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Environment variable"})," - Set ",s.jsx("code",{className:"bg-slate-700 px-1 rounded",children:"DATABRICKS_TOKEN"})]})]}),s.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[s.jsx("strong",{children:"Scope errors?"})," If using OBO auth, try signing out of Databricks and signing back in to re-authorize the app with updated scopes."]})]})]})}),w&&s.jsxs("div",{className:`p-3 rounded-lg text-sm ${w.success?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:w.message}),w.success&&w.tokenSource&&s.jsxs("span",{className:"text-xs bg-green-900/30 px-2 py-0.5 rounded",children:["via ",w.tokenSource]})]}),w.requiredScopes&&w.requiredScopes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-red-500/20",children:[s.jsx("p",{className:"font-medium mb-1",children:"Required scopes:"}),s.jsx("ul",{className:"list-disc list-inside text-xs space-y-0.5",children:w.requiredScopes.map(y=>s.jsx("li",{children:s.jsx("code",{className:"bg-red-900/30 px-1 rounded",children:y})},y))}),s.jsxs("p",{className:"mt-2 text-xs text-red-300/80",children:["Add these to ",s.jsx("code",{className:"bg-red-900/30 px-1 rounded",children:"user_api_scopes"})," in databricks.yml and redeploy."]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx(Q,{variant:"danger",type:"button",onClick:N,disabled:!Br(),children:"Disconnect"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:p,disabled:h||!u&&!l&&!a,children:h?"Testing...":"Test Connection"}),s.jsx(Q,{type:"button",onClick:v,disabled:!(w!=null&&w.success),children:"Save"})]})]}),s.jsx("div",{className:"pt-4 border-t border-slate-700",children:s.jsx("p",{className:"text-xs text-slate-500",children:"Credentials are stored in browser localStorage and sent only to your Databricks workspace."})})]})})}function zC(){const[e,t]=M.useState(!1),{detecting:n,detected:r,autoDetectedHost:a,inDatabricksApp:l,hasToken:o,oauthInfo:c,redetect:i}=O2(),{data:u,loading:m,error:h,refetch:f,configured:g}=I2(),b=M.useCallback(()=>{console.log("[ConnectionStatus] Config changed, re-detecting and refetching..."),i(),f()},[f,i]);if(M.useEffect(()=>{!n&&r&&f()},[n,r,f]),n)return s.jsxs("div",{className:"flex items-center space-x-2 text-slate-400",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"}),s.jsx("span",{className:"text-sm",children:"Detecting..."})]});if(!g)return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 text-slate-400 hover:text-white transition-colors",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-500"}),s.jsx("span",{className:"text-sm",children:a?"Token required":"Not connected"}),s.jsx(Ss,{className:"w-4 h-4"})]}),s.jsx(li,{isOpen:e,onClose:()=>t(!1),onConfigured:b,autoDetectedHost:a,oauthInfo:c})]});if(m)return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 text-slate-400",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"}),s.jsx("span",{className:"text-sm",children:"Connecting..."}),s.jsx(Ss,{className:"w-4 h-4"})]}),s.jsx(li,{isOpen:e,onClose:()=>t(!1),onConfigured:b,autoDetectedHost:a,oauthInfo:c})]});if(h||!(u!=null&&u.connected))return console.log("[ConnectionStatus] Showing failed state - error:",h,"status:",u),s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 text-red-400 hover:text-red-300 transition-colors",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),s.jsxs("span",{className:"text-sm",children:["Connection failed",u!=null&&u.error?`: ${u.error}`:""]}),s.jsx(Ss,{className:"w-4 h-4"})]}),s.jsx(li,{isOpen:e,onClose:()=>t(!1),onConfigured:b,autoDetectedHost:a,oauthInfo:c})]});const w=u.source==="oauth"?"OAuth":u.source==="obo"?"On-Behalf-Of User":u.source==="sdk"?"SDK Config":u.source==="env"?"Environment":"Manual",d=u.source==="oauth"?rm:u.source==="obo"?Sr:oc;return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 hover:bg-slate-800 px-2 py-1 rounded transition-colors",title:`Connected via ${w} authentication`,children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),u.isAutoDetected&&s.jsx(d,{className:`w-3 h-3 ${u.source==="obo"?"text-blue-400":"text-yellow-400"}`}),s.jsx("span",{className:"text-sm text-slate-300",children:s.jsx("span",{className:"text-white font-medium",children:u.display_name||u.user})}),s.jsx(Ss,{className:"w-4 h-4 text-slate-500"})]}),s.jsx(li,{isOpen:e,onClose:()=>t(!1),onConfigured:b,autoDetectedHost:a,inDatabricksApp:l,hasOboToken:o,oauthInfo:c})]})}function _t(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=_t(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var HC={value:()=>{}};function Xc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ri(n)}function Ri(e){this._=e}function UC(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ri.prototype=Xc.prototype={constructor:Ri,on:function(e,t){var n=this._,r=UC(e+"",n),a,l=-1,o=r.length;if(arguments.length<2){for(;++l<o;)if((a=(e=r[l]).type)&&(a=BC(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<o;)if(a=(e=r[l]).type)n[a]=l0(n[a],e.name,t);else if(t==null)for(a in n)n[a]=l0(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ri(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,l;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],r=0,a=l.length;r<a;++r)l[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,l=r.length;a<l;++a)r[a].value.apply(t,n)}};function BC(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function l0(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=HC,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Nm="http://www.w3.org/1999/xhtml";const o0={svg:"http://www.w3.org/2000/svg",xhtml:Nm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),o0.hasOwnProperty(t)?{space:o0[t],local:e}:e}function WC(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Nm&&t.documentElement.namespaceURI===Nm?t.createElement(e):t.createElementNS(n,e)}}function GC(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ib(e){var t=Qc(e);return(t.local?GC:WC)(t)}function YC(){}function Hf(e){return e==null?YC:function(){return this.querySelector(e)}}function qC(e){typeof e!="function"&&(e=Hf(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var l=t[a],o=l.length,c=r[a]=new Array(o),i,u,m=0;m<o;++m)(i=l[m])&&(u=e.call(i,i.__data__,m,l))&&("__data__"in i&&(u.__data__=i.__data__),c[m]=u);return new Mn(r,this._parents)}function XC(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function QC(){return[]}function Lb(e){return e==null?QC:function(){return this.querySelectorAll(e)}}function KC(e){return function(){return XC(e.apply(this,arguments))}}function ZC(e){typeof e=="function"?e=KC(e):e=Lb(e);for(var t=this._groups,n=t.length,r=[],a=[],l=0;l<n;++l)for(var o=t[l],c=o.length,i,u=0;u<c;++u)(i=o[u])&&(r.push(e.call(i,i.__data__,u,o)),a.push(i));return new Mn(r,a)}function $b(e){return function(){return this.matches(e)}}function Db(e){return function(t){return t.matches(e)}}var JC=Array.prototype.find;function ek(e){return function(){return JC.call(this.children,e)}}function tk(){return this.firstElementChild}function nk(e){return this.select(e==null?tk:ek(typeof e=="function"?e:Db(e)))}var sk=Array.prototype.filter;function rk(){return Array.from(this.children)}function ak(e){return function(){return sk.call(this.children,e)}}function lk(e){return this.selectAll(e==null?rk:ak(typeof e=="function"?e:Db(e)))}function ok(e){typeof e!="function"&&(e=$b(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var l=t[a],o=l.length,c=r[a]=[],i,u=0;u<o;++u)(i=l[u])&&e.call(i,i.__data__,u,l)&&c.push(i);return new Mn(r,this._parents)}function Fb(e){return new Array(e.length)}function ik(){return new Mn(this._enter||this._groups.map(Fb),this._parents)}function pc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}pc.prototype={constructor:pc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ck(e){return function(){return e}}function uk(e,t,n,r,a,l){for(var o=0,c,i=t.length,u=l.length;o<u;++o)(c=t[o])?(c.__data__=l[o],r[o]=c):n[o]=new pc(e,l[o]);for(;o<i;++o)(c=t[o])&&(a[o]=c)}function dk(e,t,n,r,a,l,o){var c,i,u=new Map,m=t.length,h=l.length,f=new Array(m),g;for(c=0;c<m;++c)(i=t[c])&&(f[c]=g=o.call(i,i.__data__,c,t)+"",u.has(g)?a[c]=i:u.set(g,i));for(c=0;c<h;++c)g=o.call(e,l[c],c,l)+"",(i=u.get(g))?(r[c]=i,i.__data__=l[c],u.delete(g)):n[c]=new pc(e,l[c]);for(c=0;c<m;++c)(i=t[c])&&u.get(f[c])===i&&(a[c]=i)}function mk(e){return e.__data__}function fk(e,t){if(!arguments.length)return Array.from(this,mk);var n=t?dk:uk,r=this._parents,a=this._groups;typeof e!="function"&&(e=ck(e));for(var l=a.length,o=new Array(l),c=new Array(l),i=new Array(l),u=0;u<l;++u){var m=r[u],h=a[u],f=h.length,g=hk(e.call(m,m&&m.__data__,u,r)),b=g.length,w=c[u]=new Array(b),x=o[u]=new Array(b),d=i[u]=new Array(f);n(m,h,w,x,d,g,t);for(var p=0,v=0,N,C;p<b;++p)if(N=w[p]){for(p>=v&&(v=p+1);!(C=x[v])&&++v<b;);N._next=C||null}}return o=new Mn(o,r),o._enter=c,o._exit=i,o}function hk(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pk(){return new Mn(this._exit||this._groups.map(Fb),this._parents)}function xk(e,t,n){var r=this.enter(),a=this,l=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?l.remove():n(l),r&&a?r.merge(a).order():a}function gk(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,l=r.length,o=Math.min(a,l),c=new Array(a),i=0;i<o;++i)for(var u=n[i],m=r[i],h=u.length,f=c[i]=new Array(h),g,b=0;b<h;++b)(g=u[b]||m[b])&&(f[b]=g);for(;i<a;++i)c[i]=n[i];return new Mn(c,this._parents)}function vk(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,l=r[a],o;--a>=0;)(o=r[a])&&(l&&o.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(o,l),l=o);return this}function bk(e){e||(e=yk);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,a=new Array(r),l=0;l<r;++l){for(var o=n[l],c=o.length,i=a[l]=new Array(c),u,m=0;m<c;++m)(u=o[m])&&(i[m]=u);i.sort(t)}return new Mn(a,this._parents).order()}function yk(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Nk(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function jk(){return Array.from(this)}function _k(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,l=r.length;a<l;++a){var o=r[a];if(o)return o}return null}function wk(){let e=0;for(const t of this)++e;return e}function Sk(){return!this.node()}function Ck(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],l=0,o=a.length,c;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a);return this}function kk(e){return function(){this.removeAttribute(e)}}function Ek(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ak(e,t){return function(){this.setAttribute(e,t)}}function Rk(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Mk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Pk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Tk(e,t){var n=Qc(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Ek:kk:typeof t=="function"?n.local?Pk:Mk:n.local?Rk:Ak)(n,t))}function Vb(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Ok(e){return function(){this.style.removeProperty(e)}}function Ik(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Lk(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function $k(e,t,n){return arguments.length>1?this.each((t==null?Ok:typeof t=="function"?Lk:Ik)(e,t,n??"")):Ja(this.node(),e)}function Ja(e,t){return e.style.getPropertyValue(t)||Vb(e).getComputedStyle(e,null).getPropertyValue(t)}function Dk(e){return function(){delete this[e]}}function Fk(e,t){return function(){this[e]=t}}function Vk(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function zk(e,t){return arguments.length>1?this.each((t==null?Dk:typeof t=="function"?Vk:Fk)(e,t)):this.node()[e]}function zb(e){return e.trim().split(/^|\s+/)}function Uf(e){return e.classList||new Hb(e)}function Hb(e){this._node=e,this._names=zb(e.getAttribute("class")||"")}Hb.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ub(e,t){for(var n=Uf(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Bb(e,t){for(var n=Uf(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Hk(e){return function(){Ub(this,e)}}function Uk(e){return function(){Bb(this,e)}}function Bk(e,t){return function(){(t.apply(this,arguments)?Ub:Bb)(this,e)}}function Wk(e,t){var n=zb(e+"");if(arguments.length<2){for(var r=Uf(this.node()),a=-1,l=n.length;++a<l;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?Bk:t?Hk:Uk)(n,t))}function Gk(){this.textContent=""}function Yk(e){return function(){this.textContent=e}}function qk(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Xk(e){return arguments.length?this.each(e==null?Gk:(typeof e=="function"?qk:Yk)(e)):this.node().textContent}function Qk(){this.innerHTML=""}function Kk(e){return function(){this.innerHTML=e}}function Zk(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Jk(e){return arguments.length?this.each(e==null?Qk:(typeof e=="function"?Zk:Kk)(e)):this.node().innerHTML}function e4(){this.nextSibling&&this.parentNode.appendChild(this)}function t4(){return this.each(e4)}function n4(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function s4(){return this.each(n4)}function r4(e){var t=typeof e=="function"?e:Ib(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function a4(){return null}function l4(e,t){var n=typeof e=="function"?e:Ib(e),r=t==null?a4:typeof t=="function"?t:Hf(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function o4(){var e=this.parentNode;e&&e.removeChild(this)}function i4(){return this.each(o4)}function c4(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function u4(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function d4(e){return this.select(e?u4:c4)}function m4(e){return arguments.length?this.property("__data__",e):this.node().__data__}function f4(e){return function(t){e.call(this,t,this.__data__)}}function h4(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function p4(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,l;n<a;++n)l=t[n],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++r]=l;++r?t.length=r:delete this.__on}}}function x4(e,t,n){return function(){var r=this.__on,a,l=f4(t);if(r){for(var o=0,c=r.length;o<c;++o)if((a=r[o]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=n),a.value=t;return}}this.addEventListener(e.type,l,n),a={type:e.type,name:e.name,value:t,listener:l,options:n},r?r.push(a):this.__on=[a]}}function g4(e,t,n){var r=h4(e+""),a,l=r.length,o;if(arguments.length<2){var c=this.node().__on;if(c){for(var i=0,u=c.length,m;i<u;++i)for(a=0,m=c[i];a<l;++a)if((o=r[a]).type===m.type&&o.name===m.name)return m.value}return}for(c=t?x4:p4,a=0;a<l;++a)this.each(c(r[a],t,n));return this}function Wb(e,t,n){var r=Vb(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function v4(e,t){return function(){return Wb(this,e,t)}}function b4(e,t){return function(){return Wb(this,e,t.apply(this,arguments))}}function y4(e,t){return this.each((typeof t=="function"?b4:v4)(e,t))}function*N4(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,l=r.length,o;a<l;++a)(o=r[a])&&(yield o)}var Gb=[null];function Mn(e,t){this._groups=e,this._parents=t}function To(){return new Mn([[document.documentElement]],Gb)}function j4(){return this}Mn.prototype=To.prototype={constructor:Mn,select:qC,selectAll:ZC,selectChild:nk,selectChildren:lk,filter:ok,data:fk,enter:ik,exit:pk,join:xk,merge:gk,selection:j4,order:vk,sort:bk,call:Nk,nodes:jk,node:_k,size:wk,empty:Sk,each:Ck,attr:Tk,style:$k,property:zk,classed:Wk,text:Xk,html:Jk,raise:t4,lower:s4,append:r4,insert:l4,remove:i4,clone:d4,datum:m4,on:g4,dispatch:y4,[Symbol.iterator]:N4};function Cn(e){return typeof e=="string"?new Mn([[document.querySelector(e)]],[document.documentElement]):new Mn([[e]],Gb)}function _4(e){let t;for(;t=e.sourceEvent;)e=t;return e}function es(e,t){if(e=_4(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const w4={passive:!1},xo={capture:!0,passive:!1};function Ku(e){e.stopImmediatePropagation()}function Fa(e){e.preventDefault(),e.stopImmediatePropagation()}function Yb(e){var t=e.document.documentElement,n=Cn(e).on("dragstart.drag",Fa,xo);"onselectstart"in t?n.on("selectstart.drag",Fa,xo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function qb(e,t){var n=e.document.documentElement,r=Cn(e).on("dragstart.drag",null);t&&(r.on("click.drag",Fa,xo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const oi=e=>()=>e;function jm(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:l,x:o,y:c,dx:i,dy:u,dispatch:m}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:i,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:m}})}jm.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function S4(e){return!e.ctrlKey&&!e.button}function C4(){return this.parentNode}function k4(e,t){return t??{x:e.x,y:e.y}}function E4(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xb(){var e=S4,t=C4,n=k4,r=E4,a={},l=Xc("start","drag","end"),o=0,c,i,u,m,h=0;function f(N){N.on("mousedown.drag",g).filter(r).on("touchstart.drag",x).on("touchmove.drag",d,w4).on("touchend.drag touchcancel.drag",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(N,C){if(!(m||!e.call(this,N,C))){var j=v(this,t.call(this,N,C),N,C,"mouse");j&&(Cn(N.view).on("mousemove.drag",b,xo).on("mouseup.drag",w,xo),Yb(N.view),Ku(N),u=!1,c=N.clientX,i=N.clientY,j("start",N))}}function b(N){if(Fa(N),!u){var C=N.clientX-c,j=N.clientY-i;u=C*C+j*j>h}a.mouse("drag",N)}function w(N){Cn(N.view).on("mousemove.drag mouseup.drag",null),qb(N.view,u),Fa(N),a.mouse("end",N)}function x(N,C){if(e.call(this,N,C)){var j=N.changedTouches,E=t.call(this,N,C),y=j.length,R,$;for(R=0;R<y;++R)($=v(this,E,N,C,j[R].identifier,j[R]))&&(Ku(N),$("start",N,j[R]))}}function d(N){var C=N.changedTouches,j=C.length,E,y;for(E=0;E<j;++E)(y=a[C[E].identifier])&&(Fa(N),y("drag",N,C[E]))}function p(N){var C=N.changedTouches,j=C.length,E,y;for(m&&clearTimeout(m),m=setTimeout(function(){m=null},500),E=0;E<j;++E)(y=a[C[E].identifier])&&(Ku(N),y("end",N,C[E]))}function v(N,C,j,E,y,R){var $=l.copy(),k=es(R||j,C),A,D,S;if((S=n.call(N,new jm("beforestart",{sourceEvent:j,target:f,identifier:y,active:o,x:k[0],y:k[1],dx:0,dy:0,dispatch:$}),E))!=null)return A=S.x-k[0]||0,D=S.y-k[1]||0,function T(P,L,I){var O=k,F;switch(P){case"start":a[y]=T,F=o++;break;case"end":delete a[y],--o;case"drag":k=es(I||L,C),F=o;break}$.call(P,N,new jm(P,{sourceEvent:L,subject:S,target:f,identifier:y,active:F,x:k[0]+A,y:k[1]+D,dx:k[0]-O[0],dy:k[1]-O[1],dispatch:$}),E)}}return f.filter=function(N){return arguments.length?(e=typeof N=="function"?N:oi(!!N),f):e},f.container=function(N){return arguments.length?(t=typeof N=="function"?N:oi(N),f):t},f.subject=function(N){return arguments.length?(n=typeof N=="function"?N:oi(N),f):n},f.touchable=function(N){return arguments.length?(r=typeof N=="function"?N:oi(!!N),f):r},f.on=function(){var N=l.on.apply(l,arguments);return N===l?f:N},f.clickDistance=function(N){return arguments.length?(h=(N=+N)*N,f):Math.sqrt(h)},f}function Bf(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Qb(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Oo(){}var go=.7,xc=1/go,Va="\\s*([+-]?\\d+)\\s*",vo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",As="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",A4=/^#([0-9a-f]{3,8})$/,R4=new RegExp(`^rgb\\(${Va},${Va},${Va}\\)$`),M4=new RegExp(`^rgb\\(${As},${As},${As}\\)$`),P4=new RegExp(`^rgba\\(${Va},${Va},${Va},${vo}\\)$`),T4=new RegExp(`^rgba\\(${As},${As},${As},${vo}\\)$`),O4=new RegExp(`^hsl\\(${vo},${As},${As}\\)$`),I4=new RegExp(`^hsla\\(${vo},${As},${As},${vo}\\)$`),i0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bf(Oo,aa,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:c0,formatHex:c0,formatHex8:L4,formatHsl:$4,formatRgb:u0,toString:u0});function c0(){return this.rgb().formatHex()}function L4(){return this.rgb().formatHex8()}function $4(){return Kb(this).formatHsl()}function u0(){return this.rgb().formatRgb()}function aa(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=A4.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?d0(t):n===3?new bn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ii(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ii(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=R4.exec(e))?new bn(t[1],t[2],t[3],1):(t=M4.exec(e))?new bn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=P4.exec(e))?ii(t[1],t[2],t[3],t[4]):(t=T4.exec(e))?ii(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=O4.exec(e))?h0(t[1],t[2]/100,t[3]/100,1):(t=I4.exec(e))?h0(t[1],t[2]/100,t[3]/100,t[4]):i0.hasOwnProperty(e)?d0(i0[e]):e==="transparent"?new bn(NaN,NaN,NaN,0):null}function d0(e){return new bn(e>>16&255,e>>8&255,e&255,1)}function ii(e,t,n,r){return r<=0&&(e=t=n=NaN),new bn(e,t,n,r)}function D4(e){return e instanceof Oo||(e=aa(e)),e?(e=e.rgb(),new bn(e.r,e.g,e.b,e.opacity)):new bn}function _m(e,t,n,r){return arguments.length===1?D4(e):new bn(e,t,n,r??1)}function bn(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Bf(bn,_m,Qb(Oo,{brighter(e){return e=e==null?xc:Math.pow(xc,e),new bn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?go:Math.pow(go,e),new bn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new bn(Qr(this.r),Qr(this.g),Qr(this.b),gc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:m0,formatHex:m0,formatHex8:F4,formatRgb:f0,toString:f0}));function m0(){return`#${Wr(this.r)}${Wr(this.g)}${Wr(this.b)}`}function F4(){return`#${Wr(this.r)}${Wr(this.g)}${Wr(this.b)}${Wr((isNaN(this.opacity)?1:this.opacity)*255)}`}function f0(){const e=gc(this.opacity);return`${e===1?"rgb(":"rgba("}${Qr(this.r)}, ${Qr(this.g)}, ${Qr(this.b)}${e===1?")":`, ${e})`}`}function gc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wr(e){return e=Qr(e),(e<16?"0":"")+e.toString(16)}function h0(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ss(e,t,n,r)}function Kb(e){if(e instanceof ss)return new ss(e.h,e.s,e.l,e.opacity);if(e instanceof Oo||(e=aa(e)),!e)return new ss;if(e instanceof ss)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),l=Math.max(t,n,r),o=NaN,c=l-a,i=(l+a)/2;return c?(t===l?o=(n-r)/c+(n<r)*6:n===l?o=(r-t)/c+2:o=(t-n)/c+4,c/=i<.5?l+a:2-l-a,o*=60):c=i>0&&i<1?0:o,new ss(o,c,i,e.opacity)}function V4(e,t,n,r){return arguments.length===1?Kb(e):new ss(e,t,n,r??1)}function ss(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Bf(ss,V4,Qb(Oo,{brighter(e){return e=e==null?xc:Math.pow(xc,e),new ss(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?go:Math.pow(go,e),new ss(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new bn(Zu(e>=240?e-240:e+120,a,r),Zu(e,a,r),Zu(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new ss(p0(this.h),ci(this.s),ci(this.l),gc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=gc(this.opacity);return`${e===1?"hsl(":"hsla("}${p0(this.h)}, ${ci(this.s)*100}%, ${ci(this.l)*100}%${e===1?")":`, ${e})`}`}}));function p0(e){return e=(e||0)%360,e<0?e+360:e}function ci(e){return Math.max(0,Math.min(1,e||0))}function Zu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Wf=e=>()=>e;function z4(e,t){return function(n){return e+n*t}}function H4(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function U4(e){return(e=+e)==1?Zb:function(t,n){return n-t?H4(t,n,e):Wf(isNaN(t)?n:t)}}function Zb(e,t){var n=t-e;return n?z4(e,n):Wf(isNaN(e)?t:e)}const vc=function e(t){var n=U4(t);function r(a,l){var o=n((a=_m(a)).r,(l=_m(l)).r),c=n(a.g,l.g),i=n(a.b,l.b),u=Zb(a.opacity,l.opacity);return function(m){return a.r=o(m),a.g=c(m),a.b=i(m),a.opacity=u(m),a+""}}return r.gamma=e,r}(1);function B4(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(l){for(a=0;a<n;++a)r[a]=e[a]*(1-l)+t[a]*l;return r}}function W4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function G4(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),l=new Array(n),o;for(o=0;o<r;++o)a[o]=Hl(e[o],t[o]);for(;o<n;++o)l[o]=t[o];return function(c){for(o=0;o<r;++o)l[o]=a[o](c);return l}}function Y4(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function _s(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function q4(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=Hl(e[a],t[a]):r[a]=t[a];return function(l){for(a in n)r[a]=n[a](l);return r}}var wm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ju=new RegExp(wm.source,"g");function X4(e){return function(){return e}}function Q4(e){return function(t){return e(t)+""}}function Jb(e,t){var n=wm.lastIndex=Ju.lastIndex=0,r,a,l,o=-1,c=[],i=[];for(e=e+"",t=t+"";(r=wm.exec(e))&&(a=Ju.exec(t));)(l=a.index)>n&&(l=t.slice(n,l),c[o]?c[o]+=l:c[++o]=l),(r=r[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,i.push({i:o,x:_s(r,a)})),n=Ju.lastIndex;return n<t.length&&(l=t.slice(n),c[o]?c[o]+=l:c[++o]=l),c.length<2?i[0]?Q4(i[0].x):X4(t):(t=i.length,function(u){for(var m=0,h;m<t;++m)c[(h=i[m]).i]=h.x(u);return c.join("")})}function Hl(e,t){var n=typeof t,r;return t==null||n==="boolean"?Wf(t):(n==="number"?_s:n==="string"?(r=aa(t))?(t=r,vc):Jb:t instanceof aa?vc:t instanceof Date?Y4:W4(t)?B4:Array.isArray(t)?G4:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?q4:_s)(e,t)}var x0=180/Math.PI,Sm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ey(e,t,n,r,a,l){var o,c,i;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(i=e*n+t*r)&&(n-=e*i,r-=t*i),(c=Math.sqrt(n*n+r*r))&&(n/=c,r/=c,i/=c),e*r<t*n&&(e=-e,t=-t,i=-i,o=-o),{translateX:a,translateY:l,rotate:Math.atan2(t,e)*x0,skewX:Math.atan(i)*x0,scaleX:o,scaleY:c}}var ui;function K4(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Sm:ey(t.a,t.b,t.c,t.d,t.e,t.f)}function Z4(e){return e==null||(ui||(ui=document.createElementNS("http://www.w3.org/2000/svg","g")),ui.setAttribute("transform",e),!(e=ui.transform.baseVal.consolidate()))?Sm:(e=e.matrix,ey(e.a,e.b,e.c,e.d,e.e,e.f))}function ty(e,t,n,r){function a(u){return u.length?u.pop()+" ":""}function l(u,m,h,f,g,b){if(u!==h||m!==f){var w=g.push("translate(",null,t,null,n);b.push({i:w-4,x:_s(u,h)},{i:w-2,x:_s(m,f)})}else(h||f)&&g.push("translate("+h+t+f+n)}function o(u,m,h,f){u!==m?(u-m>180?m+=360:m-u>180&&(u+=360),f.push({i:h.push(a(h)+"rotate(",null,r)-2,x:_s(u,m)})):m&&h.push(a(h)+"rotate("+m+r)}function c(u,m,h,f){u!==m?f.push({i:h.push(a(h)+"skewX(",null,r)-2,x:_s(u,m)}):m&&h.push(a(h)+"skewX("+m+r)}function i(u,m,h,f,g,b){if(u!==h||m!==f){var w=g.push(a(g)+"scale(",null,",",null,")");b.push({i:w-4,x:_s(u,h)},{i:w-2,x:_s(m,f)})}else(h!==1||f!==1)&&g.push(a(g)+"scale("+h+","+f+")")}return function(u,m){var h=[],f=[];return u=e(u),m=e(m),l(u.translateX,u.translateY,m.translateX,m.translateY,h,f),o(u.rotate,m.rotate,h,f),c(u.skewX,m.skewX,h,f),i(u.scaleX,u.scaleY,m.scaleX,m.scaleY,h,f),u=m=null,function(g){for(var b=-1,w=f.length,x;++b<w;)h[(x=f[b]).i]=x.x(g);return h.join("")}}}var J4=ty(K4,"px, ","px)","deg)"),e5=ty(Z4,", ",")",")"),t5=1e-12;function g0(e){return((e=Math.exp(e))+1/e)/2}function n5(e){return((e=Math.exp(e))-1/e)/2}function s5(e){return((e=Math.exp(2*e))-1)/(e+1)}const Mi=function e(t,n,r){function a(l,o){var c=l[0],i=l[1],u=l[2],m=o[0],h=o[1],f=o[2],g=m-c,b=h-i,w=g*g+b*b,x,d;if(w<t5)d=Math.log(f/u)/t,x=function(E){return[c+E*g,i+E*b,u*Math.exp(t*E*d)]};else{var p=Math.sqrt(w),v=(f*f-u*u+r*w)/(2*u*n*p),N=(f*f-u*u-r*w)/(2*f*n*p),C=Math.log(Math.sqrt(v*v+1)-v),j=Math.log(Math.sqrt(N*N+1)-N);d=(j-C)/t,x=function(E){var y=E*d,R=g0(C),$=u/(n*p)*(R*s5(t*y+C)-n5(C));return[c+$*g,i+$*b,u*R/g0(t*y+C)]}}return x.duration=d*1e3*t/Math.SQRT2,x}return a.rho=function(l){var o=Math.max(.001,+l),c=o*o,i=c*c;return e(o,c,i)},a}(Math.SQRT2,2,4);var el=0,Ml=0,_l=0,ny=1e3,bc,Pl,yc=0,la=0,Kc=0,bo=typeof performance=="object"&&performance.now?performance:Date,sy=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Gf(){return la||(sy(r5),la=bo.now()+Kc)}function r5(){la=0}function Nc(){this._call=this._time=this._next=null}Nc.prototype=ry.prototype={constructor:Nc,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Gf():+n)+(t==null?0:+t),!this._next&&Pl!==this&&(Pl?Pl._next=this:bc=this,Pl=this),this._call=e,this._time=n,Cm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cm())}};function ry(e,t,n){var r=new Nc;return r.restart(e,t,n),r}function a5(){Gf(),++el;for(var e=bc,t;e;)(t=la-e._time)>=0&&e._call.call(void 0,t),e=e._next;--el}function v0(){la=(yc=bo.now())+Kc,el=Ml=0;try{a5()}finally{el=0,o5(),la=0}}function l5(){var e=bo.now(),t=e-yc;t>ny&&(Kc-=t,yc=e)}function o5(){for(var e,t=bc,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:bc=n);Pl=e,Cm(r)}function Cm(e){if(!el){Ml&&(Ml=clearTimeout(Ml));var t=e-la;t>24?(e<1/0&&(Ml=setTimeout(v0,e-bo.now()-Kc)),_l&&(_l=clearInterval(_l))):(_l||(yc=bo.now(),_l=setInterval(l5,ny)),el=1,sy(v0))}}function b0(e,t,n){var r=new Nc;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var i5=Xc("start","end","cancel","interrupt"),c5=[],ay=0,y0=1,km=2,Pi=3,N0=4,Em=5,Ti=6;function Zc(e,t,n,r,a,l){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;u5(e,n,{name:t,index:r,group:a,on:i5,tween:c5,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:ay})}function Yf(e,t){var n=ms(e,t);if(n.state>ay)throw new Error("too late; already scheduled");return n}function Ps(e,t){var n=ms(e,t);if(n.state>Pi)throw new Error("too late; already running");return n}function ms(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function u5(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=ry(l,0,n.time);function l(u){n.state=y0,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var m,h,f,g;if(n.state!==y0)return i();for(m in r)if(g=r[m],g.name===n.name){if(g.state===Pi)return b0(o);g.state===N0?(g.state=Ti,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete r[m]):+m<t&&(g.state=Ti,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete r[m])}if(b0(function(){n.state===Pi&&(n.state=N0,n.timer.restart(c,n.delay,n.time),c(u))}),n.state=km,n.on.call("start",e,e.__data__,n.index,n.group),n.state===km){for(n.state=Pi,a=new Array(f=n.tween.length),m=0,h=-1;m<f;++m)(g=n.tween[m].value.call(e,e.__data__,n.index,n.group))&&(a[++h]=g);a.length=h+1}}function c(u){for(var m=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(i),n.state=Em,1),h=-1,f=a.length;++h<f;)a[h].call(e,m);n.state===Em&&(n.on.call("end",e,e.__data__,n.index,n.group),i())}function i(){n.state=Ti,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Oi(e,t){var n=e.__transition,r,a,l=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){l=!1;continue}a=r.state>km&&r.state<Em,r.state=Ti,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}l&&delete e.__transition}}function d5(e){return this.each(function(){Oi(this,e)})}function m5(e,t){var n,r;return function(){var a=Ps(this,e),l=a.tween;if(l!==n){r=n=l;for(var o=0,c=r.length;o<c;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}a.tween=r}}function f5(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var l=Ps(this,e),o=l.tween;if(o!==r){a=(r=o).slice();for(var c={name:t,value:n},i=0,u=a.length;i<u;++i)if(a[i].name===t){a[i]=c;break}i===u&&a.push(c)}l.tween=a}}function h5(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ms(this.node(),n).tween,a=0,l=r.length,o;a<l;++a)if((o=r[a]).name===e)return o.value;return null}return this.each((t==null?m5:f5)(n,e,t))}function qf(e,t,n){var r=e._id;return e.each(function(){var a=Ps(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return ms(a,r).value[t]}}function ly(e,t){var n;return(typeof t=="number"?_s:t instanceof aa?vc:(n=aa(t))?(t=n,vc):Jb)(e,t)}function p5(e){return function(){this.removeAttribute(e)}}function x5(e){return function(){this.removeAttributeNS(e.space,e.local)}}function g5(e,t,n){var r,a=n+"",l;return function(){var o=this.getAttribute(e);return o===a?null:o===r?l:l=t(r=o,n)}}function v5(e,t,n){var r,a=n+"",l;return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?l:l=t(r=o,n)}}function b5(e,t,n){var r,a,l;return function(){var o,c=n(this),i;return c==null?void this.removeAttribute(e):(o=this.getAttribute(e),i=c+"",o===i?null:o===r&&i===a?l:(a=i,l=t(r=o,c)))}}function y5(e,t,n){var r,a,l;return function(){var o,c=n(this),i;return c==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),i=c+"",o===i?null:o===r&&i===a?l:(a=i,l=t(r=o,c)))}}function N5(e,t){var n=Qc(e),r=n==="transform"?e5:ly;return this.attrTween(e,typeof t=="function"?(n.local?y5:b5)(n,r,qf(this,"attr."+e,t)):t==null?(n.local?x5:p5)(n):(n.local?v5:g5)(n,r,t))}function j5(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function _5(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function w5(e,t){var n,r;function a(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&_5(e,l)),n}return a._value=t,a}function S5(e,t){var n,r;function a(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&j5(e,l)),n}return a._value=t,a}function C5(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Qc(e);return this.tween(n,(r.local?w5:S5)(r,t))}function k5(e,t){return function(){Yf(this,e).delay=+t.apply(this,arguments)}}function E5(e,t){return t=+t,function(){Yf(this,e).delay=t}}function A5(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?k5:E5)(t,e)):ms(this.node(),t).delay}function R5(e,t){return function(){Ps(this,e).duration=+t.apply(this,arguments)}}function M5(e,t){return t=+t,function(){Ps(this,e).duration=t}}function P5(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?R5:M5)(t,e)):ms(this.node(),t).duration}function T5(e,t){if(typeof t!="function")throw new Error;return function(){Ps(this,e).ease=t}}function O5(e){var t=this._id;return arguments.length?this.each(T5(t,e)):ms(this.node(),t).ease}function I5(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ps(this,e).ease=n}}function L5(e){if(typeof e!="function")throw new Error;return this.each(I5(this._id,e))}function $5(e){typeof e!="function"&&(e=$b(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var l=t[a],o=l.length,c=r[a]=[],i,u=0;u<o;++u)(i=l[u])&&e.call(i,i.__data__,u,l)&&c.push(i);return new Qs(r,this._parents,this._name,this._id)}function D5(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,l=Math.min(r,a),o=new Array(r),c=0;c<l;++c)for(var i=t[c],u=n[c],m=i.length,h=o[c]=new Array(m),f,g=0;g<m;++g)(f=i[g]||u[g])&&(h[g]=f);for(;c<r;++c)o[c]=t[c];return new Qs(o,this._parents,this._name,this._id)}function F5(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function V5(e,t,n){var r,a,l=F5(t)?Yf:Ps;return function(){var o=l(this,e),c=o.on;c!==r&&(a=(r=c).copy()).on(t,n),o.on=a}}function z5(e,t){var n=this._id;return arguments.length<2?ms(this.node(),n).on.on(e):this.each(V5(n,e,t))}function H5(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function U5(){return this.on("end.remove",H5(this._id))}function B5(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Hf(e));for(var r=this._groups,a=r.length,l=new Array(a),o=0;o<a;++o)for(var c=r[o],i=c.length,u=l[o]=new Array(i),m,h,f=0;f<i;++f)(m=c[f])&&(h=e.call(m,m.__data__,f,c))&&("__data__"in m&&(h.__data__=m.__data__),u[f]=h,Zc(u[f],t,n,f,u,ms(m,n)));return new Qs(l,this._parents,t,n)}function W5(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Lb(e));for(var r=this._groups,a=r.length,l=[],o=[],c=0;c<a;++c)for(var i=r[c],u=i.length,m,h=0;h<u;++h)if(m=i[h]){for(var f=e.call(m,m.__data__,h,i),g,b=ms(m,n),w=0,x=f.length;w<x;++w)(g=f[w])&&Zc(g,t,n,w,f,b);l.push(f),o.push(m)}return new Qs(l,o,t,n)}var G5=To.prototype.constructor;function Y5(){return new G5(this._groups,this._parents)}function q5(e,t){var n,r,a;return function(){var l=Ja(this,e),o=(this.style.removeProperty(e),Ja(this,e));return l===o?null:l===n&&o===r?a:a=t(n=l,r=o)}}function oy(e){return function(){this.style.removeProperty(e)}}function X5(e,t,n){var r,a=n+"",l;return function(){var o=Ja(this,e);return o===a?null:o===r?l:l=t(r=o,n)}}function Q5(e,t,n){var r,a,l;return function(){var o=Ja(this,e),c=n(this),i=c+"";return c==null&&(i=c=(this.style.removeProperty(e),Ja(this,e))),o===i?null:o===r&&i===a?l:(a=i,l=t(r=o,c))}}function K5(e,t){var n,r,a,l="style."+t,o="end."+l,c;return function(){var i=Ps(this,e),u=i.on,m=i.value[l]==null?c||(c=oy(t)):void 0;(u!==n||a!==m)&&(r=(n=u).copy()).on(o,a=m),i.on=r}}function Z5(e,t,n){var r=(e+="")=="transform"?J4:ly;return t==null?this.styleTween(e,q5(e,r)).on("end.style."+e,oy(e)):typeof t=="function"?this.styleTween(e,Q5(e,r,qf(this,"style."+e,t))).each(K5(this._id,e)):this.styleTween(e,X5(e,r,t),n).on("end.style."+e,null)}function J5(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function e3(e,t,n){var r,a;function l(){var o=t.apply(this,arguments);return o!==a&&(r=(a=o)&&J5(e,o,n)),r}return l._value=t,l}function t3(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,e3(e,t,n??""))}function n3(e){return function(){this.textContent=e}}function s3(e){return function(){var t=e(this);this.textContent=t??""}}function r3(e){return this.tween("text",typeof e=="function"?s3(qf(this,"text",e)):n3(e==null?"":e+""))}function a3(e){return function(t){this.textContent=e.call(this,t)}}function l3(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&a3(a)),t}return r._value=e,r}function o3(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,l3(e))}function i3(){for(var e=this._name,t=this._id,n=iy(),r=this._groups,a=r.length,l=0;l<a;++l)for(var o=r[l],c=o.length,i,u=0;u<c;++u)if(i=o[u]){var m=ms(i,t);Zc(i,e,n,u,o,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Qs(r,this._parents,e,n)}function c3(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(l,o){var c={value:o},i={value:function(){--a===0&&l()}};n.each(function(){var u=Ps(this,r),m=u.on;m!==e&&(t=(e=m).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(i)),u.on=t}),a===0&&l()})}var u3=0;function Qs(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function iy(){return++u3}var Ls=To.prototype;Qs.prototype={constructor:Qs,select:B5,selectAll:W5,selectChild:Ls.selectChild,selectChildren:Ls.selectChildren,filter:$5,merge:D5,selection:Y5,transition:i3,call:Ls.call,nodes:Ls.nodes,node:Ls.node,size:Ls.size,empty:Ls.empty,each:Ls.each,on:z5,attr:N5,attrTween:C5,style:Z5,styleTween:t3,text:r3,textTween:o3,remove:U5,tween:h5,delay:A5,duration:P5,ease:O5,easeVarying:L5,end:c3,[Symbol.iterator]:Ls[Symbol.iterator]};function d3(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var m3={time:null,delay:0,duration:250,ease:d3};function f3(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function h3(e){var t,n;e instanceof Qs?(t=e._id,e=e._name):(t=iy(),(n=m3).time=Gf(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,l=0;l<a;++l)for(var o=r[l],c=o.length,i,u=0;u<c;++u)(i=o[u])&&Zc(i,e,t,u,o,n||f3(i,t));return new Qs(r,this._parents,e,t)}To.prototype.interrupt=d5;To.prototype.transition=h3;const di=e=>()=>e;function p3(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function Hs(e,t,n){this.k=e,this.x=t,this.y=n}Hs.prototype={constructor:Hs,scale:function(e){return e===1?this:new Hs(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Hs(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Jc=new Hs(1,0,0);cy.prototype=Hs.prototype;function cy(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Jc;return e.__zoom}function ed(e){e.stopImmediatePropagation()}function wl(e){e.preventDefault(),e.stopImmediatePropagation()}function x3(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function g3(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function j0(){return this.__zoom||Jc}function v3(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function b3(){return navigator.maxTouchPoints||"ontouchstart"in this}function y3(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),o>l?(l+o)/2:Math.min(0,l)||Math.max(0,o))}function uy(){var e=x3,t=g3,n=y3,r=v3,a=b3,l=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],c=250,i=Mi,u=Xc("start","zoom","end"),m,h,f,g=500,b=150,w=0,x=10;function d(S){S.property("__zoom",j0).on("wheel.zoom",y,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",$).filter(a).on("touchstart.zoom",k).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}d.transform=function(S,T,P,L){var I=S.selection?S.selection():S;I.property("__zoom",j0),S!==I?C(S,T,P,L):I.interrupt().each(function(){j(this,arguments).event(L).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},d.scaleBy=function(S,T,P,L){d.scaleTo(S,function(){var I=this.__zoom.k,O=typeof T=="function"?T.apply(this,arguments):T;return I*O},P,L)},d.scaleTo=function(S,T,P,L){d.transform(S,function(){var I=t.apply(this,arguments),O=this.__zoom,F=P==null?N(I):typeof P=="function"?P.apply(this,arguments):P,U=O.invert(F),B=typeof T=="function"?T.apply(this,arguments):T;return n(v(p(O,B),F,U),I,o)},P,L)},d.translateBy=function(S,T,P,L){d.transform(S,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof P=="function"?P.apply(this,arguments):P),t.apply(this,arguments),o)},null,L)},d.translateTo=function(S,T,P,L,I){d.transform(S,function(){var O=t.apply(this,arguments),F=this.__zoom,U=L==null?N(O):typeof L=="function"?L.apply(this,arguments):L;return n(Jc.translate(U[0],U[1]).scale(F.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof P=="function"?-P.apply(this,arguments):-P),O,o)},L,I)};function p(S,T){return T=Math.max(l[0],Math.min(l[1],T)),T===S.k?S:new Hs(T,S.x,S.y)}function v(S,T,P){var L=T[0]-P[0]*S.k,I=T[1]-P[1]*S.k;return L===S.x&&I===S.y?S:new Hs(S.k,L,I)}function N(S){return[(+S[0][0]+ +S[1][0])/2,(+S[0][1]+ +S[1][1])/2]}function C(S,T,P,L){S.on("start.zoom",function(){j(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(L).end()}).tween("zoom",function(){var I=this,O=arguments,F=j(I,O).event(L),U=t.apply(I,O),B=P==null?N(U):typeof P=="function"?P.apply(I,O):P,Z=Math.max(U[1][0]-U[0][0],U[1][1]-U[0][1]),ee=I.__zoom,ce=typeof T=="function"?T.apply(I,O):T,oe=i(ee.invert(B).concat(Z/ee.k),ce.invert(B).concat(Z/ce.k));return function(Y){if(Y===1)Y=ce;else{var q=oe(Y),se=Z/q[2];Y=new Hs(se,B[0]-q[0]*se,B[1]-q[1]*se)}F.zoom(null,Y)}})}function j(S,T,P){return!P&&S.__zooming||new E(S,T)}function E(S,T){this.that=S,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(S,T),this.taps=0}E.prototype={event:function(S){return S&&(this.sourceEvent=S),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(S,T){return this.mouse&&S!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&S!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&S!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(S){var T=Cn(this.that).datum();u.call(S,this.that,new p3(S,{sourceEvent:this.sourceEvent,target:d,transform:this.that.__zoom,dispatch:u}),T)}};function y(S,...T){if(!e.apply(this,arguments))return;var P=j(this,T).event(S),L=this.__zoom,I=Math.max(l[0],Math.min(l[1],L.k*Math.pow(2,r.apply(this,arguments)))),O=es(S);if(P.wheel)(P.mouse[0][0]!==O[0]||P.mouse[0][1]!==O[1])&&(P.mouse[1]=L.invert(P.mouse[0]=O)),clearTimeout(P.wheel);else{if(L.k===I)return;P.mouse=[O,L.invert(O)],Oi(this),P.start()}wl(S),P.wheel=setTimeout(F,b),P.zoom("mouse",n(v(p(L,I),P.mouse[0],P.mouse[1]),P.extent,o));function F(){P.wheel=null,P.end()}}function R(S,...T){if(f||!e.apply(this,arguments))return;var P=S.currentTarget,L=j(this,T,!0).event(S),I=Cn(S.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",Z,!0),O=es(S,P),F=S.clientX,U=S.clientY;Yb(S.view),ed(S),L.mouse=[O,this.__zoom.invert(O)],Oi(this),L.start();function B(ee){if(wl(ee),!L.moved){var ce=ee.clientX-F,oe=ee.clientY-U;L.moved=ce*ce+oe*oe>w}L.event(ee).zoom("mouse",n(v(L.that.__zoom,L.mouse[0]=es(ee,P),L.mouse[1]),L.extent,o))}function Z(ee){I.on("mousemove.zoom mouseup.zoom",null),qb(ee.view,L.moved),wl(ee),L.event(ee).end()}}function $(S,...T){if(e.apply(this,arguments)){var P=this.__zoom,L=es(S.changedTouches?S.changedTouches[0]:S,this),I=P.invert(L),O=P.k*(S.shiftKey?.5:2),F=n(v(p(P,O),L,I),t.apply(this,T),o);wl(S),c>0?Cn(this).transition().duration(c).call(C,F,L,S):Cn(this).call(d.transform,F,L,S)}}function k(S,...T){if(e.apply(this,arguments)){var P=S.touches,L=P.length,I=j(this,T,S.changedTouches.length===L).event(S),O,F,U,B;for(ed(S),F=0;F<L;++F)U=P[F],B=es(U,this),B=[B,this.__zoom.invert(B),U.identifier],I.touch0?!I.touch1&&I.touch0[2]!==B[2]&&(I.touch1=B,I.taps=0):(I.touch0=B,O=!0,I.taps=1+!!m);m&&(m=clearTimeout(m)),O&&(I.taps<2&&(h=B[0],m=setTimeout(function(){m=null},g)),Oi(this),I.start())}}function A(S,...T){if(this.__zooming){var P=j(this,T).event(S),L=S.changedTouches,I=L.length,O,F,U,B;for(wl(S),O=0;O<I;++O)F=L[O],U=es(F,this),P.touch0&&P.touch0[2]===F.identifier?P.touch0[0]=U:P.touch1&&P.touch1[2]===F.identifier&&(P.touch1[0]=U);if(F=P.that.__zoom,P.touch1){var Z=P.touch0[0],ee=P.touch0[1],ce=P.touch1[0],oe=P.touch1[1],Y=(Y=ce[0]-Z[0])*Y+(Y=ce[1]-Z[1])*Y,q=(q=oe[0]-ee[0])*q+(q=oe[1]-ee[1])*q;F=p(F,Math.sqrt(Y/q)),U=[(Z[0]+ce[0])/2,(Z[1]+ce[1])/2],B=[(ee[0]+oe[0])/2,(ee[1]+oe[1])/2]}else if(P.touch0)U=P.touch0[0],B=P.touch0[1];else return;P.zoom("touch",n(v(F,U,B),P.extent,o))}}function D(S,...T){if(this.__zooming){var P=j(this,T).event(S),L=S.changedTouches,I=L.length,O,F;for(ed(S),f&&clearTimeout(f),f=setTimeout(function(){f=null},g),O=0;O<I;++O)F=L[O],P.touch0&&P.touch0[2]===F.identifier?delete P.touch0:P.touch1&&P.touch1[2]===F.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(F=es(F,this),Math.hypot(h[0]-F[0],h[1]-F[1])<x)){var U=Cn(this).on("dblclick.zoom");U&&U.apply(this,arguments)}}}return d.wheelDelta=function(S){return arguments.length?(r=typeof S=="function"?S:di(+S),d):r},d.filter=function(S){return arguments.length?(e=typeof S=="function"?S:di(!!S),d):e},d.touchable=function(S){return arguments.length?(a=typeof S=="function"?S:di(!!S),d):a},d.extent=function(S){return arguments.length?(t=typeof S=="function"?S:di([[+S[0][0],+S[0][1]],[+S[1][0],+S[1][1]]]),d):t},d.scaleExtent=function(S){return arguments.length?(l[0]=+S[0],l[1]=+S[1],d):[l[0],l[1]]},d.translateExtent=function(S){return arguments.length?(o[0][0]=+S[0][0],o[1][0]=+S[1][0],o[0][1]=+S[0][1],o[1][1]=+S[1][1],d):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},d.constrain=function(S){return arguments.length?(n=S,d):n},d.duration=function(S){return arguments.length?(c=+S,d):c},d.interpolate=function(S){return arguments.length?(i=S,d):i},d.on=function(){var S=u.on.apply(u,arguments);return S===u?d:S},d.clickDistance=function(S){return arguments.length?(w=(S=+S)*S,d):Math.sqrt(w)},d.tapDistance=function(S){return arguments.length?(x=+S,d):x},d}const Ms={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},yo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],dy=["Enter"," ","Escape"],my={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var tl;(function(e){e.Strict="strict",e.Loose="loose"})(tl||(tl={}));var Kr;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Kr||(Kr={}));var No;(function(e){e.Partial="partial",e.Full="full"})(No||(No={}));const fy={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Fs;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Fs||(Fs={}));var oa;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(oa||(oa={}));var ye;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ye||(ye={}));const _0={[ye.Left]:ye.Right,[ye.Right]:ye.Left,[ye.Top]:ye.Bottom,[ye.Bottom]:ye.Top};function hy(e){return e===null?null:e?"valid":"invalid"}const py=e=>"id"in e&&"source"in e&&"target"in e,N3=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Xf=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Io=(e,t=[0,0])=>{const{width:n,height:r}=Js(e),a=e.origin??t,l=n*a[0],o=r*a[1];return{x:e.position.x-l,y:e.position.y-o}},j3=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const l=typeof a=="string";let o=!t.nodeLookup&&!l?a:void 0;t.nodeLookup&&(o=l?t.nodeLookup.get(a):Xf(a)?a:t.nodeLookup.get(a.id));const c=o?jc(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return eu(r,c)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return tu(n)},Lo=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return e.forEach(a=>{(t.filter===void 0||t.filter(a))&&(n=eu(n,jc(a)),r=!0)}),r?tu(n):{x:0,y:0,width:0,height:0}},Qf=(e,t,[n,r,a]=[0,0,1],l=!1,o=!1)=>{const c={...Do(t,[n,r,a]),width:t.width/a,height:t.height/a},i=[];for(const u of e.values()){const{measured:m,selectable:h=!0,hidden:f=!1}=u;if(o&&!h||f)continue;const g=m.width??u.width??u.initialWidth??null,b=m.height??u.height??u.initialHeight??null,w=jo(c,sl(u)),x=(g??0)*(b??0),d=l&&w>0;(!u.internals.handleBounds||d||w>=x||u.dragging)&&i.push(u)}return i},_3=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function w3(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function S3({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:l},o){if(e.size===0)return Promise.resolve(!0);const c=w3(e,o),i=Lo(c),u=Kf(i,t,n,(o==null?void 0:o.minZoom)??a,(o==null?void 0:o.maxZoom)??l,(o==null?void 0:o.padding)??.1);return await r.setViewport(u,{duration:o==null?void 0:o.duration,ease:o==null?void 0:o.ease,interpolate:o==null?void 0:o.interpolate}),Promise.resolve(!0)}function xy({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:l}){const o=n.get(e),c=o.parentId?n.get(o.parentId):void 0,{x:i,y:u}=c?c.internals.positionAbsolute:{x:0,y:0},m=o.origin??r;let h=o.extent||a;if(o.extent==="parent"&&!o.expandParent)if(!c)l==null||l("005",Ms.error005());else{const g=c.measured.width,b=c.measured.height;g&&b&&(h=[[i,u],[i+g,u+b]])}else c&&rl(o.extent)&&(h=[[o.extent[0][0]+i,o.extent[0][1]+u],[o.extent[1][0]+i,o.extent[1][1]+u]]);const f=rl(h)?ia(t,h,o.measured):t;return(o.measured.width===void 0||o.measured.height===void 0)&&(l==null||l("015",Ms.error015())),{position:{x:f.x-i+(o.measured.width??0)*m[0],y:f.y-u+(o.measured.height??0)*m[1]},positionAbsolute:f}}async function C3({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const l=new Set(e.map(f=>f.id)),o=[];for(const f of n){if(f.deletable===!1)continue;const g=l.has(f.id),b=!g&&f.parentId&&o.find(w=>w.id===f.parentId);(g||b)&&o.push(f)}const c=new Set(t.map(f=>f.id)),i=r.filter(f=>f.deletable!==!1),m=_3(o,i);for(const f of i)c.has(f.id)&&!m.find(b=>b.id===f.id)&&m.push(f);if(!a)return{edges:m,nodes:o};const h=await a({nodes:o,edges:m});return typeof h=="boolean"?h?{edges:m,nodes:o}:{edges:[],nodes:[]}:h}const nl=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ia=(e={x:0,y:0},t,n)=>({x:nl(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:nl(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function gy(e,t,n){const{width:r,height:a}=Js(n),{x:l,y:o}=n.internals.positionAbsolute;return ia(e,[[l,o],[l+r,o+a]],t)}const w0=(e,t,n)=>e<t?nl(Math.abs(e-t),1,t)/t:e>n?-nl(Math.abs(e-n),1,t)/t:0,vy=(e,t,n=15,r=40)=>{const a=w0(e.x,r,t.width-r)*n,l=w0(e.y,r,t.height-r)*n;return[a,l]},eu=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Am=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),tu=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),sl=(e,t=[0,0])=>{var a,l;const{x:n,y:r}=Xf(e)?e.internals.positionAbsolute:Io(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((l=e.measured)==null?void 0:l.height)??e.height??e.initialHeight??0}},jc=(e,t=[0,0])=>{var a,l;const{x:n,y:r}=Xf(e)?e.internals.positionAbsolute:Io(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((l=e.measured)==null?void 0:l.height)??e.height??e.initialHeight??0)}},by=(e,t)=>tu(eu(Am(e),Am(t))),jo=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},S0=e=>ls(e.width)&&ls(e.height)&&ls(e.x)&&ls(e.y),ls=e=>!isNaN(e)&&isFinite(e),k3=(e,t)=>{},$o=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Do=({x:e,y:t},[n,r,a],l=!1,o=[1,1])=>{const c={x:(e-n)/a,y:(t-r)/a};return l?$o(c,o):c},_c=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r});function ha(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function E3(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=ha(e,n),a=ha(e,t);return{top:r,right:a,bottom:r,left:a,x:a*2,y:r*2}}if(typeof e=="object"){const r=ha(e.top??e.y??0,n),a=ha(e.bottom??e.y??0,n),l=ha(e.left??e.x??0,t),o=ha(e.right??e.x??0,t);return{top:r,right:o,bottom:a,left:l,x:l+o,y:r+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function A3(e,t,n,r,a,l){const{x:o,y:c}=_c(e,[t,n,r]),{x:i,y:u}=_c({x:e.x+e.width,y:e.y+e.height},[t,n,r]),m=a-i,h=l-u;return{left:Math.floor(o),top:Math.floor(c),right:Math.floor(m),bottom:Math.floor(h)}}const Kf=(e,t,n,r,a,l)=>{const o=E3(l,t,n),c=(t-o.x)/e.width,i=(n-o.y)/e.height,u=Math.min(c,i),m=nl(u,r,a),h=e.x+e.width/2,f=e.y+e.height/2,g=t/2-h*m,b=n/2-f*m,w=A3(e,g,b,m,t,n),x={left:Math.min(w.left-o.left,0),top:Math.min(w.top-o.top,0),right:Math.min(w.right-o.right,0),bottom:Math.min(w.bottom-o.bottom,0)};return{x:g-x.left+x.right,y:b-x.top+x.bottom,zoom:m}},_o=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function rl(e){return e!=null&&e!=="parent"}function Js(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function yy(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Ny(e,t={width:0,height:0},n,r,a){const l={...e},o=r.get(n);if(o){const c=o.origin||a;l.x+=o.internals.positionAbsolute.x-(t.width??0)*c[0],l.y+=o.internals.positionAbsolute.y-(t.height??0)*c[1]}return l}function C0(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function R3(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}function M3(e){return{...my,...e||{}}}function Ul(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:l,y:o}=os(e),c=Do({x:l-((a==null?void 0:a.left)??0),y:o-((a==null?void 0:a.top)??0)},r),{x:i,y:u}=n?$o(c,t):c;return{xSnapped:i,ySnapped:u,...c}}const Zf=e=>({width:e.offsetWidth,height:e.offsetHeight}),jy=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},P3=["INPUT","SELECT","TEXTAREA"];function _y(e){var r,a;const t=((a=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:a[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:P3.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const wy=e=>"clientX"in e,os=(e,t)=>{var l,o;const n=wy(e),r=n?e.clientX:(l=e.touches)==null?void 0:l[0].clientX,a=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},k0=(e,t,n,r,a)=>{const l=t.querySelectorAll(`.${e}`);return!l||!l.length?null:Array.from(l).map(o=>{const c=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:e,nodeId:a,position:o.getAttribute("data-handlepos"),x:(c.left-n.left)/r,y:(c.top-n.top)/r,...Zf(o)}})};function Sy({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:o,targetControlY:c}){const i=e*.125+a*.375+o*.375+n*.125,u=t*.125+l*.375+c*.375+r*.125,m=Math.abs(i-e),h=Math.abs(u-t);return[i,u,m,h]}function mi(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function E0({pos:e,x1:t,y1:n,x2:r,y2:a,c:l}){switch(e){case ye.Left:return[t-mi(t-r,l),n];case ye.Right:return[t+mi(r-t,l),n];case ye.Top:return[t,n-mi(n-a,l)];case ye.Bottom:return[t,n+mi(a-n,l)]}}function Cy({sourceX:e,sourceY:t,sourcePosition:n=ye.Bottom,targetX:r,targetY:a,targetPosition:l=ye.Top,curvature:o=.25}){const[c,i]=E0({pos:n,x1:e,y1:t,x2:r,y2:a,c:o}),[u,m]=E0({pos:l,x1:r,y1:a,x2:e,y2:t,c:o}),[h,f,g,b]=Sy({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:c,sourceControlY:i,targetControlX:u,targetControlY:m});return[`M${e},${t} C${c},${i} ${u},${m} ${r},${a}`,h,f,g,b]}function ky({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,l=n<e?n+a:n-a,o=Math.abs(r-t)/2,c=r<t?r+o:r-o;return[l,c,a,o]}function T3({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1,zIndexMode:l="basic"}){if(l==="manual")return r;const o=a&&n?r+1e3:r,c=Math.max(e.parentId||a&&e.selected?e.internals.z:0,t.parentId||a&&t.selected?t.internals.z:0);return o+c}function O3({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const l=eu(jc(e),jc(t));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const o={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return jo(o,tu(l))>0}const I3=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,L3=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),$3=(e,t,n={})=>{if(!e.source||!e.target)return t;const r=n.getEdgeId||I3;let a;return py(e)?a={...e}:a={...e,id:r(e)},L3(a,t)?t:(a.sourceHandle===null&&delete a.sourceHandle,a.targetHandle===null&&delete a.targetHandle,t.concat(a))};function Ey({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,l,o,c]=ky({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,l,o,c]}const A0={[ye.Left]:{x:-1,y:0},[ye.Right]:{x:1,y:0},[ye.Top]:{x:0,y:-1},[ye.Bottom]:{x:0,y:1}},D3=({source:e,sourcePosition:t=ye.Bottom,target:n})=>t===ye.Left||t===ye.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},R0=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function F3({source:e,sourcePosition:t=ye.Bottom,target:n,targetPosition:r=ye.Top,center:a,offset:l,stepPosition:o}){const c=A0[t],i=A0[r],u={x:e.x+c.x*l,y:e.y+c.y*l},m={x:n.x+i.x*l,y:n.y+i.y*l},h=D3({source:u,sourcePosition:t,target:m}),f=h.x!==0?"x":"y",g=h[f];let b=[],w,x;const d={x:0,y:0},p={x:0,y:0},[,,v,N]=ky({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(c[f]*i[f]===-1){f==="x"?(w=a.x??u.x+(m.x-u.x)*o,x=a.y??(u.y+m.y)/2):(w=a.x??(u.x+m.x)/2,x=a.y??u.y+(m.y-u.y)*o);const j=[{x:w,y:u.y},{x:w,y:m.y}],E=[{x:u.x,y:x},{x:m.x,y:x}];c[f]===g?b=f==="x"?j:E:b=f==="x"?E:j}else{const j=[{x:u.x,y:m.y}],E=[{x:m.x,y:u.y}];if(f==="x"?b=c.x===g?E:j:b=c.y===g?j:E,t===r){const A=Math.abs(e[f]-n[f]);if(A<=l){const D=Math.min(l-1,l-A);c[f]===g?d[f]=(u[f]>e[f]?-1:1)*D:p[f]=(m[f]>n[f]?-1:1)*D}}if(t!==r){const A=f==="x"?"y":"x",D=c[f]===i[A],S=u[A]>m[A],T=u[A]<m[A];(c[f]===1&&(!D&&S||D&&T)||c[f]!==1&&(!D&&T||D&&S))&&(b=f==="x"?j:E)}const y={x:u.x+d.x,y:u.y+d.y},R={x:m.x+p.x,y:m.y+p.y},$=Math.max(Math.abs(y.x-b[0].x),Math.abs(R.x-b[0].x)),k=Math.max(Math.abs(y.y-b[0].y),Math.abs(R.y-b[0].y));$>=k?(w=(y.x+R.x)/2,x=b[0].y):(w=b[0].x,x=(y.y+R.y)/2)}return[[e,{x:u.x+d.x,y:u.y+d.y},...b,{x:m.x+p.x,y:m.y+p.y},n],w,x,v,N]}function V3(e,t,n,r){const a=Math.min(R0(e,t)/2,R0(t,n)/2,r),{x:l,y:o}=t;if(e.x===l&&l===n.x||e.y===o&&o===n.y)return`L${l} ${o}`;if(e.y===o){const u=e.x<n.x?-1:1,m=e.y<n.y?1:-1;return`L ${l+a*u},${o}Q ${l},${o} ${l},${o+a*m}`}const c=e.x<n.x?1:-1,i=e.y<n.y?-1:1;return`L ${l},${o+a*i}Q ${l},${o} ${l+a*c},${o}`}function Rm({sourceX:e,sourceY:t,sourcePosition:n=ye.Bottom,targetX:r,targetY:a,targetPosition:l=ye.Top,borderRadius:o=5,centerX:c,centerY:i,offset:u=20,stepPosition:m=.5}){const[h,f,g,b,w]=F3({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:l,center:{x:c,y:i},offset:u,stepPosition:m});return[h.reduce((d,p,v)=>{let N="";return v>0&&v<h.length-1?N=V3(h[v-1],p,h[v+1],o):N=`${v===0?"M":"L"}${p.x} ${p.y}`,d+=N,d},""),f,g,b,w]}function M0(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function z3(e){var h;const{sourceNode:t,targetNode:n}=e;if(!M0(t)||!M0(n))return null;const r=t.internals.handleBounds||P0(t.handles),a=n.internals.handleBounds||P0(n.handles),l=T0((r==null?void 0:r.source)??[],e.sourceHandle),o=T0(e.connectionMode===tl.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!l||!o)return(h=e.onError)==null||h.call(e,"008",Ms.error008(l?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const c=(l==null?void 0:l.position)||ye.Bottom,i=(o==null?void 0:o.position)||ye.Top,u=ca(t,l,c),m=ca(n,o,i);return{sourceX:u.x,sourceY:u.y,targetX:m.x,targetY:m.y,sourcePosition:c,targetPosition:i}}function P0(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function ca(e,t,n=ye.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,l=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:o,height:c}=t??Js(e);if(r)return{x:a+o/2,y:l+c/2};switch((t==null?void 0:t.position)??n){case ye.Top:return{x:a+o/2,y:l};case ye.Right:return{x:a+o,y:l+c/2};case ye.Bottom:return{x:a+o/2,y:l+c};case ye.Left:return{x:a,y:l+c/2}}}function T0(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Mm(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function H3(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const l=new Set;return e.reduce((o,c)=>([c.markerStart||r,c.markerEnd||a].forEach(i=>{if(i&&typeof i=="object"){const u=Mm(i,t);l.has(u)||(o.push({id:u,color:i.color||n,...i}),l.add(u))}}),o),[]).sort((o,c)=>o.id.localeCompare(c.id))}const Ay=1e3,U3=10,Jf={nodeOrigin:[0,0],nodeExtent:yo,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},B3={...Jf,checkEquality:!0};function eh(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function W3(e,t,n){const r=eh(Jf,n);for(const a of e.values())if(a.parentId)nh(a,e,t,r);else{const l=Io(a,r.nodeOrigin),o=rl(a.extent)?a.extent:r.nodeExtent,c=ia(l,o,Js(a));a.internals.positionAbsolute=c}}function G3(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const n=[],r=[];for(const a of e.handles){const l={id:a.id,width:a.width??1,height:a.height??1,nodeId:e.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?n.push(l):a.type==="target"&&r.push(l)}return{source:n,target:r}}function th(e){return e==="manual"}function Pm(e,t,n,r={}){var u,m;const a=eh(B3,r),l={i:0},o=new Map(t),c=a!=null&&a.elevateNodesOnSelect&&!th(a.zIndexMode)?Ay:0;let i=e.length>0;t.clear(),n.clear();for(const h of e){let f=o.get(h.id);if(a.checkEquality&&h===(f==null?void 0:f.internals.userNode))t.set(h.id,f);else{const g=Io(h,a.nodeOrigin),b=rl(h.extent)?h.extent:a.nodeExtent,w=ia(g,b,Js(h));f={...a.defaults,...h,measured:{width:(u=h.measured)==null?void 0:u.width,height:(m=h.measured)==null?void 0:m.height},internals:{positionAbsolute:w,handleBounds:G3(h,f),z:Ry(h,c,a.zIndexMode),userNode:h}},t.set(h.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(i=!1),h.parentId&&nh(f,t,n,r,l)}return i}function Y3(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function nh(e,t,n,r,a){const{elevateNodesOnSelect:l,nodeOrigin:o,nodeExtent:c,zIndexMode:i}=eh(Jf,r),u=e.parentId,m=t.get(u);if(!m){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Y3(e,n),a&&!m.parentId&&m.internals.rootParentIndex===void 0&&i==="auto"&&(m.internals.rootParentIndex=++a.i,m.internals.z=m.internals.z+a.i*U3),a&&m.internals.rootParentIndex!==void 0&&(a.i=m.internals.rootParentIndex);const h=l&&!th(i)?Ay:0,{x:f,y:g,z:b}=q3(e,m,o,c,h,i),{positionAbsolute:w}=e.internals,x=f!==w.x||g!==w.y;(x||b!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:x?{x:f,y:g}:w,z:b}})}function Ry(e,t,n){const r=ls(e.zIndex)?e.zIndex:0;return th(n)?r:r+(e.selected?t:0)}function q3(e,t,n,r,a,l){const{x:o,y:c}=t.internals.positionAbsolute,i=Js(e),u=Io(e,n),m=rl(e.extent)?ia(u,e.extent,i):u;let h=ia({x:o+m.x,y:c+m.y},r,i);e.extent==="parent"&&(h=gy(h,i,t));const f=Ry(e,a,l),g=t.internals.z??0;return{x:h.x,y:h.y,z:g>=f?g+1:f}}function sh(e,t,n,r=[0,0]){var o;const a=[],l=new Map;for(const c of e){const i=t.get(c.parentId);if(!i)continue;const u=((o=l.get(c.parentId))==null?void 0:o.expandedRect)??sl(i),m=by(u,c.rect);l.set(c.parentId,{expandedRect:m,parent:i})}return l.size>0&&l.forEach(({expandedRect:c,parent:i},u)=>{var v;const m=i.internals.positionAbsolute,h=Js(i),f=i.origin??r,g=c.x<m.x?Math.round(Math.abs(m.x-c.x)):0,b=c.y<m.y?Math.round(Math.abs(m.y-c.y)):0,w=Math.max(h.width,Math.round(c.width)),x=Math.max(h.height,Math.round(c.height)),d=(w-h.width)*f[0],p=(x-h.height)*f[1];(g>0||b>0||d||p)&&(a.push({id:u,type:"position",position:{x:i.position.x-g+d,y:i.position.y-b+p}}),(v=n.get(u))==null||v.forEach(N=>{e.some(C=>C.id===N.id)||a.push({id:N.id,type:"position",position:{x:N.position.x+g,y:N.position.y+b}})})),(h.width<c.width||h.height<c.height||g||b)&&a.push({id:u,type:"dimensions",setAttributes:!0,dimensions:{width:w+(g?f[0]*g-d:0),height:x+(b?f[1]*b-p:0)}})}),a}function X3(e,t,n,r,a,l,o){const c=r==null?void 0:r.querySelector(".xyflow__viewport");let i=!1;if(!c)return{changes:[],updatedInternals:i};const u=[],m=window.getComputedStyle(c),{m22:h}=new window.DOMMatrixReadOnly(m.transform),f=[];for(const g of e.values()){const b=t.get(g.id);if(!b)continue;if(b.hidden){t.set(b.id,{...b,internals:{...b.internals,handleBounds:void 0}}),i=!0;continue}const w=Zf(g.nodeElement),x=b.measured.width!==w.width||b.measured.height!==w.height;if(!!(w.width&&w.height&&(x||!b.internals.handleBounds||g.force))){const p=g.nodeElement.getBoundingClientRect(),v=rl(b.extent)?b.extent:l;let{positionAbsolute:N}=b.internals;b.parentId&&b.extent==="parent"?N=gy(N,w,t.get(b.parentId)):v&&(N=ia(N,v,w));const C={...b,measured:w,internals:{...b.internals,positionAbsolute:N,handleBounds:{source:k0("source",g.nodeElement,p,h,b.id),target:k0("target",g.nodeElement,p,h,b.id)}}};t.set(b.id,C),b.parentId&&nh(C,t,n,{nodeOrigin:a,zIndexMode:o}),i=!0,x&&(u.push({id:b.id,type:"dimensions",dimensions:w}),b.expandParent&&b.parentId&&f.push({id:b.id,parentId:b.parentId,rect:sl(C,a)}))}}if(f.length>0){const g=sh(f,t,n,a);u.push(...g)}return{changes:u,updatedInternals:i}}async function Q3({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:l}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const o=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,l]],r),c=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(c)}function O0(e,t,n,r,a,l){let o=a;const c=r.get(o)||new Map;r.set(o,c.set(n,t)),o=`${a}-${e}`;const i=r.get(o)||new Map;if(r.set(o,i.set(n,t)),l){o=`${a}-${e}-${l}`;const u=r.get(o)||new Map;r.set(o,u.set(n,t))}}function My(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:l,sourceHandle:o=null,targetHandle:c=null}=r,i={edgeId:r.id,source:a,target:l,sourceHandle:o,targetHandle:c},u=`${a}-${o}--${l}-${c}`,m=`${l}-${c}--${a}-${o}`;O0("source",i,m,e,a,o),O0("target",i,u,e,l,c),t.set(r.id,r)}}function Py(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Py(n,t):!1}function I0(e,t,n){var a;let r=e;do{if((a=r==null?void 0:r.matches)!=null&&a.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function K3(e,t,n,r){const a=new Map;for(const[l,o]of e)if((o.selected||o.id===r)&&(!o.parentId||!Py(o,e))&&(o.draggable||t&&typeof o.draggable>"u")){const c=e.get(l);c&&a.set(l,{id:l,position:c.position||{x:0,y:0},distance:{x:n.x-c.internals.positionAbsolute.x,y:n.y-c.internals.positionAbsolute.y},extent:c.extent,parentId:c.parentId,origin:c.origin,expandParent:c.expandParent,internals:{positionAbsolute:c.internals.positionAbsolute||{x:0,y:0}},measured:{width:c.measured.width??0,height:c.measured.height??0}})}return a}function td({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var o,c,i;const a=[];for(const[u,m]of t){const h=(o=n.get(u))==null?void 0:o.internals.userNode;h&&a.push({...h,position:m.position,dragging:r})}if(!e)return[a[0],a];const l=(c=n.get(e))==null?void 0:c.internals.userNode;return[l?{...l,position:((i=t.get(e))==null?void 0:i.position)||l.position,dragging:r}:a[0],a]}function Z3({dragItems:e,snapGrid:t,x:n,y:r}){const a=e.values().next().value;if(!a)return null;const l={x:n-a.distance.x,y:r-a.distance.y},o=$o(l,t);return{x:o.x-l.x,y:o.y-l.y}}function J3({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let l={x:null,y:null},o=0,c=new Map,i=!1,u={x:0,y:0},m=null,h=!1,f=null,g=!1,b=!1,w=null;function x({noDragClassName:p,handleSelector:v,domNode:N,isSelectable:C,nodeId:j,nodeClickDistance:E=0}){f=Cn(N);function y({x:A,y:D}){const{nodeLookup:S,nodeExtent:T,snapGrid:P,snapToGrid:L,nodeOrigin:I,onNodeDrag:O,onSelectionDrag:F,onError:U,updateNodePositions:B}=t();l={x:A,y:D};let Z=!1;const ee=c.size>1,ce=ee&&T?Am(Lo(c)):null,oe=ee&&L?Z3({dragItems:c,snapGrid:P,x:A,y:D}):null;for(const[Y,q]of c){if(!S.has(Y))continue;let se={x:A-q.distance.x,y:D-q.distance.y};L&&(se=oe?{x:Math.round(se.x+oe.x),y:Math.round(se.y+oe.y)}:$o(se,P));let z=null;if(ee&&T&&!q.extent&&ce){const{positionAbsolute:ae}=q.internals,je=ae.x-ce.x+T[0][0],Ne=ae.x+q.measured.width-ce.x2+T[1][0],Ce=ae.y-ce.y+T[0][1],Me=ae.y+q.measured.height-ce.y2+T[1][1];z=[[je,Ce],[Ne,Me]]}const{position:G,positionAbsolute:J}=xy({nodeId:Y,nextPosition:se,nodeLookup:S,nodeExtent:z||T,nodeOrigin:I,onError:U});Z=Z||q.position.x!==G.x||q.position.y!==G.y,q.position=G,q.internals.positionAbsolute=J}if(b=b||Z,!!Z&&(B(c,!0),w&&(r||O||!j&&F))){const[Y,q]=td({nodeId:j,dragItems:c,nodeLookup:S});r==null||r(w,c,Y,q),O==null||O(w,Y,q),j||F==null||F(w,q)}}async function R(){if(!m)return;const{transform:A,panBy:D,autoPanSpeed:S,autoPanOnNodeDrag:T}=t();if(!T){i=!1,cancelAnimationFrame(o);return}const[P,L]=vy(u,m,S);(P!==0||L!==0)&&(l.x=(l.x??0)-P/A[2],l.y=(l.y??0)-L/A[2],await D({x:P,y:L})&&y(l)),o=requestAnimationFrame(R)}function $(A){var ee;const{nodeLookup:D,multiSelectionActive:S,nodesDraggable:T,transform:P,snapGrid:L,snapToGrid:I,selectNodesOnDrag:O,onNodeDragStart:F,onSelectionDragStart:U,unselectNodesAndEdges:B}=t();h=!0,(!O||!C)&&!S&&j&&((ee=D.get(j))!=null&&ee.selected||B()),C&&O&&j&&(e==null||e(j));const Z=Ul(A.sourceEvent,{transform:P,snapGrid:L,snapToGrid:I,containerBounds:m});if(l=Z,c=K3(D,T,Z,j),c.size>0&&(n||F||!j&&U)){const[ce,oe]=td({nodeId:j,dragItems:c,nodeLookup:D});n==null||n(A.sourceEvent,c,ce,oe),F==null||F(A.sourceEvent,ce,oe),j||U==null||U(A.sourceEvent,oe)}}const k=Xb().clickDistance(E).on("start",A=>{const{domNode:D,nodeDragThreshold:S,transform:T,snapGrid:P,snapToGrid:L}=t();m=(D==null?void 0:D.getBoundingClientRect())||null,g=!1,b=!1,w=A.sourceEvent,S===0&&$(A),l=Ul(A.sourceEvent,{transform:T,snapGrid:P,snapToGrid:L,containerBounds:m}),u=os(A.sourceEvent,m)}).on("drag",A=>{const{autoPanOnNodeDrag:D,transform:S,snapGrid:T,snapToGrid:P,nodeDragThreshold:L,nodeLookup:I}=t(),O=Ul(A.sourceEvent,{transform:S,snapGrid:T,snapToGrid:P,containerBounds:m});if(w=A.sourceEvent,(A.sourceEvent.type==="touchmove"&&A.sourceEvent.touches.length>1||j&&!I.has(j))&&(g=!0),!g){if(!i&&D&&h&&(i=!0,R()),!h){const F=os(A.sourceEvent,m),U=F.x-u.x,B=F.y-u.y;Math.sqrt(U*U+B*B)>L&&$(A)}(l.x!==O.xSnapped||l.y!==O.ySnapped)&&c&&h&&(u=os(A.sourceEvent,m),y(O))}}).on("end",A=>{if(!(!h||g)&&(i=!1,h=!1,cancelAnimationFrame(o),c.size>0)){const{nodeLookup:D,updateNodePositions:S,onNodeDragStop:T,onSelectionDragStop:P}=t();if(b&&(S(c,!1),b=!1),a||T||!j&&P){const[L,I]=td({nodeId:j,dragItems:c,nodeLookup:D,dragging:!1});a==null||a(A.sourceEvent,c,L,I),T==null||T(A.sourceEvent,L,I),j||P==null||P(A.sourceEvent,I)}}}).filter(A=>{const D=A.target;return!A.button&&(!p||!I0(D,`.${p}`,N))&&(!v||I0(D,v,N))});f.call(k)}function d(){f==null||f.on(".drag",null)}return{update:x,destroy:d}}function eE(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const l of t.values())jo(a,sl(l))>0&&r.push(l);return r}const tE=250;function nE(e,t,n,r){var c,i;let a=[],l=1/0;const o=eE(e,n,t+tE);for(const u of o){const m=[...((c=u.internals.handleBounds)==null?void 0:c.source)??[],...((i=u.internals.handleBounds)==null?void 0:i.target)??[]];for(const h of m){if(r.nodeId===h.nodeId&&r.type===h.type&&r.id===h.id)continue;const{x:f,y:g}=ca(u,h,h.position,!0),b=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(g-e.y,2));b>t||(b<l?(a=[{...h,x:f,y:g}],l=b):b===l&&a.push({...h,x:f,y:g}))}}if(!a.length)return null;if(a.length>1){const u=r.type==="source"?"target":"source";return a.find(m=>m.type===u)??a[0]}return a[0]}function Ty(e,t,n,r,a,l=!1){var u,m,h;const o=r.get(e);if(!o)return null;const c=a==="strict"?(u=o.internals.handleBounds)==null?void 0:u[t]:[...((m=o.internals.handleBounds)==null?void 0:m.source)??[],...((h=o.internals.handleBounds)==null?void 0:h.target)??[]],i=(n?c==null?void 0:c.find(f=>f.id===n):c==null?void 0:c[0])??null;return i&&l?{...i,...ca(o,i,i.position,!0)}:i}function Oy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function sE(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Iy=()=>!0;function rE(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:l,isTarget:o,domNode:c,nodeLookup:i,lib:u,autoPanOnConnect:m,flowId:h,panBy:f,cancelConnection:g,onConnectStart:b,onConnect:w,onConnectEnd:x,isValidConnection:d=Iy,onReconnectEnd:p,updateConnection:v,getTransform:N,getFromHandle:C,autoPanSpeed:j,dragThreshold:E=1,handleDomNode:y}){const R=jy(e.target);let $=0,k;const{x:A,y:D}=os(e),S=Oy(l,y),T=c==null?void 0:c.getBoundingClientRect();let P=!1;if(!T||!S)return;const L=Ty(a,S,r,i,t);if(!L)return;let I=os(e,T),O=!1,F=null,U=!1,B=null;function Z(){if(!m||!T)return;const[G,J]=vy(I,T,j);f({x:G,y:J}),$=requestAnimationFrame(Z)}const ee={...L,nodeId:a,type:S,position:L.position},ce=i.get(a);let Y={inProgress:!0,isValid:null,from:ca(ce,ee,ye.Left,!0),fromHandle:ee,fromPosition:ee.position,fromNode:ce,to:I,toHandle:null,toPosition:_0[ee.position],toNode:null,pointer:I};function q(){P=!0,v(Y),b==null||b(e,{nodeId:a,handleId:r,handleType:S})}E===0&&q();function se(G){if(!P){const{x:Me,y:He}=os(G),ze=Me-A,$e=He-D;if(!(ze*ze+$e*$e>E*E))return;q()}if(!C()||!ee){z(G);return}const J=N();I=os(G,T),k=nE(Do(I,J,!1,[1,1]),n,i,ee),O||(Z(),O=!0);const ae=Ly(G,{handle:k,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:o?"target":"source",isValidConnection:d,doc:R,lib:u,flowId:h,nodeLookup:i});B=ae.handleDomNode,F=ae.connection,U=sE(!!k,ae.isValid);const je=i.get(a),Ne=je?ca(je,ee,ye.Left,!0):Y.from,Ce={...Y,from:Ne,isValid:U,to:ae.toHandle&&U?_c({x:ae.toHandle.x,y:ae.toHandle.y},J):I,toHandle:ae.toHandle,toPosition:U&&ae.toHandle?ae.toHandle.position:_0[ee.position],toNode:ae.toHandle?i.get(ae.toHandle.nodeId):null,pointer:I};v(Ce),Y=Ce}function z(G){if(!("touches"in G&&G.touches.length>0)){if(P){(k||B)&&F&&U&&(w==null||w(F));const{inProgress:J,...ae}=Y,je={...ae,toPosition:Y.toHandle?Y.toPosition:null};x==null||x(G,je),l&&(p==null||p(G,je))}g(),cancelAnimationFrame($),O=!1,U=!1,F=null,B=null,R.removeEventListener("mousemove",se),R.removeEventListener("mouseup",z),R.removeEventListener("touchmove",se),R.removeEventListener("touchend",z)}}R.addEventListener("mousemove",se),R.addEventListener("mouseup",z),R.addEventListener("touchmove",se),R.addEventListener("touchend",z)}function Ly(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:l,doc:o,lib:c,flowId:i,isValidConnection:u=Iy,nodeLookup:m}){const h=l==="target",f=t?o.querySelector(`.${c}-flow__handle[data-id="${i}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:g,y:b}=os(e),w=o.elementFromPoint(g,b),x=w!=null&&w.classList.contains(`${c}-flow__handle`)?w:f,d={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const p=Oy(void 0,x),v=x.getAttribute("data-nodeid"),N=x.getAttribute("data-handleid"),C=x.classList.contains("connectable"),j=x.classList.contains("connectableend");if(!v||!p)return d;const E={source:h?v:r,sourceHandle:h?N:a,target:h?r:v,targetHandle:h?a:N};d.connection=E;const R=C&&j&&(n===tl.Strict?h&&p==="source"||!h&&p==="target":v!==r||N!==a);d.isValid=R&&u(E),d.toHandle=Ty(v,p,N,m,n,!0)}return d}const Tm={onPointerDown:rE,isValid:Ly};function aE({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=Cn(e);function l({translateExtent:c,width:i,height:u,zoomStep:m=1,pannable:h=!0,zoomable:f=!0,inversePan:g=!1}){const b=v=>{if(v.sourceEvent.type!=="wheel"||!t)return;const N=n(),C=v.sourceEvent.ctrlKey&&_o()?10:1,j=-v.sourceEvent.deltaY*(v.sourceEvent.deltaMode===1?.05:v.sourceEvent.deltaMode?1:.002)*m,E=N[2]*Math.pow(2,j*C);t.scaleTo(E)};let w=[0,0];const x=v=>{(v.sourceEvent.type==="mousedown"||v.sourceEvent.type==="touchstart")&&(w=[v.sourceEvent.clientX??v.sourceEvent.touches[0].clientX,v.sourceEvent.clientY??v.sourceEvent.touches[0].clientY])},d=v=>{const N=n();if(v.sourceEvent.type!=="mousemove"&&v.sourceEvent.type!=="touchmove"||!t)return;const C=[v.sourceEvent.clientX??v.sourceEvent.touches[0].clientX,v.sourceEvent.clientY??v.sourceEvent.touches[0].clientY],j=[C[0]-w[0],C[1]-w[1]];w=C;const E=r()*Math.max(N[2],Math.log(N[2]))*(g?-1:1),y={x:N[0]-j[0]*E,y:N[1]-j[1]*E},R=[[0,0],[i,u]];t.setViewportConstrained({x:y.x,y:y.y,zoom:N[2]},R,c)},p=uy().on("start",x).on("zoom",h?d:null).on("zoom.wheel",f?b:null);a.call(p,{})}function o(){a.on("zoom",null)}return{update:l,destroy:o,pointer:es}}const nu=e=>({x:e.x,y:e.y,zoom:e.k}),nd=({x:e,y:t,zoom:n})=>Jc.translate(e,t).scale(n),Ma=(e,t)=>e.target.closest(`.${t}`),$y=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),lE=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,sd=(e,t=0,n=lE,r=()=>{})=>{const a=typeof t=="number"&&t>0;return a||r(),a?e.transition().duration(t).ease(n).on("end",r):e},Dy=e=>{const t=e.ctrlKey&&_o()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function oE({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:o,onPanZoomStart:c,onPanZoom:i,onPanZoomEnd:u}){return m=>{if(Ma(m,t))return m.ctrlKey&&m.preventDefault(),!1;m.preventDefault(),m.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(m.ctrlKey&&o){const x=es(m),d=Dy(m),p=h*Math.pow(2,d);r.scaleTo(n,p,x,m);return}const f=m.deltaMode===1?20:1;let g=a===Kr.Vertical?0:m.deltaX*f,b=a===Kr.Horizontal?0:m.deltaY*f;!_o()&&m.shiftKey&&a!==Kr.Vertical&&(g=m.deltaY*f,b=0),r.translateBy(n,-(g/h)*l,-(b/h)*l,{internal:!0});const w=nu(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(i==null||i(m,w),e.panScrollTimeout=setTimeout(()=>{u==null||u(m,w),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,c==null||c(m,w))}}function iE({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){const l=r.type==="wheel",o=!t&&l&&!r.ctrlKey,c=Ma(r,e);if(r.ctrlKey&&l&&c&&r.preventDefault(),o||c)return null;r.preventDefault(),n.call(this,r,a)}}function cE({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var l,o,c;if((l=r.sourceEvent)!=null&&l.internal)return;const a=nu(r.transform);e.mouseButton=((o=r.sourceEvent)==null?void 0:o.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((c=r.sourceEvent)==null?void 0:c.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function uE({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return l=>{var o,c;e.usedRightMouseButton=!!(n&&$y(t,e.mouseButton??0)),(o=l.sourceEvent)!=null&&o.sync||r([l.transform.x,l.transform.y,l.transform.k]),a&&!((c=l.sourceEvent)!=null&&c.internal)&&(a==null||a(l.sourceEvent,nu(l.transform)))}}function dE({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:l}){return o=>{var c;if(!((c=o.sourceEvent)!=null&&c.internal)&&(e.isZoomingOrPanning=!1,l&&$y(t,e.mouseButton??0)&&!e.usedRightMouseButton&&o.sourceEvent&&l(o.sourceEvent),e.usedRightMouseButton=!1,r(!1),a)){const i=nu(o.transform);e.prevViewport=i,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(o.sourceEvent,i)},n?150:0)}}}function mE({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:l,userSelectionActive:o,noWheelClassName:c,noPanClassName:i,lib:u,connectionInProgress:m}){return h=>{var x;const f=e||t,g=n&&h.ctrlKey,b=h.type==="wheel";if(h.button===1&&h.type==="mousedown"&&(Ma(h,`${u}-flow__node`)||Ma(h,`${u}-flow__edge`)))return!0;if(!r&&!f&&!a&&!l&&!n||o||m&&!b||Ma(h,c)&&b||Ma(h,i)&&(!b||a&&b&&!e)||!n&&h.ctrlKey&&b)return!1;if(!n&&h.type==="touchstart"&&((x=h.touches)==null?void 0:x.length)>1)return h.preventDefault(),!1;if(!f&&!a&&!g&&b||!r&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(r)&&!r.includes(h.button)&&h.type==="mousedown")return!1;const w=Array.isArray(r)&&r.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||b)&&w}}function fE({domNode:e,minZoom:t,maxZoom:n,translateExtent:r,viewport:a,onPanZoom:l,onPanZoomStart:o,onPanZoomEnd:c,onDraggingChange:i}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},m=e.getBoundingClientRect(),h=uy().scaleExtent([t,n]).translateExtent(r),f=Cn(e).call(h);p({x:a.x,y:a.y,zoom:nl(a.zoom,t,n)},[[0,0],[m.width,m.height]],r);const g=f.on("wheel.zoom"),b=f.on("dblclick.zoom");h.wheelDelta(Dy);function w(k,A){return f?new Promise(D=>{h==null||h.interpolate((A==null?void 0:A.interpolate)==="linear"?Hl:Mi).transform(sd(f,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>D(!0)),k)}):Promise.resolve(!1)}function x({noWheelClassName:k,noPanClassName:A,onPaneContextMenu:D,userSelectionActive:S,panOnScroll:T,panOnDrag:P,panOnScrollMode:L,panOnScrollSpeed:I,preventScrolling:O,zoomOnPinch:F,zoomOnScroll:U,zoomOnDoubleClick:B,zoomActivationKeyPressed:Z,lib:ee,onTransformChange:ce,connectionInProgress:oe,paneClickDistance:Y,selectionOnDrag:q}){S&&!u.isZoomingOrPanning&&d();const se=T&&!Z&&!S;h.clickDistance(q?1/0:!ls(Y)||Y<0?0:Y);const z=se?oE({zoomPanValues:u,noWheelClassName:k,d3Selection:f,d3Zoom:h,panOnScrollMode:L,panOnScrollSpeed:I,zoomOnPinch:F,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}):iE({noWheelClassName:k,preventScrolling:O,d3ZoomHandler:g});if(f.on("wheel.zoom",z,{passive:!1}),!S){const J=cE({zoomPanValues:u,onDraggingChange:i,onPanZoomStart:o});h.on("start",J);const ae=uE({zoomPanValues:u,panOnDrag:P,onPaneContextMenu:!!D,onPanZoom:l,onTransformChange:ce});h.on("zoom",ae);const je=dE({zoomPanValues:u,panOnDrag:P,panOnScroll:T,onPaneContextMenu:D,onPanZoomEnd:c,onDraggingChange:i});h.on("end",je)}const G=mE({zoomActivationKeyPressed:Z,panOnDrag:P,zoomOnScroll:U,panOnScroll:T,zoomOnDoubleClick:B,zoomOnPinch:F,userSelectionActive:S,noPanClassName:A,noWheelClassName:k,lib:ee,connectionInProgress:oe});h.filter(G),B?f.on("dblclick.zoom",b):f.on("dblclick.zoom",null)}function d(){h.on("zoom",null)}async function p(k,A,D){const S=nd(k),T=h==null?void 0:h.constrain()(S,A,D);return T&&await w(T),new Promise(P=>P(T))}async function v(k,A){const D=nd(k);return await w(D,A),new Promise(S=>S(D))}function N(k){if(f){const A=nd(k),D=f.property("__zoom");(D.k!==k.zoom||D.x!==k.x||D.y!==k.y)&&(h==null||h.transform(f,A,null,{sync:!0}))}}function C(){const k=f?cy(f.node()):{x:0,y:0,k:1};return{x:k.x,y:k.y,zoom:k.k}}function j(k,A){return f?new Promise(D=>{h==null||h.interpolate((A==null?void 0:A.interpolate)==="linear"?Hl:Mi).scaleTo(sd(f,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>D(!0)),k)}):Promise.resolve(!1)}function E(k,A){return f?new Promise(D=>{h==null||h.interpolate((A==null?void 0:A.interpolate)==="linear"?Hl:Mi).scaleBy(sd(f,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>D(!0)),k)}):Promise.resolve(!1)}function y(k){h==null||h.scaleExtent(k)}function R(k){h==null||h.translateExtent(k)}function $(k){const A=!ls(k)||k<0?0:k;h==null||h.clickDistance(A)}return{update:x,destroy:d,setViewport:v,setViewportConstrained:p,getViewport:C,scaleTo:j,scaleBy:E,setScaleExtent:y,setTranslateExtent:R,syncViewport:N,setClickDistance:$}}var al;(function(e){e.Line="line",e.Handle="handle"})(al||(al={}));function hE({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:l}){const o=e-t,c=n-r,i=[o>0?1:o<0?-1:0,c>0?1:c<0?-1:0];return o&&a&&(i[0]=i[0]*-1),c&&l&&(i[1]=i[1]*-1),i}function L0(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function sr(e,t){return Math.max(0,t-e)}function rr(e,t){return Math.max(0,e-t)}function fi(e,t,n){return Math.max(0,t-e,e-n)}function $0(e,t){return e?!t:t}function pE(e,t,n,r,a,l,o,c){let{affectsX:i,affectsY:u}=t;const{isHorizontal:m,isVertical:h}=t,f=m&&h,{xSnapped:g,ySnapped:b}=n,{minWidth:w,maxWidth:x,minHeight:d,maxHeight:p}=r,{x:v,y:N,width:C,height:j,aspectRatio:E}=e;let y=Math.floor(m?g-e.pointerX:0),R=Math.floor(h?b-e.pointerY:0);const $=C+(i?-y:y),k=j+(u?-R:R),A=-l[0]*C,D=-l[1]*j;let S=fi($,w,x),T=fi(k,d,p);if(o){let I=0,O=0;i&&y<0?I=sr(v+y+A,o[0][0]):!i&&y>0&&(I=rr(v+$+A,o[1][0])),u&&R<0?O=sr(N+R+D,o[0][1]):!u&&R>0&&(O=rr(N+k+D,o[1][1])),S=Math.max(S,I),T=Math.max(T,O)}if(c){let I=0,O=0;i&&y>0?I=rr(v+y,c[0][0]):!i&&y<0&&(I=sr(v+$,c[1][0])),u&&R>0?O=rr(N+R,c[0][1]):!u&&R<0&&(O=sr(N+k,c[1][1])),S=Math.max(S,I),T=Math.max(T,O)}if(a){if(m){const I=fi($/E,d,p)*E;if(S=Math.max(S,I),o){let O=0;!i&&!u||i&&!u&&f?O=rr(N+D+$/E,o[1][1])*E:O=sr(N+D+(i?y:-y)/E,o[0][1])*E,S=Math.max(S,O)}if(c){let O=0;!i&&!u||i&&!u&&f?O=sr(N+$/E,c[1][1])*E:O=rr(N+(i?y:-y)/E,c[0][1])*E,S=Math.max(S,O)}}if(h){const I=fi(k*E,w,x)/E;if(T=Math.max(T,I),o){let O=0;!i&&!u||u&&!i&&f?O=rr(v+k*E+A,o[1][0])/E:O=sr(v+(u?R:-R)*E+A,o[0][0])/E,T=Math.max(T,O)}if(c){let O=0;!i&&!u||u&&!i&&f?O=sr(v+k*E,c[1][0])/E:O=rr(v+(u?R:-R)*E,c[0][0])/E,T=Math.max(T,O)}}}R=R+(R<0?T:-T),y=y+(y<0?S:-S),a&&(f?$>k*E?R=($0(i,u)?-y:y)/E:y=($0(i,u)?-R:R)*E:m?(R=y/E,u=i):(y=R*E,i=u));const P=i?v+y:v,L=u?N+R:N;return{width:C+(i?-y:y),height:j+(u?-R:R),x:l[0]*y*(i?-1:1)+P,y:l[1]*R*(u?-1:1)+L}}const Fy={width:0,height:0,x:0,y:0},xE={...Fy,pointerX:0,pointerY:0,aspectRatio:1};function gE(e){return[[0,0],[e.measured.width,e.measured.height]]}function vE(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,l=e.measured.width??0,o=e.measured.height??0,c=n[0]*l,i=n[1]*o;return[[r-c,a-i],[r+l-c,a+o-i]]}function bE({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const l=Cn(e);let o={controlDirection:L0("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function c({controlPosition:u,boundaries:m,keepAspectRatio:h,resizeDirection:f,onResizeStart:g,onResize:b,onResizeEnd:w,shouldResize:x}){let d={...Fy},p={...xE};o={boundaries:m,resizeDirection:f,keepAspectRatio:h,controlDirection:L0(u)};let v,N=null,C=[],j,E,y,R=!1;const $=Xb().on("start",k=>{const{nodeLookup:A,transform:D,snapGrid:S,snapToGrid:T,nodeOrigin:P,paneDomNode:L}=n();if(v=A.get(t),!v)return;N=(L==null?void 0:L.getBoundingClientRect())??null;const{xSnapped:I,ySnapped:O}=Ul(k.sourceEvent,{transform:D,snapGrid:S,snapToGrid:T,containerBounds:N});d={width:v.measured.width??0,height:v.measured.height??0,x:v.position.x??0,y:v.position.y??0},p={...d,pointerX:I,pointerY:O,aspectRatio:d.width/d.height},j=void 0,v.parentId&&(v.extent==="parent"||v.expandParent)&&(j=A.get(v.parentId),E=j&&v.extent==="parent"?gE(j):void 0),C=[],y=void 0;for(const[F,U]of A)if(U.parentId===t&&(C.push({id:F,position:{...U.position},extent:U.extent}),U.extent==="parent"||U.expandParent)){const B=vE(U,v,U.origin??P);y?y=[[Math.min(B[0][0],y[0][0]),Math.min(B[0][1],y[0][1])],[Math.max(B[1][0],y[1][0]),Math.max(B[1][1],y[1][1])]]:y=B}g==null||g(k,{...d})}).on("drag",k=>{const{transform:A,snapGrid:D,snapToGrid:S,nodeOrigin:T}=n(),P=Ul(k.sourceEvent,{transform:A,snapGrid:D,snapToGrid:S,containerBounds:N}),L=[];if(!v)return;const{x:I,y:O,width:F,height:U}=d,B={},Z=v.origin??T,{width:ee,height:ce,x:oe,y:Y}=pE(p,o.controlDirection,P,o.boundaries,o.keepAspectRatio,Z,E,y),q=ee!==F,se=ce!==U,z=oe!==I&&q,G=Y!==O&&se;if(!z&&!G&&!q&&!se)return;if((z||G||Z[0]===1||Z[1]===1)&&(B.x=z?oe:d.x,B.y=G?Y:d.y,d.x=B.x,d.y=B.y,C.length>0)){const Ne=oe-I,Ce=Y-O;for(const Me of C)Me.position={x:Me.position.x-Ne+Z[0]*(ee-F),y:Me.position.y-Ce+Z[1]*(ce-U)},L.push(Me)}if((q||se)&&(B.width=q&&(!o.resizeDirection||o.resizeDirection==="horizontal")?ee:d.width,B.height=se&&(!o.resizeDirection||o.resizeDirection==="vertical")?ce:d.height,d.width=B.width,d.height=B.height),j&&v.expandParent){const Ne=Z[0]*(B.width??0);B.x&&B.x<Ne&&(d.x=Ne,p.x=p.x-(B.x-Ne));const Ce=Z[1]*(B.height??0);B.y&&B.y<Ce&&(d.y=Ce,p.y=p.y-(B.y-Ce))}const J=hE({width:d.width,prevWidth:F,height:d.height,prevHeight:U,affectsX:o.controlDirection.affectsX,affectsY:o.controlDirection.affectsY}),ae={...d,direction:J};(x==null?void 0:x(k,ae))!==!1&&(R=!0,b==null||b(k,ae),r(B,L))}).on("end",k=>{R&&(w==null||w(k,{...d}),a==null||a({...d}),R=!1)});l.call($)}function i(){l.on(".drag",null)}return{update:c,destroy:i}}const{useDebugValue:yE}=Vm,{useSyncExternalStoreWithSelector:NE}=kv,jE=e=>e;function Vy(e,t=jE,n){const r=NE(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return yE(r),r}const D0=(e,t)=>{const n=jv(e),r=(a,l=t)=>Vy(n,a,l);return Object.assign(r,n),r},_E=(e,t)=>e?D0(e,t):D0;function lt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const su=M.createContext(null),wE=su.Provider,zy=Ms.error001();function Le(e,t){const n=M.useContext(su);if(n===null)throw new Error(zy);return Vy(n,e,t)}function ot(){const e=M.useContext(su);if(e===null)throw new Error(zy);return M.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const F0={display:"none"},SE={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Hy="react-flow__node-desc",Uy="react-flow__edge-desc",CE="react-flow__aria-live",kE=e=>e.ariaLiveMessage,EE=e=>e.ariaLabelConfig;function AE({rfId:e}){const t=Le(kE);return s.jsx("div",{id:`${CE}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:SE,children:t})}function RE({rfId:e,disableKeyboardA11y:t}){const n=Le(EE);return s.jsxs(s.Fragment,{children:[s.jsx("div",{id:`${Hy}-${e}`,style:F0,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),s.jsx("div",{id:`${Uy}-${e}`,style:F0,children:n["edge.a11yDescription.default"]}),!t&&s.jsx(AE,{rfId:e})]})}const ru=M.forwardRef(({position:e="top-left",children:t,className:n,style:r,...a},l)=>{const o=`${e}`.split("-");return s.jsx("div",{className:_t(["react-flow__panel",n,...o]),style:r,ref:l,...a,children:t})});ru.displayName="Panel";function ME({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:s.jsx(ru,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:s.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const PE=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},hi=e=>e.id;function TE(e,t){return lt(e.selectedNodes.map(hi),t.selectedNodes.map(hi))&&lt(e.selectedEdges.map(hi),t.selectedEdges.map(hi))}function OE({onSelectionChange:e}){const t=ot(),{selectedNodes:n,selectedEdges:r}=Le(PE,TE);return M.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(l=>l(a))},[n,r,e]),null}const IE=e=>!!e.onSelectionChangeHandlers;function LE({onSelectionChange:e}){const t=Le(IE);return e||t?s.jsx(OE,{onSelectionChange:e}):null}const By=[0,0],$E={x:0,y:0,zoom:1},DE=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],V0=[...DE,"rfId"],FE=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),z0={translateExtent:yo,nodeOrigin:By,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function VE(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:l,setNodeExtent:o,reset:c,setDefaultNodesAndEdges:i}=Le(FE,lt),u=ot();M.useEffect(()=>(i(e.defaultNodes,e.defaultEdges),()=>{m.current=z0,c()}),[]);const m=M.useRef(z0);return M.useEffect(()=>{for(const h of V0){const f=e[h],g=m.current[h];f!==g&&(typeof e[h]>"u"||(h==="nodes"?t(f):h==="edges"?n(f):h==="minZoom"?r(f):h==="maxZoom"?a(f):h==="translateExtent"?l(f):h==="nodeExtent"?o(f):h==="ariaLabelConfig"?u.setState({ariaLabelConfig:M3(f)}):h==="fitView"?u.setState({fitViewQueued:f}):h==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[h]:f})))}m.current=e},V0.map(h=>e[h])),null}function H0(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function zE(e){var r;const[t,n]=M.useState(e==="system"?null:e);return M.useEffect(()=>{if(e!=="system"){n(e);return}const a=H0(),l=()=>n(a!=null&&a.matches?"dark":"light");return l(),a==null||a.addEventListener("change",l),()=>{a==null||a.removeEventListener("change",l)}},[e]),t!==null?t:(r=H0())!=null&&r.matches?"dark":"light"}const U0=typeof document<"u"?document:null;function wo(e=null,t={target:U0,actInsideInputWithModifier:!0}){const[n,r]=M.useState(!1),a=M.useRef(!1),l=M.useRef(new Set([])),[o,c]=M.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),m=u.reduce((h,f)=>h.concat(...f),[]);return[u,m]}return[[],[]]},[e]);return M.useEffect(()=>{const i=(t==null?void 0:t.target)??U0,u=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const m=g=>{var x,d;if(a.current=g.ctrlKey||g.metaKey||g.shiftKey||g.altKey,(!a.current||a.current&&!u)&&_y(g))return!1;const w=W0(g.code,c);if(l.current.add(g[w]),B0(o,l.current,!1)){const p=((d=(x=g.composedPath)==null?void 0:x.call(g))==null?void 0:d[0])||g.target,v=(p==null?void 0:p.nodeName)==="BUTTON"||(p==null?void 0:p.nodeName)==="A";t.preventDefault!==!1&&(a.current||!v)&&g.preventDefault(),r(!0)}},h=g=>{const b=W0(g.code,c);B0(o,l.current,!0)?(r(!1),l.current.clear()):l.current.delete(g[b]),g.key==="Meta"&&l.current.clear(),a.current=!1},f=()=>{l.current.clear(),r(!1)};return i==null||i.addEventListener("keydown",m),i==null||i.addEventListener("keyup",h),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{i==null||i.removeEventListener("keydown",m),i==null||i.removeEventListener("keyup",h),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function B0(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function W0(e,t){return t.includes(e)?"code":"key"}const HE=()=>{const e=ot();return M.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,l],panZoom:o}=e.getState();return o?(await o.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:l,maxZoom:o,panZoom:c}=e.getState(),i=Kf(t,r,a,l,o,(n==null?void 0:n.padding)??.1);return c?(await c.setViewport(i,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:a,snapToGrid:l,domNode:o}=e.getState();if(!o)return t;const{x:c,y:i}=o.getBoundingClientRect(),u={x:t.x-c,y:t.y-i},m=n.snapGrid??a,h=n.snapToGrid??l;return Do(u,r,h,m)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:l}=r.getBoundingClientRect(),o=_c(t,n);return{x:o.x+a,y:o.y+l}}}),[])};function Wy(e,t){const n=[],r=new Map,a=[];for(const l of e)if(l.type==="add"){a.push(l);continue}else if(l.type==="remove"||l.type==="replace")r.set(l.id,[l]);else{const o=r.get(l.id);o?o.push(l):r.set(l.id,[l])}for(const l of t){const o=r.get(l.id);if(!o){n.push(l);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){n.push({...o[0].item});continue}const c={...l};for(const i of o)UE(i,c);n.push(c)}return a.length&&a.forEach(l=>{l.index!==void 0?n.splice(l.index,0,{...l.item}):n.push({...l.item})}),n}function UE(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Gy(e,t){return Wy(e,t)}function Yy(e,t){return Wy(e,t)}function Fr(e,t){return{id:e,type:"select",selected:t}}function Pa(e,t=new Set,n=!1){const r=[];for(const[a,l]of e){const o=t.has(a);!(l.selected===void 0&&!o)&&l.selected!==o&&(n&&(l.selected=o),r.push(Fr(l.id,o)))}return r}function G0({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(l=>[l.id,l]));for(const[l,o]of e.entries()){const c=t.get(o.id),i=((a=c==null?void 0:c.internals)==null?void 0:a.userNode)??c;i!==void 0&&i!==o&&n.push({id:o.id,item:o,type:"replace"}),i===void 0&&n.push({item:o,type:"add",index:l})}for(const[l]of t)r.get(l)===void 0&&n.push({id:l,type:"remove"});return n}function Y0(e){return{id:e.id,type:"remove"}}const q0=e=>N3(e),BE=e=>py(e);function qy(e){return M.forwardRef(e)}const WE=typeof window<"u"?M.useLayoutEffect:M.useEffect;function X0(e){const[t,n]=M.useState(BigInt(0)),[r]=M.useState(()=>GE(()=>n(a=>a+BigInt(1))));return WE(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function GE(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Xy=M.createContext(null);function YE({children:e}){const t=ot(),n=M.useCallback(c=>{const{nodes:i=[],setNodes:u,hasDefaultNodes:m,onNodesChange:h,nodeLookup:f,fitViewQueued:g,onNodesChangeMiddlewareMap:b}=t.getState();let w=i;for(const d of c)w=typeof d=="function"?d(w):d;let x=G0({items:w,lookup:f});for(const d of b.values())x=d(x);m&&u(w),x.length>0?h==null||h(x):g&&window.requestAnimationFrame(()=>{const{fitViewQueued:d,nodes:p,setNodes:v}=t.getState();d&&v(p)})},[]),r=X0(n),a=M.useCallback(c=>{const{edges:i=[],setEdges:u,hasDefaultEdges:m,onEdgesChange:h,edgeLookup:f}=t.getState();let g=i;for(const b of c)g=typeof b=="function"?b(g):b;m?u(g):h&&h(G0({items:g,lookup:f}))},[]),l=X0(a),o=M.useMemo(()=>({nodeQueue:r,edgeQueue:l}),[]);return s.jsx(Xy.Provider,{value:o,children:e})}function qE(){const e=M.useContext(Xy);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const XE=e=>!!e.panZoom;function rh(){const e=HE(),t=ot(),n=qE(),r=Le(XE),a=M.useMemo(()=>{const l=h=>t.getState().nodeLookup.get(h),o=h=>{n.nodeQueue.push(h)},c=h=>{n.edgeQueue.push(h)},i=h=>{var d,p;const{nodeLookup:f,nodeOrigin:g}=t.getState(),b=q0(h)?h:f.get(h.id),w=b.parentId?Ny(b.position,b.measured,b.parentId,f,g):b.position,x={...b,position:w,width:((d=b.measured)==null?void 0:d.width)??b.width,height:((p=b.measured)==null?void 0:p.height)??b.height};return sl(x)},u=(h,f,g={replace:!1})=>{o(b=>b.map(w=>{if(w.id===h){const x=typeof f=="function"?f(w):f;return g.replace&&q0(x)?x:{...w,...x}}return w}))},m=(h,f,g={replace:!1})=>{c(b=>b.map(w=>{if(w.id===h){const x=typeof f=="function"?f(w):f;return g.replace&&BE(x)?x:{...w,...x}}return w}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>{var f;return(f=l(h))==null?void 0:f.internals.userNode},getInternalNode:l,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(f=>({...f}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:o,setEdges:c,addNodes:h=>{const f=Array.isArray(h)?h:[h];n.nodeQueue.push(g=>[...g,...f])},addEdges:h=>{const f=Array.isArray(h)?h:[h];n.edgeQueue.push(g=>[...g,...f])},toObject:()=>{const{nodes:h=[],edges:f=[],transform:g}=t.getState(),[b,w,x]=g;return{nodes:h.map(d=>({...d})),edges:f.map(d=>({...d})),viewport:{x:b,y:w,zoom:x}}},deleteElements:async({nodes:h=[],edges:f=[]})=>{const{nodes:g,edges:b,onNodesDelete:w,onEdgesDelete:x,triggerNodeChanges:d,triggerEdgeChanges:p,onDelete:v,onBeforeDelete:N}=t.getState(),{nodes:C,edges:j}=await C3({nodesToRemove:h,edgesToRemove:f,nodes:g,edges:b,onBeforeDelete:N}),E=j.length>0,y=C.length>0;if(E){const R=j.map(Y0);x==null||x(j),p(R)}if(y){const R=C.map(Y0);w==null||w(C),d(R)}return(y||E)&&(v==null||v({nodes:C,edges:j})),{deletedNodes:C,deletedEdges:j}},getIntersectingNodes:(h,f=!0,g)=>{const b=S0(h),w=b?h:i(h),x=g!==void 0;return w?(g||t.getState().nodes).filter(d=>{const p=t.getState().nodeLookup.get(d.id);if(p&&!b&&(d.id===h.id||!p.internals.positionAbsolute))return!1;const v=sl(x?d:p),N=jo(v,w);return f&&N>0||N>=v.width*v.height||N>=w.width*w.height}):[]},isNodeIntersecting:(h,f,g=!0)=>{const w=S0(h)?h:i(h);if(!w)return!1;const x=jo(w,f);return g&&x>0||x>=f.width*f.height||x>=w.width*w.height},updateNode:u,updateNodeData:(h,f,g={replace:!1})=>{u(h,b=>{const w=typeof f=="function"?f(b):f;return g.replace?{...b,data:w}:{...b,data:{...b.data,...w}}},g)},updateEdge:m,updateEdgeData:(h,f,g={replace:!1})=>{m(h,b=>{const w=typeof f=="function"?f(b):f;return g.replace?{...b,data:w}:{...b,data:{...b.data,...w}}},g)},getNodesBounds:h=>{const{nodeLookup:f,nodeOrigin:g}=t.getState();return j3(h,{nodeLookup:f,nodeOrigin:g})},getHandleConnections:({type:h,id:f,nodeId:g})=>{var b;return Array.from(((b=t.getState().connectionLookup.get(`${g}-${h}${f?`-${f}`:""}`))==null?void 0:b.values())??[])},getNodeConnections:({type:h,handleId:f,nodeId:g})=>{var b;return Array.from(((b=t.getState().connectionLookup.get(`${g}${h?f?`-${h}-${f}`:`-${h}`:""}`))==null?void 0:b.values())??[])},fitView:async h=>{const f=t.getState().fitViewResolver??R3();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:f}),n.nodeQueue.push(g=>[...g]),f.promise}}},[]);return M.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const Q0=e=>e.selected,QE=typeof window<"u"?window:void 0;function KE({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ot(),{deleteElements:r}=rh(),a=wo(e,{actInsideInputWithModifier:!1}),l=wo(t,{target:QE});M.useEffect(()=>{if(a){const{edges:o,nodes:c}=n.getState();r({nodes:c.filter(Q0),edges:o.filter(Q0)}),n.setState({nodesSelectionActive:!1})}},[a]),M.useEffect(()=>{n.setState({multiSelectionActive:l})},[l])}function ZE(e){const t=ot();M.useEffect(()=>{const n=()=>{var a,l,o,c;if(!e.current||!(((l=(a=e.current).checkVisibility)==null?void 0:l.call(a))??!0))return!1;const r=Zf(e.current);(r.height===0||r.width===0)&&((c=(o=t.getState()).onError)==null||c.call(o,"004",Ms.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const au={position:"absolute",width:"100%",height:"100%",top:0,left:0},JE=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function eA({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Kr.Free,zoomOnDoubleClick:o=!0,panOnDrag:c=!0,defaultViewport:i,translateExtent:u,minZoom:m,maxZoom:h,zoomActivationKeyCode:f,preventScrolling:g=!0,children:b,noWheelClassName:w,noPanClassName:x,onViewportChange:d,isControlledViewport:p,paneClickDistance:v,selectionOnDrag:N}){const C=ot(),j=M.useRef(null),{userSelectionActive:E,lib:y,connectionInProgress:R}=Le(JE,lt),$=wo(f),k=M.useRef();ZE(j);const A=M.useCallback(D=>{d==null||d({x:D[0],y:D[1],zoom:D[2]}),p||C.setState({transform:D})},[d,p]);return M.useEffect(()=>{if(j.current){k.current=fE({domNode:j.current,minZoom:m,maxZoom:h,translateExtent:u,viewport:i,onDraggingChange:P=>C.setState({paneDragging:P}),onPanZoomStart:(P,L)=>{const{onViewportChangeStart:I,onMoveStart:O}=C.getState();O==null||O(P,L),I==null||I(L)},onPanZoom:(P,L)=>{const{onViewportChange:I,onMove:O}=C.getState();O==null||O(P,L),I==null||I(L)},onPanZoomEnd:(P,L)=>{const{onViewportChangeEnd:I,onMoveEnd:O}=C.getState();O==null||O(P,L),I==null||I(L)}});const{x:D,y:S,zoom:T}=k.current.getViewport();return C.setState({panZoom:k.current,transform:[D,S,T],domNode:j.current.closest(".react-flow")}),()=>{var P;(P=k.current)==null||P.destroy()}}},[]),M.useEffect(()=>{var D;(D=k.current)==null||D.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:l,zoomOnDoubleClick:o,panOnDrag:c,zoomActivationKeyPressed:$,preventScrolling:g,noPanClassName:x,userSelectionActive:E,noWheelClassName:w,lib:y,onTransformChange:A,connectionInProgress:R,selectionOnDrag:N,paneClickDistance:v})},[e,t,n,r,a,l,o,c,$,g,x,E,w,y,A,R,N,v]),s.jsx("div",{className:"react-flow__renderer",ref:j,style:au,children:b})}const tA=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function nA(){const{userSelectionActive:e,userSelectionRect:t}=Le(tA,lt);return e&&t?s.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const rd=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},sA=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function rA({isSelecting:e,selectionKeyPressed:t,selectionMode:n=No.Full,panOnDrag:r,paneClickDistance:a,selectionOnDrag:l,onSelectionStart:o,onSelectionEnd:c,onPaneClick:i,onPaneContextMenu:u,onPaneScroll:m,onPaneMouseEnter:h,onPaneMouseMove:f,onPaneMouseLeave:g,children:b}){const w=ot(),{userSelectionActive:x,elementsSelectable:d,dragging:p,connectionInProgress:v}=Le(sA,lt),N=d&&(e||x),C=M.useRef(null),j=M.useRef(),E=M.useRef(new Set),y=M.useRef(new Set),R=M.useRef(!1),$=I=>{if(R.current||v){R.current=!1;return}i==null||i(I),w.getState().resetSelectedElements(),w.setState({nodesSelectionActive:!1})},k=I=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){I.preventDefault();return}u==null||u(I)},A=m?I=>m(I):void 0,D=I=>{R.current&&(I.stopPropagation(),R.current=!1)},S=I=>{var ce,oe;const{domNode:O}=w.getState();if(j.current=O==null?void 0:O.getBoundingClientRect(),!j.current)return;const F=I.target===C.current;if(!F&&!!I.target.closest(".nokey")||!e||!(l&&F||t)||I.button!==0||!I.isPrimary)return;(oe=(ce=I.target)==null?void 0:ce.setPointerCapture)==null||oe.call(ce,I.pointerId),R.current=!1;const{x:Z,y:ee}=os(I.nativeEvent,j.current);w.setState({userSelectionRect:{width:0,height:0,startX:Z,startY:ee,x:Z,y:ee}}),F||(I.stopPropagation(),I.preventDefault())},T=I=>{const{userSelectionRect:O,transform:F,nodeLookup:U,edgeLookup:B,connectionLookup:Z,triggerNodeChanges:ee,triggerEdgeChanges:ce,defaultEdgeOptions:oe,resetSelectedElements:Y}=w.getState();if(!j.current||!O)return;const{x:q,y:se}=os(I.nativeEvent,j.current),{startX:z,startY:G}=O;if(!R.current){const Ce=t?0:a;if(Math.hypot(q-z,se-G)<=Ce)return;Y(),o==null||o(I)}R.current=!0;const J={startX:z,startY:G,x:q<z?q:z,y:se<G?se:G,width:Math.abs(q-z),height:Math.abs(se-G)},ae=E.current,je=y.current;E.current=new Set(Qf(U,J,F,n===No.Partial,!0).map(Ce=>Ce.id)),y.current=new Set;const Ne=(oe==null?void 0:oe.selectable)??!0;for(const Ce of E.current){const Me=Z.get(Ce);if(Me)for(const{edgeId:He}of Me.values()){const ze=B.get(He);ze&&(ze.selectable??Ne)&&y.current.add(He)}}if(!C0(ae,E.current)){const Ce=Pa(U,E.current,!0);ee(Ce)}if(!C0(je,y.current)){const Ce=Pa(B,y.current);ce(Ce)}w.setState({userSelectionRect:J,userSelectionActive:!0,nodesSelectionActive:!1})},P=I=>{var O,F;I.button===0&&((F=(O=I.target)==null?void 0:O.releasePointerCapture)==null||F.call(O,I.pointerId),!x&&I.target===C.current&&w.getState().userSelectionRect&&($==null||$(I)),w.setState({userSelectionActive:!1,userSelectionRect:null}),R.current&&(c==null||c(I),w.setState({nodesSelectionActive:E.current.size>0})))},L=r===!0||Array.isArray(r)&&r.includes(0);return s.jsxs("div",{className:_t(["react-flow__pane",{draggable:L,dragging:p,selection:e}]),onClick:N?void 0:rd($,C),onContextMenu:rd(k,C),onWheel:rd(A,C),onPointerEnter:N?void 0:h,onPointerMove:N?T:f,onPointerUp:N?P:void 0,onPointerDownCapture:N?S:void 0,onClickCapture:N?D:void 0,onPointerLeave:g,ref:C,style:au,children:[b,s.jsx(nA,{})]})}function Om({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:l,multiSelectionActive:o,nodeLookup:c,onError:i}=t.getState(),u=c.get(e);if(!u){i==null||i("012",Ms.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&o)&&(l({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var m;return(m=r==null?void 0:r.current)==null?void 0:m.blur()})):a([e])}function Qy({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:l,nodeClickDistance:o}){const c=ot(),[i,u]=M.useState(!1),m=M.useRef();return M.useEffect(()=>{m.current=J3({getStoreItems:()=>c.getState(),onNodeMouseDown:h=>{Om({id:h,store:c,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),M.useEffect(()=>{var h,f;if(t)(h=m.current)==null||h.destroy();else if(e.current)return(f=m.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:l,nodeId:a,nodeClickDistance:o}),()=>{var g;(g=m.current)==null||g.destroy()}},[n,r,t,l,e,a]),i}const aA=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Ky(){const e=ot();return M.useCallback(n=>{const{nodeExtent:r,snapToGrid:a,snapGrid:l,nodesDraggable:o,onError:c,updateNodePositions:i,nodeLookup:u,nodeOrigin:m}=e.getState(),h=new Map,f=aA(o),g=a?l[0]:5,b=a?l[1]:5,w=n.direction.x*g*n.factor,x=n.direction.y*b*n.factor;for(const[,d]of u){if(!f(d))continue;let p={x:d.internals.positionAbsolute.x+w,y:d.internals.positionAbsolute.y+x};a&&(p=$o(p,l));const{position:v,positionAbsolute:N}=xy({nodeId:d.id,nextPosition:p,nodeLookup:u,nodeExtent:r,nodeOrigin:m,onError:c});d.position=v,d.internals.positionAbsolute=N,h.set(d.id,d)}i(h)},[])}const ah=M.createContext(null),lA=ah.Provider;ah.Consumer;const Zy=()=>M.useContext(ah),oA=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),iA=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:l,connection:o}=r,{fromHandle:c,toHandle:i,isValid:u}=o,m=(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===n;return{connectingFrom:(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n,connectingTo:m,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:l===tl.Strict?(c==null?void 0:c.type)!==n:e!==(c==null?void 0:c.nodeId)||t!==(c==null?void 0:c.id),connectionInProcess:!!c,clickConnectionInProcess:!!a,valid:m&&u}};function cA({type:e="source",position:t=ye.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:l=!0,id:o,onConnect:c,children:i,className:u,onMouseDown:m,onTouchStart:h,...f},g){var T,P;const b=o||null,w=e==="target",x=ot(),d=Zy(),{connectOnClick:p,noPanClassName:v,rfId:N}=Le(oA,lt),{connectingFrom:C,connectingTo:j,clickConnecting:E,isPossibleEndHandle:y,connectionInProcess:R,clickConnectionInProcess:$,valid:k}=Le(iA(d,b,e),lt);d||(P=(T=x.getState()).onError)==null||P.call(T,"010",Ms.error010());const A=L=>{const{defaultEdgeOptions:I,onConnect:O,hasDefaultEdges:F}=x.getState(),U={...I,...L};if(F){const{edges:B,setEdges:Z}=x.getState();Z($3(U,B))}O==null||O(U),c==null||c(U)},D=L=>{if(!d)return;const I=wy(L.nativeEvent);if(a&&(I&&L.button===0||!I)){const O=x.getState();Tm.onPointerDown(L.nativeEvent,{handleDomNode:L.currentTarget,autoPanOnConnect:O.autoPanOnConnect,connectionMode:O.connectionMode,connectionRadius:O.connectionRadius,domNode:O.domNode,nodeLookup:O.nodeLookup,lib:O.lib,isTarget:w,handleId:b,nodeId:d,flowId:O.rfId,panBy:O.panBy,cancelConnection:O.cancelConnection,onConnectStart:O.onConnectStart,onConnectEnd:O.onConnectEnd,updateConnection:O.updateConnection,onConnect:A,isValidConnection:n||O.isValidConnection,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,autoPanSpeed:O.autoPanSpeed,dragThreshold:O.connectionDragThreshold})}I?m==null||m(L):h==null||h(L)},S=L=>{const{onClickConnectStart:I,onClickConnectEnd:O,connectionClickStartHandle:F,connectionMode:U,isValidConnection:B,lib:Z,rfId:ee,nodeLookup:ce,connection:oe}=x.getState();if(!d||!F&&!a)return;if(!F){I==null||I(L.nativeEvent,{nodeId:d,handleId:b,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:d,type:e,id:b}});return}const Y=jy(L.target),q=n||B,{connection:se,isValid:z}=Tm.isValid(L.nativeEvent,{handle:{nodeId:d,id:b,type:e},connectionMode:U,fromNodeId:F.nodeId,fromHandleId:F.id||null,fromType:F.type,isValidConnection:q,flowId:ee,doc:Y,lib:Z,nodeLookup:ce});z&&se&&A(se);const G=structuredClone(oe);delete G.inProgress,G.toPosition=G.toHandle?G.toHandle.position:null,O==null||O(L,G),x.setState({connectionClickStartHandle:null})};return s.jsx("div",{"data-handleid":b,"data-nodeid":d,"data-handlepos":t,"data-id":`${N}-${d}-${b}-${e}`,className:_t(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",v,u,{source:!w,target:w,connectable:r,connectablestart:a,connectableend:l,clickconnecting:E,connectingfrom:C,connectingto:j,valid:k,connectionindicator:r&&(!R||y)&&(R||$?l:a)}]),onMouseDown:D,onTouchStart:D,onClick:p?S:void 0,ref:g,...f,children:i})}const Er=M.memo(qy(cA));function uA({data:e,isConnectable:t,sourcePosition:n=ye.Bottom}){return s.jsxs(s.Fragment,{children:[e==null?void 0:e.label,s.jsx(Er,{type:"source",position:n,isConnectable:t})]})}function dA({data:e,isConnectable:t,targetPosition:n=ye.Top,sourcePosition:r=ye.Bottom}){return s.jsxs(s.Fragment,{children:[s.jsx(Er,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,s.jsx(Er,{type:"source",position:r,isConnectable:t})]})}function mA(){return null}function fA({data:e,isConnectable:t,targetPosition:n=ye.Top}){return s.jsxs(s.Fragment,{children:[s.jsx(Er,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const wc={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},K0={input:uA,default:dA,output:fA,group:mA};function hA(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const pA=e=>{const{width:t,height:n,x:r,y:a}=Lo(e.nodeLookup,{filter:l=>!!l.selected});return{width:ls(t)?t:null,height:ls(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function xA({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ot(),{width:a,height:l,transformString:o,userSelectionActive:c}=Le(pA,lt),i=Ky(),u=M.useRef(null);if(M.useEffect(()=>{var f;n||(f=u.current)==null||f.focus({preventScroll:!0})},[n]),Qy({nodeRef:u}),c||!a||!l)return null;const m=e?f=>{const g=r.getState().nodes.filter(b=>b.selected);e(f,g)}:void 0,h=f=>{Object.prototype.hasOwnProperty.call(wc,f.key)&&(f.preventDefault(),i({direction:wc[f.key],factor:f.shiftKey?4:1}))};return s.jsx("div",{className:_t(["react-flow__nodesselection","react-flow__container",t]),style:{transform:o},children:s.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:a,height:l}})})}const Z0=typeof window<"u"?window:void 0,gA=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Jy({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:o,paneClickDistance:c,deleteKeyCode:i,selectionKeyCode:u,selectionOnDrag:m,selectionMode:h,onSelectionStart:f,onSelectionEnd:g,multiSelectionKeyCode:b,panActivationKeyCode:w,zoomActivationKeyCode:x,elementsSelectable:d,zoomOnScroll:p,zoomOnPinch:v,panOnScroll:N,panOnScrollSpeed:C,panOnScrollMode:j,zoomOnDoubleClick:E,panOnDrag:y,defaultViewport:R,translateExtent:$,minZoom:k,maxZoom:A,preventScrolling:D,onSelectionContextMenu:S,noWheelClassName:T,noPanClassName:P,disableKeyboardA11y:L,onViewportChange:I,isControlledViewport:O}){const{nodesSelectionActive:F,userSelectionActive:U}=Le(gA,lt),B=wo(u,{target:Z0}),Z=wo(w,{target:Z0}),ee=Z||y,ce=Z||N,oe=m&&ee!==!0,Y=B||U||oe;return KE({deleteKeyCode:i,multiSelectionKeyCode:b}),s.jsx(eA,{onPaneContextMenu:l,elementsSelectable:d,zoomOnScroll:p,zoomOnPinch:v,panOnScroll:ce,panOnScrollSpeed:C,panOnScrollMode:j,zoomOnDoubleClick:E,panOnDrag:!B&&ee,defaultViewport:R,translateExtent:$,minZoom:k,maxZoom:A,zoomActivationKeyCode:x,preventScrolling:D,noWheelClassName:T,noPanClassName:P,onViewportChange:I,isControlledViewport:O,paneClickDistance:c,selectionOnDrag:oe,children:s.jsxs(rA,{onSelectionStart:f,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:o,panOnDrag:ee,isSelecting:!!Y,selectionMode:h,selectionKeyPressed:B,paneClickDistance:c,selectionOnDrag:oe,children:[e,F&&s.jsx(xA,{onSelectionContextMenu:S,noPanClassName:P,disableKeyboardA11y:L})]})})}Jy.displayName="FlowRenderer";const vA=M.memo(Jy),bA=e=>t=>e?Qf(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function yA(e){return Le(M.useCallback(bA(e),[e]),lt)}const NA=e=>e.updateNodeInternals;function jA(){const e=Le(NA),[t]=M.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const l=a.target.getAttribute("data-id");r.set(l,{id:l,nodeElement:a.target,force:!0})}),e(r)}));return M.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function _A({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=ot(),l=M.useRef(null),o=M.useRef(null),c=M.useRef(e.sourcePosition),i=M.useRef(e.targetPosition),u=M.useRef(t),m=n&&!!e.internals.handleBounds;return M.useEffect(()=>{l.current&&!e.hidden&&(!m||o.current!==l.current)&&(o.current&&(r==null||r.unobserve(o.current)),r==null||r.observe(l.current),o.current=l.current)},[m,e.hidden]),M.useEffect(()=>()=>{o.current&&(r==null||r.unobserve(o.current),o.current=null)},[]),M.useEffect(()=>{if(l.current){const h=u.current!==t,f=c.current!==e.sourcePosition,g=i.current!==e.targetPosition;(h||f||g)&&(u.current=t,c.current=e.sourcePosition,i.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:l.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),l}function wA({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:l,onDoubleClick:o,nodesDraggable:c,elementsSelectable:i,nodesConnectable:u,nodesFocusable:m,resizeObserver:h,noDragClassName:f,noPanClassName:g,disableKeyboardA11y:b,rfId:w,nodeTypes:x,nodeClickDistance:d,onError:p}){const{node:v,internals:N,isParent:C}=Le(q=>{const se=q.nodeLookup.get(e),z=q.parentLookup.has(e);return{node:se,internals:se.internals,isParent:z}},lt);let j=v.type||"default",E=(x==null?void 0:x[j])||K0[j];E===void 0&&(p==null||p("003",Ms.error003(j)),j="default",E=(x==null?void 0:x.default)||K0.default);const y=!!(v.draggable||c&&typeof v.draggable>"u"),R=!!(v.selectable||i&&typeof v.selectable>"u"),$=!!(v.connectable||u&&typeof v.connectable>"u"),k=!!(v.focusable||m&&typeof v.focusable>"u"),A=ot(),D=yy(v),S=_A({node:v,nodeType:j,hasDimensions:D,resizeObserver:h}),T=Qy({nodeRef:S,disabled:v.hidden||!y,noDragClassName:f,handleSelector:v.dragHandle,nodeId:e,isSelectable:R,nodeClickDistance:d}),P=Ky();if(v.hidden)return null;const L=Js(v),I=hA(v),O=R||y||t||n||r||a,F=n?q=>n(q,{...N.userNode}):void 0,U=r?q=>r(q,{...N.userNode}):void 0,B=a?q=>a(q,{...N.userNode}):void 0,Z=l?q=>l(q,{...N.userNode}):void 0,ee=o?q=>o(q,{...N.userNode}):void 0,ce=q=>{const{selectNodesOnDrag:se,nodeDragThreshold:z}=A.getState();R&&(!se||!y||z>0)&&Om({id:e,store:A,nodeRef:S}),t&&t(q,{...N.userNode})},oe=q=>{if(!(_y(q.nativeEvent)||b)){if(dy.includes(q.key)&&R){const se=q.key==="Escape";Om({id:e,store:A,unselect:se,nodeRef:S})}else if(y&&v.selected&&Object.prototype.hasOwnProperty.call(wc,q.key)){q.preventDefault();const{ariaLabelConfig:se}=A.getState();A.setState({ariaLiveMessage:se["node.a11yDescription.ariaLiveMessage"]({direction:q.key.replace("Arrow","").toLowerCase(),x:~~N.positionAbsolute.x,y:~~N.positionAbsolute.y})}),P({direction:wc[q.key],factor:q.shiftKey?4:1})}}},Y=()=>{var je;if(b||!((je=S.current)!=null&&je.matches(":focus-visible")))return;const{transform:q,width:se,height:z,autoPanOnNodeFocus:G,setCenter:J}=A.getState();if(!G)return;Qf(new Map([[e,v]]),{x:0,y:0,width:se,height:z},q,!0).length>0||J(v.position.x+L.width/2,v.position.y+L.height/2,{zoom:q[2]})};return s.jsx("div",{className:_t(["react-flow__node",`react-flow__node-${j}`,{[g]:y},v.className,{selected:v.selected,selectable:R,parent:C,draggable:y,dragging:T}]),ref:S,style:{zIndex:N.z,transform:`translate(${N.positionAbsolute.x}px,${N.positionAbsolute.y}px)`,pointerEvents:O?"all":"none",visibility:D?"visible":"hidden",...v.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:U,onMouseLeave:B,onContextMenu:Z,onClick:ce,onDoubleClick:ee,onKeyDown:k?oe:void 0,tabIndex:k?0:void 0,onFocus:k?Y:void 0,role:v.ariaRole??(k?"group":void 0),"aria-roledescription":"node","aria-describedby":b?void 0:`${Hy}-${w}`,"aria-label":v.ariaLabel,...v.domAttributes,children:s.jsx(lA,{value:e,children:s.jsx(E,{id:e,data:v.data,type:j,positionAbsoluteX:N.positionAbsolute.x,positionAbsoluteY:N.positionAbsolute.y,selected:v.selected??!1,selectable:R,draggable:y,deletable:v.deletable??!0,isConnectable:$,sourcePosition:v.sourcePosition,targetPosition:v.targetPosition,dragging:T,dragHandle:v.dragHandle,zIndex:N.z,parentId:v.parentId,...L})})})}var SA=M.memo(wA);const CA=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function eN(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:l}=Le(CA,lt),o=yA(e.onlyRenderVisibleElements),c=jA();return s.jsx("div",{className:"react-flow__nodes",style:au,children:o.map(i=>s.jsx(SA,{id:i,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:l},i))})}eN.displayName="NodeRenderer";const kA=M.memo(eN);function EA(e){return Le(M.useCallback(n=>{if(!e)return n.edges.map(a=>a.id);const r=[];if(n.width&&n.height)for(const a of n.edges){const l=n.nodeLookup.get(a.source),o=n.nodeLookup.get(a.target);l&&o&&O3({sourceNode:l,targetNode:o,width:n.width,height:n.height,transform:n.transform})&&r.push(a.id)}return r},[e]),lt)}const AA=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return s.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},RA=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return s.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},J0={[oa.Arrow]:AA,[oa.ArrowClosed]:RA};function MA(e){const t=ot();return M.useMemo(()=>{var a,l;return Object.prototype.hasOwnProperty.call(J0,e)?J0[e]:((l=(a=t.getState()).onError)==null||l.call(a,"009",Ms.error009(e)),null)},[e])}const PA=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:l="strokeWidth",strokeWidth:o,orient:c="auto-start-reverse"})=>{const i=MA(t);return i?s.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:c,refX:"0",refY:"0",children:s.jsx(i,{color:n,strokeWidth:o})}):null},tN=({defaultColor:e,rfId:t})=>{const n=Le(l=>l.edges),r=Le(l=>l.defaultEdgeOptions),a=M.useMemo(()=>H3(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?s.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:s.jsx("defs",{children:a.map(l=>s.jsx(PA,{id:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient},l.id))})}):null};tN.displayName="MarkerDefinitions";var TA=M.memo(tN);function nN({x:e,y:t,label:n,labelStyle:r,labelShowBg:a=!0,labelBgStyle:l,labelBgPadding:o=[2,4],labelBgBorderRadius:c=2,children:i,className:u,...m}){const[h,f]=M.useState({x:1,y:0,width:0,height:0}),g=_t(["react-flow__edge-textwrapper",u]),b=M.useRef(null);return M.useEffect(()=>{if(b.current){const w=b.current.getBBox();f({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),n?s.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:g,visibility:h.width?"visible":"hidden",...m,children:[a&&s.jsx("rect",{width:h.width+2*o[0],x:-o[0],y:-o[1],height:h.height+2*o[1],className:"react-flow__edge-textbg",style:l,rx:c,ry:c}),s.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:b,style:r,children:n}),i]}):null}nN.displayName="EdgeText";const OA=M.memo(nN);function lu({path:e,labelX:t,labelY:n,label:r,labelStyle:a,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:i,interactionWidth:u=20,...m}){return s.jsxs(s.Fragment,{children:[s.jsx("path",{...m,d:e,fill:"none",className:_t(["react-flow__edge-path",m.className])}),u?s.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,r&&ls(t)&&ls(n)?s.jsx(OA,{x:t,y:n,label:r,labelStyle:a,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:i}):null]})}function ex({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===ye.Left||e===ye.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function sN({sourceX:e,sourceY:t,sourcePosition:n=ye.Bottom,targetX:r,targetY:a,targetPosition:l=ye.Top}){const[o,c]=ex({pos:n,x1:e,y1:t,x2:r,y2:a}),[i,u]=ex({pos:l,x1:r,y1:a,x2:e,y2:t}),[m,h,f,g]=Sy({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:o,sourceControlY:c,targetControlX:i,targetControlY:u});return[`M${e},${t} C${o},${c} ${i},${u} ${r},${a}`,m,h,f,g]}function rN(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,sourcePosition:o,targetPosition:c,label:i,labelStyle:u,labelShowBg:m,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:b,markerEnd:w,markerStart:x,interactionWidth:d})=>{const[p,v,N]=sN({sourceX:n,sourceY:r,sourcePosition:o,targetX:a,targetY:l,targetPosition:c}),C=e.isInternal?void 0:t;return s.jsx(lu,{id:C,path:p,labelX:v,labelY:N,label:i,labelStyle:u,labelShowBg:m,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:b,markerEnd:w,markerStart:x,interactionWidth:d})})}const IA=rN({isInternal:!1}),aN=rN({isInternal:!0});IA.displayName="SimpleBezierEdge";aN.displayName="SimpleBezierEdgeInternal";function lN(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,label:o,labelStyle:c,labelShowBg:i,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:h,style:f,sourcePosition:g=ye.Bottom,targetPosition:b=ye.Top,markerEnd:w,markerStart:x,pathOptions:d,interactionWidth:p})=>{const[v,N,C]=Rm({sourceX:n,sourceY:r,sourcePosition:g,targetX:a,targetY:l,targetPosition:b,borderRadius:d==null?void 0:d.borderRadius,offset:d==null?void 0:d.offset,stepPosition:d==null?void 0:d.stepPosition}),j=e.isInternal?void 0:t;return s.jsx(lu,{id:j,path:v,labelX:N,labelY:C,label:o,labelStyle:c,labelShowBg:i,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:h,style:f,markerEnd:w,markerStart:x,interactionWidth:p})})}const oN=lN({isInternal:!1}),iN=lN({isInternal:!0});oN.displayName="SmoothStepEdge";iN.displayName="SmoothStepEdgeInternal";function cN(e){return M.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return s.jsx(oN,{...n,id:r,pathOptions:M.useMemo(()=>{var l;return{borderRadius:0,offset:(l=n.pathOptions)==null?void 0:l.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const LA=cN({isInternal:!1}),uN=cN({isInternal:!0});LA.displayName="StepEdge";uN.displayName="StepEdgeInternal";function dN(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,label:o,labelStyle:c,labelShowBg:i,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:b,interactionWidth:w})=>{const[x,d,p]=Ey({sourceX:n,sourceY:r,targetX:a,targetY:l}),v=e.isInternal?void 0:t;return s.jsx(lu,{id:v,path:x,labelX:d,labelY:p,label:o,labelStyle:c,labelShowBg:i,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:b,interactionWidth:w})})}const $A=dN({isInternal:!1}),mN=dN({isInternal:!0});$A.displayName="StraightEdge";mN.displayName="StraightEdgeInternal";function fN(e){return M.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,sourcePosition:o=ye.Bottom,targetPosition:c=ye.Top,label:i,labelStyle:u,labelShowBg:m,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:b,markerEnd:w,markerStart:x,pathOptions:d,interactionWidth:p})=>{const[v,N,C]=Cy({sourceX:n,sourceY:r,sourcePosition:o,targetX:a,targetY:l,targetPosition:c,curvature:d==null?void 0:d.curvature}),j=e.isInternal?void 0:t;return s.jsx(lu,{id:j,path:v,labelX:N,labelY:C,label:i,labelStyle:u,labelShowBg:m,labelBgStyle:h,labelBgPadding:f,labelBgBorderRadius:g,style:b,markerEnd:w,markerStart:x,interactionWidth:p})})}const DA=fN({isInternal:!1}),hN=fN({isInternal:!0});DA.displayName="BezierEdge";hN.displayName="BezierEdgeInternal";const tx={default:hN,straight:mN,step:uN,smoothstep:iN,simplebezier:aN},nx={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},FA=(e,t,n)=>n===ye.Left?e-t:n===ye.Right?e+t:e,VA=(e,t,n)=>n===ye.Top?e-t:n===ye.Bottom?e+t:e,sx="react-flow__edgeupdater";function rx({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:l,onMouseOut:o,type:c}){return s.jsx("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:o,className:_t([sx,`${sx}-${c}`]),cx:FA(t,r,e),cy:VA(n,r,e),r,stroke:"transparent",fill:"transparent"})}function zA({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:l,targetY:o,sourcePosition:c,targetPosition:i,onReconnect:u,onReconnectStart:m,onReconnectEnd:h,setReconnecting:f,setUpdateHover:g}){const b=ot(),w=(N,C)=>{if(N.button!==0)return;const{autoPanOnConnect:j,domNode:E,isValidConnection:y,connectionMode:R,connectionRadius:$,lib:k,onConnectStart:A,onConnectEnd:D,cancelConnection:S,nodeLookup:T,rfId:P,panBy:L,updateConnection:I}=b.getState(),O=C.type==="target",F=(Z,ee)=>{f(!1),h==null||h(Z,n,C.type,ee)},U=Z=>u==null?void 0:u(n,Z),B=(Z,ee)=>{f(!0),m==null||m(N,n,C.type),A==null||A(Z,ee)};Tm.onPointerDown(N.nativeEvent,{autoPanOnConnect:j,connectionMode:R,connectionRadius:$,domNode:E,handleId:C.id,nodeId:C.nodeId,nodeLookup:T,isTarget:O,edgeUpdaterType:C.type,lib:k,flowId:P,cancelConnection:S,panBy:L,isValidConnection:y,onConnect:U,onConnectStart:B,onConnectEnd:D,onReconnectEnd:F,updateConnection:I,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,dragThreshold:b.getState().connectionDragThreshold,handleDomNode:N.currentTarget})},x=N=>w(N,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),d=N=>w(N,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),p=()=>g(!0),v=()=>g(!1);return s.jsxs(s.Fragment,{children:[(e===!0||e==="source")&&s.jsx(rx,{position:c,centerX:r,centerY:a,radius:t,onMouseDown:x,onMouseEnter:p,onMouseOut:v,type:"source"}),(e===!0||e==="target")&&s.jsx(rx,{position:i,centerX:l,centerY:o,radius:t,onMouseDown:d,onMouseEnter:p,onMouseOut:v,type:"target"})]})}function HA({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:l,onContextMenu:o,onMouseEnter:c,onMouseMove:i,onMouseLeave:u,reconnectRadius:m,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,rfId:b,edgeTypes:w,noPanClassName:x,onError:d,disableKeyboardA11y:p}){let v=Le(J=>J.edgeLookup.get(e));const N=Le(J=>J.defaultEdgeOptions);v=N?{...N,...v}:v;let C=v.type||"default",j=(w==null?void 0:w[C])||tx[C];j===void 0&&(d==null||d("011",Ms.error011(C)),C="default",j=(w==null?void 0:w.default)||tx.default);const E=!!(v.focusable||t&&typeof v.focusable>"u"),y=typeof h<"u"&&(v.reconnectable||n&&typeof v.reconnectable>"u"),R=!!(v.selectable||r&&typeof v.selectable>"u"),$=M.useRef(null),[k,A]=M.useState(!1),[D,S]=M.useState(!1),T=ot(),{zIndex:P,sourceX:L,sourceY:I,targetX:O,targetY:F,sourcePosition:U,targetPosition:B}=Le(M.useCallback(J=>{const ae=J.nodeLookup.get(v.source),je=J.nodeLookup.get(v.target);if(!ae||!je)return{zIndex:v.zIndex,...nx};const Ne=z3({id:e,sourceNode:ae,targetNode:je,sourceHandle:v.sourceHandle||null,targetHandle:v.targetHandle||null,connectionMode:J.connectionMode,onError:d});return{zIndex:T3({selected:v.selected,zIndex:v.zIndex,sourceNode:ae,targetNode:je,elevateOnSelect:J.elevateEdgesOnSelect,zIndexMode:J.zIndexMode}),...Ne||nx}},[v.source,v.target,v.sourceHandle,v.targetHandle,v.selected,v.zIndex]),lt),Z=M.useMemo(()=>v.markerStart?`url('#${Mm(v.markerStart,b)}')`:void 0,[v.markerStart,b]),ee=M.useMemo(()=>v.markerEnd?`url('#${Mm(v.markerEnd,b)}')`:void 0,[v.markerEnd,b]);if(v.hidden||L===null||I===null||O===null||F===null)return null;const ce=J=>{var Ce;const{addSelectedEdges:ae,unselectNodesAndEdges:je,multiSelectionActive:Ne}=T.getState();R&&(T.setState({nodesSelectionActive:!1}),v.selected&&Ne?(je({nodes:[],edges:[v]}),(Ce=$.current)==null||Ce.blur()):ae([e])),a&&a(J,v)},oe=l?J=>{l(J,{...v})}:void 0,Y=o?J=>{o(J,{...v})}:void 0,q=c?J=>{c(J,{...v})}:void 0,se=i?J=>{i(J,{...v})}:void 0,z=u?J=>{u(J,{...v})}:void 0,G=J=>{var ae;if(!p&&dy.includes(J.key)&&R){const{unselectNodesAndEdges:je,addSelectedEdges:Ne}=T.getState();J.key==="Escape"?((ae=$.current)==null||ae.blur(),je({edges:[v]})):Ne([e])}};return s.jsx("svg",{style:{zIndex:P},children:s.jsxs("g",{className:_t(["react-flow__edge",`react-flow__edge-${C}`,v.className,x,{selected:v.selected,animated:v.animated,inactive:!R&&!a,updating:k,selectable:R}]),onClick:ce,onDoubleClick:oe,onContextMenu:Y,onMouseEnter:q,onMouseMove:se,onMouseLeave:z,onKeyDown:E?G:void 0,tabIndex:E?0:void 0,role:v.ariaRole??(E?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":v.ariaLabel===null?void 0:v.ariaLabel||`Edge from ${v.source} to ${v.target}`,"aria-describedby":E?`${Uy}-${b}`:void 0,ref:$,...v.domAttributes,children:[!D&&s.jsx(j,{id:e,source:v.source,target:v.target,type:v.type,selected:v.selected,animated:v.animated,selectable:R,deletable:v.deletable??!0,label:v.label,labelStyle:v.labelStyle,labelShowBg:v.labelShowBg,labelBgStyle:v.labelBgStyle,labelBgPadding:v.labelBgPadding,labelBgBorderRadius:v.labelBgBorderRadius,sourceX:L,sourceY:I,targetX:O,targetY:F,sourcePosition:U,targetPosition:B,data:v.data,style:v.style,sourceHandleId:v.sourceHandle,targetHandleId:v.targetHandle,markerStart:Z,markerEnd:ee,pathOptions:"pathOptions"in v?v.pathOptions:void 0,interactionWidth:v.interactionWidth}),y&&s.jsx(zA,{edge:v,isReconnectable:y,reconnectRadius:m,onReconnect:h,onReconnectStart:f,onReconnectEnd:g,sourceX:L,sourceY:I,targetX:O,targetY:F,sourcePosition:U,targetPosition:B,setUpdateHover:A,setReconnecting:S})]})})}var UA=M.memo(HA);const BA=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function pN({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:l,onEdgeContextMenu:o,onEdgeMouseEnter:c,onEdgeMouseMove:i,onEdgeMouseLeave:u,onEdgeClick:m,reconnectRadius:h,onEdgeDoubleClick:f,onReconnectStart:g,onReconnectEnd:b,disableKeyboardA11y:w}){const{edgesFocusable:x,edgesReconnectable:d,elementsSelectable:p,onError:v}=Le(BA,lt),N=EA(t);return s.jsxs("div",{className:"react-flow__edges",children:[s.jsx(TA,{defaultColor:e,rfId:n}),N.map(C=>s.jsx(UA,{id:C,edgesFocusable:x,edgesReconnectable:d,elementsSelectable:p,noPanClassName:a,onReconnect:l,onContextMenu:o,onMouseEnter:c,onMouseMove:i,onMouseLeave:u,onClick:m,reconnectRadius:h,onDoubleClick:f,onReconnectStart:g,onReconnectEnd:b,rfId:n,onError:v,edgeTypes:r,disableKeyboardA11y:w},C))]})}pN.displayName="EdgeRenderer";const WA=M.memo(pN),GA=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function YA({children:e}){const t=Le(GA);return s.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function qA(e){const t=rh(),n=M.useRef(!1);M.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const XA=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function QA(e){const t=Le(XA),n=ot();return M.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function KA(e){return e.connection.inProgress?{...e.connection,to:Do(e.connection.to,e.transform)}:{...e.connection}}function ZA(e){return KA}function JA(e){const t=ZA();return Le(t,lt)}const eR=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function tR({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:l,height:o,isValid:c,inProgress:i}=Le(eR,lt);return!(l&&a&&i)?null:s.jsx("svg",{style:e,width:l,height:o,className:"react-flow__connectionline react-flow__container",children:s.jsx("g",{className:_t(["react-flow__connection",hy(c)]),children:s.jsx(xN,{style:t,type:n,CustomComponent:r,isValid:c})})})}const xN=({style:e,type:t=Fs.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:l,fromNode:o,fromHandle:c,fromPosition:i,to:u,toNode:m,toHandle:h,toPosition:f,pointer:g}=JA();if(!a)return;if(n)return s.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:o,fromHandle:c,fromX:l.x,fromY:l.y,toX:u.x,toY:u.y,fromPosition:i,toPosition:f,connectionStatus:hy(r),toNode:m,toHandle:h,pointer:g});let b="";const w={sourceX:l.x,sourceY:l.y,sourcePosition:i,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case Fs.Bezier:[b]=Cy(w);break;case Fs.SimpleBezier:[b]=sN(w);break;case Fs.Step:[b]=Rm({...w,borderRadius:0});break;case Fs.SmoothStep:[b]=Rm(w);break;default:[b]=Ey(w)}return s.jsx("path",{d:b,fill:"none",className:"react-flow__connection-path",style:e})};xN.displayName="ConnectionLine";const nR={};function ax(e=nR){M.useRef(e),ot(),M.useEffect(()=>{},[e])}function sR(){ot(),M.useRef(!1),M.useEffect(()=>{},[])}function gN({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:o,onNodeMouseEnter:c,onNodeMouseMove:i,onNodeMouseLeave:u,onNodeContextMenu:m,onSelectionContextMenu:h,onSelectionStart:f,onSelectionEnd:g,connectionLineType:b,connectionLineStyle:w,connectionLineComponent:x,connectionLineContainerStyle:d,selectionKeyCode:p,selectionOnDrag:v,selectionMode:N,multiSelectionKeyCode:C,panActivationKeyCode:j,zoomActivationKeyCode:E,deleteKeyCode:y,onlyRenderVisibleElements:R,elementsSelectable:$,defaultViewport:k,translateExtent:A,minZoom:D,maxZoom:S,preventScrolling:T,defaultMarkerColor:P,zoomOnScroll:L,zoomOnPinch:I,panOnScroll:O,panOnScrollSpeed:F,panOnScrollMode:U,zoomOnDoubleClick:B,panOnDrag:Z,onPaneClick:ee,onPaneMouseEnter:ce,onPaneMouseMove:oe,onPaneMouseLeave:Y,onPaneScroll:q,onPaneContextMenu:se,paneClickDistance:z,nodeClickDistance:G,onEdgeContextMenu:J,onEdgeMouseEnter:ae,onEdgeMouseMove:je,onEdgeMouseLeave:Ne,reconnectRadius:Ce,onReconnect:Me,onReconnectStart:He,onReconnectEnd:ze,noDragClassName:$e,noWheelClassName:Ve,noPanClassName:tt,disableKeyboardA11y:gt,nodeExtent:Ft,rfId:ge,viewport:Rt,onViewportChange:wt}){return ax(e),ax(t),sR(),qA(n),QA(Rt),s.jsx(vA,{onPaneClick:ee,onPaneMouseEnter:ce,onPaneMouseMove:oe,onPaneMouseLeave:Y,onPaneContextMenu:se,onPaneScroll:q,paneClickDistance:z,deleteKeyCode:y,selectionKeyCode:p,selectionOnDrag:v,selectionMode:N,onSelectionStart:f,onSelectionEnd:g,multiSelectionKeyCode:C,panActivationKeyCode:j,zoomActivationKeyCode:E,elementsSelectable:$,zoomOnScroll:L,zoomOnPinch:I,zoomOnDoubleClick:B,panOnScroll:O,panOnScrollSpeed:F,panOnScrollMode:U,panOnDrag:Z,defaultViewport:k,translateExtent:A,minZoom:D,maxZoom:S,onSelectionContextMenu:h,preventScrolling:T,noDragClassName:$e,noWheelClassName:Ve,noPanClassName:tt,disableKeyboardA11y:gt,onViewportChange:wt,isControlledViewport:!!Rt,children:s.jsxs(YA,{children:[s.jsx(WA,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:o,onReconnect:Me,onReconnectStart:He,onReconnectEnd:ze,onlyRenderVisibleElements:R,onEdgeContextMenu:J,onEdgeMouseEnter:ae,onEdgeMouseMove:je,onEdgeMouseLeave:Ne,reconnectRadius:Ce,defaultMarkerColor:P,noPanClassName:tt,disableKeyboardA11y:gt,rfId:ge}),s.jsx(tR,{style:w,type:b,component:x,containerStyle:d}),s.jsx("div",{className:"react-flow__edgelabel-renderer"}),s.jsx(kA,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:c,onNodeMouseMove:i,onNodeMouseLeave:u,onNodeContextMenu:m,nodeClickDistance:G,onlyRenderVisibleElements:R,noPanClassName:tt,noDragClassName:$e,disableKeyboardA11y:gt,nodeExtent:Ft,rfId:ge}),s.jsx("div",{className:"react-flow__viewport-portal"})]})})}gN.displayName="GraphView";const rR=M.memo(gN),lx=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:l,fitView:o,fitViewOptions:c,minZoom:i=.5,maxZoom:u=2,nodeOrigin:m,nodeExtent:h,zIndexMode:f="basic"}={})=>{const g=new Map,b=new Map,w=new Map,x=new Map,d=r??t??[],p=n??e??[],v=m??[0,0],N=h??yo;My(w,x,d);const C=Pm(p,g,b,{nodeOrigin:v,nodeExtent:N,zIndexMode:f});let j=[0,0,1];if(o&&a&&l){const E=Lo(g,{filter:k=>!!((k.width||k.initialWidth)&&(k.height||k.initialHeight))}),{x:y,y:R,zoom:$}=Kf(E,a,l,i,u,(c==null?void 0:c.padding)??.1);j=[y,R,$]}return{rfId:"1",width:a??0,height:l??0,transform:j,nodes:p,nodesInitialized:C,nodeLookup:g,parentLookup:b,edges:d,edgeLookup:x,connectionLookup:w,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:i,maxZoom:u,translateExtent:yo,nodeExtent:N,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:tl.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:v,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:c,fitViewResolver:null,connection:{...fy},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:k3,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:my,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},aR=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:l,fitView:o,fitViewOptions:c,minZoom:i,maxZoom:u,nodeOrigin:m,nodeExtent:h,zIndexMode:f})=>_E((g,b)=>{async function w(){const{nodeLookup:x,panZoom:d,fitViewOptions:p,fitViewResolver:v,width:N,height:C,minZoom:j,maxZoom:E}=b();d&&(await S3({nodes:x,width:N,height:C,panZoom:d,minZoom:j,maxZoom:E},p),v==null||v.resolve(!0),g({fitViewResolver:null}))}return{...lx({nodes:e,edges:t,width:a,height:l,fitView:o,fitViewOptions:c,minZoom:i,maxZoom:u,nodeOrigin:m,nodeExtent:h,defaultNodes:n,defaultEdges:r,zIndexMode:f}),setNodes:x=>{const{nodeLookup:d,parentLookup:p,nodeOrigin:v,elevateNodesOnSelect:N,fitViewQueued:C,zIndexMode:j}=b(),E=Pm(x,d,p,{nodeOrigin:v,nodeExtent:h,elevateNodesOnSelect:N,checkEquality:!0,zIndexMode:j});C&&E?(w(),g({nodes:x,nodesInitialized:E,fitViewQueued:!1,fitViewOptions:void 0})):g({nodes:x,nodesInitialized:E})},setEdges:x=>{const{connectionLookup:d,edgeLookup:p}=b();My(d,p,x),g({edges:x})},setDefaultNodesAndEdges:(x,d)=>{if(x){const{setNodes:p}=b();p(x),g({hasDefaultNodes:!0})}if(d){const{setEdges:p}=b();p(d),g({hasDefaultEdges:!0})}},updateNodeInternals:x=>{const{triggerNodeChanges:d,nodeLookup:p,parentLookup:v,domNode:N,nodeOrigin:C,nodeExtent:j,debug:E,fitViewQueued:y,zIndexMode:R}=b(),{changes:$,updatedInternals:k}=X3(x,p,v,N,C,j,R);k&&(W3(p,v,{nodeOrigin:C,nodeExtent:j,zIndexMode:R}),y?(w(),g({fitViewQueued:!1,fitViewOptions:void 0})):g({}),($==null?void 0:$.length)>0&&(E&&console.log("React Flow: trigger node changes",$),d==null||d($)))},updateNodePositions:(x,d=!1)=>{const p=[];let v=[];const{nodeLookup:N,triggerNodeChanges:C,connection:j,updateConnection:E,onNodesChangeMiddlewareMap:y}=b();for(const[R,$]of x){const k=N.get(R),A=!!(k!=null&&k.expandParent&&(k!=null&&k.parentId)&&($!=null&&$.position)),D={id:R,type:"position",position:A?{x:Math.max(0,$.position.x),y:Math.max(0,$.position.y)}:$.position,dragging:d};if(k&&j.inProgress&&j.fromNode.id===k.id){const S=ca(k,j.fromHandle,ye.Left,!0);E({...j,from:S})}A&&k.parentId&&p.push({id:R,parentId:k.parentId,rect:{...$.internals.positionAbsolute,width:$.measured.width??0,height:$.measured.height??0}}),v.push(D)}if(p.length>0){const{parentLookup:R,nodeOrigin:$}=b(),k=sh(p,N,R,$);v.push(...k)}for(const R of y.values())v=R(v);C(v)},triggerNodeChanges:x=>{const{onNodesChange:d,setNodes:p,nodes:v,hasDefaultNodes:N,debug:C}=b();if(x!=null&&x.length){if(N){const j=Gy(x,v);p(j)}C&&console.log("React Flow: trigger node changes",x),d==null||d(x)}},triggerEdgeChanges:x=>{const{onEdgesChange:d,setEdges:p,edges:v,hasDefaultEdges:N,debug:C}=b();if(x!=null&&x.length){if(N){const j=Yy(x,v);p(j)}C&&console.log("React Flow: trigger edge changes",x),d==null||d(x)}},addSelectedNodes:x=>{const{multiSelectionActive:d,edgeLookup:p,nodeLookup:v,triggerNodeChanges:N,triggerEdgeChanges:C}=b();if(d){const j=x.map(E=>Fr(E,!0));N(j);return}N(Pa(v,new Set([...x]),!0)),C(Pa(p))},addSelectedEdges:x=>{const{multiSelectionActive:d,edgeLookup:p,nodeLookup:v,triggerNodeChanges:N,triggerEdgeChanges:C}=b();if(d){const j=x.map(E=>Fr(E,!0));C(j);return}C(Pa(p,new Set([...x]))),N(Pa(v,new Set,!0))},unselectNodesAndEdges:({nodes:x,edges:d}={})=>{const{edges:p,nodes:v,nodeLookup:N,triggerNodeChanges:C,triggerEdgeChanges:j}=b(),E=x||v,y=d||p,R=E.map(k=>{const A=N.get(k.id);return A&&(A.selected=!1),Fr(k.id,!1)}),$=y.map(k=>Fr(k.id,!1));C(R),j($)},setMinZoom:x=>{const{panZoom:d,maxZoom:p}=b();d==null||d.setScaleExtent([x,p]),g({minZoom:x})},setMaxZoom:x=>{const{panZoom:d,minZoom:p}=b();d==null||d.setScaleExtent([p,x]),g({maxZoom:x})},setTranslateExtent:x=>{var d;(d=b().panZoom)==null||d.setTranslateExtent(x),g({translateExtent:x})},resetSelectedElements:()=>{const{edges:x,nodes:d,triggerNodeChanges:p,triggerEdgeChanges:v,elementsSelectable:N}=b();if(!N)return;const C=d.reduce((E,y)=>y.selected?[...E,Fr(y.id,!1)]:E,[]),j=x.reduce((E,y)=>y.selected?[...E,Fr(y.id,!1)]:E,[]);p(C),v(j)},setNodeExtent:x=>{const{nodes:d,nodeLookup:p,parentLookup:v,nodeOrigin:N,elevateNodesOnSelect:C,nodeExtent:j,zIndexMode:E}=b();x[0][0]===j[0][0]&&x[0][1]===j[0][1]&&x[1][0]===j[1][0]&&x[1][1]===j[1][1]||(Pm(d,p,v,{nodeOrigin:N,nodeExtent:x,elevateNodesOnSelect:C,checkEquality:!1,zIndexMode:E}),g({nodeExtent:x}))},panBy:x=>{const{transform:d,width:p,height:v,panZoom:N,translateExtent:C}=b();return Q3({delta:x,panZoom:N,transform:d,translateExtent:C,width:p,height:v})},setCenter:async(x,d,p)=>{const{width:v,height:N,maxZoom:C,panZoom:j}=b();if(!j)return Promise.resolve(!1);const E=typeof(p==null?void 0:p.zoom)<"u"?p.zoom:C;return await j.setViewport({x:v/2-x*E,y:N/2-d*E,zoom:E},{duration:p==null?void 0:p.duration,ease:p==null?void 0:p.ease,interpolate:p==null?void 0:p.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{g({connection:{...fy}})},updateConnection:x=>{g({connection:x})},reset:()=>g({...lx()})}},Object.is);function lR({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:l,initialMinZoom:o,initialMaxZoom:c,initialFitViewOptions:i,fitView:u,nodeOrigin:m,nodeExtent:h,zIndexMode:f,children:g}){const[b]=M.useState(()=>aR({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:l,fitView:u,minZoom:o,maxZoom:c,fitViewOptions:i,nodeOrigin:m,nodeExtent:h,zIndexMode:f}));return s.jsx(wE,{value:b,children:s.jsx(YE,{children:g})})}function oR({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:l,height:o,fitView:c,fitViewOptions:i,minZoom:u,maxZoom:m,nodeOrigin:h,nodeExtent:f,zIndexMode:g}){return M.useContext(su)?s.jsx(s.Fragment,{children:e}):s.jsx(lR,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:l,initialHeight:o,fitView:c,initialFitViewOptions:i,initialMinZoom:u,initialMaxZoom:m,nodeOrigin:h,nodeExtent:f,zIndexMode:g,children:e})}const iR={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function cR({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:l,edgeTypes:o,onNodeClick:c,onEdgeClick:i,onInit:u,onMove:m,onMoveStart:h,onMoveEnd:f,onConnect:g,onConnectStart:b,onConnectEnd:w,onClickConnectStart:x,onClickConnectEnd:d,onNodeMouseEnter:p,onNodeMouseMove:v,onNodeMouseLeave:N,onNodeContextMenu:C,onNodeDoubleClick:j,onNodeDragStart:E,onNodeDrag:y,onNodeDragStop:R,onNodesDelete:$,onEdgesDelete:k,onDelete:A,onSelectionChange:D,onSelectionDragStart:S,onSelectionDrag:T,onSelectionDragStop:P,onSelectionContextMenu:L,onSelectionStart:I,onSelectionEnd:O,onBeforeDelete:F,connectionMode:U,connectionLineType:B=Fs.Bezier,connectionLineStyle:Z,connectionLineComponent:ee,connectionLineContainerStyle:ce,deleteKeyCode:oe="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:q=!1,selectionMode:se=No.Full,panActivationKeyCode:z="Space",multiSelectionKeyCode:G=_o()?"Meta":"Control",zoomActivationKeyCode:J=_o()?"Meta":"Control",snapToGrid:ae,snapGrid:je,onlyRenderVisibleElements:Ne=!1,selectNodesOnDrag:Ce,nodesDraggable:Me,autoPanOnNodeFocus:He,nodesConnectable:ze,nodesFocusable:$e,nodeOrigin:Ve=By,edgesFocusable:tt,edgesReconnectable:gt,elementsSelectable:Ft=!0,defaultViewport:ge=$E,minZoom:Rt=.5,maxZoom:wt=2,translateExtent:nt=yo,preventScrolling:de=!0,nodeExtent:vt,defaultMarkerColor:Mt="#b1b1b7",zoomOnScroll:Pt=!0,zoomOnPinch:sn=!0,panOnScroll:In=!1,panOnScrollSpeed:mn=.5,panOnScrollMode:fn=Kr.Free,zoomOnDoubleClick:Gt=!0,panOnDrag:Vt=!0,onPaneClick:Yt,onPaneMouseEnter:X,onPaneMouseMove:ne,onPaneMouseLeave:ve,onPaneScroll:pe,onPaneContextMenu:H,paneClickDistance:te=1,nodeClickDistance:_=0,children:V,onReconnect:W,onReconnectStart:K,onReconnectEnd:me,onEdgeContextMenu:he,onEdgeDoubleClick:Se,onEdgeMouseEnter:ue,onEdgeMouseMove:Ae,onEdgeMouseLeave:mt,reconnectRadius:bt=10,onNodesChange:Oe,onEdgesChange:Ie,noDragClassName:Ke="nodrag",noWheelClassName:st="nowheel",noPanClassName:Ge="nopan",fitView:Ue,fitViewOptions:ft,connectOnClick:fs,attributionPosition:hs,proOptions:ps,defaultEdgeOptions:xs,elevateNodesOnSelect:_n=!0,elevateEdgesOnSelect:Ln=!1,disableKeyboardA11y:Xn=!1,autoPanOnConnect:gs,autoPanOnNodeDrag:vs,autoPanSpeed:bs,connectionRadius:ys,isValidConnection:rn,onError:qe,style:De,id:Re,nodeDragThreshold:rt,connectionDragThreshold:yt,viewport:it,onViewportChange:qt,width:Or,height:we,colorMode:er="light",debug:Ts,onScroll:Os,ariaLabelConfig:tr,zIndexMode:Fo="basic",...ul},wn){const hn=Re||"1",NN=zE(er),jN=M.useCallback(lh=>{lh.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Os==null||Os(lh)},[Os]);return s.jsx("div",{"data-testid":"rf__wrapper",...ul,onScroll:jN,style:{...De,...iR},ref:wn,className:_t(["react-flow",a,NN]),id:Re,role:"application",children:s.jsxs(oR,{nodes:e,edges:t,width:Or,height:we,fitView:Ue,fitViewOptions:ft,minZoom:Rt,maxZoom:wt,nodeOrigin:Ve,nodeExtent:vt,zIndexMode:Fo,children:[s.jsx(rR,{onInit:u,onNodeClick:c,onEdgeClick:i,onNodeMouseEnter:p,onNodeMouseMove:v,onNodeMouseLeave:N,onNodeContextMenu:C,onNodeDoubleClick:j,nodeTypes:l,edgeTypes:o,connectionLineType:B,connectionLineStyle:Z,connectionLineComponent:ee,connectionLineContainerStyle:ce,selectionKeyCode:Y,selectionOnDrag:q,selectionMode:se,deleteKeyCode:oe,multiSelectionKeyCode:G,panActivationKeyCode:z,zoomActivationKeyCode:J,onlyRenderVisibleElements:Ne,defaultViewport:ge,translateExtent:nt,minZoom:Rt,maxZoom:wt,preventScrolling:de,zoomOnScroll:Pt,zoomOnPinch:sn,zoomOnDoubleClick:Gt,panOnScroll:In,panOnScrollSpeed:mn,panOnScrollMode:fn,panOnDrag:Vt,onPaneClick:Yt,onPaneMouseEnter:X,onPaneMouseMove:ne,onPaneMouseLeave:ve,onPaneScroll:pe,onPaneContextMenu:H,paneClickDistance:te,nodeClickDistance:_,onSelectionContextMenu:L,onSelectionStart:I,onSelectionEnd:O,onReconnect:W,onReconnectStart:K,onReconnectEnd:me,onEdgeContextMenu:he,onEdgeDoubleClick:Se,onEdgeMouseEnter:ue,onEdgeMouseMove:Ae,onEdgeMouseLeave:mt,reconnectRadius:bt,defaultMarkerColor:Mt,noDragClassName:Ke,noWheelClassName:st,noPanClassName:Ge,rfId:hn,disableKeyboardA11y:Xn,nodeExtent:vt,viewport:it,onViewportChange:qt}),s.jsx(VE,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:g,onConnectStart:b,onConnectEnd:w,onClickConnectStart:x,onClickConnectEnd:d,nodesDraggable:Me,autoPanOnNodeFocus:He,nodesConnectable:ze,nodesFocusable:$e,edgesFocusable:tt,edgesReconnectable:gt,elementsSelectable:Ft,elevateNodesOnSelect:_n,elevateEdgesOnSelect:Ln,minZoom:Rt,maxZoom:wt,nodeExtent:vt,onNodesChange:Oe,onEdgesChange:Ie,snapToGrid:ae,snapGrid:je,connectionMode:U,translateExtent:nt,connectOnClick:fs,defaultEdgeOptions:xs,fitView:Ue,fitViewOptions:ft,onNodesDelete:$,onEdgesDelete:k,onDelete:A,onNodeDragStart:E,onNodeDrag:y,onNodeDragStop:R,onSelectionDrag:T,onSelectionDragStart:S,onSelectionDragStop:P,onMove:m,onMoveStart:h,onMoveEnd:f,noPanClassName:Ge,nodeOrigin:Ve,rfId:hn,autoPanOnConnect:gs,autoPanOnNodeDrag:vs,autoPanSpeed:bs,onError:qe,connectionRadius:ys,isValidConnection:rn,selectNodesOnDrag:Ce,nodeDragThreshold:rt,connectionDragThreshold:yt,onBeforeDelete:F,debug:Ts,ariaLabelConfig:tr,zIndexMode:Fo}),s.jsx(LE,{onSelectionChange:D}),V,s.jsx(ME,{proOptions:ps,position:hs}),s.jsx(RE,{rfId:hn,disableKeyboardA11y:Xn})]})})}var uR=qy(cR);function dR(e){const[t,n]=M.useState(e),r=M.useCallback(a=>n(l=>Gy(a,l)),[]);return[t,n,r]}function mR(e){const[t,n]=M.useState(e),r=M.useCallback(a=>n(l=>Yy(a,l)),[]);return[t,n,r]}function fR({dimensions:e,lineWidth:t,variant:n,className:r}){return s.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:_t(["react-flow__background-pattern",n,r])})}function hR({radius:e,className:t}){return s.jsx("circle",{cx:e,cy:e,r:e,className:_t(["react-flow__background-pattern","dots",t])})}var Nr;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Nr||(Nr={}));const pR={[Nr.Dots]:1,[Nr.Lines]:1,[Nr.Cross]:6},xR=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function vN({id:e,variant:t=Nr.Dots,gap:n=20,size:r,lineWidth:a=1,offset:l=0,color:o,bgColor:c,style:i,className:u,patternClassName:m}){const h=M.useRef(null),{transform:f,patternId:g}=Le(xR,lt),b=r||pR[t],w=t===Nr.Dots,x=t===Nr.Cross,d=Array.isArray(n)?n:[n,n],p=[d[0]*f[2]||1,d[1]*f[2]||1],v=b*f[2],N=Array.isArray(l)?l:[l,l],C=x?[v,v]:p,j=[N[0]*f[2]||1+C[0]/2,N[1]*f[2]||1+C[1]/2],E=`${g}${e||""}`;return s.jsxs("svg",{className:_t(["react-flow__background",u]),style:{...i,...au,"--xy-background-color-props":c,"--xy-background-pattern-color-props":o},ref:h,"data-testid":"rf__background",children:[s.jsx("pattern",{id:E,x:f[0]%p[0],y:f[1]%p[1],width:p[0],height:p[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${j[0]},-${j[1]})`,children:w?s.jsx(hR,{radius:v/2,className:m}):s.jsx(fR,{dimensions:C,lineWidth:a,variant:t,className:m})}),s.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${E})`})]})}vN.displayName="Background";const gR=M.memo(vN);function vR(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:s.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function bR(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:s.jsx("path",{d:"M0 0h32v4.2H0z"})})}function yR(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:s.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function NR(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:s.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function jR(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:s.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function pi({children:e,className:t,...n}){return s.jsx("button",{type:"button",className:_t(["react-flow__controls-button",t]),...n,children:e})}const _R=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function bN({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:l,onZoomOut:o,onFitView:c,onInteractiveChange:i,className:u,children:m,position:h="bottom-left",orientation:f="vertical","aria-label":g}){const b=ot(),{isInteractive:w,minZoomReached:x,maxZoomReached:d,ariaLabelConfig:p}=Le(_R,lt),{zoomIn:v,zoomOut:N,fitView:C}=rh(),j=()=>{v(),l==null||l()},E=()=>{N(),o==null||o()},y=()=>{C(a),c==null||c()},R=()=>{b.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),i==null||i(!w)},$=f==="horizontal"?"horizontal":"vertical";return s.jsxs(ru,{className:_t(["react-flow__controls",$,u]),position:h,style:e,"data-testid":"rf__controls","aria-label":g??p["controls.ariaLabel"],children:[t&&s.jsxs(s.Fragment,{children:[s.jsx(pi,{onClick:j,className:"react-flow__controls-zoomin",title:p["controls.zoomIn.ariaLabel"],"aria-label":p["controls.zoomIn.ariaLabel"],disabled:d,children:s.jsx(vR,{})}),s.jsx(pi,{onClick:E,className:"react-flow__controls-zoomout",title:p["controls.zoomOut.ariaLabel"],"aria-label":p["controls.zoomOut.ariaLabel"],disabled:x,children:s.jsx(bR,{})})]}),n&&s.jsx(pi,{className:"react-flow__controls-fitview",onClick:y,title:p["controls.fitView.ariaLabel"],"aria-label":p["controls.fitView.ariaLabel"],children:s.jsx(yR,{})}),r&&s.jsx(pi,{className:"react-flow__controls-interactive",onClick:R,title:p["controls.interactive.ariaLabel"],"aria-label":p["controls.interactive.ariaLabel"],children:w?s.jsx(jR,{}):s.jsx(NR,{})}),m]})}bN.displayName="Controls";const wR=M.memo(bN);function SR({id:e,x:t,y:n,width:r,height:a,style:l,color:o,strokeColor:c,strokeWidth:i,className:u,borderRadius:m,shapeRendering:h,selected:f,onClick:g}){const{background:b,backgroundColor:w}=l||{},x=o||b||w;return s.jsx("rect",{className:_t(["react-flow__minimap-node",{selected:f},u]),x:t,y:n,rx:m,ry:m,width:r,height:a,style:{fill:x,stroke:c,strokeWidth:i},shapeRendering:h,onClick:g?d=>g(d,e):void 0})}const CR=M.memo(SR),kR=e=>e.nodes.map(t=>t.id),ad=e=>e instanceof Function?e:()=>e;function ER({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:l=CR,onClick:o}){const c=Le(kR,lt),i=ad(t),u=ad(e),m=ad(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return s.jsx(s.Fragment,{children:c.map(f=>s.jsx(RR,{id:f,nodeColorFunc:i,nodeStrokeColorFunc:u,nodeClassNameFunc:m,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:l,onClick:o,shapeRendering:h},f))})}function AR({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:l,shapeRendering:o,NodeComponent:c,onClick:i}){const{node:u,x:m,y:h,width:f,height:g}=Le(b=>{const{internals:w}=b.nodeLookup.get(e),x=w.userNode,{x:d,y:p}=w.positionAbsolute,{width:v,height:N}=Js(x);return{node:x,x:d,y:p,width:v,height:N}},lt);return!u||u.hidden||!yy(u)?null:s.jsx(c,{x:m,y:h,width:f,height:g,style:u.style,selected:!!u.selected,className:r(u),color:t(u),borderRadius:a,strokeColor:n(u),strokeWidth:l,shapeRendering:o,onClick:i,id:u.id})}const RR=M.memo(AR);var MR=M.memo(ER);const PR=200,TR=150,OR=e=>!e.hidden,IR=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?by(Lo(e.nodeLookup,{filter:OR}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},LR="react-flow__minimap-desc";function yN({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:l=5,nodeStrokeWidth:o,nodeComponent:c,bgColor:i,maskColor:u,maskStrokeColor:m,maskStrokeWidth:h,position:f="bottom-right",onClick:g,onNodeClick:b,pannable:w=!1,zoomable:x=!1,ariaLabel:d,inversePan:p,zoomStep:v=1,offsetScale:N=5}){const C=ot(),j=M.useRef(null),{boundingRect:E,viewBB:y,rfId:R,panZoom:$,translateExtent:k,flowWidth:A,flowHeight:D,ariaLabelConfig:S}=Le(IR,lt),T=(e==null?void 0:e.width)??PR,P=(e==null?void 0:e.height)??TR,L=E.width/T,I=E.height/P,O=Math.max(L,I),F=O*T,U=O*P,B=N*O,Z=E.x-(F-E.width)/2-B,ee=E.y-(U-E.height)/2-B,ce=F+B*2,oe=U+B*2,Y=`${LR}-${R}`,q=M.useRef(0),se=M.useRef();q.current=O,M.useEffect(()=>{if(j.current&&$)return se.current=aE({domNode:j.current,panZoom:$,getTransform:()=>C.getState().transform,getViewScale:()=>q.current}),()=>{var ae;(ae=se.current)==null||ae.destroy()}},[$]),M.useEffect(()=>{var ae;(ae=se.current)==null||ae.update({translateExtent:k,width:A,height:D,inversePan:p,pannable:w,zoomStep:v,zoomable:x})},[w,x,p,v,k,A,D]);const z=g?ae=>{var Ce;const[je,Ne]=((Ce=se.current)==null?void 0:Ce.pointer(ae))||[0,0];g(ae,{x:je,y:Ne})}:void 0,G=b?M.useCallback((ae,je)=>{const Ne=C.getState().nodeLookup.get(je).internals.userNode;b(ae,Ne)},[]):void 0,J=d??S["minimap.ariaLabel"];return s.jsx(ru,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof i=="string"?i:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof m=="string"?m:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*O:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="number"?o:void 0},className:_t(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:s.jsxs("svg",{width:T,height:P,viewBox:`${Z} ${ee} ${ce} ${oe}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:j,onClick:z,children:[J&&s.jsx("title",{id:Y,children:J}),s.jsx(MR,{onClick:G,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:l,nodeClassName:a,nodeStrokeWidth:o,nodeComponent:c}),s.jsx("path",{className:"react-flow__minimap-mask",d:`M${Z-B},${ee-B}h${ce+B*2}v${oe+B*2}h${-ce-B*2}z
        M${y.x},${y.y}h${y.width}v${y.height}h${-y.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}yN.displayName="MiniMap";const $R=M.memo(yN),DR=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,FR={[al.Line]:"right",[al.Handle]:"bottom-right"};function VR({nodeId:e,position:t,variant:n=al.Handle,className:r,style:a=void 0,children:l,color:o,minWidth:c=10,minHeight:i=10,maxWidth:u=Number.MAX_VALUE,maxHeight:m=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:f,autoScale:g=!0,shouldResize:b,onResizeStart:w,onResize:x,onResizeEnd:d}){const p=Zy(),v=typeof e=="string"?e:p,N=ot(),C=M.useRef(null),j=n===al.Handle,E=Le(M.useCallback(DR(j&&g),[j,g]),lt),y=M.useRef(null),R=t??FR[n];M.useEffect(()=>{if(!(!C.current||!v))return y.current||(y.current=bE({domNode:C.current,nodeId:v,getStoreItems:()=>{const{nodeLookup:k,transform:A,snapGrid:D,snapToGrid:S,nodeOrigin:T,domNode:P}=N.getState();return{nodeLookup:k,transform:A,snapGrid:D,snapToGrid:S,nodeOrigin:T,paneDomNode:P}},onChange:(k,A)=>{const{triggerNodeChanges:D,nodeLookup:S,parentLookup:T,nodeOrigin:P}=N.getState(),L=[],I={x:k.x,y:k.y},O=S.get(v);if(O&&O.expandParent&&O.parentId){const F=O.origin??P,U=k.width??O.measured.width??0,B=k.height??O.measured.height??0,Z={id:O.id,parentId:O.parentId,rect:{width:U,height:B,...Ny({x:k.x??O.position.x,y:k.y??O.position.y},{width:U,height:B},O.parentId,S,F)}},ee=sh([Z],S,T,P);L.push(...ee),I.x=k.x?Math.max(F[0]*U,k.x):void 0,I.y=k.y?Math.max(F[1]*B,k.y):void 0}if(I.x!==void 0&&I.y!==void 0){const F={id:v,type:"position",position:{...I}};L.push(F)}if(k.width!==void 0&&k.height!==void 0){const U={id:v,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:k.width,height:k.height}};L.push(U)}for(const F of A){const U={...F,type:"position"};L.push(U)}D(L)},onEnd:({width:k,height:A})=>{const D={id:v,type:"dimensions",resizing:!1,dimensions:{width:k,height:A}};N.getState().triggerNodeChanges([D])}})),y.current.update({controlPosition:R,boundaries:{minWidth:c,minHeight:i,maxWidth:u,maxHeight:m},keepAspectRatio:h,resizeDirection:f,onResizeStart:w,onResize:x,onResizeEnd:d,shouldResize:b}),()=>{var k;(k=y.current)==null||k.destroy()}},[R,c,i,u,m,h,w,x,d,b]);const $=R.split("-");return s.jsx("div",{className:_t(["react-flow__resize-control","nodrag",...$,n,r]),ref:C,style:{...a,scale:E,...o&&{[j?"backgroundColor":"borderColor"]:o}},children:l})}M.memo(VR);function zR({data:e}){return s.jsxs("div",{className:`px-4 py-3 rounded-xl border-2 shadow-lg min-w-[200px] ${e.isDefault?"border-amber-500 bg-amber-950/80":"border-blue-500 bg-slate-800/90"}`,children:[s.jsx(Er,{type:"target",position:ye.Top,className:"!bg-blue-500 !w-3 !h-3"}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${e.isDefault?"bg-amber-500/20":"bg-blue-500/20"}`,children:s.jsx(Zt,{className:`w-4 h-4 ${e.isDefault?"text-amber-400":"text-blue-400"}`})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-slate-100",children:e.name}),e.isDefault&&s.jsx("div",{className:"text-[10px] text-amber-400 font-medium",children:"Default Agent"})]})]}),e.description&&s.jsx("p",{className:"text-xs text-slate-400 mb-2 line-clamp-2",children:e.description}),s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(oo,{className:"w-3 h-3 text-purple-400"}),s.jsx("span",{className:"truncate",children:e.modelName})]}),e.toolCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(Rs,{className:"w-3 h-3 text-green-400"}),s.jsxs("span",{children:[e.toolCount," tool",e.toolCount!==1?"s":""]})]}),e.guardrailCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(Sr,{className:"w-3 h-3 text-red-400"}),s.jsxs("span",{children:[e.guardrailCount," guardrail",e.guardrailCount!==1?"s":""]})]}),e.handoffTargets&&e.handoffTargets.length>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(Ro,{className:"w-3 h-3 text-cyan-400"}),s.jsxs("span",{children:[" ",e.handoffTargets.join(", ")]})]})]}),s.jsx(Er,{type:"source",position:ye.Bottom,className:"!bg-blue-500 !w-3 !h-3"})]})}function HR({data:e}){return s.jsxs("div",{className:"px-4 py-3 rounded-xl border-2 border-purple-500 bg-purple-950/80 shadow-lg min-w-[180px]",children:[s.jsx(Er,{type:"target",position:ye.Top,className:"!bg-purple-500 !w-3 !h-3"}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-purple-500/20",children:s.jsx(im,{className:"w-4 h-4 text-purple-400"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Supervisor"}),s.jsx("div",{className:"text-[10px] text-purple-400 font-medium",children:"Orchestrator"})]})]}),s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(oo,{className:"w-3 h-3 text-purple-400"}),s.jsx("span",{className:"truncate",children:e.modelName})]}),e.toolCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(Rs,{className:"w-3 h-3 text-green-400"}),s.jsxs("span",{children:[e.toolCount," tool",e.toolCount!==1?"s":""]})]})]}),s.jsx(Er,{type:"source",position:ye.Bottom,className:"!bg-purple-500 !w-3 !h-3"})]})}const UR={agent:zR,supervisor:HR};function BR({config:e}){var i,u,m,h;const{nodes:t,edges:n}=M.useMemo(()=>WR(e),[e]),[r,,a]=dR(t),[l,,o]=mR(n),c=(u=(i=e.app)==null?void 0:i.orchestration)!=null&&u.supervisor?"supervisor":(h=(m=e.app)==null?void 0:m.orchestration)!=null&&h.swarm?"swarm":"none";return s.jsxs("div",{className:"w-full h-full bg-slate-900 rounded-lg overflow-hidden",children:[s.jsx("div",{className:"px-4 py-3 border-b border-slate-700 bg-slate-800/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ro,{className:"w-5 h-5 text-blue-400"}),s.jsx("h3",{className:"text-sm font-medium text-slate-200",children:"Agent Graph"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-slate-400",children:"Orchestration:"}),s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${c==="supervisor"?"bg-purple-500/20 text-purple-300":c==="swarm"?"bg-blue-500/20 text-blue-300":"bg-slate-700 text-slate-400"}`,children:c==="supervisor"?"Supervisor":c==="swarm"?"Swarm":"Not Configured"})]})]})}),s.jsx("div",{className:"h-[calc(100%-52px)]",children:t.length===0?s.jsx("div",{className:"flex items-center justify-center h-full text-slate-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Zt,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No agents configured"}),s.jsx("p",{className:"text-xs mt-1",children:"Add agents to visualize the graph"})]})}):s.jsxs(uR,{nodes:r,edges:l,onNodesChange:a,onEdgesChange:o,nodeTypes:UR,connectionLineType:Fs.SmoothStep,fitView:!0,fitViewOptions:{padding:.3},minZoom:.3,maxZoom:2,defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"#64748b",strokeWidth:2},markerEnd:{type:oa.ArrowClosed,color:"#64748b"}},children:[s.jsx(gR,{color:"#334155",gap:20,size:1}),s.jsx(wR,{className:"!bg-slate-800 !border-slate-700 !rounded-lg [&>button]:!bg-slate-700 [&>button]:!border-slate-600 [&>button]:!text-slate-300 [&>button:hover]:!bg-slate-600"}),s.jsx($R,{nodeColor:f=>{var g;return f.type==="supervisor"?"#a855f7":(g=f.data)!=null&&g.isDefault?"#f59e0b":"#3b82f6"},maskColor:"rgba(15, 23, 42, 0.8)",className:"!bg-slate-800 !border-slate-700 !rounded-lg"})]})})]})}function WR(e){var w,x,d,p,v;const t=[],n=[],r=e.agents||{},a=((w=e.app)==null?void 0:w.agents)||[],l=a.length>0?Object.keys(r).filter(N=>{const C=r[N];return a.some(j=>{const E=typeof j=="string"?j:j==null?void 0:j.name;return C.name===E})}):Object.keys(r),o=Object.fromEntries(l.map(N=>[N,r[N]]));if(l.length===0)return{nodes:t,edges:n};const c=l.map(N=>o[N].name),i=(x=e.app)==null?void 0:x.orchestration,u=240,m=180,h=100,f=120,g=u+h,b=m+f;if(i!=null&&i.supervisor){const N=i.supervisor,C=l.length,j=Math.min(3,C),R=Math.min(j,C)*g/2;t.push({id:"supervisor",type:"supervisor",position:{x:R-90,y:40},data:{modelName:((d=N.model)==null?void 0:d.name)||"Unknown",toolCount:((p=N.tools)==null?void 0:p.length)||0}}),l.forEach(($,k)=>{var I,O,F;const A=o[$],D=Math.floor(k/j),S=k%j,P=Math.min(j,C-D*j)*g,L=R-P/2;t.push({id:$,type:"agent",position:{x:L+S*g,y:40+b+D*b},data:{name:A.name,description:A.description,modelName:((I=A.model)==null?void 0:I.name)||"Unknown",toolCount:((O=A.tools)==null?void 0:O.length)||0,guardrailCount:((F=A.guardrails)==null?void 0:F.length)||0}}),n.push({id:`supervisor-${$}`,source:"supervisor",target:$,animated:!0,style:{stroke:"#a855f7",strokeWidth:2},markerEnd:{type:oa.ArrowClosed,color:"#a855f7"}})})}else if(i!=null&&i.swarm){const N=i.swarm,C=typeof N.default_agent=="string"?N.default_agent:(v=N.default_agent)==null?void 0:v.name,j=N.handoffs||{},E=$=>{if(!Object.prototype.hasOwnProperty.call(j,$))return c.filter(D=>D!==$);const A=j[$];return A==null?c.filter(D=>D!==$):Array.isArray(A)&&A.length===0?[]:Array.isArray(A)?A.map(D=>typeof D=="string"?D:(D==null?void 0:D.name)||"").filter(D=>D&&D!==$&&c.includes(D)):[]},y=l.length,R=($,k)=>{var P,L,I,O;const A=E($.name),D=Object.prototype.hasOwnProperty.call(j,$.name),S=!D||j[$.name]===null||j[$.name]===void 0,T=D&&Array.isArray(j[$.name])&&((P=j[$.name])==null?void 0:P.length)===0;return{name:$.name,description:$.description,modelName:((L=$.model)==null?void 0:L.name)||"Unknown",toolCount:((I=$.tools)==null?void 0:I.length)||0,guardrailCount:((O=$.guardrails)==null?void 0:O.length)||0,isDefault:k,handoffTargets:S?["(all agents)"]:T?["(none)"]:A.length>0?A:void 0}};if(y===2){const $=g*1.5,k=50;l.forEach((A,D)=>{const S=o[A],T=S.name===C;t.push({id:A,type:"agent",position:{x:k+D*$,y:100},data:R(S,T)})})}else if(y===3){const A=50+b,D=g*.7,S=o[l[0]];t.push({id:l[0],type:"agent",position:{x:300-u/2,y:50},data:R(S,S.name===C)});const T=o[l[1]];t.push({id:l[1],type:"agent",position:{x:300-u/2-D,y:A},data:R(T,T.name===C)});const P=o[l[2]];t.push({id:l[2],type:"agent",position:{x:300-u/2+D,y:A},data:R(P,P.name===C)})}else if(y<=6){const $=280+y*30,k=$+u/2+50,A=$+m/2+50,D=2*Math.PI/y,S=-Math.PI/2;l.forEach((T,P)=>{const L=o[T],I=S+P*D,O=k+$*Math.cos(I)-u/2,F=A+$*Math.sin(I)-m/2,U=L.name===C;t.push({id:T,type:"agent",position:{x:O,y:F},data:R(L,U)})})}else{const A=Math.min(3,y)*g/2;l.forEach((D,S)=>{const T=o[D],P=S%3,L=Math.floor(S/3),O=Math.min(3,y-L*3)*g,F=A-O/2,U=T.name===C;t.push({id:D,type:"agent",position:{x:F+P*g,y:50+L*b},data:R(T,U)})})}l.forEach($=>{const k=o[$];E(k.name).forEach((D,S)=>{const T=l.find(P=>o[P].name===D);!T||$===T||n.push({id:`${$}-${T}-${S}`,source:$,target:T,animated:!0,style:{stroke:"#22d3ee",strokeWidth:2},markerEnd:{type:oa.ArrowClosed,color:"#22d3ee"}})})})}else{const N=l.length,C=Math.min(3,N),E=Math.min(C,N)*g/2;l.forEach((y,R)=>{var P,L,I;const $=o[y],k=Math.floor(R/C),A=R%C,S=Math.min(C,N-k*C)*g,T=E-S/2;t.push({id:y,type:"agent",position:{x:T+A*g,y:50+k*b},data:{name:$.name,description:$.description,modelName:((P=$.model)==null?void 0:P.name)||"Unknown",toolCount:((L=$.tools)==null?void 0:L.length)||0,guardrailCount:((I=$.guardrails)==null?void 0:I.length)||0,isDefault:R===0}})})}return{nodes:t,edges:n}}const GR=cl((e,t)=>({deploymentId:null,deploymentStatus:null,isDeploying:!1,selectedOption:"quick",error:null,startDeployment:n=>{const r={id:"pending",status:"starting",type:n,started_at:new Date().toISOString(),steps:[{name:"validate",status:"running"},{name:"create_agent",status:"pending"},{name:"deploy_agent",status:"pending"}],current_step:0};return e({isDeploying:!0,selectedOption:n,deploymentStatus:r,error:null}),r},setDeploymentId:n=>{e({deploymentId:n})},setDeploymentStatus:n=>{e({deploymentStatus:n}),(n.status==="completed"||n.status==="failed")&&e({isDeploying:!1})},setError:n=>{e({error:n,isDeploying:!1})},completeDeployment:()=>{e({isDeploying:!1})},failDeployment:(n,r)=>{e(a=>({isDeploying:!1,error:n,deploymentStatus:a.deploymentStatus?{...a.deploymentStatus,status:"failed",error:n,error_trace:r,steps:a.deploymentStatus.steps.map((l,o)=>o===a.deploymentStatus.current_step?{...l,status:"failed",error:n}:l)}:null}))},reset:()=>{t().isDeploying||e({deploymentId:null,deploymentStatus:null,isDeploying:!1,error:null})},canStartNewDeployment:()=>{const n=t();return n.isDeploying?!1:n.deploymentStatus?n.deploymentStatus.status==="completed"||n.deploymentStatus.status==="failed":!0}}));function Sc(e){if(!e||typeof e!="object")return e;if(Array.isArray(e))return e.map(Sc);const t={};for(const[n,r]of Object.entries(e))n!=="refName"&&(t[n]=Sc(r));return t}const YR={validate:s.jsx(Ss,{className:"w-4 h-4"}),create_agent:s.jsx(Zt,{className:"w-4 h-4"}),deploy_agent:s.jsx(io,{className:"w-4 h-4"})},qR={validate:"Validate Configuration",create_agent:"Create Agent Model",deploy_agent:"Deploy to Endpoint"};function XR({onClose:e}){const{config:t}=We(),{deploymentId:n,deploymentStatus:r,isDeploying:a,startDeployment:l,setDeploymentId:o,setDeploymentStatus:c,failDeployment:i,reset:u,canStartNewDeployment:m}=GR(),[h,f]=M.useState(null),[g,b]=M.useState(!1),[w,x]=M.useState(null),[d,p]=M.useState("manual_pat"),[v,N]=M.useState(""),[C,j]=M.useState(""),[E,y]=M.useState(""),[R,$]=M.useState({hasAppCredentials:!1,hasOboToken:!1});M.useEffect(()=>{(async()=>{try{const P=await fetch("/api/auth/context");if(P.ok){const L=await P.json();$({hasAppCredentials:L.has_service_principal||!1,hasOboToken:L.has_obo_token||!1}),p("manual_pat")}}catch(P){console.error("Failed to check credentials:",P)}})()},[]);const k=M.useCallback(async()=>{b(!0),x(null);try{const T=ra(t),P=Bs.load(T),L=Sc(P),I=await fetch("/api/deploy/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:L})}),O=I.headers.get("content-type"),F=O&&O.includes("application/json");if(!I.ok)if(F){const B=await I.json();throw new Error(B.error||"Validation failed")}else throw console.error("Server returned non-JSON response:",I.status,I.statusText),new Error(`Server error: ${I.status} ${I.statusText}. The server may be experiencing issues.`);if(!F)throw new Error("Server returned unexpected response format");const U=await I.json();f(U)}catch(T){console.error("Validation error:",T),x(T instanceof Error?T.message:"Failed to validate configuration")}finally{b(!1)}},[t]);M.useEffect(()=>{k()},[k]),M.useEffect(()=>{if(!n)return;const T=async()=>{try{const L=await fetch(`/api/deploy/status/${n}`);if(!L.ok)return;const I=await L.json();c(I)}catch(L){console.error("Failed to poll deployment status:",L)}};T();const P=setInterval(T,2e3);return()=>clearInterval(P)},[n,c]);const A=async()=>{if(!(h!=null&&h.valid))return;if(!m()){x("A deployment is already in progress. Please wait for it to complete.");return}if(d==="manual_sp"&&(!v||!C)){x("Please enter both Client ID and Client Secret");return}if(d==="manual_pat"&&!E){x("Please enter a Personal Access Token");return}x(null),l("quick");const T={type:d};d==="manual_sp"?(T.client_id=v,T.client_secret=C):d==="manual_pat"&&(T.pat=E);try{const P="/api/deploy/quick",L=ra(t),I=Bs.load(L),O=Sc(I),F=await fetch(P,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:O,credentials:T})}),U=F.headers.get("content-type"),B=U&&U.includes("application/json");if(!F.ok)if(B){const ee=await F.json();throw new Error(ee.error||"Deployment failed to start")}else throw console.error("Server returned non-JSON response:",F.status,F.statusText),new Error(`Server error: ${F.status} ${F.statusText}. Check server logs for details.`);if(!B)throw new Error("Server returned unexpected response format");const Z=await F.json();o(Z.deployment_id)}catch(P){const L=P instanceof Error?P.message:"Failed to start deployment";x(L),i(L)}},D=T=>{switch(T){case"completed":return s.jsx(Kn,{className:"w-5 h-5 text-green-400"});case"failed":return s.jsx(Vn,{className:"w-5 h-5 text-red-400"});case"running":return s.jsx(xt,{className:"w-5 h-5 text-blue-400 animate-spin"});default:return s.jsx(lc,{className:"w-5 h-5 text-slate-500"})}},S=()=>{if(!r)return null;switch(r.status){case"completed":return s.jsx(Ee,{variant:"success",children:"Completed"});case"failed":return s.jsx(Ee,{variant:"danger",children:"Failed"});case"creating_agent":return s.jsx(Ee,{variant:"info",children:"Creating Agent..."});case"deploying":return s.jsx(Ee,{variant:"info",children:"Deploying..."});default:return s.jsx(Ee,{variant:"warning",children:"Starting..."})}};return s.jsx("div",{className:"space-y-6",children:g?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(Ut,{className:"w-6 h-6 text-blue-400 animate-spin mr-2"}),s.jsx("span",{className:"text-slate-300",children:"Validating configuration..."})]}):h?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`p-4 rounded-lg border ${h.valid?"bg-green-950/30 border-green-800":"bg-red-950/30 border-red-800"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[h.valid?s.jsx(Kn,{className:"w-6 h-6 text-green-400"}):s.jsx(Vn,{className:"w-6 h-6 text-red-400"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-slate-100",children:h.valid?"Configuration Valid":"Configuration Invalid"}),s.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:[h.app_name&&`App: ${h.app_name}`,h.agent_count!==void 0&&`  ${h.agent_count} agent(s)`]})]})]}),h.errors.length>0&&s.jsx("div",{className:"mt-3 space-y-1",children:h.errors.map((T,P)=>s.jsxs("div",{className:"flex items-start gap-2 text-xs text-red-400",children:[s.jsx(Vn,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:T})]},P))}),h.warnings.length>0&&s.jsx("div",{className:"mt-3 space-y-1",children:h.warnings.map((T,P)=>s.jsxs("div",{className:"flex items-start gap-2 text-xs text-amber-400",children:[s.jsx(Uc,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:T})]},P))})]}),h.requirements.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Resource Requirements"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:h.requirements.map((T,P)=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800/50 rounded-lg border border-slate-700",children:[T.type==="vector_search"&&s.jsx(sa,{className:"w-3 h-3 text-purple-400"}),T.type==="database"&&s.jsx(on,{className:"w-3 h-3 text-blue-400"}),T.type==="genie"&&s.jsx(Zt,{className:"w-3 h-3 text-cyan-400"}),T.type==="functions"&&s.jsx(Ss,{className:"w-3 h-3 text-green-400"}),s.jsx("span",{className:"text-xs text-slate-300",children:T.description}),s.jsx(Ee,{variant:"default",className:"text-[10px]",children:T.count})]},P))})]}),h.valid&&!r&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Deployment Credentials"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>p("manual_pat"),className:`p-3 rounded-lg border text-left transition-all ${d==="manual_pat"?"bg-cyan-950/40 border-cyan-500 ring-1 ring-cyan-500/50":"bg-slate-800/30 border-slate-700 hover:border-slate-600"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Un,{className:"w-4 h-4 text-cyan-400"}),s.jsx("span",{className:`text-sm font-medium ${d==="manual_pat"?"text-slate-100":"text-slate-300"}`,children:"Manual PAT"}),d==="manual_pat"&&s.jsx(Kn,{className:"w-3 h-3 text-cyan-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter personal access token"})]}),s.jsxs("button",{onClick:()=>p("manual_sp"),className:`p-3 rounded-lg border text-left transition-all ${d==="manual_sp"?"bg-amber-950/40 border-amber-500 ring-1 ring-amber-500/50":"bg-slate-800/30 border-slate-700 hover:border-slate-600"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Sr,{className:"w-4 h-4 text-amber-400"}),s.jsx("span",{className:`text-sm font-medium ${d==="manual_sp"?"text-slate-100":"text-slate-300"}`,children:"Manual SP"}),d==="manual_sp"&&s.jsx(Kn,{className:"w-3 h-3 text-amber-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter client ID & secret"})]}),s.jsxs("button",{onClick:()=>p("obo"),disabled:!R.hasOboToken,className:`p-3 rounded-lg border text-left transition-all ${d==="obo"?"bg-purple-950/40 border-purple-500 ring-1 ring-purple-500/50":R.hasOboToken?"bg-slate-800/30 border-slate-700 hover:border-slate-600":"bg-slate-800/20 border-slate-800 opacity-50 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Yn,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:`text-sm font-medium ${d==="obo"?"text-slate-100":"text-slate-300"}`,children:"User Token (OBO)"}),d==="obo"&&s.jsx(Kn,{className:"w-3 h-3 text-purple-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Use your logged-in credentials"})]}),s.jsxs("button",{onClick:()=>p("app"),disabled:!R.hasAppCredentials,className:`p-3 rounded-lg border text-left transition-all ${d==="app"?"bg-green-950/40 border-green-500 ring-1 ring-green-500/50":R.hasAppCredentials?"bg-slate-800/30 border-slate-700 hover:border-slate-600":"bg-slate-800/20 border-slate-800 opacity-50 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(jw,{className:"w-4 h-4 text-green-400"}),s.jsx("span",{className:`text-sm font-medium ${d==="app"?"text-slate-100":"text-slate-300"}`,children:"App Service Principal"}),d==="app"&&s.jsx(Kn,{className:"w-3 h-3 text-green-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Use application credentials"})]})]}),d==="manual_sp"&&s.jsxs("div",{className:"space-y-2 p-3 bg-slate-800/30 rounded-lg border border-slate-700",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Client ID"}),s.jsx("input",{type:"text",value:v,onChange:T=>N(T.target.value),placeholder:"Enter service principal client ID",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-amber-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Client Secret"}),s.jsx("input",{type:"password",value:C,onChange:T=>j(T.target.value),placeholder:"Enter service principal client secret",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-amber-500"})]})]}),d==="manual_pat"&&s.jsxs("div",{className:"p-3 bg-slate-800/30 rounded-lg border border-slate-700",children:[s.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Personal Access Token"}),s.jsx("input",{type:"password",value:E,onChange:T=>y(T.target.value),placeholder:"Enter Databricks personal access token",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-cyan-500"})]})]}),h.valid&&h.deployment_options&&!r&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Deployment Options"}),s.jsxs("div",{className:"p-4 rounded-xl border bg-blue-950/40 border-blue-500 ring-1 ring-blue-500/50",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/20",children:s.jsx(oc,{className:"w-4 h-4 text-blue-400"})}),s.jsx("span",{className:"font-medium text-slate-100",children:"Quick Deploy"}),s.jsx(Kn,{className:"w-4 h-4 text-blue-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-400 mb-3",children:h.deployment_options.quick.description}),s.jsx("div",{className:"flex flex-wrap gap-1",children:h.deployment_options.quick.provisions.map((T,P)=>s.jsx("span",{className:"px-2 py-0.5 text-[10px] bg-slate-700/50 rounded text-slate-300",children:T},P))})]})]}),r&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Deployment Progress"}),a&&s.jsx("span",{className:"text-[10px] text-blue-400 bg-blue-500/20 px-2 py-0.5 rounded",children:"Running in background"})]}),S()]}),s.jsx("div",{className:"space-y-2",children:r.steps.map(T=>s.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${T.status==="running"?"bg-blue-950/30 border-blue-800":T.status==="completed"?"bg-green-950/20 border-green-900":T.status==="failed"?"bg-red-950/20 border-red-900":"bg-slate-800/30 border-slate-700"}`,children:[s.jsx("div",{className:`p-1.5 rounded-lg ${T.status==="running"?"bg-blue-500/20":T.status==="completed"?"bg-green-500/20":T.status==="failed"?"bg-red-500/20":"bg-slate-700"}`,children:YR[T.name]||s.jsx(Ss,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-slate-200",children:qR[T.name]||T.name}),T.error&&s.jsx("p",{className:"text-xs text-red-400 mt-1",children:T.error})]}),D(T.status)]},T.name))}),r.status==="completed"&&r.result&&s.jsxs("div",{className:"p-4 bg-green-950/30 border border-green-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Kn,{className:"w-5 h-5 text-green-400"}),s.jsx("span",{className:"font-medium text-green-300",children:"Deployment Successful!"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-slate-400",children:"Endpoint:"}),s.jsx("code",{className:"px-2 py-0.5 bg-slate-800 rounded text-green-300",children:r.result.endpoint_name})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-slate-400",children:"Model:"}),s.jsx("code",{className:"px-2 py-0.5 bg-slate-800 rounded text-slate-300 text-xs",children:r.result.model_name})]})]})]}),r.status==="failed"&&r.error&&s.jsxs("div",{className:"p-4 bg-red-950/30 border border-red-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Vn,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"font-medium text-red-300",children:"Deployment Failed"})]}),s.jsx("p",{className:"text-sm text-red-400",children:r.error}),r.error_trace&&s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-slate-500 cursor-pointer hover:text-slate-400",children:"Show details"}),s.jsx("pre",{className:"mt-2 p-2 bg-slate-900 rounded text-xs text-slate-400 overflow-x-auto max-h-40",children:r.error_trace})]})]})]}),w&&s.jsx("div",{className:"p-4 bg-red-950/30 border border-red-800 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"text-red-300",children:w})]})}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Q,{variant:"ghost",onClick:k,disabled:g||a,children:[s.jsx(Ut,{className:`w-4 h-4 ${g?"animate-spin":""}`}),"Revalidate"]}),((r==null?void 0:r.status)==="completed"||(r==null?void 0:r.status)==="failed")&&s.jsxs(Q,{variant:"ghost",onClick:u,children:[s.jsx(am,{className:"w-4 h-4"}),"New Deployment"]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[e&&s.jsx(Q,{variant:"secondary",onClick:e,children:a?"Close (continues in background)":"Close"}),s.jsx(Q,{variant:"primary",onClick:A,disabled:!h.valid||a||!m(),children:a?s.jsxs(s.Fragment,{children:[s.jsx(xt,{className:"w-4 h-4 animate-spin"}),"Deploying..."]}):(r==null?void 0:r.status)==="completed"?s.jsxs(s.Fragment,{children:[s.jsx(Kn,{className:"w-4 h-4"}),"Deployed"]}):s.jsxs(s.Fragment,{children:[s.jsx(am,{className:"w-4 h-4"}),"Deploy"]})})]})]})]}):w?s.jsxs("div",{className:"p-4 bg-red-950/30 border border-red-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"text-red-300",children:w})]}),s.jsxs(Q,{variant:"ghost",onClick:k,className:"mt-3",children:[s.jsx(Ut,{className:"w-4 h-4"}),"Retry"]})]}):null})}const ox=cl()(Tb((e,t)=>({credentialType:"obo",manualClientId:"",manualClientSecret:"",manualPat:"",setCredentialType:n=>e({credentialType:n}),setManualClientId:n=>e({manualClientId:n}),setManualClientSecret:n=>e({manualClientSecret:n}),setManualPat:n=>e({manualPat:n}),getCredentials:()=>{const n=t(),r={type:n.credentialType};return n.credentialType==="manual_sp"?(r.client_id=n.manualClientId,r.client_secret=n.manualClientSecret):n.credentialType==="manual_pat"&&(r.pat=n.manualPat),r},hasCredentials:()=>{const n=t();return n.credentialType==="obo"?!0:n.credentialType==="manual_sp"?!!(n.manualClientId&&n.manualClientSecret):n.credentialType==="manual_pat"?!!n.manualPat:!1}}),{name:"credential-storage"}));function Im(e){if(!e||typeof e!="object")return e;if(Array.isArray(e))return e.map(Im);const t={};for(const[n,r]of Object.entries(e))n!=="refName"&&(t[n]=Im(r));return t}function QR({onClose:e}){var Ft,ge,Rt,wt,nt;const{config:t}=We(),{conversationId:n,messages:r,logs:a,addMessage:l,updateLastMessage:o,addLog:c,clearLogs:i,startNewSession:u,removeEmptyMessages:m}=Ob(),{credentialType:h,manualClientId:f,manualClientSecret:g,manualPat:b,setCredentialType:w,setManualClientId:x,setManualClientSecret:d,setManualPat:p,hasCredentials:v}=ox(),[N,C]=M.useState(""),[j,E]=M.useState(!1),[y,R]=M.useState(null),[$,k]=M.useState(null),[A,D]=M.useState(!1),[S,T]=M.useState(!1),[P,L]=M.useState(!1),[I,O]=M.useState(""),[F,U]=M.useState(null),[B,Z]=M.useState(!1),[ee,ce]=M.useState(null),[oe,Y]=M.useState(!1),q=M.useRef(null),se=M.useRef(null),z=M.useRef(null),G=M.useCallback(()=>{var de;(de=q.current)==null||de.scrollIntoView({behavior:"smooth"})},[]);M.useEffect(()=>{G()},[r,G]),M.useEffect(()=>{var de;A&&((de=se.current)==null||de.scrollIntoView({behavior:"smooth"}))},[a,A]),M.useEffect(()=>{var de;(de=z.current)==null||de.focus()},[]);const J=Object.keys(t.agents||{}).length>0,ae=!!((ge=(Ft=t.app)==null?void 0:Ft.orchestration)!=null&&ge.supervisor||(wt=(Rt=t.app)==null?void 0:Rt.orchestration)!=null&&wt.swarm),je=J&&ae,Ne=async()=>{var vt,Mt;if(!N.trim()||j||!je)return;const de=N.trim();C(""),E(!0),R(null),k(null),l("user",de),c("info",`Sending message: "${de.substring(0,50)}${de.length>50?"...":""}"`),l("assistant","");try{const Pt=[...r,{role:"user",content:de}].map(pe=>({role:pe.role,content:pe.content}));c("debug",`Preparing request with ${Pt.length} messages`),c("info","Creating agent from configuration...");const sn=ra(t),In=Bs.load(sn),mn=Im(In),fn=ox.getState().getCredentials();c("debug",`Using ${fn.type} authentication`);let Gt={};if(I.trim())try{Gt=JSON.parse(I),U(null),c("debug",`Custom inputs provided: ${Object.keys(Gt).join(", ")}`)}catch{throw U("Invalid JSON format"),new Error("Invalid custom_inputs JSON")}ce(null);const Vt=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:mn,messages:Pt,credentials:fn,context:{thread_id:n,user_id:"builder-user"},custom_inputs:Object.keys(Gt).length>0?Gt:void 0})});if(!Vt.ok){const pe=await Vt.json();throw new Error(pe.error||"Chat request failed")}const Yt=(vt=Vt.body)==null?void 0:vt.getReader(),X=new TextDecoder;let ne="",ve="";if(Yt)for(;;){const{done:pe,value:H}=await Yt.read();if(pe)break;ve+=X.decode(H,{stream:!0});const te=ve.split(`
`);ve=te.pop()||"";for(const _ of te)if(_.startsWith("data: "))try{const V=JSON.parse(_.slice(6));switch(V.type){case"log":c(V.level,V.message);break;case"delta":ne+=V.content,o(ne);break;case"custom_outputs":ce(V.data),Y(!0),!B&&V.data&&Object.keys(V.data).length>0&&(O(JSON.stringify(V.data,null,2)),c("info","Auto-populated custom_inputs from custom_outputs"));break;case"done":c("info",`Completed: ${V.response.length} characters`),o(V.response||ne);break;case"error":c("error",V.error),R(V.error),V.trace&&k(V.trace),m();break}}catch{console.warn("Failed to parse SSE message:",_)}}}catch(Pt){const sn=Pt instanceof Error?Pt.message:"Failed to get response";R(sn),c("error",sn),m()}finally{E(!1),(Mt=z.current)==null||Mt.focus()}},Ce=de=>{de.key==="Enter"&&!de.shiftKey&&(de.preventDefault(),Ne())},Me=()=>{u(),R(null),k(null),O(""),Z(!1),ce(null)},He=de=>new Date(de).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),ze=de=>new Date(de).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),$e=de=>{switch(de){case"error":return s.jsx(Vn,{className:"w-3 h-3 text-red-400"});case"warning":return s.jsx(Xa,{className:"w-3 h-3 text-amber-400"});case"debug":return s.jsx(Ou,{className:"w-3 h-3 text-slate-500"});default:return s.jsx(Ka,{className:"w-3 h-3 text-blue-400"})}},Ve=de=>{switch(de){case"error":return"text-red-400";case"warning":return"text-amber-400";case"debug":return"text-slate-500";default:return"text-slate-300"}},tt=r.filter(de=>de.content||de.role==="user"),gt=r.length>0&&r[r.length-1].role==="assistant"&&!r[r.length-1].content;return s.jsxs("div",{className:"flex flex-col h-[70vh]",children:[s.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-slate-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-cyan-500/20 to-blue-500/20",children:s.jsx(wr,{className:"w-5 h-5 text-cyan-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-slate-100",children:"Local Agent Chat"}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[s.jsxs("span",{children:["Testing ",((nt=t.app)==null?void 0:nt.name)||"your agent"," locally"]}),s.jsx("span",{className:"text-slate-600",children:""}),s.jsxs("div",{className:"flex items-center gap-1",title:`Conversation ID: ${n}`,children:[s.jsx(nm,{className:"w-3 h-3"}),s.jsx("span",{className:"font-mono",children:n.slice(-8)})]})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Q,{variant:"ghost",size:"sm",onClick:Me,title:"Start a new conversation",children:[s.jsx(Pe,{className:"w-4 h-4"}),"New Session"]})})]}),s.jsxs("div",{className:"border-b border-slate-700",children:[s.jsxs("button",{onClick:()=>T(!S),className:"w-full flex items-center justify-between p-2 text-xs hover:bg-slate-800/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Un,{className:"w-3.5 h-3.5 text-slate-400"}),s.jsx("span",{className:"text-slate-400",children:"Authentication:"}),s.jsxs("span",{className:"text-slate-300",children:[h==="obo"&&"On-Behalf-Of Token",h==="manual_sp"&&"Service Principal",h==="manual_pat"&&"Personal Access Token"]}),!v()&&h!=="obo"&&s.jsx("span",{className:"text-amber-400 text-xs",children:"(not configured)"})]}),S?s.jsx(Ur,{className:"w-4 h-4 text-slate-400"}):s.jsx(rs,{className:"w-4 h-4 text-slate-400"})]}),S&&s.jsxs("div",{className:"p-3 bg-slate-800/30 space-y-3",children:[s.jsx("div",{className:"flex gap-2",children:["obo","manual_sp","manual_pat"].map(de=>s.jsxs("button",{onClick:()=>w(de),className:`px-3 py-1.5 text-xs rounded-md transition-colors ${h===de?"bg-cyan-500/20 text-cyan-300 border border-cyan-500/50":"bg-slate-700/50 text-slate-400 border border-slate-600 hover:bg-slate-700"}`,children:[de==="obo"&&"OBO Token",de==="manual_sp"&&"Service Principal",de==="manual_pat"&&"PAT"]},de))}),h==="obo"&&s.jsx("p",{className:"text-xs text-slate-500",children:"Uses the On-Behalf-Of token from Databricks Apps. This may have limited scopes."}),h==="manual_sp"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("input",{type:"text",placeholder:"Client ID",value:f,onChange:de=>x(de.target.value),className:"w-full px-3 py-1.5 text-sm bg-slate-900 border border-slate-600 rounded-md text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"}),s.jsx("input",{type:"password",placeholder:"Client Secret",value:g,onChange:de=>d(de.target.value),className:"w-full px-3 py-1.5 text-sm bg-slate-900 border border-slate-600 rounded-md text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]}),h==="manual_pat"&&s.jsx("input",{type:"password",placeholder:"Personal Access Token",value:b,onChange:de=>p(de.target.value),className:"w-full px-3 py-1.5 text-sm bg-slate-900 border border-slate-600 rounded-md text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"})]})]}),s.jsxs("div",{className:"border-b border-slate-700",children:[s.jsxs("button",{onClick:()=>L(!P),className:"w-full flex items-center justify-between p-2 text-xs hover:bg-slate-800/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(nm,{className:"w-3.5 h-3.5 text-slate-400"}),s.jsx("span",{className:"text-slate-400",children:"Custom Inputs:"}),s.jsx("span",{className:"text-slate-300",children:I.trim()?"Configured":"None"}),F&&s.jsxs("span",{className:"text-red-400 text-xs",children:["(",F,")"]})]}),P?s.jsx(Ur,{className:"w-4 h-4 text-slate-400"}):s.jsx(rs,{className:"w-4 h-4 text-slate-400"})]}),P&&s.jsxs("div",{className:"p-3 bg-slate-800/30 space-y-2",children:[s.jsxs("p",{className:"text-xs text-slate-500",children:["Optional JSON object to pass as custom_inputs to the agent. Example: ",'{"genie_conversation_ids": {"my_room": "abc123"}}']}),s.jsx("textarea",{value:I,onChange:de=>{O(de.target.value),U(null),Z(!0)},placeholder:'{"key": "value"}',rows:3,className:`w-full px-3 py-2 text-sm bg-slate-900 border rounded-md text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-1 font-mono ${F?"border-red-500 focus:ring-red-500":"border-slate-600 focus:ring-cyan-500"}`}),!B&&I&&s.jsx("p",{className:"text-xs text-cyan-400 mt-1",children:" Auto-populated from previous response"})]})]}),!je&&s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center p-6 max-w-md",children:[s.jsx(Uc,{className:"w-12 h-12 text-amber-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-100 mb-2",children:"Configuration Required"}),s.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"To chat with your agent locally, you need to:"}),s.jsxs("ul",{className:"text-sm text-slate-400 text-left space-y-2",children:[!J&&s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),"Add at least one agent"]}),!ae&&s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(Vn,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),"Configure orchestration (Supervisor or Swarm)"]})]})]})}),je&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex-1 overflow-y-auto py-4 space-y-4 min-h-0 ${A?"max-h-[30vh]":""}`,children:[tt.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[s.jsx(Zt,{className:"w-16 h-16 text-slate-600 mb-4"}),s.jsx("h4",{className:"text-lg font-medium text-slate-300 mb-2",children:"Start a Conversation"}),s.jsx("p",{className:"text-sm text-slate-500 max-w-sm",children:"Test your agent configuration locally. Messages are processed using the dao-ai library without deploying to an endpoint."}),s.jsx("p",{className:"text-xs text-slate-600 mt-4",children:"Your chat history will be preserved when you close this panel."})]}):tt.map((de,vt)=>s.jsxs("div",{className:`flex gap-3 ${de.role==="user"?"flex-row-reverse":""}`,children:[s.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${de.role==="user"?"bg-blue-500/20":"bg-gradient-to-br from-cyan-500/20 to-purple-500/20"}`,children:de.role==="user"?s.jsx(Yn,{className:"w-4 h-4 text-blue-400"}):s.jsx(Zt,{className:"w-4 h-4 text-cyan-400"})}),s.jsxs("div",{className:`flex flex-col max-w-[80%] ${de.role==="user"?"items-end":"items-start"}`,children:[s.jsx("div",{className:`px-4 py-3 rounded-2xl ${de.role==="user"?"bg-blue-600 text-white rounded-br-md":"bg-slate-800 text-slate-100 rounded-bl-md border border-slate-700"}`,children:s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:de.content})}),s.jsx("span",{className:"text-[10px] text-slate-500 mt-1 px-1",children:He(de.timestamp)})]})]},`${de.timestamp}-${vt}`)),j&&gt&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500/20 to-purple-500/20 flex items-center justify-center",children:s.jsx(Zt,{className:"w-4 h-4 text-cyan-400"})}),s.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl rounded-bl-md px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xt,{className:"w-4 h-4 text-cyan-400 animate-spin"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Generating response..."})]})})]}),s.jsx("div",{ref:q})]}),y&&s.jsxs("div",{className:"px-4 py-3 bg-red-950/30 border border-red-800 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Vn,{className:"w-4 h-4 text-red-400"}),s.jsx("span",{className:"text-sm text-red-300",children:y})]}),$&&s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-slate-500 cursor-pointer hover:text-slate-400",children:"Show details"}),s.jsx("pre",{className:"mt-2 p-2 bg-slate-900 rounded text-xs text-slate-400 overflow-x-auto max-h-32",children:$})]})]}),s.jsxs("div",{className:"pt-4 border-t border-slate-700",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-1 relative",children:s.jsx("textarea",{ref:z,value:N,onChange:de=>C(de.target.value),onKeyDown:Ce,placeholder:"Type your message...",disabled:j,rows:1,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500/50 resize-none disabled:opacity-50",style:{minHeight:"48px",maxHeight:"120px"}})}),s.jsx(Q,{variant:"primary",onClick:Ne,disabled:!N.trim()||j,className:"self-end bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500",children:j?s.jsx(xt,{className:"w-4 h-4 animate-spin"}):s.jsx(Iw,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-[10px] text-slate-600 mt-2 text-center",children:"Press Enter to send  Shift+Enter for new line"})]}),ee&&Object.keys(ee).length>0&&s.jsxs("div",{className:"mt-4 border border-emerald-500/30 rounded-lg overflow-hidden",children:[s.jsxs("button",{onClick:()=>Y(!oe),className:"w-full flex items-center justify-between px-4 py-2 bg-emerald-900/20 hover:bg-emerald-900/30 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ka,{className:"w-4 h-4 text-emerald-400"}),s.jsx("span",{className:"text-sm font-medium text-emerald-300",children:"Custom Outputs"}),s.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-emerald-500/20 text-emerald-400 rounded",children:[Object.keys(ee).length," ",Object.keys(ee).length===1?"key":"keys"]})]}),oe?s.jsx(rs,{className:"w-4 h-4 text-emerald-400"}):s.jsx(Ur,{className:"w-4 h-4 text-emerald-400"})]}),oe&&s.jsx("div",{className:"p-3 bg-emerald-900/10 max-h-40 overflow-y-auto",children:s.jsx("pre",{className:"text-xs text-emerald-300 font-mono whitespace-pre-wrap",children:JSON.stringify(ee,null,2)})})]}),s.jsxs("div",{className:"mt-4 border border-slate-700 rounded-lg overflow-hidden",children:[s.jsxs("button",{onClick:()=>D(!A),className:"w-full flex items-center justify-between px-4 py-2 bg-slate-800/50 hover:bg-slate-800 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ou,{className:"w-4 h-4 text-slate-400"}),s.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Application Logs"}),a.length>0&&s.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-slate-700 text-slate-400 rounded",children:a.length})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[a.length>0&&s.jsx("button",{onClick:de=>{de.stopPropagation(),i()},className:"text-xs text-slate-500 hover:text-slate-300 px-2 py-1",children:"Clear"}),A?s.jsx(rs,{className:"w-4 h-4 text-slate-400"}):s.jsx(Ur,{className:"w-4 h-4 text-slate-400"})]})]}),A&&s.jsx("div",{className:"bg-slate-900/50 max-h-40 overflow-y-auto",children:a.length===0?s.jsxs("div",{className:"px-4 py-6 text-center",children:[s.jsx(Ou,{className:"w-8 h-8 text-slate-700 mx-auto mb-2"}),s.jsx("p",{className:"text-xs text-slate-600",children:"No logs yet. Send a message to see activity."})]}):s.jsxs("div",{className:"divide-y divide-slate-800",children:[a.map((de,vt)=>s.jsxs("div",{className:"px-4 py-2 flex items-start gap-2 hover:bg-slate-800/30",children:[s.jsx("span",{className:"text-[10px] text-slate-600 font-mono whitespace-nowrap pt-0.5",children:ze(de.timestamp)}),s.jsx("div",{className:"pt-0.5",children:$e(de.level)}),s.jsx("span",{className:`text-xs font-mono flex-1 ${Ve(de.level)}`,children:de.message})]},vt)),s.jsx("div",{ref:se})]})})]})]}),e&&s.jsx("div",{className:"pt-4 mt-4 border-t border-slate-700 flex justify-end",children:s.jsx(Q,{variant:"secondary",onClick:e,children:"Close"})})]})}const ix={repo:"natefleming/dao-ai",branch:"main",path:"config"};function KR({isOpen:e,onClose:t,onImportFile:n,onLocalUpload:r}){const[a,l]=M.useState("choose"),[o,c]=M.useState(ix),[i,u]=M.useState(ix.path),[m,h]=M.useState([]),[f,g]=M.useState(!1),[b,w]=M.useState(!1),[x,d]=M.useState(null),[p,v]=M.useState(null);M.useEffect(()=>{(async()=>{w(!0);try{const A=await fetch("/api/github-config");if(A.ok){const D=await A.json();c(D),u(D.path)}}catch(A){console.warn("Failed to fetch GitHub config, using defaults:",A)}finally{w(!1)}})()},[]),M.useEffect(()=>{if(a!=="github"||b)return;(async()=>{g(!0),d(null);try{const A=`https://api.github.com/repos/${o.repo}/contents/${i}?ref=${o.branch}`,D=await fetch(A);if(!D.ok)throw D.status===404?new Error("Path not found in repository"):D.status===403?new Error("API rate limit exceeded. Please try again later."):new Error(`GitHub API error: ${D.status}`);const S=await D.json(),T=(Array.isArray(S)?S:[S]).filter(P=>P.type==="dir"||P.name.endsWith(".yaml")||P.name.endsWith(".yml")).sort((P,L)=>P.type!==L.type?P.type==="dir"?-1:1:P.name.localeCompare(L.name));h(T)}catch(A){d(A instanceof Error?A.message:"Failed to fetch repository contents"),h([])}finally{g(!1)}})()},[i,o.repo,o.branch,a,b]);const N=async k=>{if(k.type==="dir")u(k.path);else if(k.download_url){v(k.name);try{const A=await fetch(k.download_url);if(!A.ok)throw new Error("Failed to download file");const D=await A.text();n(D,k.name),t()}catch(A){d(A instanceof Error?A.message:"Failed to download file")}finally{v(null)}}},C=()=>{const k=i.split("/");k.length>1&&(k.pop(),u(k.join("/")))},j=()=>{r(),t()},E=()=>{l("choose"),u(o.path),d(null)};M.useEffect(()=>{e&&(l("choose"),u(o.path),d(null))},[e,o.path]);const y=i.split("/"),R=o.path.split("/"),$=y.length>R.length;return s.jsx(An,{isOpen:e,onClose:t,title:"Import Configuration",size:"lg",children:a==="choose"?s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-400",children:"Choose how you want to import a configuration file:"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("button",{onClick:j,className:"flex flex-col items-center gap-3 p-6 rounded-lg border border-slate-700 bg-slate-800/50 hover:bg-slate-800 hover:border-slate-600 transition-colors",children:[s.jsx("div",{className:"p-3 rounded-full bg-blue-500/20",children:s.jsx(Pv,{className:"w-6 h-6 text-blue-400"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-100",children:"Upload File"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Import a YAML file from your computer"})]})]}),s.jsxs("button",{onClick:()=>l("github"),className:"flex flex-col items-center gap-3 p-6 rounded-lg border border-slate-700 bg-slate-800/50 hover:bg-slate-800 hover:border-slate-600 transition-colors",children:[s.jsx("div",{className:"p-3 rounded-full bg-purple-500/20",children:s.jsx(wp,{className:"w-6 h-6 text-purple-400"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-100",children:"Browse GitHub"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Load a template from the dao-ai repository"})]})]})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:E,children:s.jsx(yp,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[s.jsx(wp,{className:"w-4 h-4"}),s.jsx("span",{children:o.repo}),s.jsx(jp,{className:"w-3 h-3"}),s.jsx("span",{className:"text-slate-300",children:i})]})]}),$&&s.jsxs("button",{onClick:C,className:"flex items-center gap-2 text-sm text-cyan-400 hover:text-cyan-300 transition-colors",children:[s.jsx(yp,{className:"w-4 h-4"}),"Back to parent directory"]}),x&&s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:[s.jsx(Xa,{className:"w-4 h-4 flex-shrink-0"}),x]}),f&&s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(xt,{className:"w-6 h-6 text-cyan-400 animate-spin"}),s.jsx("span",{className:"ml-2 text-slate-400",children:"Loading..."})]}),!f&&m.length>0&&s.jsx("div",{className:"max-h-80 overflow-y-auto space-y-1 border border-slate-700 rounded-lg p-2",children:m.map(k=>s.jsxs("button",{onClick:()=>N(k),disabled:p!==null,className:`w-full flex items-center gap-3 px-3 py-2 rounded-md text-left transition-colors ${p===k.name?"bg-cyan-500/20 text-cyan-300":"hover:bg-slate-800 text-slate-300"}`,children:[p===k.name?s.jsx(xt,{className:"w-4 h-4 animate-spin text-cyan-400"}):k.type==="dir"?s.jsx(Aw,{className:"w-4 h-4 text-amber-400"}):s.jsx(Qa,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm",children:k.name}),k.type==="dir"&&s.jsx(jp,{className:"w-4 h-4 text-slate-500 ml-auto"})]},k.path))}),!f&&!x&&m.length===0&&s.jsx("div",{className:"text-center py-8 text-slate-500",children:"No YAML files found in this directory"})]})})}function ZR({showPreview:e,onTogglePreview:t}){var k,A,D,S,T;const{config:n,setConfig:r,reset:a}=We(),{startNewSession:l}=Ob(),o=M.useRef(null),[c,i]=M.useState(null),[u,m]=M.useState(!1),[h,f]=M.useState(!1),[g,b]=M.useState(!1),[w,x]=M.useState(!1),d=Object.keys(n.agents||{}).length>0,p=!!((A=(k=n.app)==null?void 0:k.orchestration)!=null&&A.supervisor||(S=(D=n.app)==null?void 0:D.orchestration)!=null&&S.swarm),v=d&&p,N=d;M.useEffect(()=>{fetch("/api/version").then(P=>P.json()).then(P=>i(P.dao_ai)).catch(()=>i(null))},[]);const C=()=>{var L;const P=((L=n.app)==null?void 0:L.name)||"model_config";g2(n,`${P}.yaml`)},j=(P,L)=>{try{const I=jb(P);_b(I),console.log(`[Import from ${L}] Extracted YAML references:`,I);const O=Bs.load(P);if(O.memory&&I.anchorPaths){const F=I.anchors.find(U=>U.path==="memory");F&&(O.memory.refName=F.name,console.log("[Import] Set memory refName to:",F.name))}hm(),r(O),l(),console.log(`[Import from ${L}] Started new chat session for imported config`)}catch(I){console.error("Failed to parse YAML:",I),alert("Failed to parse YAML file. Please check the format.")}},E=P=>{var O;const L=(O=P.target.files)==null?void 0:O[0];if(!L)return;const I=new FileReader;I.onload=F=>{var B;const U=(B=F.target)==null?void 0:B.result;j(U,`file: ${L.name}`)},I.readAsText(L),o.current&&(o.current.value="")},y=(P,L)=>{j(P,`GitHub: ${L}`)},R=()=>{var P;(P=o.current)==null||P.click()},$=()=>{confirm("Are you sure you want to reset all configuration? This cannot be undone.")&&(a2(),hm(),a(),l())};return s.jsxs("header",{className:"h-16 bg-slate-900 border-b border-slate-800 px-6 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg shadow-blue-500/20",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h1",{className:"text-lg font-bold text-white",children:"DAO AI Builder"}),c&&s.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-slate-700 text-slate-400 rounded",children:["v",c]})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Agent Configuration Studio"})]})]}),((T=n.app)==null?void 0:T.name)&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-cyan-500/10 to-blue-500/10 border border-cyan-500/30 rounded-lg",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-cyan-400 animate-pulse"}),s.jsx("span",{className:"text-sm font-medium text-cyan-300",children:n.app.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(zC,{}),s.jsx("div",{className:"w-px h-6 bg-slate-700"}),s.jsx("input",{ref:o,type:"file",accept:".yaml,.yml",onChange:E,className:"hidden"}),s.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>x(!0),children:[s.jsx(Pv,{className:"w-4 h-4"}),"Import"]}),s.jsxs(Q,{variant:"ghost",size:"sm",onClick:$,children:[s.jsx(Tw,{className:"w-4 h-4"}),"Reset"]}),s.jsx("div",{className:"w-px h-6 bg-slate-700"}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:t,children:[e?s.jsx(kw,{className:"w-4 h-4"}):s.jsx(Ew,{className:"w-4 h-4"}),e?"Hide":"Show"," Preview"]}),s.jsxs(Q,{variant:"primary",size:"sm",onClick:C,children:[s.jsx(Rv,{className:"w-4 h-4"}),"Export YAML"]}),s.jsx("div",{className:"w-px h-6 bg-slate-700"}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>m(!0),disabled:!d,title:d?"Visualize agent graph":"Add agents to visualize",children:[s.jsx(Ro,{className:"w-4 h-4"}),"Visualize"]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>b(!0),disabled:!N,title:N?"Test agent locally":"Add agents to chat",className:"bg-gradient-to-r from-cyan-600/80 to-blue-600/80 hover:from-cyan-500 hover:to-blue-500 text-white border-0",children:[s.jsx(wr,{className:"w-4 h-4"}),"Chat"]}),s.jsxs(Q,{variant:"primary",size:"sm",onClick:()=>f(!0),disabled:!v,title:v?"Deploy to Databricks":"Configure agents and orchestration first",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500",children:[s.jsx(am,{className:"w-4 h-4"}),"Deploy"]})]}),s.jsx(An,{isOpen:u,onClose:()=>m(!1),title:"Application Visualization",description:"Interactive graph showing agent relationships and orchestration flow",size:"full",children:s.jsx("div",{className:"h-[70vh]",children:s.jsx(BR,{config:n})})}),s.jsx(An,{isOpen:h,onClose:()=>f(!1),title:"Deploy to Databricks",description:"Deploy your agent configuration to a Databricks workspace",size:"lg",children:s.jsx(XR,{onClose:()=>f(!1)})}),s.jsx(An,{isOpen:g,onClose:()=>b(!1),title:"Chat with Agent",description:"Test your agent configuration locally without deploying",size:"lg",children:s.jsx(QR,{onClose:()=>b(!1)})}),s.jsx(KR,{isOpen:w,onClose:()=>x(!1),onImportFile:y,onLocalUpload:R})]})}const JR={error:Xa,warning:Uc,success:Av,info:Ka},eM={error:"bg-red-500/10 border-red-500/30 text-red-400",warning:"bg-amber-500/10 border-amber-500/30 text-amber-400",success:"bg-emerald-500/10 border-emerald-500/30 text-emerald-400",info:"bg-blue-500/10 border-blue-500/30 text-blue-400"};function tM(){const{notifications:e,removeNotification:t}=Cb();return e.length===0?null:s.jsx("div",{className:"fixed bottom-4 right-4 z-50 flex flex-col gap-2 max-w-md",children:e.map(n=>{const r=JR[n.type],a=eM[n.type];return s.jsx("div",{className:`${a} border rounded-lg p-4 shadow-lg backdrop-blur-sm animate-in slide-in-from-right duration-300`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(r,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium",children:n.message}),n.details&&s.jsx("p",{className:"text-sm opacity-80 mt-1 whitespace-pre-wrap",children:n.details})]}),s.jsx("button",{onClick:()=>t(n.id),className:"flex-shrink-0 p-1 hover:opacity-70 transition-opacity",children:s.jsx(qr,{className:"w-4 h-4"})})]})},n.id)})})}function nM({onResize:e,onResizeEnd:t}){const[n,r]=M.useState(!1),[a,l]=M.useState(0),o=M.useCallback(u=>{u.preventDefault(),r(!0),l(u.clientX)},[]),c=M.useCallback(u=>{if(!n)return;const m=u.clientX-a;l(u.clientX),e(m)},[n,a,e]),i=M.useCallback(()=>{n&&(r(!1),t==null||t())},[n,t]);return M.useEffect(()=>(n&&(document.addEventListener("mousemove",c),document.addEventListener("mouseup",i),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",i),document.body.style.cursor="",document.body.style.userSelect=""}),[n,c,i]),s.jsx("div",{onMouseDown:o,className:`
        w-2 flex-shrink-0 cursor-col-resize
        flex items-center justify-center
        transition-colors duration-150
        ${n?"bg-blue-500/30":"bg-slate-800 hover:bg-slate-700"}
      `,children:s.jsx("div",{className:`
        flex flex-col gap-0.5 py-2 rounded
        ${n?"opacity-100":"opacity-40 hover:opacity-100"}
        transition-opacity duration-150
      `,children:s.jsx(Rw,{className:"w-3 h-3 text-slate-400"})})})}const sM=300,rM=800,aM=500;function lM(){const[e,t]=M.useState("overview"),[n,r]=M.useState(!0),[a,l]=M.useState(aM),{config:o}=We(),c=M.useCallback(i=>{l(u=>{const m=u-i;return Math.min(rM,Math.max(sM,m))})},[]);return s.jsxs("div",{className:"h-screen flex flex-col bg-slate-900",children:[s.jsx(ZR,{showPreview:n,onTogglePreview:()=>r(!n)}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx(Dw,{activeSection:e,onSectionChange:t,config:o}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx("div",{className:"flex-1 flex flex-col min-h-0 min-w-0",children:s.jsx(MC,{activeSection:e,onNavigate:t})}),n&&s.jsx(nM,{onResize:c}),n&&s.jsx("div",{className:"overflow-hidden flex-shrink-0",style:{width:a},children:s.jsx(IC,{})})]})]}),s.jsx(tM,{})]})}ld.createRoot(document.getElementById("root")).render(s.jsx(Vm.StrictMode,{children:s.jsx(lM,{})}));
//# sourceMappingURL=index-BD5bnIqu.js.map
