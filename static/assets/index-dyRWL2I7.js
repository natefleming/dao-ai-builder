(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function h0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var p0={exports:{}},Bi={},x0={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zl=Symbol.for("react.element"),Wb=Symbol.for("react.portal"),Gb=Symbol.for("react.fragment"),qb=Symbol.for("react.strict_mode"),Xb=Symbol.for("react.profiler"),Qb=Symbol.for("react.provider"),Kb=Symbol.for("react.context"),Zb=Symbol.for("react.forward_ref"),Jb=Symbol.for("react.suspense"),eN=Symbol.for("react.memo"),tN=Symbol.for("react.lazy"),vf=Symbol.iterator;function nN(e){return e===null||typeof e!="object"?null:(e=vf&&e[vf]||e["@@iterator"],typeof e=="function"?e:null)}var g0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v0=Object.assign,y0={};function ka(e,t,n){this.props=e,this.context=t,this.refs=y0,this.updater=n||g0}ka.prototype.isReactComponent={};ka.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ka.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b0(){}b0.prototype=ka.prototype;function Ud(e,t,n){this.props=e,this.context=t,this.refs=y0,this.updater=n||g0}var Bd=Ud.prototype=new b0;Bd.constructor=Ud;v0(Bd,ka.prototype);Bd.isPureReactComponent=!0;var yf=Array.isArray,N0=Object.prototype.hasOwnProperty,Yd={current:null},j0={key:!0,ref:!0,__self:!0,__source:!0};function w0(e,t,n){var r,a={},l=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(l=""+t.key),t)N0.call(t,r)&&!j0.hasOwnProperty(r)&&(a[r]=t[r]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var c=Array(i),u=0;u<i;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(r in i=e.defaultProps,i)a[r]===void 0&&(a[r]=i[r]);return{$$typeof:zl,type:e,key:l,ref:o,props:a,_owner:Yd.current}}function sN(e,t){return{$$typeof:zl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Wd(e){return typeof e=="object"&&e!==null&&e.$$typeof===zl}function rN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var bf=/\/+/g;function wc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?rN(""+e.key):t.toString(36)}function Oo(e,t,n,r,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case zl:case Wb:o=!0}}if(o)return o=e,a=a(o),e=r===""?"."+wc(o,0):r,yf(a)?(n="",e!=null&&(n=e.replace(bf,"$&/")+"/"),Oo(a,t,n,"",function(u){return u})):a!=null&&(Wd(a)&&(a=sN(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(bf,"$&/")+"/")+e)),t.push(a)),1;if(o=0,r=r===""?".":r+":",yf(e))for(var i=0;i<e.length;i++){l=e[i];var c=r+wc(l,i);o+=Oo(l,t,n,c,a)}else if(c=nN(e),typeof c=="function")for(e=c.call(e),i=0;!(l=e.next()).done;)l=l.value,c=r+wc(l,i++),o+=Oo(l,t,n,c,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function no(e,t,n){if(e==null)return e;var r=[],a=0;return Oo(e,r,"","",function(l){return t.call(n,l,a++)}),r}function aN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rt={current:null},Io={transition:null},lN={ReactCurrentDispatcher:Rt,ReactCurrentBatchConfig:Io,ReactCurrentOwner:Yd};function _0(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:no,forEach:function(e,t,n){no(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return no(e,function(){t++}),t},toArray:function(e){return no(e,function(t){return t})||[]},only:function(e){if(!Wd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=ka;ke.Fragment=Gb;ke.Profiler=Xb;ke.PureComponent=Ud;ke.StrictMode=qb;ke.Suspense=Jb;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lN;ke.act=_0;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=v0({},e.props),a=e.key,l=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,o=Yd.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(c in t)N0.call(t,c)&&!j0.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&i!==void 0?i[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){i=Array(c);for(var u=0;u<c;u++)i[u]=arguments[u+2];r.children=i}return{$$typeof:zl,type:e.type,key:a,ref:l,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:Kb,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Qb,_context:e},e.Consumer=e};ke.createElement=w0;ke.createFactory=function(e){var t=w0.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:Zb,render:e}};ke.isValidElement=Wd;ke.lazy=function(e){return{$$typeof:tN,_payload:{_status:-1,_result:e},_init:aN}};ke.memo=function(e,t){return{$$typeof:eN,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=Io.transition;Io.transition={};try{e()}finally{Io.transition=t}};ke.unstable_act=_0;ke.useCallback=function(e,t){return Rt.current.useCallback(e,t)};ke.useContext=function(e){return Rt.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return Rt.current.useDeferredValue(e)};ke.useEffect=function(e,t){return Rt.current.useEffect(e,t)};ke.useId=function(){return Rt.current.useId()};ke.useImperativeHandle=function(e,t,n){return Rt.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return Rt.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return Rt.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return Rt.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return Rt.current.useReducer(e,t,n)};ke.useRef=function(e){return Rt.current.useRef(e)};ke.useState=function(e){return Rt.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return Rt.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return Rt.current.useTransition()};ke.version="18.3.1";x0.exports=ke;var R=x0.exports;const Gd=h0(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oN=R,iN=Symbol.for("react.element"),cN=Symbol.for("react.fragment"),uN=Object.prototype.hasOwnProperty,dN=oN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mN={key:!0,ref:!0,__self:!0,__source:!0};function S0(e,t,n){var r,a={},l=null,o=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)uN.call(t,r)&&!mN.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:iN,type:e,key:l,ref:o,props:a,_owner:dN.current}}Bi.Fragment=cN;Bi.jsx=S0;Bi.jsxs=S0;p0.exports=Bi;var s=p0.exports,bu={},k0={exports:{}},Jt={},C0={exports:{}},E0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,M){var D=P.length;P.push(M);e:for(;0<D;){var V=D-1>>>1,B=P[V];if(0<a(B,M))P[V]=M,P[D]=B,D=V;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var M=P[0],D=P.pop();if(D!==M){P[0]=D;e:for(var V=0,B=P.length,K=B>>>1;V<K;){var J=2*(V+1)-1,ae=P[J],U=J+1,Y=P[U];if(0>a(ae,D))U<B&&0>a(Y,ae)?(P[V]=Y,P[U]=D,V=U):(P[V]=ae,P[J]=D,V=J);else if(U<B&&0>a(Y,D))P[V]=Y,P[U]=D,V=U;else break e}}return M}function a(P,M){var D=P.sortIndex-M.sortIndex;return D!==0?D:P.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,i=o.now();e.unstable_now=function(){return o.now()-i}}var c=[],u=[],m=1,d=null,f=3,p=!1,v=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(P){for(var M=n(u);M!==null;){if(M.callback===null)r(u);else if(M.startTime<=P)r(u),M.sortIndex=M.expirationTime,t(c,M);else break;M=n(u)}}function w(P){if(b=!1,y(P),!v)if(n(c)!==null)v=!0,I(E);else{var M=n(u);M!==null&&$(w,M.startTime-P)}}function E(P,M){v=!1,b&&(b=!1,h(N),N=-1),p=!0;var D=f;try{for(y(M),d=n(c);d!==null&&(!(d.expirationTime>M)||P&&!C());){var V=d.callback;if(typeof V=="function"){d.callback=null,f=d.priorityLevel;var B=V(d.expirationTime<=M);M=e.unstable_now(),typeof B=="function"?d.callback=B:d===n(c)&&r(c),y(M)}else r(c);d=n(c)}if(d!==null)var K=!0;else{var J=n(u);J!==null&&$(w,J.startTime-M),K=!1}return K}finally{d=null,f=D,p=!1}}var _=!1,S=null,N=-1,k=5,A=-1;function C(){return!(e.unstable_now()-A<k)}function O(){if(S!==null){var P=e.unstable_now();A=P;var M=!0;try{M=S(!0,P)}finally{M?F():(_=!1,S=null)}}else _=!1}var F;if(typeof g=="function")F=function(){g(O)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,T=j.port2;j.port1.onmessage=O,F=function(){T.postMessage(null)}}else F=function(){x(O,0)};function I(P){S=P,_||(_=!0,F())}function $(P,M){N=x(function(){P(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,I(E))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(P){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var D=f;f=M;try{return P()}finally{f=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,M){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var D=f;f=P;try{return M()}finally{f=D}},e.unstable_scheduleCallback=function(P,M,D){var V=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?V+D:V):D=V,P){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=D+B,P={id:m++,callback:M,priorityLevel:P,startTime:D,expirationTime:B,sortIndex:-1},D>V?(P.sortIndex=D,t(u,P),n(c)===null&&P===n(u)&&(b?(h(N),N=-1):b=!0,$(w,D-V))):(P.sortIndex=B,t(c,P),v||p||(v=!0,I(E))),P},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(P){var M=f;return function(){var D=f;f=M;try{return P.apply(this,arguments)}finally{f=D}}}})(E0);C0.exports=E0;var fN=C0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hN=R,Kt=fN;function se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var A0=new Set,ll={};function Ar(e,t){ca(e,t),ca(e+"Capture",t)}function ca(e,t){for(ll[e]=t,e=0;e<t.length;e++)A0.add(t[e])}var gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nu=Object.prototype.hasOwnProperty,pN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nf={},jf={};function xN(e){return Nu.call(jf,e)?!0:Nu.call(Nf,e)?!1:pN.test(e)?jf[e]=!0:(Nf[e]=!0,!1)}function gN(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vN(e,t,n,r){if(t===null||typeof t>"u"||gN(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Mt(e,t,n,r,a,l,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=o}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yt[e]=new Mt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yt[t]=new Mt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yt[e]=new Mt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yt[e]=new Mt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yt[e]=new Mt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yt[e]=new Mt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yt[e]=new Mt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yt[e]=new Mt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yt[e]=new Mt(e,5,!1,e.toLowerCase(),null,!1,!1)});var qd=/[\-:]([a-z])/g;function Xd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(qd,Xd);yt[t]=new Mt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(qd,Xd);yt[t]=new Mt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(qd,Xd);yt[t]=new Mt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Mt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yt[e]=new Mt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Qd(e,t,n,r){var a=yt.hasOwnProperty(t)?yt[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vN(t,n,a,r)&&(n=null),r||a===null?xN(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Ss=hN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,so=Symbol.for("react.element"),Lr=Symbol.for("react.portal"),$r=Symbol.for("react.fragment"),Kd=Symbol.for("react.strict_mode"),ju=Symbol.for("react.profiler"),P0=Symbol.for("react.provider"),R0=Symbol.for("react.context"),Zd=Symbol.for("react.forward_ref"),wu=Symbol.for("react.suspense"),_u=Symbol.for("react.suspense_list"),Jd=Symbol.for("react.memo"),Ps=Symbol.for("react.lazy"),M0=Symbol.for("react.offscreen"),wf=Symbol.iterator;function Aa(e){return e===null||typeof e!="object"?null:(e=wf&&e[wf]||e["@@iterator"],typeof e=="function"?e:null)}var qe=Object.assign,_c;function za(e){if(_c===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);_c=t&&t[1]||""}return`
`+_c+e}var Sc=!1;function kc(e,t){if(!e||Sc)return"";Sc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),l=r.stack.split(`
`),o=a.length-1,i=l.length-1;1<=o&&0<=i&&a[o]!==l[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==l[i]){if(o!==1||i!==1)do if(o--,i--,0>i||a[o]!==l[i]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=i);break}}}finally{Sc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?za(e):""}function yN(e){switch(e.tag){case 5:return za(e.type);case 16:return za("Lazy");case 13:return za("Suspense");case 19:return za("SuspenseList");case 0:case 2:case 15:return e=kc(e.type,!1),e;case 11:return e=kc(e.type.render,!1),e;case 1:return e=kc(e.type,!0),e;default:return""}}function Su(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $r:return"Fragment";case Lr:return"Portal";case ju:return"Profiler";case Kd:return"StrictMode";case wu:return"Suspense";case _u:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case R0:return(e.displayName||"Context")+".Consumer";case P0:return(e._context.displayName||"Context")+".Provider";case Zd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Jd:return t=e.displayName||null,t!==null?t:Su(e.type)||"Memo";case Ps:t=e._payload,e=e._init;try{return Su(e(t))}catch{}}return null}function bN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Su(t);case 8:return t===Kd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ws(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function T0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function NN(e){var t=T0(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,l.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ro(e){e._valueTracker||(e._valueTracker=NN(e))}function O0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=T0(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Jo(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ku(e,t){var n=t.checked;return qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function _f(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ws(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function I0(e,t){t=t.checked,t!=null&&Qd(e,"checked",t,!1)}function Cu(e,t){I0(e,t);var n=Ws(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Eu(e,t.type,n):t.hasOwnProperty("defaultValue")&&Eu(e,t.type,Ws(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Sf(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Eu(e,t,n){(t!=="number"||Jo(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Va=Array.isArray;function Jr(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ws(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Au(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(se(91));return qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function kf(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(se(92));if(Va(n)){if(1<n.length)throw Error(se(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ws(n)}}function L0(e,t){var n=Ws(t.value),r=Ws(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Cf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $0(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$0(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ao,D0=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ao=ao||document.createElement("div"),ao.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ao.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ol(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var qa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jN=["Webkit","ms","Moz","O"];Object.keys(qa).forEach(function(e){jN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),qa[t]=qa[e]})});function F0(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||qa.hasOwnProperty(e)&&qa[e]?(""+t).trim():t+"px"}function z0(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=F0(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var wN=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ru(e,t){if(t){if(wN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(se(62))}}function Mu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tu=null;function em(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ou=null,ea=null,ta=null;function Ef(e){if(e=Ul(e)){if(typeof Ou!="function")throw Error(se(280));var t=e.stateNode;t&&(t=Xi(t),Ou(e.stateNode,e.type,t))}}function V0(e){ea?ta?ta.push(e):ta=[e]:ea=e}function H0(){if(ea){var e=ea,t=ta;if(ta=ea=null,Ef(e),t)for(e=0;e<t.length;e++)Ef(t[e])}}function U0(e,t){return e(t)}function B0(){}var Cc=!1;function Y0(e,t,n){if(Cc)return e(t,n);Cc=!0;try{return U0(e,t,n)}finally{Cc=!1,(ea!==null||ta!==null)&&(B0(),H0())}}function il(e,t){var n=e.stateNode;if(n===null)return null;var r=Xi(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(se(231,t,typeof n));return n}var Iu=!1;if(gs)try{var Pa={};Object.defineProperty(Pa,"passive",{get:function(){Iu=!0}}),window.addEventListener("test",Pa,Pa),window.removeEventListener("test",Pa,Pa)}catch{Iu=!1}function _N(e,t,n,r,a,l,o,i,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(m){this.onError(m)}}var Xa=!1,ei=null,ti=!1,Lu=null,SN={onError:function(e){Xa=!0,ei=e}};function kN(e,t,n,r,a,l,o,i,c){Xa=!1,ei=null,_N.apply(SN,arguments)}function CN(e,t,n,r,a,l,o,i,c){if(kN.apply(this,arguments),Xa){if(Xa){var u=ei;Xa=!1,ei=null}else throw Error(se(198));ti||(ti=!0,Lu=u)}}function Pr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function W0(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Af(e){if(Pr(e)!==e)throw Error(se(188))}function EN(e){var t=e.alternate;if(!t){if(t=Pr(e),t===null)throw Error(se(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return Af(a),e;if(l===r)return Af(a),t;l=l.sibling}throw Error(se(188))}if(n.return!==r.return)n=a,r=l;else{for(var o=!1,i=a.child;i;){if(i===n){o=!0,n=a,r=l;break}if(i===r){o=!0,r=a,n=l;break}i=i.sibling}if(!o){for(i=l.child;i;){if(i===n){o=!0,n=l,r=a;break}if(i===r){o=!0,r=l,n=a;break}i=i.sibling}if(!o)throw Error(se(189))}}if(n.alternate!==r)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?e:t}function G0(e){return e=EN(e),e!==null?q0(e):null}function q0(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=q0(e);if(t!==null)return t;e=e.sibling}return null}var X0=Kt.unstable_scheduleCallback,Pf=Kt.unstable_cancelCallback,AN=Kt.unstable_shouldYield,PN=Kt.unstable_requestPaint,Ke=Kt.unstable_now,RN=Kt.unstable_getCurrentPriorityLevel,tm=Kt.unstable_ImmediatePriority,Q0=Kt.unstable_UserBlockingPriority,ni=Kt.unstable_NormalPriority,MN=Kt.unstable_LowPriority,K0=Kt.unstable_IdlePriority,Yi=null,Zn=null;function TN(e){if(Zn&&typeof Zn.onCommitFiberRoot=="function")try{Zn.onCommitFiberRoot(Yi,e,void 0,(e.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:LN,ON=Math.log,IN=Math.LN2;function LN(e){return e>>>=0,e===0?32:31-(ON(e)/IN|0)|0}var lo=64,oo=4194304;function Ha(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function si(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,l=e.pingedLanes,o=n&268435455;if(o!==0){var i=o&~a;i!==0?r=Ha(i):(l&=o,l!==0&&(r=Ha(l)))}else o=n&~a,o!==0?r=Ha(o):l!==0&&(r=Ha(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Sn(t),a=1<<n,r|=e[n],t&=~a;return r}function $N(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function DN(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var o=31-Sn(l),i=1<<o,c=a[o];c===-1?(!(i&n)||i&r)&&(a[o]=$N(i,t)):c<=t&&(e.expiredLanes|=i),l&=~i}}function $u(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Z0(){var e=lo;return lo<<=1,!(lo&4194240)&&(lo=64),e}function Ec(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Vl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Sn(t),e[t]=n}function FN(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Sn(n),l=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~l}}function nm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Sn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Me=0;function J0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ex,sm,tx,nx,sx,Du=!1,io=[],Ls=null,$s=null,Ds=null,cl=new Map,ul=new Map,Ms=[],zN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rf(e,t){switch(e){case"focusin":case"focusout":Ls=null;break;case"dragenter":case"dragleave":$s=null;break;case"mouseover":case"mouseout":Ds=null;break;case"pointerover":case"pointerout":cl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ul.delete(t.pointerId)}}function Ra(e,t,n,r,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[a]},t!==null&&(t=Ul(t),t!==null&&sm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function VN(e,t,n,r,a){switch(t){case"focusin":return Ls=Ra(Ls,e,t,n,r,a),!0;case"dragenter":return $s=Ra($s,e,t,n,r,a),!0;case"mouseover":return Ds=Ra(Ds,e,t,n,r,a),!0;case"pointerover":var l=a.pointerId;return cl.set(l,Ra(cl.get(l)||null,e,t,n,r,a)),!0;case"gotpointercapture":return l=a.pointerId,ul.set(l,Ra(ul.get(l)||null,e,t,n,r,a)),!0}return!1}function rx(e){var t=ir(e.target);if(t!==null){var n=Pr(t);if(n!==null){if(t=n.tag,t===13){if(t=W0(n),t!==null){e.blockedOn=t,sx(e.priority,function(){tx(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Lo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Fu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Tu=r,n.target.dispatchEvent(r),Tu=null}else return t=Ul(n),t!==null&&sm(t),e.blockedOn=n,!1;t.shift()}return!0}function Mf(e,t,n){Lo(e)&&n.delete(t)}function HN(){Du=!1,Ls!==null&&Lo(Ls)&&(Ls=null),$s!==null&&Lo($s)&&($s=null),Ds!==null&&Lo(Ds)&&(Ds=null),cl.forEach(Mf),ul.forEach(Mf)}function Ma(e,t){e.blockedOn===t&&(e.blockedOn=null,Du||(Du=!0,Kt.unstable_scheduleCallback(Kt.unstable_NormalPriority,HN)))}function dl(e){function t(a){return Ma(a,e)}if(0<io.length){Ma(io[0],e);for(var n=1;n<io.length;n++){var r=io[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ls!==null&&Ma(Ls,e),$s!==null&&Ma($s,e),Ds!==null&&Ma(Ds,e),cl.forEach(t),ul.forEach(t),n=0;n<Ms.length;n++)r=Ms[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ms.length&&(n=Ms[0],n.blockedOn===null);)rx(n),n.blockedOn===null&&Ms.shift()}var na=Ss.ReactCurrentBatchConfig,ri=!0;function UN(e,t,n,r){var a=Me,l=na.transition;na.transition=null;try{Me=1,rm(e,t,n,r)}finally{Me=a,na.transition=l}}function BN(e,t,n,r){var a=Me,l=na.transition;na.transition=null;try{Me=4,rm(e,t,n,r)}finally{Me=a,na.transition=l}}function rm(e,t,n,r){if(ri){var a=Fu(e,t,n,r);if(a===null)Dc(e,t,r,ai,n),Rf(e,r);else if(VN(a,e,t,n,r))r.stopPropagation();else if(Rf(e,r),t&4&&-1<zN.indexOf(e)){for(;a!==null;){var l=Ul(a);if(l!==null&&ex(l),l=Fu(e,t,n,r),l===null&&Dc(e,t,r,ai,n),l===a)break;a=l}a!==null&&r.stopPropagation()}else Dc(e,t,r,null,n)}}var ai=null;function Fu(e,t,n,r){if(ai=null,e=em(r),e=ir(e),e!==null)if(t=Pr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=W0(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ai=e,null}function ax(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RN()){case tm:return 1;case Q0:return 4;case ni:case MN:return 16;case K0:return 536870912;default:return 16}default:return 16}}var Os=null,am=null,$o=null;function lx(){if($o)return $o;var e,t=am,n=t.length,r,a="value"in Os?Os.value:Os.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===a[l-r];r++);return $o=a.slice(e,1<r?1-r:void 0)}function Do(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function co(){return!0}function Tf(){return!1}function en(e){function t(n,r,a,l,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?co:Tf,this.isPropagationStopped=Tf,this}return qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=co)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=co)},persist:function(){},isPersistent:co}),t}var Ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lm=en(Ca),Hl=qe({},Ca,{view:0,detail:0}),YN=en(Hl),Ac,Pc,Ta,Wi=qe({},Hl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:om,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ta&&(Ta&&e.type==="mousemove"?(Ac=e.screenX-Ta.screenX,Pc=e.screenY-Ta.screenY):Pc=Ac=0,Ta=e),Ac)},movementY:function(e){return"movementY"in e?e.movementY:Pc}}),Of=en(Wi),WN=qe({},Wi,{dataTransfer:0}),GN=en(WN),qN=qe({},Hl,{relatedTarget:0}),Rc=en(qN),XN=qe({},Ca,{animationName:0,elapsedTime:0,pseudoElement:0}),QN=en(XN),KN=qe({},Ca,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ZN=en(KN),JN=qe({},Ca,{data:0}),If=en(JN),ej={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nj[e])?!!t[e]:!1}function om(){return sj}var rj=qe({},Hl,{key:function(e){if(e.key){var t=ej[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Do(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:om,charCode:function(e){return e.type==="keypress"?Do(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Do(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),aj=en(rj),lj=qe({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lf=en(lj),oj=qe({},Hl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:om}),ij=en(oj),cj=qe({},Ca,{propertyName:0,elapsedTime:0,pseudoElement:0}),uj=en(cj),dj=qe({},Wi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),mj=en(dj),fj=[9,13,27,32],im=gs&&"CompositionEvent"in window,Qa=null;gs&&"documentMode"in document&&(Qa=document.documentMode);var hj=gs&&"TextEvent"in window&&!Qa,ox=gs&&(!im||Qa&&8<Qa&&11>=Qa),$f=" ",Df=!1;function ix(e,t){switch(e){case"keyup":return fj.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Dr=!1;function pj(e,t){switch(e){case"compositionend":return cx(t);case"keypress":return t.which!==32?null:(Df=!0,$f);case"textInput":return e=t.data,e===$f&&Df?null:e;default:return null}}function xj(e,t){if(Dr)return e==="compositionend"||!im&&ix(e,t)?(e=lx(),$o=am=Os=null,Dr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ox&&t.locale!=="ko"?null:t.data;default:return null}}var gj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ff(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!gj[e.type]:t==="textarea"}function ux(e,t,n,r){V0(r),t=li(t,"onChange"),0<t.length&&(n=new lm("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ka=null,ml=null;function vj(e){Nx(e,0)}function Gi(e){var t=Vr(e);if(O0(t))return e}function yj(e,t){if(e==="change")return t}var dx=!1;if(gs){var Mc;if(gs){var Tc="oninput"in document;if(!Tc){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),Tc=typeof zf.oninput=="function"}Mc=Tc}else Mc=!1;dx=Mc&&(!document.documentMode||9<document.documentMode)}function Vf(){Ka&&(Ka.detachEvent("onpropertychange",mx),ml=Ka=null)}function mx(e){if(e.propertyName==="value"&&Gi(ml)){var t=[];ux(t,ml,e,em(e)),Y0(vj,t)}}function bj(e,t,n){e==="focusin"?(Vf(),Ka=t,ml=n,Ka.attachEvent("onpropertychange",mx)):e==="focusout"&&Vf()}function Nj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Gi(ml)}function jj(e,t){if(e==="click")return Gi(t)}function wj(e,t){if(e==="input"||e==="change")return Gi(t)}function _j(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Pn=typeof Object.is=="function"?Object.is:_j;function fl(e,t){if(Pn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Nu.call(t,a)||!Pn(e[a],t[a]))return!1}return!0}function Hf(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Uf(e,t){var n=Hf(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Hf(n)}}function fx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hx(){for(var e=window,t=Jo();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Jo(e.document)}return t}function cm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Sj(e){var t=hx(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fx(n.ownerDocument.documentElement,n)){if(r!==null&&cm(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(r.start,a);r=r.end===void 0?l:Math.min(r.end,a),!e.extend&&l>r&&(a=r,r=l,l=a),a=Uf(n,l);var o=Uf(n,r);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var kj=gs&&"documentMode"in document&&11>=document.documentMode,Fr=null,zu=null,Za=null,Vu=!1;function Bf(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vu||Fr==null||Fr!==Jo(r)||(r=Fr,"selectionStart"in r&&cm(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Za&&fl(Za,r)||(Za=r,r=li(zu,"onSelect"),0<r.length&&(t=new lm("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Fr)))}function uo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var zr={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionend:uo("Transition","TransitionEnd")},Oc={},px={};gs&&(px=document.createElement("div").style,"AnimationEvent"in window||(delete zr.animationend.animation,delete zr.animationiteration.animation,delete zr.animationstart.animation),"TransitionEvent"in window||delete zr.transitionend.transition);function qi(e){if(Oc[e])return Oc[e];if(!zr[e])return e;var t=zr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in px)return Oc[e]=t[n];return e}var xx=qi("animationend"),gx=qi("animationiteration"),vx=qi("animationstart"),yx=qi("transitionend"),bx=new Map,Yf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Js(e,t){bx.set(e,t),Ar(t,[e])}for(var Ic=0;Ic<Yf.length;Ic++){var Lc=Yf[Ic],Cj=Lc.toLowerCase(),Ej=Lc[0].toUpperCase()+Lc.slice(1);Js(Cj,"on"+Ej)}Js(xx,"onAnimationEnd");Js(gx,"onAnimationIteration");Js(vx,"onAnimationStart");Js("dblclick","onDoubleClick");Js("focusin","onFocus");Js("focusout","onBlur");Js(yx,"onTransitionEnd");ca("onMouseEnter",["mouseout","mouseover"]);ca("onMouseLeave",["mouseout","mouseover"]);ca("onPointerEnter",["pointerout","pointerover"]);ca("onPointerLeave",["pointerout","pointerover"]);Ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ar("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Aj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ua));function Wf(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,CN(r,t,void 0,e),e.currentTarget=null}function Nx(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var o=r.length-1;0<=o;o--){var i=r[o],c=i.instance,u=i.currentTarget;if(i=i.listener,c!==l&&a.isPropagationStopped())break e;Wf(a,i,u),l=c}else for(o=0;o<r.length;o++){if(i=r[o],c=i.instance,u=i.currentTarget,i=i.listener,c!==l&&a.isPropagationStopped())break e;Wf(a,i,u),l=c}}}if(ti)throw e=Lu,ti=!1,Lu=null,e}function $e(e,t){var n=t[Wu];n===void 0&&(n=t[Wu]=new Set);var r=e+"__bubble";n.has(r)||(jx(t,e,2,!1),n.add(r))}function $c(e,t,n){var r=0;t&&(r|=4),jx(n,e,r,t)}var mo="_reactListening"+Math.random().toString(36).slice(2);function hl(e){if(!e[mo]){e[mo]=!0,A0.forEach(function(n){n!=="selectionchange"&&(Aj.has(n)||$c(n,!1,e),$c(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[mo]||(t[mo]=!0,$c("selectionchange",!1,t))}}function jx(e,t,n,r){switch(ax(t)){case 1:var a=UN;break;case 4:a=BN;break;default:a=rm}n=a.bind(null,t,n,e),a=void 0,!Iu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Dc(e,t,n,r,a){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var i=r.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;i!==null;){if(o=ir(i),o===null)return;if(c=o.tag,c===5||c===6){r=l=o;continue e}i=i.parentNode}}r=r.return}Y0(function(){var u=l,m=em(n),d=[];e:{var f=bx.get(e);if(f!==void 0){var p=lm,v=e;switch(e){case"keypress":if(Do(n)===0)break e;case"keydown":case"keyup":p=aj;break;case"focusin":v="focus",p=Rc;break;case"focusout":v="blur",p=Rc;break;case"beforeblur":case"afterblur":p=Rc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Of;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=GN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ij;break;case xx:case gx:case vx:p=QN;break;case yx:p=uj;break;case"scroll":p=YN;break;case"wheel":p=mj;break;case"copy":case"cut":case"paste":p=ZN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Lf}var b=(t&4)!==0,x=!b&&e==="scroll",h=b?f!==null?f+"Capture":null:f;b=[];for(var g=u,y;g!==null;){y=g;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,h!==null&&(w=il(g,h),w!=null&&b.push(pl(g,w,y)))),x)break;g=g.return}0<b.length&&(f=new p(f,v,null,n,m),d.push({event:f,listeners:b}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&n!==Tu&&(v=n.relatedTarget||n.fromElement)&&(ir(v)||v[vs]))break e;if((p||f)&&(f=m.window===m?m:(f=m.ownerDocument)?f.defaultView||f.parentWindow:window,p?(v=n.relatedTarget||n.toElement,p=u,v=v?ir(v):null,v!==null&&(x=Pr(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=u),p!==v)){if(b=Of,w="onMouseLeave",h="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(b=Lf,w="onPointerLeave",h="onPointerEnter",g="pointer"),x=p==null?f:Vr(p),y=v==null?f:Vr(v),f=new b(w,g+"leave",p,n,m),f.target=x,f.relatedTarget=y,w=null,ir(m)===u&&(b=new b(h,g+"enter",v,n,m),b.target=y,b.relatedTarget=x,w=b),x=w,p&&v)t:{for(b=p,h=v,g=0,y=b;y;y=Mr(y))g++;for(y=0,w=h;w;w=Mr(w))y++;for(;0<g-y;)b=Mr(b),g--;for(;0<y-g;)h=Mr(h),y--;for(;g--;){if(b===h||h!==null&&b===h.alternate)break t;b=Mr(b),h=Mr(h)}b=null}else b=null;p!==null&&Gf(d,f,p,b,!1),v!==null&&x!==null&&Gf(d,x,v,b,!0)}}e:{if(f=u?Vr(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var E=yj;else if(Ff(f))if(dx)E=wj;else{E=Nj;var _=bj}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=jj);if(E&&(E=E(e,u))){ux(d,E,n,m);break e}_&&_(e,f,u),e==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&Eu(f,"number",f.value)}switch(_=u?Vr(u):window,e){case"focusin":(Ff(_)||_.contentEditable==="true")&&(Fr=_,zu=u,Za=null);break;case"focusout":Za=zu=Fr=null;break;case"mousedown":Vu=!0;break;case"contextmenu":case"mouseup":case"dragend":Vu=!1,Bf(d,n,m);break;case"selectionchange":if(kj)break;case"keydown":case"keyup":Bf(d,n,m)}var S;if(im)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Dr?ix(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(ox&&n.locale!=="ko"&&(Dr||N!=="onCompositionStart"?N==="onCompositionEnd"&&Dr&&(S=lx()):(Os=m,am="value"in Os?Os.value:Os.textContent,Dr=!0)),_=li(u,N),0<_.length&&(N=new If(N,e,null,n,m),d.push({event:N,listeners:_}),S?N.data=S:(S=cx(n),S!==null&&(N.data=S)))),(S=hj?pj(e,n):xj(e,n))&&(u=li(u,"onBeforeInput"),0<u.length&&(m=new If("onBeforeInput","beforeinput",null,n,m),d.push({event:m,listeners:u}),m.data=S))}Nx(d,t)})}function pl(e,t,n){return{instance:e,listener:t,currentTarget:n}}function li(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=il(e,n),l!=null&&r.unshift(pl(e,l,a)),l=il(e,t),l!=null&&r.push(pl(e,l,a))),e=e.return}return r}function Mr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gf(e,t,n,r,a){for(var l=t._reactName,o=[];n!==null&&n!==r;){var i=n,c=i.alternate,u=i.stateNode;if(c!==null&&c===r)break;i.tag===5&&u!==null&&(i=u,a?(c=il(n,l),c!=null&&o.unshift(pl(n,c,i))):a||(c=il(n,l),c!=null&&o.push(pl(n,c,i)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Pj=/\r\n?/g,Rj=/\u0000|\uFFFD/g;function qf(e){return(typeof e=="string"?e:""+e).replace(Pj,`
`).replace(Rj,"")}function fo(e,t,n){if(t=qf(t),qf(e)!==t&&n)throw Error(se(425))}function oi(){}var Hu=null,Uu=null;function Bu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yu=typeof setTimeout=="function"?setTimeout:void 0,Mj=typeof clearTimeout=="function"?clearTimeout:void 0,Xf=typeof Promise=="function"?Promise:void 0,Tj=typeof queueMicrotask=="function"?queueMicrotask:typeof Xf<"u"?function(e){return Xf.resolve(null).then(e).catch(Oj)}:Yu;function Oj(e){setTimeout(function(){throw e})}function Fc(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),dl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);dl(t)}function Fs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Qf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ea=Math.random().toString(36).slice(2),Xn="__reactFiber$"+Ea,xl="__reactProps$"+Ea,vs="__reactContainer$"+Ea,Wu="__reactEvents$"+Ea,Ij="__reactListeners$"+Ea,Lj="__reactHandles$"+Ea;function ir(e){var t=e[Xn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vs]||n[Xn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Qf(e);e!==null;){if(n=e[Xn])return n;e=Qf(e)}return t}e=n,n=e.parentNode}return null}function Ul(e){return e=e[Xn]||e[vs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(se(33))}function Xi(e){return e[xl]||null}var Gu=[],Hr=-1;function er(e){return{current:e}}function Fe(e){0>Hr||(e.current=Gu[Hr],Gu[Hr]=null,Hr--)}function Ie(e,t){Hr++,Gu[Hr]=e.current,e.current=t}var Gs={},St=er(Gs),Vt=er(!1),vr=Gs;function ua(e,t){var n=e.type.contextTypes;if(!n)return Gs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ht(e){return e=e.childContextTypes,e!=null}function ii(){Fe(Vt),Fe(St)}function Kf(e,t,n){if(St.current!==Gs)throw Error(se(168));Ie(St,t),Ie(Vt,n)}function wx(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(se(108,bN(e)||"Unknown",a));return qe({},n,r)}function ci(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Gs,vr=St.current,Ie(St,e),Ie(Vt,Vt.current),!0}function Zf(e,t,n){var r=e.stateNode;if(!r)throw Error(se(169));n?(e=wx(e,t,vr),r.__reactInternalMemoizedMergedChildContext=e,Fe(Vt),Fe(St),Ie(St,e)):Fe(Vt),Ie(Vt,n)}var us=null,Qi=!1,zc=!1;function _x(e){us===null?us=[e]:us.push(e)}function $j(e){Qi=!0,_x(e)}function tr(){if(!zc&&us!==null){zc=!0;var e=0,t=Me;try{var n=us;for(Me=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}us=null,Qi=!1}catch(a){throw us!==null&&(us=us.slice(e+1)),X0(tm,tr),a}finally{Me=t,zc=!1}}return null}var Ur=[],Br=0,ui=null,di=0,ln=[],on=0,yr=null,ms=1,fs="";function ar(e,t){Ur[Br++]=di,Ur[Br++]=ui,ui=e,di=t}function Sx(e,t,n){ln[on++]=ms,ln[on++]=fs,ln[on++]=yr,yr=e;var r=ms;e=fs;var a=32-Sn(r)-1;r&=~(1<<a),n+=1;var l=32-Sn(t)+a;if(30<l){var o=a-a%5;l=(r&(1<<o)-1).toString(32),r>>=o,a-=o,ms=1<<32-Sn(t)+a|n<<a|r,fs=l+e}else ms=1<<l|n<<a|r,fs=e}function um(e){e.return!==null&&(ar(e,1),Sx(e,1,0))}function dm(e){for(;e===ui;)ui=Ur[--Br],Ur[Br]=null,di=Ur[--Br],Ur[Br]=null;for(;e===yr;)yr=ln[--on],ln[on]=null,fs=ln[--on],ln[on]=null,ms=ln[--on],ln[on]=null}var Xt=null,qt=null,Ve=!1,bn=null;function kx(e,t){var n=un(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Jf(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xt=e,qt=Fs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xt=e,qt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=yr!==null?{id:ms,overflow:fs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=un(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Xt=e,qt=null,!0):!1;default:return!1}}function qu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Xu(e){if(Ve){var t=qt;if(t){var n=t;if(!Jf(e,t)){if(qu(e))throw Error(se(418));t=Fs(n.nextSibling);var r=Xt;t&&Jf(e,t)?kx(r,n):(e.flags=e.flags&-4097|2,Ve=!1,Xt=e)}}else{if(qu(e))throw Error(se(418));e.flags=e.flags&-4097|2,Ve=!1,Xt=e}}}function eh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xt=e}function ho(e){if(e!==Xt)return!1;if(!Ve)return eh(e),Ve=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Bu(e.type,e.memoizedProps)),t&&(t=qt)){if(qu(e))throw Cx(),Error(se(418));for(;t;)kx(e,t),t=Fs(t.nextSibling)}if(eh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){qt=Fs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}qt=null}}else qt=Xt?Fs(e.stateNode.nextSibling):null;return!0}function Cx(){for(var e=qt;e;)e=Fs(e.nextSibling)}function da(){qt=Xt=null,Ve=!1}function mm(e){bn===null?bn=[e]:bn.push(e)}var Dj=Ss.ReactCurrentBatchConfig;function Oa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var r=n.stateNode}if(!r)throw Error(se(147,e));var a=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(o){var i=a.refs;o===null?delete i[l]:i[l]=o},t._stringRef=l,t)}if(typeof e!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,e))}return e}function po(e,t){throw e=Object.prototype.toString.call(t),Error(se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function th(e){var t=e._init;return t(e._payload)}function Ex(e){function t(h,g){if(e){var y=h.deletions;y===null?(h.deletions=[g],h.flags|=16):y.push(g)}}function n(h,g){if(!e)return null;for(;g!==null;)t(h,g),g=g.sibling;return null}function r(h,g){for(h=new Map;g!==null;)g.key!==null?h.set(g.key,g):h.set(g.index,g),g=g.sibling;return h}function a(h,g){return h=Us(h,g),h.index=0,h.sibling=null,h}function l(h,g,y){return h.index=y,e?(y=h.alternate,y!==null?(y=y.index,y<g?(h.flags|=2,g):y):(h.flags|=2,g)):(h.flags|=1048576,g)}function o(h){return e&&h.alternate===null&&(h.flags|=2),h}function i(h,g,y,w){return g===null||g.tag!==6?(g=Gc(y,h.mode,w),g.return=h,g):(g=a(g,y),g.return=h,g)}function c(h,g,y,w){var E=y.type;return E===$r?m(h,g,y.props.children,w,y.key):g!==null&&(g.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ps&&th(E)===g.type)?(w=a(g,y.props),w.ref=Oa(h,g,y),w.return=h,w):(w=Yo(y.type,y.key,y.props,null,h.mode,w),w.ref=Oa(h,g,y),w.return=h,w)}function u(h,g,y,w){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=qc(y,h.mode,w),g.return=h,g):(g=a(g,y.children||[]),g.return=h,g)}function m(h,g,y,w,E){return g===null||g.tag!==7?(g=hr(y,h.mode,w,E),g.return=h,g):(g=a(g,y),g.return=h,g)}function d(h,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Gc(""+g,h.mode,y),g.return=h,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case so:return y=Yo(g.type,g.key,g.props,null,h.mode,y),y.ref=Oa(h,null,g),y.return=h,y;case Lr:return g=qc(g,h.mode,y),g.return=h,g;case Ps:var w=g._init;return d(h,w(g._payload),y)}if(Va(g)||Aa(g))return g=hr(g,h.mode,y,null),g.return=h,g;po(h,g)}return null}function f(h,g,y,w){var E=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:i(h,g,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case so:return y.key===E?c(h,g,y,w):null;case Lr:return y.key===E?u(h,g,y,w):null;case Ps:return E=y._init,f(h,g,E(y._payload),w)}if(Va(y)||Aa(y))return E!==null?null:m(h,g,y,w,null);po(h,y)}return null}function p(h,g,y,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return h=h.get(y)||null,i(g,h,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case so:return h=h.get(w.key===null?y:w.key)||null,c(g,h,w,E);case Lr:return h=h.get(w.key===null?y:w.key)||null,u(g,h,w,E);case Ps:var _=w._init;return p(h,g,y,_(w._payload),E)}if(Va(w)||Aa(w))return h=h.get(y)||null,m(g,h,w,E,null);po(g,w)}return null}function v(h,g,y,w){for(var E=null,_=null,S=g,N=g=0,k=null;S!==null&&N<y.length;N++){S.index>N?(k=S,S=null):k=S.sibling;var A=f(h,S,y[N],w);if(A===null){S===null&&(S=k);break}e&&S&&A.alternate===null&&t(h,S),g=l(A,g,N),_===null?E=A:_.sibling=A,_=A,S=k}if(N===y.length)return n(h,S),Ve&&ar(h,N),E;if(S===null){for(;N<y.length;N++)S=d(h,y[N],w),S!==null&&(g=l(S,g,N),_===null?E=S:_.sibling=S,_=S);return Ve&&ar(h,N),E}for(S=r(h,S);N<y.length;N++)k=p(S,h,N,y[N],w),k!==null&&(e&&k.alternate!==null&&S.delete(k.key===null?N:k.key),g=l(k,g,N),_===null?E=k:_.sibling=k,_=k);return e&&S.forEach(function(C){return t(h,C)}),Ve&&ar(h,N),E}function b(h,g,y,w){var E=Aa(y);if(typeof E!="function")throw Error(se(150));if(y=E.call(y),y==null)throw Error(se(151));for(var _=E=null,S=g,N=g=0,k=null,A=y.next();S!==null&&!A.done;N++,A=y.next()){S.index>N?(k=S,S=null):k=S.sibling;var C=f(h,S,A.value,w);if(C===null){S===null&&(S=k);break}e&&S&&C.alternate===null&&t(h,S),g=l(C,g,N),_===null?E=C:_.sibling=C,_=C,S=k}if(A.done)return n(h,S),Ve&&ar(h,N),E;if(S===null){for(;!A.done;N++,A=y.next())A=d(h,A.value,w),A!==null&&(g=l(A,g,N),_===null?E=A:_.sibling=A,_=A);return Ve&&ar(h,N),E}for(S=r(h,S);!A.done;N++,A=y.next())A=p(S,h,N,A.value,w),A!==null&&(e&&A.alternate!==null&&S.delete(A.key===null?N:A.key),g=l(A,g,N),_===null?E=A:_.sibling=A,_=A);return e&&S.forEach(function(O){return t(h,O)}),Ve&&ar(h,N),E}function x(h,g,y,w){if(typeof y=="object"&&y!==null&&y.type===$r&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case so:e:{for(var E=y.key,_=g;_!==null;){if(_.key===E){if(E=y.type,E===$r){if(_.tag===7){n(h,_.sibling),g=a(_,y.props.children),g.return=h,h=g;break e}}else if(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ps&&th(E)===_.type){n(h,_.sibling),g=a(_,y.props),g.ref=Oa(h,_,y),g.return=h,h=g;break e}n(h,_);break}else t(h,_);_=_.sibling}y.type===$r?(g=hr(y.props.children,h.mode,w,y.key),g.return=h,h=g):(w=Yo(y.type,y.key,y.props,null,h.mode,w),w.ref=Oa(h,g,y),w.return=h,h=w)}return o(h);case Lr:e:{for(_=y.key;g!==null;){if(g.key===_)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(h,g.sibling),g=a(g,y.children||[]),g.return=h,h=g;break e}else{n(h,g);break}else t(h,g);g=g.sibling}g=qc(y,h.mode,w),g.return=h,h=g}return o(h);case Ps:return _=y._init,x(h,g,_(y._payload),w)}if(Va(y))return v(h,g,y,w);if(Aa(y))return b(h,g,y,w);po(h,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(h,g.sibling),g=a(g,y),g.return=h,h=g):(n(h,g),g=Gc(y,h.mode,w),g.return=h,h=g),o(h)):n(h,g)}return x}var ma=Ex(!0),Ax=Ex(!1),mi=er(null),fi=null,Yr=null,fm=null;function hm(){fm=Yr=fi=null}function pm(e){var t=mi.current;Fe(mi),e._currentValue=t}function Qu(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function sa(e,t){fi=e,fm=Yr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Dt=!0),e.firstContext=null)}function mn(e){var t=e._currentValue;if(fm!==e)if(e={context:e,memoizedValue:t,next:null},Yr===null){if(fi===null)throw Error(se(308));Yr=e,fi.dependencies={lanes:0,firstContext:e}}else Yr=Yr.next=e;return t}var cr=null;function xm(e){cr===null?cr=[e]:cr.push(e)}function Px(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,xm(t)):(n.next=a.next,a.next=n),t.interleaved=n,ys(e,r)}function ys(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Rs=!1;function gm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ae&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,ys(e,n)}return a=r.interleaved,a===null?(t.next=t,xm(r)):(t.next=a.next,a.next=t),r.interleaved=t,ys(e,n)}function Fo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,nm(e,n)}}function nh(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=o:l=l.next=o,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function hi(e,t,n,r){var a=e.updateQueue;Rs=!1;var l=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var c=i,u=c.next;c.next=null,o===null?l=u:o.next=u,o=c;var m=e.alternate;m!==null&&(m=m.updateQueue,i=m.lastBaseUpdate,i!==o&&(i===null?m.firstBaseUpdate=u:i.next=u,m.lastBaseUpdate=c))}if(l!==null){var d=a.baseState;o=0,m=u=c=null,i=l;do{var f=i.lane,p=i.eventTime;if((r&f)===f){m!==null&&(m=m.next={eventTime:p,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var v=e,b=i;switch(f=t,p=n,b.tag){case 1:if(v=b.payload,typeof v=="function"){d=v.call(p,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=b.payload,f=typeof v=="function"?v.call(p,d,f):v,f==null)break e;d=qe({},d,f);break e;case 2:Rs=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[i]:f.push(i))}else p={eventTime:p,lane:f,tag:i.tag,payload:i.payload,callback:i.callback,next:null},m===null?(u=m=p,c=d):m=m.next=p,o|=f;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;f=i,i=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(m===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=m,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);Nr|=o,e.lanes=o,e.memoizedState=d}}function sh(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(se(191,a));a.call(r)}}}var Bl={},Jn=er(Bl),gl=er(Bl),vl=er(Bl);function ur(e){if(e===Bl)throw Error(se(174));return e}function vm(e,t){switch(Ie(vl,t),Ie(gl,e),Ie(Jn,Bl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Pu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Pu(t,e)}Fe(Jn),Ie(Jn,t)}function fa(){Fe(Jn),Fe(gl),Fe(vl)}function Mx(e){ur(vl.current);var t=ur(Jn.current),n=Pu(t,e.type);t!==n&&(Ie(gl,e),Ie(Jn,n))}function ym(e){gl.current===e&&(Fe(Jn),Fe(gl))}var Ye=er(0);function pi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vc=[];function bm(){for(var e=0;e<Vc.length;e++)Vc[e]._workInProgressVersionPrimary=null;Vc.length=0}var zo=Ss.ReactCurrentDispatcher,Hc=Ss.ReactCurrentBatchConfig,br=0,We=null,nt=null,ut=null,xi=!1,Ja=!1,yl=0,Fj=0;function Nt(){throw Error(se(321))}function Nm(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Pn(e[n],t[n]))return!1;return!0}function jm(e,t,n,r,a,l){if(br=l,We=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zo.current=e===null||e.memoizedState===null?Uj:Bj,e=n(r,a),Ja){l=0;do{if(Ja=!1,yl=0,25<=l)throw Error(se(301));l+=1,ut=nt=null,t.updateQueue=null,zo.current=Yj,e=n(r,a)}while(Ja)}if(zo.current=gi,t=nt!==null&&nt.next!==null,br=0,ut=nt=We=null,xi=!1,t)throw Error(se(300));return e}function wm(){var e=yl!==0;return yl=0,e}function Gn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ut===null?We.memoizedState=ut=e:ut=ut.next=e,ut}function fn(){if(nt===null){var e=We.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var t=ut===null?We.memoizedState:ut.next;if(t!==null)ut=t,nt=e;else{if(e===null)throw Error(se(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},ut===null?We.memoizedState=ut=e:ut=ut.next=e}return ut}function bl(e,t){return typeof t=="function"?t(e):t}function Uc(e){var t=fn(),n=t.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=e;var r=nt,a=r.baseQueue,l=n.pending;if(l!==null){if(a!==null){var o=a.next;a.next=l.next,l.next=o}r.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,r=r.baseState;var i=o=null,c=null,u=l;do{var m=u.lane;if((br&m)===m)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(i=c=d,o=r):c=c.next=d,We.lanes|=m,Nr|=m}u=u.next}while(u!==null&&u!==l);c===null?o=r:c.next=i,Pn(r,t.memoizedState)||(Dt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do l=a.lane,We.lanes|=l,Nr|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Bc(e){var t=fn(),n=t.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do l=e(l,o.action),o=o.next;while(o!==a);Pn(l,t.memoizedState)||(Dt=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function Tx(){}function Ox(e,t){var n=We,r=fn(),a=t(),l=!Pn(r.memoizedState,a);if(l&&(r.memoizedState=a,Dt=!0),r=r.queue,_m($x.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||ut!==null&&ut.memoizedState.tag&1){if(n.flags|=2048,Nl(9,Lx.bind(null,n,r,a,t),void 0,null),mt===null)throw Error(se(349));br&30||Ix(n,t,a)}return a}function Ix(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Lx(e,t,n,r){t.value=n,t.getSnapshot=r,Dx(t)&&Fx(e)}function $x(e,t,n){return n(function(){Dx(t)&&Fx(e)})}function Dx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Pn(e,n)}catch{return!0}}function Fx(e){var t=ys(e,1);t!==null&&kn(t,e,1,-1)}function rh(e){var t=Gn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:e},t.queue=e,e=e.dispatch=Hj.bind(null,We,e),[t.memoizedState,e]}function Nl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function zx(){return fn().memoizedState}function Vo(e,t,n,r){var a=Gn();We.flags|=e,a.memoizedState=Nl(1|t,n,void 0,r===void 0?null:r)}function Ki(e,t,n,r){var a=fn();r=r===void 0?null:r;var l=void 0;if(nt!==null){var o=nt.memoizedState;if(l=o.destroy,r!==null&&Nm(r,o.deps)){a.memoizedState=Nl(t,n,l,r);return}}We.flags|=e,a.memoizedState=Nl(1|t,n,l,r)}function ah(e,t){return Vo(8390656,8,e,t)}function _m(e,t){return Ki(2048,8,e,t)}function Vx(e,t){return Ki(4,2,e,t)}function Hx(e,t){return Ki(4,4,e,t)}function Ux(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Bx(e,t,n){return n=n!=null?n.concat([e]):null,Ki(4,4,Ux.bind(null,t,e),n)}function Sm(){}function Yx(e,t){var n=fn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Nm(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wx(e,t){var n=fn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Nm(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Gx(e,t,n){return br&21?(Pn(n,t)||(n=Z0(),We.lanes|=n,Nr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Dt=!0),e.memoizedState=n)}function zj(e,t){var n=Me;Me=n!==0&&4>n?n:4,e(!0);var r=Hc.transition;Hc.transition={};try{e(!1),t()}finally{Me=n,Hc.transition=r}}function qx(){return fn().memoizedState}function Vj(e,t,n){var r=Hs(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xx(e))Qx(t,n);else if(n=Px(e,t,n,r),n!==null){var a=Pt();kn(n,e,r,a),Kx(n,t,r)}}function Hj(e,t,n){var r=Hs(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xx(e))Qx(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var o=t.lastRenderedState,i=l(o,n);if(a.hasEagerState=!0,a.eagerState=i,Pn(i,o)){var c=t.interleaved;c===null?(a.next=a,xm(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}n=Px(e,t,a,r),n!==null&&(a=Pt(),kn(n,e,r,a),Kx(n,t,r))}}function Xx(e){var t=e.alternate;return e===We||t!==null&&t===We}function Qx(e,t){Ja=xi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Kx(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,nm(e,n)}}var gi={readContext:mn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},Uj={readContext:mn,useCallback:function(e,t){return Gn().memoizedState=[e,t===void 0?null:t],e},useContext:mn,useEffect:ah,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Vo(4194308,4,Ux.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vo(4,2,e,t)},useMemo:function(e,t){var n=Gn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Gn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Vj.bind(null,We,e),[r.memoizedState,e]},useRef:function(e){var t=Gn();return e={current:e},t.memoizedState=e},useState:rh,useDebugValue:Sm,useDeferredValue:function(e){return Gn().memoizedState=e},useTransition:function(){var e=rh(!1),t=e[0];return e=zj.bind(null,e[1]),Gn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=We,a=Gn();if(Ve){if(n===void 0)throw Error(se(407));n=n()}else{if(n=t(),mt===null)throw Error(se(349));br&30||Ix(r,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,ah($x.bind(null,r,l,e),[e]),r.flags|=2048,Nl(9,Lx.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=Gn(),t=mt.identifierPrefix;if(Ve){var n=fs,r=ms;n=(r&~(1<<32-Sn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=yl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Fj++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Bj={readContext:mn,useCallback:Yx,useContext:mn,useEffect:_m,useImperativeHandle:Bx,useInsertionEffect:Vx,useLayoutEffect:Hx,useMemo:Wx,useReducer:Uc,useRef:zx,useState:function(){return Uc(bl)},useDebugValue:Sm,useDeferredValue:function(e){var t=fn();return Gx(t,nt.memoizedState,e)},useTransition:function(){var e=Uc(bl)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Tx,useSyncExternalStore:Ox,useId:qx,unstable_isNewReconciler:!1},Yj={readContext:mn,useCallback:Yx,useContext:mn,useEffect:_m,useImperativeHandle:Bx,useInsertionEffect:Vx,useLayoutEffect:Hx,useMemo:Wx,useReducer:Bc,useRef:zx,useState:function(){return Bc(bl)},useDebugValue:Sm,useDeferredValue:function(e){var t=fn();return nt===null?t.memoizedState=e:Gx(t,nt.memoizedState,e)},useTransition:function(){var e=Bc(bl)[0],t=fn().memoizedState;return[e,t]},useMutableSource:Tx,useSyncExternalStore:Ox,useId:qx,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=qe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Ku(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:qe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Zi={isMounted:function(e){return(e=e._reactInternals)?Pr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Pt(),a=Hs(e),l=xs(r,a);l.payload=t,n!=null&&(l.callback=n),t=zs(e,l,a),t!==null&&(kn(t,e,a,r),Fo(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Pt(),a=Hs(e),l=xs(r,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=zs(e,l,a),t!==null&&(kn(t,e,a,r),Fo(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Pt(),r=Hs(e),a=xs(n,r);a.tag=2,t!=null&&(a.callback=t),t=zs(e,a,r),t!==null&&(kn(t,e,r,n),Fo(t,e,r))}};function lh(e,t,n,r,a,l,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,o):t.prototype&&t.prototype.isPureReactComponent?!fl(n,r)||!fl(a,l):!0}function Zx(e,t,n){var r=!1,a=Gs,l=t.contextType;return typeof l=="object"&&l!==null?l=mn(l):(a=Ht(t)?vr:St.current,r=t.contextTypes,l=(r=r!=null)?ua(e,a):Gs),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Zi,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function oh(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Zi.enqueueReplaceState(t,t.state,null)}function Zu(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},gm(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=mn(l):(l=Ht(t)?vr:St.current,a.context=ua(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(Ku(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Zi.enqueueReplaceState(a,a.state,null),hi(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ha(e,t){try{var n="",r=t;do n+=yN(r),r=r.return;while(r);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function Yc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ju(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Wj=typeof WeakMap=="function"?WeakMap:Map;function Jx(e,t,n){n=xs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){yi||(yi=!0,cd=r),Ju(e,t)},n}function eg(e,t,n){n=xs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Ju(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Ju(e,t),typeof r!="function"&&(Vs===null?Vs=new Set([this]):Vs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function ih(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Wj;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=l1.bind(null,e,t,n),t.then(e,e))}function ch(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function uh(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=xs(-1,1),t.tag=2,zs(n,t,1))),n.lanes|=1),e)}var Gj=Ss.ReactCurrentOwner,Dt=!1;function Et(e,t,n,r){t.child=e===null?Ax(t,null,n,r):ma(t,e.child,n,r)}function dh(e,t,n,r,a){n=n.render;var l=t.ref;return sa(t,a),r=jm(e,t,n,r,l,a),n=wm(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,bs(e,t,a)):(Ve&&n&&um(t),t.flags|=1,Et(e,t,r,a),t.child)}function mh(e,t,n,r,a){if(e===null){var l=n.type;return typeof l=="function"&&!Tm(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,tg(e,t,l,r,a)):(e=Yo(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var o=l.memoizedProps;if(n=n.compare,n=n!==null?n:fl,n(o,r)&&e.ref===t.ref)return bs(e,t,a)}return t.flags|=1,e=Us(l,r),e.ref=t.ref,e.return=t,t.child=e}function tg(e,t,n,r,a){if(e!==null){var l=e.memoizedProps;if(fl(l,r)&&e.ref===t.ref)if(Dt=!1,t.pendingProps=r=l,(e.lanes&a)!==0)e.flags&131072&&(Dt=!0);else return t.lanes=e.lanes,bs(e,t,a)}return ed(e,t,n,r,a)}function ng(e,t,n){var r=t.pendingProps,a=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ie(Gr,Wt),Wt|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ie(Gr,Wt),Wt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,Ie(Gr,Wt),Wt|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,Ie(Gr,Wt),Wt|=r;return Et(e,t,a,n),t.child}function sg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ed(e,t,n,r,a){var l=Ht(n)?vr:St.current;return l=ua(t,l),sa(t,a),n=jm(e,t,n,r,l,a),r=wm(),e!==null&&!Dt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,bs(e,t,a)):(Ve&&r&&um(t),t.flags|=1,Et(e,t,n,a),t.child)}function fh(e,t,n,r,a){if(Ht(n)){var l=!0;ci(t)}else l=!1;if(sa(t,a),t.stateNode===null)Ho(e,t),Zx(t,n,r),Zu(t,n,r,a),r=!0;else if(e===null){var o=t.stateNode,i=t.memoizedProps;o.props=i;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=mn(u):(u=Ht(n)?vr:St.current,u=ua(t,u));var m=n.getDerivedStateFromProps,d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==r||c!==u)&&oh(t,o,r,u),Rs=!1;var f=t.memoizedState;o.state=f,hi(t,r,o,a),c=t.memoizedState,i!==r||f!==c||Vt.current||Rs?(typeof m=="function"&&(Ku(t,n,m,r),c=t.memoizedState),(i=Rs||lh(t,n,i,r,f,c,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=i):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Rx(e,t),i=t.memoizedProps,u=t.type===t.elementType?i:gn(t.type,i),o.props=u,d=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=mn(c):(c=Ht(n)?vr:St.current,c=ua(t,c));var p=n.getDerivedStateFromProps;(m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==d||f!==c)&&oh(t,o,r,c),Rs=!1,f=t.memoizedState,o.state=f,hi(t,r,o,a);var v=t.memoizedState;i!==d||f!==v||Vt.current||Rs?(typeof p=="function"&&(Ku(t,n,p,r),v=t.memoizedState),(u=Rs||lh(t,n,u,r,f,v,c)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),o.props=r,o.state=v,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return td(e,t,n,r,l,a)}function td(e,t,n,r,a,l){sg(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return a&&Zf(t,n,!1),bs(e,t,l);r=t.stateNode,Gj.current=t;var i=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=ma(t,e.child,null,l),t.child=ma(t,null,i,l)):Et(e,t,i,l),t.memoizedState=r.state,a&&Zf(t,n,!0),t.child}function rg(e){var t=e.stateNode;t.pendingContext?Kf(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Kf(e,t.context,!1),vm(e,t.containerInfo)}function hh(e,t,n,r,a){return da(),mm(a),t.flags|=256,Et(e,t,n,r),t.child}var nd={dehydrated:null,treeContext:null,retryLane:0};function sd(e){return{baseLanes:e,cachePool:null,transitions:null}}function ag(e,t,n){var r=t.pendingProps,a=Ye.current,l=!1,o=(t.flags&128)!==0,i;if((i=o)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Ie(Ye,a&1),e===null)return Xu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,l?(r=t.mode,l=t.child,o={mode:"hidden",children:o},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=tc(o,r,0,null),e=hr(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=sd(n),t.memoizedState=nd,e):km(t,o));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return qj(e,t,o,r,i,a,n);if(l){l=r.fallback,o=t.mode,a=e.child,i=a.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Us(a,c),r.subtreeFlags=a.subtreeFlags&14680064),i!==null?l=Us(i,l):(l=hr(l,o,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,o=e.child.memoizedState,o=o===null?sd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~n,t.memoizedState=nd,r}return l=e.child,e=l.sibling,r=Us(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function km(e,t){return t=tc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xo(e,t,n,r){return r!==null&&mm(r),ma(t,e.child,null,n),e=km(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qj(e,t,n,r,a,l,o){if(n)return t.flags&256?(t.flags&=-257,r=Yc(Error(se(422))),xo(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,a=t.mode,r=tc({mode:"visible",children:r.children},a,0,null),l=hr(l,a,o,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&ma(t,e.child,null,o),t.child.memoizedState=sd(o),t.memoizedState=nd,l);if(!(t.mode&1))return xo(e,t,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var i=r.dgst;return r=i,l=Error(se(419)),r=Yc(l,r,void 0),xo(e,t,o,r)}if(i=(o&e.childLanes)!==0,Dt||i){if(r=mt,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,ys(e,a),kn(r,e,a,-1))}return Mm(),r=Yc(Error(se(421))),xo(e,t,o,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=o1.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,qt=Fs(a.nextSibling),Xt=t,Ve=!0,bn=null,e!==null&&(ln[on++]=ms,ln[on++]=fs,ln[on++]=yr,ms=e.id,fs=e.overflow,yr=t),t=km(t,r.children),t.flags|=4096,t)}function ph(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Qu(e.return,t,n)}function Wc(e,t,n,r,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=a)}function lg(e,t,n){var r=t.pendingProps,a=r.revealOrder,l=r.tail;if(Et(e,t,r.children,n),r=Ye.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ph(e,n,t);else if(e.tag===19)ph(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ie(Ye,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&pi(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Wc(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&pi(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Wc(t,!0,n,null,l);break;case"together":Wc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function bs(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Nr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(se(153));if(t.child!==null){for(e=t.child,n=Us(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Us(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Xj(e,t,n){switch(t.tag){case 3:rg(t),da();break;case 5:Mx(t);break;case 1:Ht(t.type)&&ci(t);break;case 4:vm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ie(mi,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ie(Ye,Ye.current&1),t.flags|=128,null):n&t.child.childLanes?ag(e,t,n):(Ie(Ye,Ye.current&1),e=bs(e,t,n),e!==null?e.sibling:null);Ie(Ye,Ye.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return lg(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ie(Ye,Ye.current),r)break;return null;case 22:case 23:return t.lanes=0,ng(e,t,n)}return bs(e,t,n)}var og,rd,ig,cg;og=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rd=function(){};ig=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ur(Jn.current);var l=null;switch(n){case"input":a=ku(e,a),r=ku(e,r),l=[];break;case"select":a=qe({},a,{value:void 0}),r=qe({},r,{value:void 0}),l=[];break;case"textarea":a=Au(e,a),r=Au(e,r),l=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=oi)}Ru(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var i=a[u];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ll.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in r){var c=r[u];if(i=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&c!==i&&(c!=null||i!=null))if(u==="style")if(i){for(o in i)!i.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&i[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(l||(l=[]),l.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,i=i?i.__html:void 0,c!=null&&i!==c&&(l=l||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ll.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&$e("scroll",e),l||i===c||(l=[])):(l=l||[]).push(u,c))}n&&(l=l||[]).push("style",n);var u=l;(t.updateQueue=u)&&(t.flags|=4)}};cg=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ia(e,t){if(!Ve)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qj(e,t,n){var r=t.pendingProps;switch(dm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return Ht(t.type)&&ii(),jt(t),null;case 3:return r=t.stateNode,fa(),Fe(Vt),Fe(St),bm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ho(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bn!==null&&(md(bn),bn=null))),rd(e,t),jt(t),null;case 5:ym(t);var a=ur(vl.current);if(n=t.type,e!==null&&t.stateNode!=null)ig(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(se(166));return jt(t),null}if(e=ur(Jn.current),ho(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[Xn]=t,r[xl]=l,e=(t.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(a=0;a<Ua.length;a++)$e(Ua[a],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":_f(r,l),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},$e("invalid",r);break;case"textarea":kf(r,l),$e("invalid",r)}Ru(n,l),a=null;for(var o in l)if(l.hasOwnProperty(o)){var i=l[o];o==="children"?typeof i=="string"?r.textContent!==i&&(l.suppressHydrationWarning!==!0&&fo(r.textContent,i,e),a=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&fo(r.textContent,i,e),a=["children",""+i]):ll.hasOwnProperty(o)&&i!=null&&o==="onScroll"&&$e("scroll",r)}switch(n){case"input":ro(r),Sf(r,l,!0);break;case"textarea":ro(r),Cf(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=oi)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$0(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Xn]=t,e[xl]=r,og(e,t,!1,!1),t.stateNode=e;e:{switch(o=Mu(n,r),n){case"dialog":$e("cancel",e),$e("close",e),a=r;break;case"iframe":case"object":case"embed":$e("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ua.length;a++)$e(Ua[a],e);a=r;break;case"source":$e("error",e),a=r;break;case"img":case"image":case"link":$e("error",e),$e("load",e),a=r;break;case"details":$e("toggle",e),a=r;break;case"input":_f(e,r),a=ku(e,r),$e("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=qe({},r,{value:void 0}),$e("invalid",e);break;case"textarea":kf(e,r),a=Au(e,r),$e("invalid",e);break;default:a=r}Ru(n,a),i=a;for(l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="style"?z0(e,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&D0(e,c)):l==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ol(e,c):typeof c=="number"&&ol(e,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ll.hasOwnProperty(l)?c!=null&&l==="onScroll"&&$e("scroll",e):c!=null&&Qd(e,l,c,o))}switch(n){case"input":ro(e),Sf(e,r,!1);break;case"textarea":ro(e),Cf(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ws(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?Jr(e,!!r.multiple,l,!1):r.defaultValue!=null&&Jr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=oi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)cg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(se(166));if(n=ur(vl.current),ur(Jn.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[Xn]=t,(l=r.nodeValue!==n)&&(e=Xt,e!==null))switch(e.tag){case 3:fo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fo(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Xn]=t,t.stateNode=r}return jt(t),null;case 13:if(Fe(Ye),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ve&&qt!==null&&t.mode&1&&!(t.flags&128))Cx(),da(),t.flags|=98560,l=!1;else if(l=ho(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(se(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(se(317));l[Xn]=t}else da(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),l=!1}else bn!==null&&(md(bn),bn=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ye.current&1?lt===0&&(lt=3):Mm())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return fa(),rd(e,t),e===null&&hl(t.stateNode.containerInfo),jt(t),null;case 10:return pm(t.type._context),jt(t),null;case 17:return Ht(t.type)&&ii(),jt(t),null;case 19:if(Fe(Ye),l=t.memoizedState,l===null)return jt(t),null;if(r=(t.flags&128)!==0,o=l.rendering,o===null)if(r)Ia(l,!1);else{if(lt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=pi(e),o!==null){for(t.flags|=128,Ia(l,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,e=o.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ie(Ye,Ye.current&1|2),t.child}e=e.sibling}l.tail!==null&&Ke()>pa&&(t.flags|=128,r=!0,Ia(l,!1),t.lanes=4194304)}else{if(!r)if(e=pi(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ia(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!Ve)return jt(t),null}else 2*Ke()-l.renderingStartTime>pa&&n!==1073741824&&(t.flags|=128,r=!0,Ia(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(n=l.last,n!==null?n.sibling=o:t.child=o,l.last=o)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Ke(),t.sibling=null,n=Ye.current,Ie(Ye,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Rm(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Wt&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(se(156,t.tag))}function Kj(e,t){switch(dm(t),t.tag){case 1:return Ht(t.type)&&ii(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fa(),Fe(Vt),Fe(St),bm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ym(t),null;case 13:if(Fe(Ye),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(se(340));da()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Fe(Ye),null;case 4:return fa(),null;case 10:return pm(t.type._context),null;case 22:case 23:return Rm(),null;case 24:return null;default:return null}}var go=!1,wt=!1,Zj=typeof WeakSet=="function"?WeakSet:Set,ue=null;function Wr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(e,t,r)}else n.current=null}function ad(e,t,n){try{n()}catch(r){Xe(e,t,r)}}var xh=!1;function Jj(e,t){if(Hu=ri,e=hx(),cm(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var o=0,i=-1,c=-1,u=0,m=0,d=e,f=null;t:for(;;){for(var p;d!==n||a!==0&&d.nodeType!==3||(i=o+a),d!==l||r!==0&&d.nodeType!==3||(c=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===a&&(i=o),f===l&&++m===r&&(c=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}n=i===-1||c===-1?null:{start:i,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Uu={focusedElem:e,selectionRange:n},ri=!1,ue=t;ue!==null;)if(t=ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ue=e;else for(;ue!==null;){t=ue;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var b=v.memoizedProps,x=v.memoizedState,h=t.stateNode,g=h.getSnapshotBeforeUpdate(t.elementType===t.type?b:gn(t.type,b),x);h.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(w){Xe(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ue=e;break}ue=t.return}return v=xh,xh=!1,v}function el(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&ad(t,n,l)}a=a.next}while(a!==r)}}function Ji(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ld(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function ug(e){var t=e.alternate;t!==null&&(e.alternate=null,ug(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Xn],delete t[xl],delete t[Wu],delete t[Ij],delete t[Lj])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function dg(e){return e.tag===5||e.tag===3||e.tag===4}function gh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||dg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function od(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=oi));else if(r!==4&&(e=e.child,e!==null))for(od(e,t,n),e=e.sibling;e!==null;)od(e,t,n),e=e.sibling}function id(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(id(e,t,n),e=e.sibling;e!==null;)id(e,t,n),e=e.sibling}var pt=null,vn=!1;function Cs(e,t,n){for(n=n.child;n!==null;)mg(e,t,n),n=n.sibling}function mg(e,t,n){if(Zn&&typeof Zn.onCommitFiberUnmount=="function")try{Zn.onCommitFiberUnmount(Yi,n)}catch{}switch(n.tag){case 5:wt||Wr(n,t);case 6:var r=pt,a=vn;pt=null,Cs(e,t,n),pt=r,vn=a,pt!==null&&(vn?(e=pt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):pt.removeChild(n.stateNode));break;case 18:pt!==null&&(vn?(e=pt,n=n.stateNode,e.nodeType===8?Fc(e.parentNode,n):e.nodeType===1&&Fc(e,n),dl(e)):Fc(pt,n.stateNode));break;case 4:r=pt,a=vn,pt=n.stateNode.containerInfo,vn=!0,Cs(e,t,n),pt=r,vn=a;break;case 0:case 11:case 14:case 15:if(!wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var l=a,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&ad(n,t,o),a=a.next}while(a!==r)}Cs(e,t,n);break;case 1:if(!wt&&(Wr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){Xe(n,t,i)}Cs(e,t,n);break;case 21:Cs(e,t,n);break;case 22:n.mode&1?(wt=(r=wt)||n.memoizedState!==null,Cs(e,t,n),wt=r):Cs(e,t,n);break;default:Cs(e,t,n)}}function vh(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Zj),t.forEach(function(r){var a=i1.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function xn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var l=e,o=t,i=o;e:for(;i!==null;){switch(i.tag){case 5:pt=i.stateNode,vn=!1;break e;case 3:pt=i.stateNode.containerInfo,vn=!0;break e;case 4:pt=i.stateNode.containerInfo,vn=!0;break e}i=i.return}if(pt===null)throw Error(se(160));mg(l,o,a),pt=null,vn=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Xe(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)fg(t,e),t=t.sibling}function fg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xn(t,e),Wn(e),r&4){try{el(3,e,e.return),Ji(3,e)}catch(b){Xe(e,e.return,b)}try{el(5,e,e.return)}catch(b){Xe(e,e.return,b)}}break;case 1:xn(t,e),Wn(e),r&512&&n!==null&&Wr(n,n.return);break;case 5:if(xn(t,e),Wn(e),r&512&&n!==null&&Wr(n,n.return),e.flags&32){var a=e.stateNode;try{ol(a,"")}catch(b){Xe(e,e.return,b)}}if(r&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,o=n!==null?n.memoizedProps:l,i=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&I0(a,l),Mu(i,o);var u=Mu(i,l);for(o=0;o<c.length;o+=2){var m=c[o],d=c[o+1];m==="style"?z0(a,d):m==="dangerouslySetInnerHTML"?D0(a,d):m==="children"?ol(a,d):Qd(a,m,d,u)}switch(i){case"input":Cu(a,l);break;case"textarea":L0(a,l);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var p=l.value;p!=null?Jr(a,!!l.multiple,p,!1):f!==!!l.multiple&&(l.defaultValue!=null?Jr(a,!!l.multiple,l.defaultValue,!0):Jr(a,!!l.multiple,l.multiple?[]:"",!1))}a[xl]=l}catch(b){Xe(e,e.return,b)}}break;case 6:if(xn(t,e),Wn(e),r&4){if(e.stateNode===null)throw Error(se(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(b){Xe(e,e.return,b)}}break;case 3:if(xn(t,e),Wn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{dl(t.containerInfo)}catch(b){Xe(e,e.return,b)}break;case 4:xn(t,e),Wn(e);break;case 13:xn(t,e),Wn(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(Am=Ke())),r&4&&vh(e);break;case 22:if(m=n!==null&&n.memoizedState!==null,e.mode&1?(wt=(u=wt)||m,xn(t,e),wt=u):xn(t,e),Wn(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!m&&e.mode&1)for(ue=e,m=e.child;m!==null;){for(d=ue=m;ue!==null;){switch(f=ue,p=f.child,f.tag){case 0:case 11:case 14:case 15:el(4,f,f.return);break;case 1:Wr(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(b){Xe(r,n,b)}}break;case 5:Wr(f,f.return);break;case 22:if(f.memoizedState!==null){bh(d);continue}}p!==null?(p.return=f,ue=p):bh(d)}m=m.sibling}e:for(m=null,d=e;;){if(d.tag===5){if(m===null){m=d;try{a=d.stateNode,u?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,i.style.display=F0("display",o))}catch(b){Xe(e,e.return,b)}}}else if(d.tag===6){if(m===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(b){Xe(e,e.return,b)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;m===d&&(m=null),d=d.return}m===d&&(m=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:xn(t,e),Wn(e),r&4&&vh(e);break;case 21:break;default:xn(t,e),Wn(e)}}function Wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(dg(n)){var r=n;break e}n=n.return}throw Error(se(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(ol(a,""),r.flags&=-33);var l=gh(e);id(e,l,a);break;case 3:case 4:var o=r.stateNode.containerInfo,i=gh(e);od(e,i,o);break;default:throw Error(se(161))}}catch(c){Xe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function e1(e,t,n){ue=e,hg(e)}function hg(e,t,n){for(var r=(e.mode&1)!==0;ue!==null;){var a=ue,l=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||go;if(!o){var i=a.alternate,c=i!==null&&i.memoizedState!==null||wt;i=go;var u=wt;if(go=o,(wt=c)&&!u)for(ue=a;ue!==null;)o=ue,c=o.child,o.tag===22&&o.memoizedState!==null?Nh(a):c!==null?(c.return=o,ue=c):Nh(a);for(;l!==null;)ue=l,hg(l),l=l.sibling;ue=a,go=i,wt=u}yh(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,ue=l):yh(e)}}function yh(e){for(;ue!==null;){var t=ue;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wt||Ji(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!wt)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:gn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&sh(t,l,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}sh(t,o,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var d=m.dehydrated;d!==null&&dl(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}wt||t.flags&512&&ld(t)}catch(f){Xe(t,t.return,f)}}if(t===e){ue=null;break}if(n=t.sibling,n!==null){n.return=t.return,ue=n;break}ue=t.return}}function bh(e){for(;ue!==null;){var t=ue;if(t===e){ue=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ue=n;break}ue=t.return}}function Nh(e){for(;ue!==null;){var t=ue;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ji(4,t)}catch(c){Xe(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(c){Xe(t,a,c)}}var l=t.return;try{ld(t)}catch(c){Xe(t,l,c)}break;case 5:var o=t.return;try{ld(t)}catch(c){Xe(t,o,c)}}}catch(c){Xe(t,t.return,c)}if(t===e){ue=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ue=i;break}ue=t.return}}var t1=Math.ceil,vi=Ss.ReactCurrentDispatcher,Cm=Ss.ReactCurrentOwner,dn=Ss.ReactCurrentBatchConfig,Ae=0,mt=null,Ze=null,xt=0,Wt=0,Gr=er(0),lt=0,jl=null,Nr=0,ec=0,Em=0,tl=null,$t=null,Am=0,pa=1/0,cs=null,yi=!1,cd=null,Vs=null,vo=!1,Is=null,bi=0,nl=0,ud=null,Uo=-1,Bo=0;function Pt(){return Ae&6?Ke():Uo!==-1?Uo:Uo=Ke()}function Hs(e){return e.mode&1?Ae&2&&xt!==0?xt&-xt:Dj.transition!==null?(Bo===0&&(Bo=Z0()),Bo):(e=Me,e!==0||(e=window.event,e=e===void 0?16:ax(e.type)),e):1}function kn(e,t,n,r){if(50<nl)throw nl=0,ud=null,Error(se(185));Vl(e,n,r),(!(Ae&2)||e!==mt)&&(e===mt&&(!(Ae&2)&&(ec|=n),lt===4&&Ts(e,xt)),Ut(e,r),n===1&&Ae===0&&!(t.mode&1)&&(pa=Ke()+500,Qi&&tr()))}function Ut(e,t){var n=e.callbackNode;DN(e,t);var r=si(e,e===mt?xt:0);if(r===0)n!==null&&Pf(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Pf(n),t===1)e.tag===0?$j(jh.bind(null,e)):_x(jh.bind(null,e)),Tj(function(){!(Ae&6)&&tr()}),n=null;else{switch(J0(r)){case 1:n=tm;break;case 4:n=Q0;break;case 16:n=ni;break;case 536870912:n=K0;break;default:n=ni}n=jg(n,pg.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function pg(e,t){if(Uo=-1,Bo=0,Ae&6)throw Error(se(327));var n=e.callbackNode;if(ra()&&e.callbackNode!==n)return null;var r=si(e,e===mt?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ni(e,r);else{t=r;var a=Ae;Ae|=2;var l=gg();(mt!==e||xt!==t)&&(cs=null,pa=Ke()+500,fr(e,t));do try{r1();break}catch(i){xg(e,i)}while(!0);hm(),vi.current=l,Ae=a,Ze!==null?t=0:(mt=null,xt=0,t=lt)}if(t!==0){if(t===2&&(a=$u(e),a!==0&&(r=a,t=dd(e,a))),t===1)throw n=jl,fr(e,0),Ts(e,r),Ut(e,Ke()),n;if(t===6)Ts(e,r);else{if(a=e.current.alternate,!(r&30)&&!n1(a)&&(t=Ni(e,r),t===2&&(l=$u(e),l!==0&&(r=l,t=dd(e,l))),t===1))throw n=jl,fr(e,0),Ts(e,r),Ut(e,Ke()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(se(345));case 2:lr(e,$t,cs);break;case 3:if(Ts(e,r),(r&130023424)===r&&(t=Am+500-Ke(),10<t)){if(si(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Pt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Yu(lr.bind(null,e,$t,cs),t);break}lr(e,$t,cs);break;case 4:if(Ts(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var o=31-Sn(r);l=1<<o,o=t[o],o>a&&(a=o),r&=~l}if(r=a,r=Ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*t1(r/1960))-r,10<r){e.timeoutHandle=Yu(lr.bind(null,e,$t,cs),r);break}lr(e,$t,cs);break;case 5:lr(e,$t,cs);break;default:throw Error(se(329))}}}return Ut(e,Ke()),e.callbackNode===n?pg.bind(null,e):null}function dd(e,t){var n=tl;return e.current.memoizedState.isDehydrated&&(fr(e,t).flags|=256),e=Ni(e,t),e!==2&&(t=$t,$t=n,t!==null&&md(t)),e}function md(e){$t===null?$t=e:$t.push.apply($t,e)}function n1(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],l=a.getSnapshot;a=a.value;try{if(!Pn(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ts(e,t){for(t&=~Em,t&=~ec,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Sn(t),r=1<<n;e[n]=-1,t&=~r}}function jh(e){if(Ae&6)throw Error(se(327));ra();var t=si(e,0);if(!(t&1))return Ut(e,Ke()),null;var n=Ni(e,t);if(e.tag!==0&&n===2){var r=$u(e);r!==0&&(t=r,n=dd(e,r))}if(n===1)throw n=jl,fr(e,0),Ts(e,t),Ut(e,Ke()),n;if(n===6)throw Error(se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,lr(e,$t,cs),Ut(e,Ke()),null}function Pm(e,t){var n=Ae;Ae|=1;try{return e(t)}finally{Ae=n,Ae===0&&(pa=Ke()+500,Qi&&tr())}}function jr(e){Is!==null&&Is.tag===0&&!(Ae&6)&&ra();var t=Ae;Ae|=1;var n=dn.transition,r=Me;try{if(dn.transition=null,Me=1,e)return e()}finally{Me=r,dn.transition=n,Ae=t,!(Ae&6)&&tr()}}function Rm(){Wt=Gr.current,Fe(Gr)}function fr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Mj(n)),Ze!==null)for(n=Ze.return;n!==null;){var r=n;switch(dm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ii();break;case 3:fa(),Fe(Vt),Fe(St),bm();break;case 5:ym(r);break;case 4:fa();break;case 13:Fe(Ye);break;case 19:Fe(Ye);break;case 10:pm(r.type._context);break;case 22:case 23:Rm()}n=n.return}if(mt=e,Ze=e=Us(e.current,null),xt=Wt=t,lt=0,jl=null,Em=ec=Nr=0,$t=tl=null,cr!==null){for(t=0;t<cr.length;t++)if(n=cr[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,l=n.pending;if(l!==null){var o=l.next;l.next=a,r.next=o}n.pending=r}cr=null}return e}function xg(e,t){do{var n=Ze;try{if(hm(),zo.current=gi,xi){for(var r=We.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}xi=!1}if(br=0,ut=nt=We=null,Ja=!1,yl=0,Cm.current=null,n===null||n.return===null){lt=1,jl=t,Ze=null;break}e:{var l=e,o=n.return,i=n,c=t;if(t=xt,i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,m=i,d=m.tag;if(!(m.mode&1)&&(d===0||d===11||d===15)){var f=m.alternate;f?(m.updateQueue=f.updateQueue,m.memoizedState=f.memoizedState,m.lanes=f.lanes):(m.updateQueue=null,m.memoizedState=null)}var p=ch(o);if(p!==null){p.flags&=-257,uh(p,o,i,l,t),p.mode&1&&ih(l,u,t),t=p,c=u;var v=t.updateQueue;if(v===null){var b=new Set;b.add(c),t.updateQueue=b}else v.add(c);break e}else{if(!(t&1)){ih(l,u,t),Mm();break e}c=Error(se(426))}}else if(Ve&&i.mode&1){var x=ch(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),uh(x,o,i,l,t),mm(ha(c,i));break e}}l=c=ha(c,i),lt!==4&&(lt=2),tl===null?tl=[l]:tl.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var h=Jx(l,c,t);nh(l,h);break e;case 1:i=c;var g=l.type,y=l.stateNode;if(!(l.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Vs===null||!Vs.has(y)))){l.flags|=65536,t&=-t,l.lanes|=t;var w=eg(l,i,t);nh(l,w);break e}}l=l.return}while(l!==null)}yg(n)}catch(E){t=E,Ze===n&&n!==null&&(Ze=n=n.return);continue}break}while(!0)}function gg(){var e=vi.current;return vi.current=gi,e===null?gi:e}function Mm(){(lt===0||lt===3||lt===2)&&(lt=4),mt===null||!(Nr&268435455)&&!(ec&268435455)||Ts(mt,xt)}function Ni(e,t){var n=Ae;Ae|=2;var r=gg();(mt!==e||xt!==t)&&(cs=null,fr(e,t));do try{s1();break}catch(a){xg(e,a)}while(!0);if(hm(),Ae=n,vi.current=r,Ze!==null)throw Error(se(261));return mt=null,xt=0,lt}function s1(){for(;Ze!==null;)vg(Ze)}function r1(){for(;Ze!==null&&!AN();)vg(Ze)}function vg(e){var t=Ng(e.alternate,e,Wt);e.memoizedProps=e.pendingProps,t===null?yg(e):Ze=t,Cm.current=null}function yg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Kj(n,t),n!==null){n.flags&=32767,Ze=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{lt=6,Ze=null;return}}else if(n=Qj(n,t,Wt),n!==null){Ze=n;return}if(t=t.sibling,t!==null){Ze=t;return}Ze=t=e}while(t!==null);lt===0&&(lt=5)}function lr(e,t,n){var r=Me,a=dn.transition;try{dn.transition=null,Me=1,a1(e,t,n,r)}finally{dn.transition=a,Me=r}return null}function a1(e,t,n,r){do ra();while(Is!==null);if(Ae&6)throw Error(se(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(se(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(FN(e,l),e===mt&&(Ze=mt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vo||(vo=!0,jg(ni,function(){return ra(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=dn.transition,dn.transition=null;var o=Me;Me=1;var i=Ae;Ae|=4,Cm.current=null,Jj(e,n),fg(n,e),Sj(Uu),ri=!!Hu,Uu=Hu=null,e.current=n,e1(n),PN(),Ae=i,Me=o,dn.transition=l}else e.current=n;if(vo&&(vo=!1,Is=e,bi=a),l=e.pendingLanes,l===0&&(Vs=null),TN(n.stateNode),Ut(e,Ke()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(yi)throw yi=!1,e=cd,cd=null,e;return bi&1&&e.tag!==0&&ra(),l=e.pendingLanes,l&1?e===ud?nl++:(nl=0,ud=e):nl=0,tr(),null}function ra(){if(Is!==null){var e=J0(bi),t=dn.transition,n=Me;try{if(dn.transition=null,Me=16>e?16:e,Is===null)var r=!1;else{if(e=Is,Is=null,bi=0,Ae&6)throw Error(se(331));var a=Ae;for(Ae|=4,ue=e.current;ue!==null;){var l=ue,o=l.child;if(ue.flags&16){var i=l.deletions;if(i!==null){for(var c=0;c<i.length;c++){var u=i[c];for(ue=u;ue!==null;){var m=ue;switch(m.tag){case 0:case 11:case 15:el(8,m,l)}var d=m.child;if(d!==null)d.return=m,ue=d;else for(;ue!==null;){m=ue;var f=m.sibling,p=m.return;if(ug(m),m===u){ue=null;break}if(f!==null){f.return=p,ue=f;break}ue=p}}}var v=l.alternate;if(v!==null){var b=v.child;if(b!==null){v.child=null;do{var x=b.sibling;b.sibling=null,b=x}while(b!==null)}}ue=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,ue=o;else e:for(;ue!==null;){if(l=ue,l.flags&2048)switch(l.tag){case 0:case 11:case 15:el(9,l,l.return)}var h=l.sibling;if(h!==null){h.return=l.return,ue=h;break e}ue=l.return}}var g=e.current;for(ue=g;ue!==null;){o=ue;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,ue=y;else e:for(o=g;ue!==null;){if(i=ue,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:Ji(9,i)}}catch(E){Xe(i,i.return,E)}if(i===o){ue=null;break e}var w=i.sibling;if(w!==null){w.return=i.return,ue=w;break e}ue=i.return}}if(Ae=a,tr(),Zn&&typeof Zn.onPostCommitFiberRoot=="function")try{Zn.onPostCommitFiberRoot(Yi,e)}catch{}r=!0}return r}finally{Me=n,dn.transition=t}}return!1}function wh(e,t,n){t=ha(n,t),t=Jx(e,t,1),e=zs(e,t,1),t=Pt(),e!==null&&(Vl(e,1,t),Ut(e,t))}function Xe(e,t,n){if(e.tag===3)wh(e,e,n);else for(;t!==null;){if(t.tag===3){wh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Vs===null||!Vs.has(r))){e=ha(n,e),e=eg(t,e,1),t=zs(t,e,1),e=Pt(),t!==null&&(Vl(t,1,e),Ut(t,e));break}}t=t.return}}function l1(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Pt(),e.pingedLanes|=e.suspendedLanes&n,mt===e&&(xt&n)===n&&(lt===4||lt===3&&(xt&130023424)===xt&&500>Ke()-Am?fr(e,0):Em|=n),Ut(e,t)}function bg(e,t){t===0&&(e.mode&1?(t=oo,oo<<=1,!(oo&130023424)&&(oo=4194304)):t=1);var n=Pt();e=ys(e,t),e!==null&&(Vl(e,t,n),Ut(e,n))}function o1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),bg(e,n)}function i1(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(se(314))}r!==null&&r.delete(t),bg(e,n)}var Ng;Ng=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vt.current)Dt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Dt=!1,Xj(e,t,n);Dt=!!(e.flags&131072)}else Dt=!1,Ve&&t.flags&1048576&&Sx(t,di,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var a=ua(t,St.current);sa(t,n),a=jm(null,t,r,e,a,n);var l=wm();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ht(r)?(l=!0,ci(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,gm(t),a.updater=Zi,t.stateNode=a,a._reactInternals=t,Zu(t,r,e,n),t=td(null,t,r,!0,l,n)):(t.tag=0,Ve&&l&&um(t),Et(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=u1(r),e=gn(r,e),a){case 0:t=ed(null,t,r,e,n);break e;case 1:t=fh(null,t,r,e,n);break e;case 11:t=dh(null,t,r,e,n);break e;case 14:t=mh(null,t,r,gn(r.type,e),n);break e}throw Error(se(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),ed(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),fh(e,t,r,a,n);case 3:e:{if(rg(t),e===null)throw Error(se(387));r=t.pendingProps,l=t.memoizedState,a=l.element,Rx(e,t),hi(t,r,null,n);var o=t.memoizedState;if(r=o.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=ha(Error(se(423)),t),t=hh(e,t,r,n,a);break e}else if(r!==a){a=ha(Error(se(424)),t),t=hh(e,t,r,n,a);break e}else for(qt=Fs(t.stateNode.containerInfo.firstChild),Xt=t,Ve=!0,bn=null,n=Ax(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(da(),r===a){t=bs(e,t,n);break e}Et(e,t,r,n)}t=t.child}return t;case 5:return Mx(t),e===null&&Xu(t),r=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,o=a.children,Bu(r,a)?o=null:l!==null&&Bu(r,l)&&(t.flags|=32),sg(e,t),Et(e,t,o,n),t.child;case 6:return e===null&&Xu(t),null;case 13:return ag(e,t,n);case 4:return vm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ma(t,null,r,n):Et(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),dh(e,t,r,a,n);case 7:return Et(e,t,t.pendingProps,n),t.child;case 8:return Et(e,t,t.pendingProps.children,n),t.child;case 12:return Et(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,l=t.memoizedProps,o=a.value,Ie(mi,r._currentValue),r._currentValue=o,l!==null)if(Pn(l.value,o)){if(l.children===a.children&&!Vt.current){t=bs(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){o=l.child;for(var c=i.firstContext;c!==null;){if(c.context===r){if(l.tag===1){c=xs(-1,n&-n),c.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?c.next=c:(c.next=m.next,m.next=c),u.pending=c}}l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),Qu(l.return,n,t),i.lanes|=n;break}c=c.next}}else if(l.tag===10)o=l.type===t.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(se(341));o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),Qu(o,n,t),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===t){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}Et(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,sa(t,n),a=mn(a),r=r(a),t.flags|=1,Et(e,t,r,n),t.child;case 14:return r=t.type,a=gn(r,t.pendingProps),a=gn(r.type,a),mh(e,t,r,a,n);case 15:return tg(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gn(r,a),Ho(e,t),t.tag=1,Ht(r)?(e=!0,ci(t)):e=!1,sa(t,n),Zx(t,r,a),Zu(t,r,a,n),td(null,t,r,!0,e,n);case 19:return lg(e,t,n);case 22:return ng(e,t,n)}throw Error(se(156,t.tag))};function jg(e,t){return X0(e,t)}function c1(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function un(e,t,n,r){return new c1(e,t,n,r)}function Tm(e){return e=e.prototype,!(!e||!e.isReactComponent)}function u1(e){if(typeof e=="function")return Tm(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Zd)return 11;if(e===Jd)return 14}return 2}function Us(e,t){var n=e.alternate;return n===null?(n=un(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Yo(e,t,n,r,a,l){var o=2;if(r=e,typeof e=="function")Tm(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case $r:return hr(n.children,a,l,t);case Kd:o=8,a|=8;break;case ju:return e=un(12,n,t,a|2),e.elementType=ju,e.lanes=l,e;case wu:return e=un(13,n,t,a),e.elementType=wu,e.lanes=l,e;case _u:return e=un(19,n,t,a),e.elementType=_u,e.lanes=l,e;case M0:return tc(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P0:o=10;break e;case R0:o=9;break e;case Zd:o=11;break e;case Jd:o=14;break e;case Ps:o=16,r=null;break e}throw Error(se(130,e==null?e:typeof e,""))}return t=un(o,n,t,a),t.elementType=e,t.type=r,t.lanes=l,t}function hr(e,t,n,r){return e=un(7,e,r,t),e.lanes=n,e}function tc(e,t,n,r){return e=un(22,e,r,t),e.elementType=M0,e.lanes=n,e.stateNode={isHidden:!1},e}function Gc(e,t,n){return e=un(6,e,null,t),e.lanes=n,e}function qc(e,t,n){return t=un(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function d1(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ec(0),this.expirationTimes=Ec(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ec(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Om(e,t,n,r,a,l,o,i,c){return e=new d1(e,t,n,i,c),t===1?(t=1,l===!0&&(t|=8)):t=0,l=un(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},gm(l),e}function m1(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Lr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function wg(e){if(!e)return Gs;e=e._reactInternals;e:{if(Pr(e)!==e||e.tag!==1)throw Error(se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(se(171))}if(e.tag===1){var n=e.type;if(Ht(n))return wx(e,n,t)}return t}function _g(e,t,n,r,a,l,o,i,c){return e=Om(n,r,!0,e,a,l,o,i,c),e.context=wg(null),n=e.current,r=Pt(),a=Hs(n),l=xs(r,a),l.callback=t??null,zs(n,l,a),e.current.lanes=a,Vl(e,a,r),Ut(e,r),e}function nc(e,t,n,r){var a=t.current,l=Pt(),o=Hs(a);return n=wg(n),t.context===null?t.context=n:t.pendingContext=n,t=xs(l,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=zs(a,t,o),e!==null&&(kn(e,a,o,l),Fo(e,a,o)),o}function ji(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _h(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Im(e,t){_h(e,t),(e=e.alternate)&&_h(e,t)}function f1(){return null}var Sg=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lm(e){this._internalRoot=e}sc.prototype.render=Lm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(se(409));nc(e,t,null,null)};sc.prototype.unmount=Lm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;jr(function(){nc(null,e,null,null)}),t[vs]=null}};function sc(e){this._internalRoot=e}sc.prototype.unstable_scheduleHydration=function(e){if(e){var t=nx();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ms.length&&t!==0&&t<Ms[n].priority;n++);Ms.splice(n,0,e),n===0&&rx(e)}};function $m(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function rc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Sh(){}function h1(e,t,n,r,a){if(a){if(typeof r=="function"){var l=r;r=function(){var u=ji(o);l.call(u)}}var o=_g(t,r,e,0,null,!1,!1,"",Sh);return e._reactRootContainer=o,e[vs]=o.current,hl(e.nodeType===8?e.parentNode:e),jr(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var i=r;r=function(){var u=ji(c);i.call(u)}}var c=Om(e,0,!1,null,null,!1,!1,"",Sh);return e._reactRootContainer=c,e[vs]=c.current,hl(e.nodeType===8?e.parentNode:e),jr(function(){nc(t,c,n,r)}),c}function ac(e,t,n,r,a){var l=n._reactRootContainer;if(l){var o=l;if(typeof a=="function"){var i=a;a=function(){var c=ji(o);i.call(c)}}nc(t,o,e,a)}else o=h1(n,t,e,a,r);return ji(o)}ex=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ha(t.pendingLanes);n!==0&&(nm(t,n|1),Ut(t,Ke()),!(Ae&6)&&(pa=Ke()+500,tr()))}break;case 13:jr(function(){var r=ys(e,1);if(r!==null){var a=Pt();kn(r,e,1,a)}}),Im(e,1)}};sm=function(e){if(e.tag===13){var t=ys(e,134217728);if(t!==null){var n=Pt();kn(t,e,134217728,n)}Im(e,134217728)}};tx=function(e){if(e.tag===13){var t=Hs(e),n=ys(e,t);if(n!==null){var r=Pt();kn(n,e,t,r)}Im(e,t)}};nx=function(){return Me};sx=function(e,t){var n=Me;try{return Me=e,t()}finally{Me=n}};Ou=function(e,t,n){switch(t){case"input":if(Cu(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Xi(r);if(!a)throw Error(se(90));O0(r),Cu(r,a)}}}break;case"textarea":L0(e,n);break;case"select":t=n.value,t!=null&&Jr(e,!!n.multiple,t,!1)}};U0=Pm;B0=jr;var p1={usingClientEntryPoint:!1,Events:[Ul,Vr,Xi,V0,H0,Pm]},La={findFiberByHostInstance:ir,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},x1={bundleType:La.bundleType,version:La.version,rendererPackageName:La.rendererPackageName,rendererConfig:La.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ss.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=G0(e),e===null?null:e.stateNode},findFiberByHostInstance:La.findFiberByHostInstance||f1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yo.isDisabled&&yo.supportsFiber)try{Yi=yo.inject(x1),Zn=yo}catch{}}Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p1;Jt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$m(t))throw Error(se(200));return m1(e,t,null,n)};Jt.createRoot=function(e,t){if(!$m(e))throw Error(se(299));var n=!1,r="",a=Sg;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Om(e,1,!1,null,null,n,!1,r,a),e[vs]=t.current,hl(e.nodeType===8?e.parentNode:e),new Lm(t)};Jt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(se(188)):(e=Object.keys(e).join(","),Error(se(268,e)));return e=G0(t),e=e===null?null:e.stateNode,e};Jt.flushSync=function(e){return jr(e)};Jt.hydrate=function(e,t,n){if(!rc(t))throw Error(se(200));return ac(null,e,t,!0,n)};Jt.hydrateRoot=function(e,t,n){if(!$m(e))throw Error(se(405));var r=n!=null&&n.hydratedSources||null,a=!1,l="",o=Sg;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=_g(t,null,e,1,n??null,a,!1,l,o),e[vs]=t.current,hl(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new sc(t)};Jt.render=function(e,t,n){if(!rc(t))throw Error(se(200));return ac(null,e,t,!1,n)};Jt.unmountComponentAtNode=function(e){if(!rc(e))throw Error(se(40));return e._reactRootContainer?(jr(function(){ac(null,null,e,!1,function(){e._reactRootContainer=null,e[vs]=null})}),!0):!1};Jt.unstable_batchedUpdates=Pm;Jt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!rc(n))throw Error(se(200));if(e==null||e._reactInternals===void 0)throw Error(se(38));return ac(e,t,n,!1,r)};Jt.version="18.3.1-next-f1338f8080-20240426";function kg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kg)}catch(e){console.error(e)}}kg(),k0.exports=Jt;var g1=k0.exports,kh=g1;bu.createRoot=kh.createRoot,bu.hydrateRoot=kh.hydrateRoot;const v1={},Ch=e=>{let t;const n=new Set,r=(m,d)=>{const f=typeof m=="function"?m(t):m;if(!Object.is(f,t)){const p=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(v=>v(t,p))}},a=()=>t,c={setState:r,getState:a,getInitialState:()=>u,subscribe:m=>(n.add(m),()=>n.delete(m)),destroy:()=>{(v1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,a,c);return c},Cg=e=>e?Ch(e):Ch;var Eg={exports:{}},Ag={},Pg={exports:{}},Rg={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xa=R;function y1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var b1=typeof Object.is=="function"?Object.is:y1,N1=xa.useState,j1=xa.useEffect,w1=xa.useLayoutEffect,_1=xa.useDebugValue;function S1(e,t){var n=t(),r=N1({inst:{value:n,getSnapshot:t}}),a=r[0].inst,l=r[1];return w1(function(){a.value=n,a.getSnapshot=t,Xc(a)&&l({inst:a})},[e,n,t]),j1(function(){return Xc(a)&&l({inst:a}),e(function(){Xc(a)&&l({inst:a})})},[e]),_1(n),n}function Xc(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!b1(e,n)}catch{return!0}}function k1(e,t){return t()}var C1=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?k1:S1;Rg.useSyncExternalStore=xa.useSyncExternalStore!==void 0?xa.useSyncExternalStore:C1;Pg.exports=Rg;var E1=Pg.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lc=R,A1=E1;function P1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var R1=typeof Object.is=="function"?Object.is:P1,M1=A1.useSyncExternalStore,T1=lc.useRef,O1=lc.useEffect,I1=lc.useMemo,L1=lc.useDebugValue;Ag.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var l=T1(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=I1(function(){function c(p){if(!u){if(u=!0,m=p,p=r(p),a!==void 0&&o.hasValue){var v=o.value;if(a(v,p))return d=v}return d=p}if(v=d,R1(m,p))return v;var b=r(p);return a!==void 0&&a(v,b)?(m=p,v):(m=p,d=b)}var u=!1,m,d,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,a]);var i=M1(e,l[0],l[1]);return O1(function(){o.hasValue=!0,o.value=i},[i]),L1(i),i};Eg.exports=Ag;var $1=Eg.exports;const Mg=h0($1),Tg={},{useDebugValue:D1}=Gd,{useSyncExternalStoreWithSelector:F1}=Mg;let Eh=!1;const z1=e=>e;function V1(e,t=z1,n){(Tg?"production":void 0)!=="production"&&n&&!Eh&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Eh=!0);const r=F1(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return D1(r),r}const Ah=e=>{(Tg?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?Cg(e):e,n=(r,a)=>V1(t,r,a);return Object.assign(n,t),n},Og=e=>e?Ah(e):Ah,Ph={variables:{},schemas:{},resources:{llms:{},vector_stores:{},genie_rooms:{},tables:{},volumes:{},functions:{},warehouses:{},databases:{},connections:{}},retrievers:{},tools:{},guardrails:{},prompts:{},agents:{},app:void 0},Oe=Og(e=>({config:Ph,setConfig:t=>e({config:t}),updateConfig:t=>e(n=>({config:{...n.config,...t}})),addVariable:(t,n)=>e(r=>({config:{...r.config,variables:{...r.config.variables,[t]:n}}})),updateVariable:(t,n)=>e(r=>({config:{...r.config,variables:{...r.config.variables,[t]:n}}})),removeVariable:t=>e(n=>{const r={...n.config.variables};return r==null||delete r[t],{config:{...n.config,variables:r}}}),updateMemory:t=>e(n=>({config:{...n.config,memory:t}})),addDatabase:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,databases:{...(a=r.config.resources)==null?void 0:a.databases,[t]:n}}}}}),updateDatabase:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.databases};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,databases:a||{}}}}}),removeDatabase:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.databases};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,databases:r||{}}}}}),addSchema:(t,n)=>e(r=>({config:{...r.config,schemas:{...r.config.schemas,[t]:n}}})),updateSchema:(t,n)=>e(r=>{const a={...r.config.schemas};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,schemas:a}}}),removeSchema:t=>e(n=>{const r={...n.config.schemas};return r==null||delete r[t],{config:{...n.config,schemas:r}}}),addLLM:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,llms:{...(a=r.config.resources)==null?void 0:a.llms,[t]:n}}}}}),updateLLM:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.llms};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,llms:a||{}}}}}),removeLLM:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.llms};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,llms:r||{}}}}}),addGenieRoom:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,genie_rooms:{...(a=r.config.resources)==null?void 0:a.genie_rooms,[t]:n}}}}}),updateGenieRoom:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.genie_rooms};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,genie_rooms:a||{}}}}}),removeGenieRoom:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.genie_rooms};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,genie_rooms:r||{}}}}}),addTable:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,tables:{...(a=r.config.resources)==null?void 0:a.tables,[t]:n}}}}}),updateTable:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.tables};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,tables:a||{}}}}}),removeTable:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.tables};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,tables:r||{}}}}}),addVolume:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,volumes:{...(a=r.config.resources)==null?void 0:a.volumes,[t]:n}}}}}),updateVolume:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.volumes};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,volumes:a||{}}}}}),removeVolume:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.volumes};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,volumes:r||{}}}}}),addFunction:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,functions:{...(a=r.config.resources)==null?void 0:a.functions,[t]:n}}}}}),updateFunction:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.functions};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,functions:a||{}}}}}),removeFunction:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.functions};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,functions:r||{}}}}}),addWarehouse:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,warehouses:{...(a=r.config.resources)==null?void 0:a.warehouses,[t]:n}}}}}),updateWarehouse:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.warehouses};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,warehouses:a||{}}}}}),removeWarehouse:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.warehouses};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,warehouses:r||{}}}}}),addConnection:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,connections:{...(a=r.config.resources)==null?void 0:a.connections,[t]:n}}}}}),updateConnection:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.connections};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,connections:a||{}}}}}),removeConnection:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.connections};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,connections:r||{}}}}}),addServicePrincipal:(t,n)=>e(r=>({config:{...r.config,service_principals:{...r.config.service_principals,[t]:n}}})),updateServicePrincipal:(t,n)=>e(r=>{const a={...r.config.service_principals};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,service_principals:a}}}),removeServicePrincipal:t=>e(n=>{const r={...n.config.service_principals};return r==null||delete r[t],{config:{...n.config,service_principals:r}}}),addVectorStore:(t,n)=>e(r=>{var a;return{config:{...r.config,resources:{...r.config.resources,vector_stores:{...(a=r.config.resources)==null?void 0:a.vector_stores,[t]:n}}}}}),updateVectorStore:(t,n)=>e(r=>{var l;const a={...(l=r.config.resources)==null?void 0:l.vector_stores};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,resources:{...r.config.resources,vector_stores:a||{}}}}}),removeVectorStore:t=>e(n=>{var a;const r={...(a=n.config.resources)==null?void 0:a.vector_stores};return r==null||delete r[t],{config:{...n.config,resources:{...n.config.resources,vector_stores:r||{}}}}}),addRetriever:(t,n)=>e(r=>({config:{...r.config,retrievers:{...r.config.retrievers,[t]:n}}})),updateRetriever:(t,n)=>e(r=>{const a={...r.config.retrievers};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,retrievers:a}}}),removeRetriever:t=>e(n=>{const r={...n.config.retrievers};return r==null||delete r[t],{config:{...n.config,retrievers:r}}}),addTool:t=>e(n=>({config:{...n.config,tools:{...n.config.tools,[t.name]:t}}})),updateTool:(t,n)=>e(r=>{const a={...r.config.tools};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,tools:a}}}),removeTool:t=>e(n=>{const r={...n.config.tools};return r==null||delete r[t],{config:{...n.config,tools:r}}}),addGuardrail:t=>e(n=>({config:{...n.config,guardrails:{...n.config.guardrails,[t.name]:t}}})),updateGuardrail:(t,n)=>e(r=>{const a={...r.config.guardrails};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,guardrails:a}}}),removeGuardrail:t=>e(n=>{const r={...n.config.guardrails};return r==null||delete r[t],{config:{...n.config,guardrails:r}}}),addPrompt:(t,n)=>e(r=>({config:{...r.config,prompts:{...r.config.prompts,[t]:n}}})),updatePrompt:(t,n)=>e(r=>{const a={...r.config.prompts};return a!=null&&a[t]&&(a[t]={...a[t],...n}),{config:{...r.config,prompts:a}}}),removePrompt:t=>e(n=>{const r={...n.config.prompts};return r==null||delete r[t],{config:{...n.config,prompts:r}}}),addAgent:(t,n)=>e(r=>{var o;const a={...r.config.agents,[t]:n},l=[...((o=r.config.app)==null?void 0:o.agents)||[],n];return{config:{...r.config,agents:a,app:r.config.app?{...r.config.app,agents:l}:void 0}}}),updateAgent:(t,n)=>e(r=>{var l,o;const a={...r.config.agents};if(a!=null&&a[t]){a[t]={...a[t],...n};const i=((o=(l=r.config.app)==null?void 0:l.agents)==null?void 0:o.map(c=>c.name===t?{...c,...n}:c))||[];return{config:{...r.config,agents:a,app:r.config.app?{...r.config.app,agents:i}:void 0}}}return{config:r.config}}),removeAgent:t=>e(n=>{var l,o;const r={...n.config.agents};r==null||delete r[t];const a=((o=(l=n.config.app)==null?void 0:l.agents)==null?void 0:o.filter(i=>i.name!==t))||[];return{config:{...n.config,agents:r,app:n.config.app?{...n.config.app,agents:a}:void 0}}}),updateApp:t=>e(n=>{var r,a,l;return{config:{...n.config,app:{name:((r=n.config.app)==null?void 0:r.name)||"",registered_model:((a=n.config.app)==null?void 0:a.registered_model)||{name:""},agents:((l=n.config.app)==null?void 0:l.agents)||[],...n.config.app,...t}}}}),reset:()=>e({config:Ph})}));/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var H1={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),de=(e,t)=>{const n=R.forwardRef(({color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:i="",children:c,...u},m)=>R.createElement("svg",{ref:m,...H1,width:a,height:a,stroke:r,strokeWidth:o?Number(l)*24/Number(a):l,className:["lucide",`lucide-${U1(e)}`,i].join(" "),...u},[...t.map(([d,f])=>R.createElement(d,f)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=de("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=de("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rh=de("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=de("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=de("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=de("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=de("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=de("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=de("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=de("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=de("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G1=de("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=de("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=de("CloudCog",[["circle",{cx:"12",cy:"17",r:"3",key:"1spfwm"}],["path",{d:"M4.2 15.1A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.2",key:"zaobp"}],["path",{d:"m15.7 18.4-.9-.3",key:"4qxpbn"}],["path",{d:"m9.2 15.9-.9-.3",key:"17q7o2"}],["path",{d:"m10.6 20.7.3-.9",key:"1pf4s2"}],["path",{d:"m13.1 14.2.3-.9",key:"1mnuqm"}],["path",{d:"m13.6 20.7-.4-1",key:"1jpd1m"}],["path",{d:"m10.8 14.3-.4-1",key:"17ugyy"}],["path",{d:"m8.3 18.6 1-.4",key:"s42vdx"}],["path",{d:"m14.7 15.8 1-.4",key:"2wizun"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=de("Code2",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X1=de("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=de("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=de("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=de("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q1=de("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K1=de("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z1=de("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=de("FileCode",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=de("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=de("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=de("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=de("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J1=de("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=de("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=de("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oc=de("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=de("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=de("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=de("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=de("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=de("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=de("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=de("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=de("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=de("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=de("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=de("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=de("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=de("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fg=de("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=de("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=de("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=de("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=de("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=de("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=de("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=de("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=de("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=de("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=de("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=de("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=de("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aw=de("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lw=de("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=de("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=de("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=de("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=de("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=de("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=de("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=de("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function zg(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=zg(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Te(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=zg(e))&&(r&&(r+=" "),r+=t);return r}const Kc=[{id:"overview",label:"Overview",icon:ew,description:"Getting started"},{id:"variables",label:"Variables",icon:Cn,description:"Config variables"},{id:"service_principals",label:"Service Principals",icon:Rn,description:"OAuth credentials"},{id:"schemas",label:"Schemas",icon:Qt,description:"Unity Catalog schemas",required:!0},{id:"resources",label:"Resources",icon:Dg,description:"Databricks resources",required:!0},{id:"retrievers",label:"Retrievers",icon:wr,description:"Vector search retrievers"},{id:"tools",label:"Tools",icon:js,description:"Agent tools"},{id:"guardrails",label:"Guardrails",icon:Xs,description:"Safety checks"},{id:"memory",label:"Memory",icon:Lg,description:"Persistence & storage"},{id:"prompts",label:"Prompts",icon:ga,description:"MLflow prompts"},{id:"agents",label:"Agents",icon:_t,description:"AI agents",required:!0},{id:"app",label:"Application",icon:Qn,description:"App settings & orchestration",required:!0}];function ow({activeSection:e,onSectionChange:t,config:n}){const r=l=>{var o,i,c,u,m,d,f,p,v,b;switch(l){case"overview":return 0;case"variables":return Object.keys(n.variables||{}).length;case"service_principals":return Object.keys(n.service_principals||{}).length;case"schemas":return Object.keys(n.schemas||{}).length;case"resources":return Object.keys(((o=n.resources)==null?void 0:o.llms)||{}).length+Object.keys(((i=n.resources)==null?void 0:i.genie_rooms)||{}).length+Object.keys(((c=n.resources)==null?void 0:c.tables)||{}).length+Object.keys(((u=n.resources)==null?void 0:u.volumes)||{}).length+Object.keys(((m=n.resources)==null?void 0:m.functions)||{}).length+Object.keys(((d=n.resources)==null?void 0:d.warehouses)||{}).length+Object.keys(((f=n.resources)==null?void 0:f.connections)||{}).length;case"retrievers":return Object.keys(n.retrievers||{}).length;case"tools":return Object.keys(n.tools||{}).length;case"guardrails":return Object.keys(n.guardrails||{}).length;case"memory":return((p=n.memory)!=null&&p.checkpointer?1:0)+((v=n.memory)!=null&&v.store?1:0);case"prompts":return Object.keys(n.prompts||{}).length;case"agents":return Object.keys(n.agents||{}).length;case"app":return(b=n.app)!=null&&b.name?1:0;default:return 0}},a=l=>{const o=r(l),i=Kc.find(c=>c.id===l);return i!=null&&i.required?o>0:!0};return s.jsxs("aside",{className:"w-64 bg-slate-900 border-r border-slate-800 flex flex-col",children:[s.jsxs("div",{className:"p-4",children:[s.jsx("h2",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3",children:"Configuration"}),s.jsx("nav",{className:"space-y-1",children:Kc.map(l=>{const o=l.icon,i=r(l.id),c=a(l.id),u=e===l.id;return s.jsxs("button",{onClick:()=>t(l.id),className:Te("w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-left transition-all duration-200",u?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"text-slate-400 hover:bg-slate-800 hover:text-slate-200 border border-transparent"),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(o,{className:Te("w-5 h-5",u?"text-blue-400":"text-slate-500")}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium",children:l.label}),s.jsx("p",{className:"text-xs text-slate-500",children:l.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[i>0&&s.jsx("span",{className:Te("px-1.5 py-0.5 text-xs rounded",u?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"),children:i}),l.required&&(c?s.jsx(an,{className:"w-4 h-4 text-emerald-500"}):s.jsx(G1,{className:"w-4 h-4 text-amber-500"}))]})]},l.id)})})]}),s.jsx("div",{className:"mt-auto p-4 border-t border-slate-800",children:s.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[s.jsx("h3",{className:"text-xs font-semibold text-slate-400 mb-2",children:"Configuration Status"}),s.jsx("div",{className:"space-y-1.5",children:Kc.filter(l=>l.required).map(l=>{const o=a(l.id);return s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-slate-500",children:l.label}),s.jsx("span",{className:o?"text-emerald-400":"text-amber-400",children:o?" Ready":" Required"})]},l.id)})})]})})]})}const ye=R.forwardRef(({className:e,variant:t="default",children:n,...r},a)=>{const l={default:"bg-slate-800/50 border-slate-700/50",interactive:"bg-slate-800/50 border-slate-700/50 hover:border-slate-600 hover:bg-slate-800/70 cursor-pointer transition-all duration-200",highlight:"bg-gradient-to-br from-blue-500/10 to-purple-500/10 border-blue-500/30"};return s.jsx("div",{ref:a,className:Te("rounded-xl border p-4",l[t],e),...r,children:n})});ye.displayName="Card";const Q=R.forwardRef(({className:e,variant:t="primary",size:n="md",loading:r,children:a,disabled:l,...o},i)=>{const c="inline-flex items-center justify-center font-medium transition-all duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:opacity-50 disabled:cursor-not-allowed",u={primary:"bg-blue-600 text-white hover:bg-blue-500 focus:ring-blue-500 shadow-lg shadow-blue-500/25",secondary:"bg-slate-700 text-slate-200 hover:bg-slate-600 focus:ring-slate-500 border border-slate-600",ghost:"bg-transparent text-slate-300 hover:bg-slate-800 hover:text-white focus:ring-slate-500",danger:"bg-red-600/20 text-red-400 hover:bg-red-600/30 focus:ring-red-500 border border-red-500/30"},m={sm:"px-3 py-1.5 text-sm gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-2"};return s.jsxs("button",{ref:i,className:Te(c,u[t],m[n],e),disabled:l||r,...o,children:[r&&s.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]})});Q.displayName="Button";const we=R.forwardRef(({className:e,variant:t="default",children:n,...r},a)=>{const l={default:"bg-slate-700 text-slate-300",success:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",warning:"bg-amber-500/20 text-amber-400 border-amber-500/30",danger:"bg-red-500/20 text-red-400 border-red-500/30",info:"bg-blue-500/20 text-blue-400 border-blue-500/30"};return s.jsx("span",{ref:a,className:Te("inline-flex items-center px-2 py-0.5 rounded-md text-xs font-medium border",l[t],e),...r,children:n})});we.displayName="Badge";const bo=[{id:"schemas",title:"1. Define Schemas",description:"Set up Unity Catalog schemas for your resources",icon:Qt,color:"text-blue-400",isComplete:e=>Object.keys(e.schemas||{}).length>0},{id:"resources",title:"2. Configure Resources",description:"Add LLMs, Genie rooms, tables, and other Databricks resources",icon:Dg,color:"text-emerald-400",isComplete:e=>{const t=e.resources||{};return Object.keys(t.llms||{}).length>0}},{id:"tools",title:"3. Create Tools",description:"Define tools that agents can use to perform tasks",icon:js,color:"text-amber-400",isComplete:e=>Object.keys(e.tools||{}).length>0},{id:"agents",title:"4. Build Agents",description:"Create AI agents with models, tools, and prompts",icon:_t,color:"text-violet-400",isComplete:e=>Object.keys(e.agents||{}).length>0},{id:"app",title:"5. Configure Application",description:"Set up your application and deployment settings",icon:Qn,color:"text-rose-400",isComplete:e=>{var t,n,r;return((t=e.app)==null?void 0:t.name)&&((r=(n=e.app)==null?void 0:n.registered_model)==null?void 0:r.name)}}];function iw({onNavigate:e}){var i;const{config:t}=Oe(),n={schemas:Object.keys(t.schemas||{}).length,llms:Object.keys(((i=t.resources)==null?void 0:i.llms)||{}).length,tools:Object.keys(t.tools||{}).length,agents:Object.keys(t.agents||{}).length,prompts:Object.keys(t.prompts||{}).length},r=bo.filter(c=>c.isComplete(t)).length,a=bo.length,l=Math.round(r/a*100),o=r===0;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"DAO AI Configuration Builder"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Build and configure multi-agent AI systems for Databricks"})]}),s.jsxs(ye,{className:"bg-gradient-to-br from-slate-800/80 to-slate-900/80 border-slate-700/50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center",children:s.jsx(rt,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-white",children:o?"Get Started":"Configuration Progress"}),s.jsx("p",{className:"text-sm text-slate-400",children:o?"Follow the steps below to build your agent configuration":`${r} of ${a} steps completed`})]})]}),!o&&s.jsxs("div",{className:"text-right",children:[s.jsxs("span",{className:"text-2xl font-bold text-white",children:[l,"%"]}),s.jsx("p",{className:"text-xs text-slate-500",children:"complete"})]})]}),s.jsx("div",{className:"w-full bg-slate-700/50 rounded-full h-2 mb-4",children:s.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-violet-500 h-2 rounded-full transition-all duration-500",style:{width:`${l}%`}})}),!o&&s.jsxs("div",{className:"grid grid-cols-5 gap-4 pt-2",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.schemas}),s.jsx("p",{className:"text-xs text-slate-500",children:"Schemas"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.llms}),s.jsx("p",{className:"text-xs text-slate-500",children:"LLMs"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.tools}),s.jsx("p",{className:"text-xs text-slate-500",children:"Tools"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.agents}),s.jsx("p",{className:"text-xs text-slate-500",children:"Agents"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-lg font-semibold text-white",children:n.prompts}),s.jsx("p",{className:"text-xs text-slate-500",children:"Prompts"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-white",children:o?"Getting Started":"Configuration Steps"}),bo.map((c,u)=>{const m=c.icon,d=c.isComplete(t),f=!d&&bo.slice(0,u).every(p=>p.isComplete(t));return s.jsx(ye,{variant:f?"highlight":"default",className:`transition-all duration-200 ${f?"ring-1 ring-blue-500/50":""}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${d?"bg-emerald-500/20":f?"bg-blue-500/20":"bg-slate-700/50"}`,children:d?s.jsx(an,{className:"w-5 h-5 text-emerald-400"}):s.jsx(m,{className:`w-5 h-5 ${f?c.color:"text-slate-500"}`})}),s.jsxs("div",{children:[s.jsx("h4",{className:`font-medium ${d?"text-slate-400":"text-white"}`,children:c.title}),s.jsx("p",{className:"text-sm text-slate-500",children:c.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[d&&s.jsx(we,{variant:"success",children:"Complete"}),f&&s.jsx(we,{variant:"info",children:"Next Step"}),s.jsxs(Q,{variant:f?"primary":"secondary",size:"sm",onClick:()=>e(c.id),children:[d?"Edit":f?"Start":"Configure",s.jsx(B1,{className:"w-4 h-4 ml-1"})]})]})]})},c.id)})]}),s.jsxs(ye,{children:[s.jsx("h3",{className:"font-semibold text-white mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("button",{onClick:()=>e("prompts"),className:"flex items-center space-x-3 p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg transition-colors text-left",children:[s.jsx(ga,{className:"w-5 h-5 text-violet-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Manage Prompts"}),s.jsx("p",{className:"text-xs text-slate-500",children:"MLflow registry"})]})]}),s.jsxs("button",{onClick:()=>e("memory"),className:"flex items-center space-x-3 p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg transition-colors text-left",children:[s.jsx(Qt,{className:"w-5 h-5 text-cyan-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Configure Memory"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Persistence options"})]})]}),s.jsxs("button",{onClick:()=>e("app"),className:"flex items-center space-x-3 p-3 bg-slate-800/50 hover:bg-slate-700/50 rounded-lg transition-colors text-left",children:[s.jsx(_t,{className:"w-5 h-5 text-amber-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:"Configure Application"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Orchestration & deployment"})]})]})]})]}),s.jsx("div",{className:"text-center text-sm text-slate-500 py-4",children:s.jsx("p",{children:" Tip: Use the YAML preview on the right to see your configuration in real-time"})})]})}const re=R.forwardRef(({className:e,label:t,error:n,hint:r,id:a,...l},o)=>{const i=a||(t==null?void 0:t.toLowerCase().replace(/\s+/g,"-"));return s.jsxs("div",{className:"space-y-1.5",children:[t&&s.jsxs("label",{htmlFor:i,className:"block text-sm font-medium text-slate-300",children:[t,l.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("input",{ref:o,id:i,className:Te("w-full px-3 py-2 bg-slate-800/50 border rounded-lg text-slate-200 placeholder-slate-500","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200",n?"border-red-500/50":"border-slate-700",e),...l}),r&&!n&&s.jsx("p",{className:"text-xs text-slate-500",children:r}),n&&s.jsx("p",{className:"text-xs text-red-400",children:n})]})});re.displayName="Input";const le=R.forwardRef(({className:e,label:t,error:n,hint:r,options:a,placeholder:l,id:o,...i},c)=>{const u=o||(t==null?void 0:t.toLowerCase().replace(/\s+/g,"-")),m=a.length===0;return s.jsxs("div",{className:"space-y-1.5",children:[t&&s.jsxs("label",{htmlFor:u,className:"block text-sm font-medium text-slate-300",children:[t,i.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("div",{className:"relative",children:m?s.jsxs("div",{className:Te("w-full px-3 py-2 bg-slate-800/50 border rounded-lg appearance-none","transition-all duration-200","border-slate-700 text-sm text-slate-500",e),children:["No options available",s.jsx(Ns,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("select",{ref:c,id:u,className:Te("w-full px-3 py-2 bg-slate-800/50 border rounded-lg text-slate-200 appearance-none","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200 cursor-pointer",n?"border-red-500/50":"border-slate-700",e),...i,children:[l&&s.jsx("option",{value:"",className:"text-slate-500",children:l}),a.map(d=>s.jsx("option",{value:d.value,className:"bg-slate-800",children:d.label},d.value))]}),s.jsx(Ns,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none"})]})}),r&&!n&&s.jsx("p",{className:"text-xs text-slate-500",children:r}),n&&s.jsx("p",{className:"text-xs text-red-400",children:n})]})});le.displayName="Select";const Zc={name:"",type:"primitive",primitiveValue:"",envName:"",envDefault:"",secretScope:"",secretKey:"",secretDefault:"",compositeOptions:[],compositeDefault:""},cw=[{value:"primitive",label:"Primitive Value"},{value:"env",label:"Environment Variable"},{value:"secret",label:"Databricks Secret"},{value:"composite",label:"Composite (Fallback Chain)"}],uw=e=>{switch(e){case"primitive":return Fm;case"env":return Cn;case"secret":return zm;case"composite":return hs;default:return Cn}},Vg=e=>"type"in e?e.type:"primitive",dw=e=>{switch(Vg(e)){case"primitive":return`Value: ${e.value}`;case"env":return`Env: ${e.env}`;case"secret":const n=e;return`Secret: ${n.scope}/${n.secret}`;case"composite":return`${e.options.length} fallback option(s)`;default:return""}};function mw(){const{config:e,addVariable:t,removeVariable:n}=Oe(),[r,a]=R.useState(!1),[l,o]=R.useState(Zc),i=e.variables||{},c=()=>{switch(l.type){case"primitive":return{type:"primitive",value:l.primitiveValue};case"env":return{type:"env",env:l.envName,...l.envDefault&&{default_value:l.envDefault}};case"secret":return{type:"secret",scope:l.secretScope,secret:l.secretKey,...l.secretDefault&&{default_value:l.secretDefault}};case"composite":return{type:"composite",options:l.compositeOptions.map(p=>p.type==="env"?{type:"env",env:p.envName||""}:p.type==="secret"?{type:"secret",scope:p.scope||"",secret:p.secret||""}:{type:"primitive",value:p.value||""}),...l.compositeDefault&&{default_value:l.compositeDefault}};default:return{type:"primitive",value:""}}},u=()=>{if(!l.name.trim())return;const p=c();t(l.name,p),o(Zc),a(!1)},m=p=>{o({...l,compositeOptions:[...l.compositeOptions,{type:p,envName:"",scope:"",secret:"",value:""}]})},d=(p,v)=>{const b=[...l.compositeOptions];b[p]={...b[p],...v},o({...l,compositeOptions:b})},f=p=>{o({...l,compositeOptions:l.compositeOptions.filter((v,b)=>b!==p)})};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-white",children:"Variables"}),s.jsx("p",{className:"text-sm text-slate-400",children:"Define reusable configuration variables (env vars, secrets, or values)"})]}),s.jsxs(Q,{onClick:()=>a(!0),disabled:r,children:[s.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Add Variable"]})]}),r&&s.jsxs(ye,{className:"p-4 space-y-4 border-blue-500/50",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Variable Name",placeholder:"e.g., client_id, workspace_host",value:l.name,onChange:p=>o({...l,name:p.target.value})}),s.jsx(le,{label:"Variable Type",value:l.type,onChange:p=>o({...l,type:p.target.value}),options:cw})]}),l.type==="primitive"&&s.jsx(re,{label:"Value",placeholder:"Enter the value",value:l.primitiveValue,onChange:p=>o({...l,primitiveValue:p.target.value})}),l.type==="env"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Environment Variable Name",placeholder:"e.g., DATABRICKS_HOST",value:l.envName,onChange:p=>o({...l,envName:p.target.value})}),s.jsx(re,{label:"Default Value (optional)",placeholder:"Fallback if env var not set",value:l.envDefault,onChange:p=>o({...l,envDefault:p.target.value})})]}),l.type==="secret"&&s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsx(re,{label:"Secret Scope",placeholder:"e.g., retail_ai",value:l.secretScope,onChange:p=>o({...l,secretScope:p.target.value})}),s.jsx(re,{label:"Secret Key",placeholder:"e.g., DATABRICKS_TOKEN",value:l.secretKey,onChange:p=>o({...l,secretKey:p.target.value})}),s.jsx(re,{label:"Default Value (optional)",placeholder:"Fallback if secret not found",value:l.secretDefault,onChange:p=>o({...l,secretDefault:p.target.value})})]}),l.type==="composite"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Fallback Options (tried in order)"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(Q,{size:"sm",variant:"secondary",onClick:()=>m("env"),children:[s.jsx(Cn,{className:"w-3 h-3 mr-1"})," Add Env"]}),s.jsxs(Q,{size:"sm",variant:"secondary",onClick:()=>m("secret"),children:[s.jsx(zm,{className:"w-3 h-3 mr-1"})," Add Secret"]}),s.jsxs(Q,{size:"sm",variant:"secondary",onClick:()=>m("primitive"),children:[s.jsx(Fm,{className:"w-3 h-3 mr-1"})," Add Value"]})]})]}),l.compositeOptions.length===0&&s.jsx("p",{className:"text-sm text-slate-500 italic",children:"Add fallback options. They will be tried in order until one succeeds."}),l.compositeOptions.map((p,v)=>s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-800/50 rounded-lg",children:[s.jsxs("span",{className:"text-xs text-slate-500 w-6",children:[v+1,"."]}),p.type==="env"&&s.jsx(re,{className:"flex-1",placeholder:"Environment variable name",value:p.envName||"",onChange:b=>d(v,{envName:b.target.value})}),p.type==="secret"&&s.jsxs(s.Fragment,{children:[s.jsx(re,{className:"flex-1",placeholder:"Scope",value:p.scope||"",onChange:b=>d(v,{scope:b.target.value})}),s.jsx(re,{className:"flex-1",placeholder:"Secret key",value:p.secret||"",onChange:b=>d(v,{secret:b.target.value})})]}),p.type==="primitive"&&s.jsx(re,{className:"flex-1",placeholder:"Value",value:p.value||"",onChange:b=>d(v,{value:b.target.value})}),s.jsx("span",{className:"text-xs text-slate-500 capitalize",children:p.type}),s.jsx("button",{onClick:()=>f(v),className:"text-slate-400 hover:text-red-400",children:s.jsx(Ge,{className:"w-4 h-4"})})]},v)),s.jsx(re,{label:"Default Value (optional)",placeholder:"Final fallback if all options fail",value:l.compositeDefault,onChange:p=>o({...l,compositeDefault:p.target.value})})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(Q,{variant:"secondary",onClick:()=>{a(!1),o(Zc)},children:"Cancel"}),s.jsx(Q,{onClick:u,disabled:!l.name.trim(),children:"Add Variable"})]})]}),Object.keys(i).length===0&&!r?s.jsxs(ye,{className:"p-8 text-center",children:[s.jsx("div",{className:"text-slate-400 mb-4",children:s.jsx(Cn,{className:"w-12 h-12 mx-auto opacity-50"})}),s.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No Variables Defined"}),s.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Variables let you configure values from environment variables, Databricks secrets, or fallback chains. Use them to keep sensitive data out of your config."}),s.jsxs(Q,{onClick:()=>a(!0),children:[s.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Add Your First Variable"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(i).map(([p,v])=>{const b=Vg(v),x=uw(b);return s.jsx(ye,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-slate-700/50 rounded-lg",children:s.jsx(x,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-white",children:p}),s.jsx("p",{className:"text-sm text-slate-400",children:dw(v)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs px-2 py-1 bg-slate-700/50 rounded text-slate-300 capitalize",children:b}),s.jsx("button",{onClick:()=>n(p),className:"text-slate-400 hover:text-red-400 p-1",children:s.jsx(Ge,{className:"w-4 h-4"})})]})]})},p)})}),Object.keys(i).length>0&&s.jsxs(ye,{className:"p-4 bg-slate-800/30 border-slate-700/50",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300 mb-2",children:"Usage in YAML"}),s.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Reference variables using YAML anchors:"}),s.jsx("pre",{className:"text-xs bg-slate-900/50 p-2 rounded overflow-x-auto",children:s.jsx("code",{className:"text-green-400",children:`variables:
  ${Object.keys(i)[0]||"my_var"}: &${Object.keys(i)[0]||"my_var"}
    ...

# Use in config:
tools:
  my_tool:
    function:
      client_id: *${Object.keys(i)[0]||"my_var"}`})})]})]})}function Th(e,t){return typeof e=="string"&&e.startsWith(t)}function No(e){return typeof e=="string"?e:""}function Oh(e,t,n){if(!e)return!1;const r=t.resources||{},a=["llms","genie_rooms","tables","volumes","functions","warehouses","connections","databases","vector_stores"];for(const m of a){const d=r[m]||{};if(e in d&&e!==n)return!0}const l=t.service_principals||{};if(e in l&&e!==n)return!0;const o=t.agents||{};if(e in o&&e!==n)return!0;const i=t.tools||{};if(e in i&&e!==n)return!0;const c=t.schemas||{};if(e in c&&e!==n)return!0;const u=t.variables||{};return e in u&&e!==n}const jo={refName:"",clientIdSource:"variable",clientSecretSource:"variable",client_id:"",client_secret:"",clientIdVariable:"",clientSecretVariable:""};function fw(){const{config:e,addServicePrincipal:t,updateServicePrincipal:n,removeServicePrincipal:r}=Oe(),a=e.service_principals||{},l=e.variables||{},o=Object.keys(l),[i,c]=R.useState(!1),[u,m]=R.useState(null),[d,f]=R.useState(jo),p=y=>{const w=a[y];if(w){const E=S=>Th(S,"*"),_=S=>{const N=No(S);return N.startsWith("*")?N.slice(1):""};f({refName:y,clientIdSource:E(w.client_id)?"variable":"manual",clientSecretSource:E(w.client_secret)?"variable":"manual",client_id:E(w.client_id)?"":No(w.client_id),client_secret:E(w.client_secret)?"":No(w.client_secret),clientIdVariable:E(w.client_id)?_(w.client_id):"",clientSecretVariable:E(w.client_secret)?_(w.client_secret):""}),m(y),c(!0)}},v=()=>{const y={client_id:d.clientIdSource==="variable"&&d.clientIdVariable?`*${d.clientIdVariable}`:d.client_id,client_secret:d.clientSecretSource==="variable"&&d.clientSecretVariable?`*${d.clientSecretVariable}`:d.client_secret};u?u!==d.refName?(r(u),t(d.refName,y)):n(d.refName,y):t(d.refName,y),f(jo),c(!1),m(null)},b=()=>{f(jo),c(!1),m(null)},x=y=>{r(y)},h=d.clientIdSource==="variable"?!!d.clientIdVariable:!!d.client_id,g=d.clientSecretSource==="variable"?!!d.clientSecretVariable:!!d.client_secret;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Service Principals"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure OAuth credentials for database connections, MCP tools, and other services that require authentication."})]}),s.jsx(ye,{className:"p-4 bg-blue-500/10 border-blue-500/30",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Cn,{className:"w-5 h-5 text-blue-400 mt-0.5"}),s.jsxs("div",{className:"text-sm text-blue-200",children:[s.jsx("p",{className:"font-medium",children:"About Service Principals"}),s.jsxs("p",{className:"text-blue-300 mt-1",children:["Service principals provide OAuth client credentials (client_id and client_secret) that can be referenced throughout your configuration using ",s.jsx("code",{className:"bg-blue-900/50 px-1 rounded",children:"*reference_name"})," syntax. They're commonly used for database connections, external API authentication, and MCP tool configuration."]})]})]})}),s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Cn,{className:"w-5 h-5 text-amber-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Configured Service Principals"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{f(jo),m(null),c(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Service Principal"]})]}),Object.keys(a).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(a).map(([y,w])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Cn,{className:"w-4 h-4 text-amber-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:y}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Client ID: ",Th(w.client_id,"*")?`Variable (${No(w.client_id).slice(1)})`:""]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>p(y),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>x(y),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},y))}),Object.keys(a).length===0&&!i&&s.jsx("p",{className:"text-slate-500 text-sm",children:'No service principals configured. Click "Add Service Principal" to create one.'}),i&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[u?"Edit":"New"," Service Principal"]}),s.jsx(re,{label:"Reference Name",value:d.refName,onChange:y=>f({...d,refName:y.target.value}),placeholder:"my_service_principal",hint:u?"Changing this will update all references in the YAML":"Unique key to reference this service principal (e.g., *my_service_principal)",required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client ID *"}),s.jsx("div",{className:"flex space-x-2",children:s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>f({...d,clientIdSource:"variable",client_id:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${d.clientIdSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>f({...d,clientIdSource:"manual",clientIdVariable:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${d.clientIdSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})})]}),d.clientIdSource==="variable"?s.jsx(le,{value:d.clientIdVariable,onChange:y=>f({...d,clientIdVariable:y.target.value}),options:[{value:"",label:"Select a variable..."},...o.map(y=>({value:y,label:y}))],hint:"Reference a configured variable for the client ID"}):s.jsx(re,{type:"password",value:d.client_id,onChange:y=>f({...d,client_id:y.target.value}),placeholder:"Enter client ID...",hint:"OAuth client ID for the service principal"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client Secret *"}),s.jsx("div",{className:"flex space-x-2",children:s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>f({...d,clientSecretSource:"variable",client_secret:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${d.clientSecretSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>f({...d,clientSecretSource:"manual",clientSecretVariable:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${d.clientSecretSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})})]}),d.clientSecretSource==="variable"?s.jsx(le,{value:d.clientSecretVariable,onChange:y=>f({...d,clientSecretVariable:y.target.value}),options:[{value:"",label:"Select a variable..."},...o.map(y=>({value:y,label:y}))],hint:"Reference a configured variable for the client secret"}):s.jsx(re,{type:"password",value:d.client_secret,onChange:y=>f({...d,client_secret:y.target.value}),placeholder:"Enter client secret...",hint:"OAuth client secret for the service principal"})]}),d.refName&&Oh(d.refName,e,u)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',d.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:b,children:"Cancel"}),s.jsx(Q,{onClick:v,disabled:!d.refName||!h||!g||Oh(d.refName,e,u),children:u?"Update":"Add"})]})]})]}),s.jsxs(ye,{className:"p-4",children:[s.jsx("h4",{className:"font-medium text-slate-200 mb-3",children:"Usage Examples"}),s.jsxs("div",{className:"text-sm text-slate-400 space-y-2",children:[s.jsx("p",{children:"Once configured, reference service principals in your YAML using the asterisk notation:"}),s.jsx("pre",{className:"bg-slate-800 p-3 rounded text-xs overflow-x-auto",children:`databases:
  my_database:
    service_principal: *my_service_principal
    host: ...

tools:
  mcp_tool:
    function:
      type: mcp
      service_principal: *my_service_principal
      ...`})]})]})]})}function En({isOpen:e,onClose:t,title:n,description:r,children:a,size:l="md"}){if(R.useEffect(()=>{const i=c=>{c.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow="unset"}},[e,t]),!e)return null;const o={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-[90vw]"};return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[s.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:t}),s.jsxs("div",{className:Te("relative w-full bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl animate-fade-in",o[l]),children:[s.jsxs("div",{className:"flex items-start justify-between p-6 border-b border-slate-800",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-white",children:n}),r&&s.jsx("p",{className:"mt-1 text-sm text-slate-400",children:r})]}),s.jsx("button",{onClick:t,className:"p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(aa,{className:"w-5 h-5"})})]}),s.jsx("div",{className:Te("p-6 overflow-y-auto",l==="full"?"max-h-[80vh]":"max-h-[70vh]"),children:a})]})]})}let qr=null;const Vm="databricks_config";function hw(){const e=window.location.hostname;return e.includes(".databricks")||e.includes(".azuredatabricks.")||e.endsWith(".databricks.com")||e.endsWith(".gcp.databricks.com")||e.endsWith(".cloud.databricks.com")}function pw(){return window.location.origin}let Sl=null;function xw(e){Sl=e}function Ba(e){console.log("[Config] Setting config:",{host:e.host,source:e.source,isAutoDetected:e.isAutoDetected}),qr=e;try{localStorage.setItem(Vm,JSON.stringify(e)),console.log("[Config] Saved to localStorage")}catch(t){console.error("[Config] Failed to save to localStorage:",t)}Sl?(console.log("[Config] Notifying listeners of config change"),Sl()):console.warn("[Config] No config change callback registered")}function dr(){if(qr)return qr;try{const e=localStorage.getItem(Vm);if(e)return qr=JSON.parse(e),qr}catch{}return null}function Hg(){qr=null;try{localStorage.removeItem(Vm)}catch{}Sl&&Sl()}function nr(){return dr()!==null}async function gw(e){const t=e?`/api/auth/login?host=${encodeURIComponent(e)}`:"/api/auth/login";return(await fetch(t,{credentials:"include"})).json()}async function vw(){await fetch("/api/auth/logout",{credentials:"include"}),Hg()}async function yw(){var n;const e=hw(),t=dr();if(t)return console.log("[AutoDetect] Already configured, returning existing config"),{success:!0,host:t.host,hasToken:!0,inDatabricksApp:e,source:t.source};try{console.log("[AutoDetect] Fetching /api/auth/context...");const r=await fetch("/api/auth/context",{credentials:"include"});if(console.log("[AutoDetect] Response status:",r.status,r.ok),r.ok){const a=await r.json();if(console.log("[AutoDetect] Auth context data:",a),a.host&&a.has_token){const l=a.auth_method;return Ba({host:a.host,token:`__${l.toUpperCase()}_TOKEN__`,isAutoDetected:!0,source:l}),{success:!0,host:a.host,hasToken:!0,inDatabricksApp:a.is_databricks_app,user:a.user,source:l,oauth:a.oauth}}return a.host&&!a.has_token?{success:!1,host:a.host,hasToken:!1,inDatabricksApp:a.is_databricks_app,user:a.user,source:null,oauth:a.oauth,error:(n=a.oauth)!=null&&n.configured?'Not authenticated. Click "Login with Databricks" to authenticate.':a.is_databricks_app?"On-behalf-of-user authentication is not enabled. Please configure manual credentials or enable OBO auth for this app.":"Token not found. Configure credentials manually or set DATABRICKS_TOKEN environment variable."}:{success:!1,host:null,hasToken:!1,inDatabricksApp:a.is_databricks_app,oauth:a.oauth,error:"No Databricks host configured."}}}catch{}return e?{success:!1,host:pw(),hasToken:!1,inDatabricksApp:!0,error:"Could not connect to backend. Please ensure the app is running correctly."}:{success:!1,host:null,hasToken:!1,inDatabricksApp:!1,error:"Configure Databricks credentials manually."}}class os extends Error{constructor(t,n,r){super(t),this.status=n,this.errorCode=r,this.name="DatabricksApiError"}}const bt={async getConnectionStatus(){const e=dr();if(console.log("[getConnectionStatus] Current config:",e),!e)return console.log("[getConnectionStatus] No config found, returning not connected"),{connected:!1,error:"Not configured"};try{console.log("[getConnectionStatus] Fetching /api/auth/verify...");const t={"Content-Type":"application/json","X-Databricks-Host":e.host};e.token&&!e.token.startsWith("__")&&e.source==="manual"?(console.log("[getConnectionStatus] Using manual token for verification"),t.Authorization=`Bearer ${e.token}`):console.log("[getConnectionStatus] Using auto-detected auth (no Authorization header)");const a=await(await fetch("/api/auth/verify",{credentials:"include",headers:t})).json();return console.log("[getConnectionStatus] Verify response:",a),a.authenticated&&a.user?{connected:!0,user:a.user.userName,display_name:a.user.displayName,host:a.host||e.host,isAutoDetected:e.isAutoDetected,source:a.token_source||e.source}:{connected:!1,error:a.error||a.message||"Authentication failed"}}catch(t){return console.error("[getConnectionStatus] Error:",t),{connected:!1,error:t instanceof Error?t.message:"Unknown error"}}},async listCatalogs(){const e=await fetch("/api/uc/catalogs",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new os(n.error||"Failed to list catalogs")}return(await e.json()).catalogs||[]},async listSchemas(e){const t=await fetch(`/api/uc/schemas?catalog=${encodeURIComponent(e)}`,{credentials:"include"});if(!t.ok){const r=await t.json().catch(()=>({error:t.statusText}));throw new os(r.error||"Failed to list schemas")}return(await t.json()).schemas||[]},async listTables(e,t){const n=await fetch(`/api/uc/tables?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new os(a.error||"Failed to list tables")}return(await n.json()).tables||[]},async getTableColumns(e,t,n){const r=await fetch(`/api/uc/table-columns?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}&table=${encodeURIComponent(n)}`,{credentials:"include"});if(!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));throw new os(l.error||"Failed to get table columns")}return(await r.json()).columns||[]},async listFunctions(e,t){const n=await fetch(`/api/uc/functions?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new os(a.error||"Failed to list functions")}return(await n.json()).functions||[]},async listVolumes(e,t){const n=await fetch(`/api/uc/volumes?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"});if(!n.ok){const a=await n.json().catch(()=>({error:n.statusText}));throw new os(a.error||"Failed to list volumes")}return(await n.json()).volumes||[]},async listDatabases(){try{const e=await fetch("/api/uc/databases",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));return console.error("[listDatabases] Error:",n),[]}return(await e.json()).databases||[]}catch(e){return console.error("[listDatabases] Error:",e),[]}},async listServingEndpoints(){try{const e=await fetch("/api/uc/serving-endpoints",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new os(n.error||"Failed to list serving endpoints")}return(await e.json()).endpoints||[]}catch(e){return console.error("[listServingEndpoints] Error:",e),[]}},async listSQLWarehouses(){try{const e=await fetch("/api/uc/sql-warehouses",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new os(n.error||"Failed to list SQL warehouses")}return(await e.json()).warehouses||[]}catch(e){return console.error("[listSQLWarehouses] Error:",e),[]}},async listGenieSpaces(){try{const e=await fetch("/api/uc/genie-spaces",{credentials:"include"});return e.ok?((await e.json()).spaces||[]).map(n=>({space_id:n.id||n.space_id||"",title:n.name||n.title||"",description:n.description,owner:n.owner})):[]}catch{return[]}},async listVectorSearchEndpoints(){try{const e=await fetch("/api/uc/vector-search-endpoints",{credentials:"include"});return e.ok?(await e.json()).endpoints||[]:[]}catch{return[]}},async listVectorSearchIndexes(e){try{const t=e?`/api/uc/vector-search-indexes?endpoint=${encodeURIComponent(e)}`:"/api/uc/vector-search-indexes",n=await fetch(t,{credentials:"include"});return n.ok?(await n.json()).vector_indexes||[]:[]}catch{return[]}},async listUCConnections(){try{const e=await fetch("/api/uc/connections",{credentials:"include"});return e.ok?(await e.json()).connections||[]:[]}catch{return[]}},async listRegisteredModels(){try{const e=await fetch("/api/uc/registered-models",{credentials:"include"});if(!e.ok){const n=await e.json().catch(()=>({error:e.statusText}));throw new os(n.error||"Failed to list registered models")}return(await e.json()).models||[]}catch(e){return console.error("[listRegisteredModels] Error:",e),[]}},async listPrompts(e,t,n){try{let r;if(n?r=await fetch("/api/uc/prompts",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({catalog:e,schema:t,service_principal:n})}):r=await fetch(`/api/uc/prompts?catalog=${encodeURIComponent(e)}&schema=${encodeURIComponent(t)}`,{credentials:"include"}),!r.ok){const l=await r.json().catch(()=>({error:r.statusText}));return console.error("[listPrompts] Error:",l),[]}return(await r.json()).prompts||[]}catch(r){return console.error("[listPrompts] Error:",r),[]}},async getPromptDetails(e,t){try{let n;if(t?n=await fetch("/api/uc/prompt-details",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,service_principal:t})}):n=await fetch(`/api/uc/prompt-details?name=${encodeURIComponent(e)}`,{credentials:"include"}),!n.ok){const r=await n.json().catch(()=>({error:n.statusText}));return console.error("[getPromptDetails] Error:",r),null}return await n.json()}catch(n){return console.error("[getPromptDetails] Error:",n),null}},async getPromptTemplate(e,t,n,r){try{let a;if(r)a=await fetch("/api/uc/prompt-template",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,version:t||void 0,alias:n||void 0,service_principal:r})});else{let o=`/api/uc/prompt-template?name=${encodeURIComponent(e)}`;t?o+=`&version=${encodeURIComponent(t)}`:n&&(o+=`&alias=${encodeURIComponent(n)}`),a=await fetch(o,{credentials:"include"})}const l=await a.json().catch(()=>({error:a.statusText}));return a.ok?l:(console.error("[getPromptTemplate] Error:",l),{template:"",version:"",error:l.error||"Failed to load template",alias_not_found:l.alias_not_found,version_not_found:l.version_not_found})}catch(a){return console.error("[getPromptTemplate] Error:",a),{template:"",version:"",error:a instanceof Error?a.message:"Unknown error"}}}};let bd=0;const Ci=new Set;function bw(){bd++,console.log("[Hooks] Config change notified, new version:",bd,"listeners:",Ci.size),Ci.forEach(e=>e())}console.log("[Hooks] Registering config change callback");xw(bw);function Nw(e){return Ci.add(e),()=>Ci.delete(e)}function jw(){return bd}function Ug(){return R.useSyncExternalStore(Nw,jw)}function kt(e,t=[],n=!1){const r=Ug(),[a,l]=R.useState(null),[o,i]=R.useState(!1),[c,u]=R.useState(null),m=JSON.stringify(t),d=R.useRef(!1),f=R.useCallback(async()=>{if(d.current)return;const p=nr();if(n||!p){i(!1),l(null);return}d.current=!0,i(!0),u(null);try{const v=await e();l(v)}catch(v){console.error("[useAsync] Fetch error:",v),u(v instanceof Error?v:new Error(String(v)))}finally{i(!1),d.current=!1}},[n,r,m]);return R.useEffect(()=>{f()},[f]),{data:a,loading:o,error:c,refetch:f}}function ww(){const[e,t]=R.useState(!0),[n,r]=R.useState(!1),[a,l]=R.useState(null),[o,i]=R.useState(!1),[c,u]=R.useState(!1),[m,d]=R.useState(null),[f,p]=R.useState(void 0),[v,b]=R.useState(0),x=R.useCallback(()=>{b(h=>h+1)},[]);return R.useEffect(()=>{(async()=>{console.log("[useAutoDetectConfig] Starting detection..."),t(!0);const g=await yw();console.log("[useAutoDetectConfig] Detection result:",g),r(g.success),l(g.host),i(g.hasToken),u(g.inDatabricksApp),d(g.error||null),p(g.oauth),t(!1)})()},[v]),{detecting:e,detected:n,autoDetectedHost:a,hasToken:o,inDatabricksApp:c,error:m,oauthInfo:f,redetect:x}}function _w(){const e=Ug(),t=nr();console.log("[useConnectionStatus] configured:",t,"configVer:",e);const n=kt(async()=>{console.log("[useConnectionStatus] Calling getConnectionStatus...");const r=await bt.getConnectionStatus();return console.log("[useConnectionStatus] Got status:",r),r},[t,e],!1);return console.log("[useConnectionStatus] Returning:",{...n,configured:t}),{...n,configured:t}}function Rr(){return kt(()=>bt.listCatalogs(),[])}function Kn(e){return kt(async()=>e?bt.listSchemas(e):[],[e],!e)}function Nd(e,t){return kt(async()=>!e||!t?[]:bt.listTables(e,t),[e,t],!e||!t)}function Sw(e,t,n){return kt(async()=>!e||!t||!n?[]:bt.getTableColumns(e,t,n),[e,t,n],!e||!t||!n)}function Bg(e,t){return kt(async()=>!e||!t?[]:bt.listFunctions(e,t),[e,t],!e||!t)}function jd(e,t){return kt(async()=>!e||!t?[]:bt.listVolumes(e,t),[e,t],!e||!t)}function kw(){return kt(()=>bt.listServingEndpoints(),[])}function Cw(){return kt(()=>bt.listDatabases(),[])}function Ew(){return kt(()=>bt.listSQLWarehouses(),[])}function Yg(){return kt(()=>bt.listGenieSpaces(),[])}function Wg(){return kt(()=>bt.listUCConnections(),[])}function Gg(){return kt(()=>bt.listVectorSearchEndpoints(),[])}function wd(e){return kt(async()=>bt.listVectorSearchIndexes(e),[e])}function Aw(e,t,n){return kt(async()=>!e||!t?[]:bt.listPrompts(e,t,n),[e,t,n],!e||!t)}function Pw(e,t){return kt(async()=>e?bt.getPromptDetails(e,t):null,[e,t],!e)}function Wo({label:e="Catalog",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select a catalog"}){const{data:i,loading:c,error:u}=Rr(),m=nr(),d=[{value:"",label:o},...(i||[]).map(f=>({value:f.name,label:f.name}))];return s.jsx(le,{label:e,value:t,onChange:f=>n(f.target.value),options:d,hint:m?c?"Loading catalogs...":u?"Failed to load catalogs":r:"Connect to Databricks first",required:a,disabled:l||c||!m})}function Go({label:e="Schema",value:t,onChange:n,catalog:r,hint:a,required:l,disabled:o,placeholder:i="Select a schema"}){const{data:c,loading:u,error:m}=Kn(r),d=nr();R.useEffect(()=>{t&&c&&!c.find(p=>p.name===t)&&n("")},[r,c,t,n]);const f=[{value:"",label:i},...(c||[]).map(p=>({value:p.name,label:p.name}))];return s.jsx(le,{label:e,value:t,onChange:p=>n(p.target.value),options:f,hint:d?r?u?"Loading schemas...":m?"Failed to load schemas":a:"Select a catalog first":"Connect to Databricks first",required:l,disabled:o||u||!r||!d})}function Ih({label:e="Genie Space",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select a Genie space"}){const{data:i,loading:c,error:u}=Yg(),m=nr(),d=p=>{let v=p.title;if(p.description){const b=p.description.length>50?p.description.substring(0,50)+"...":p.description;v+=` - ${b}`}return v},f=[{value:"",label:o},...(i||[]).map(p=>({value:p.space_id,label:d(p)}))];return s.jsx(le,{label:e,value:t,onChange:p=>n(p.target.value),options:f,hint:m?c?"Loading Genie spaces...":u?"Failed to load Genie spaces":r:"Connect to Databricks first",required:a,disabled:l||c||!m})}function Lh({label:e="Vector Search Endpoint",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select an endpoint"}){const{data:i,loading:c,error:u}=Gg(),m=nr(),d=[{value:"",label:o},...(i||[]).map(f=>{var p;return{value:f.name,label:`${f.name}${(p=f.endpoint_status)!=null&&p.state?` (${f.endpoint_status.state})`:""}`}})];return s.jsx(le,{label:e,value:t,onChange:f=>n(f.target.value),options:d,hint:m?c?"Loading endpoints...":u?"Failed to load endpoints":r:"Connect to Databricks first",required:a,disabled:l||c||!m})}function Rw({label:e="UC Connection",value:t,onChange:n,hint:r,required:a,disabled:l,placeholder:o="Select a connection"}){const{data:i,loading:c,error:u}=Wg(),m=nr(),d=[{value:"",label:o},...(i||[]).map(f=>({value:f.name,label:`${f.name}${f.connection_type?` (${f.connection_type})`:""}`}))];return s.jsx(le,{label:e,value:t,onChange:f=>n(f.target.value),options:d,hint:m?c?"Loading connections...":u?"Failed to load connections":(i==null?void 0:i.length)===0?"No UC connections found":r:"Connect to Databricks first",required:a,disabled:l||c||!m})}function Jc(e,t){return`${e}_${t}`.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function Mw(){const{config:e,addSchema:t,removeSchema:n,updateSchema:r}=Oe(),[a,l]=R.useState(!1),[o,i]=R.useState(null),[c,u]=R.useState("select"),[m,d]=R.useState({name:"",catalogName:"",schemaName:""}),f=e.schemas||{},p=nr(),{data:v,loading:b,refetch:x}=Rr(),{data:h}=Kn(m.catalogName||null),g=()=>{d({name:"",catalogName:"",schemaName:""}),u("select"),i(null)},y=(S,N)=>{i(S),d({name:S,catalogName:N.catalog_name,schemaName:N.schema_name});const k=v==null?void 0:v.some(A=>A.name===N.catalog_name);u(k?"select":"create"),l(!0)},w=S=>{if(S.preventDefault(),m.name&&m.catalogName&&m.schemaName){const N={catalog_name:m.catalogName,schema_name:m.schemaName};o?r(o,N):t(m.name,N),g(),l(!1)}},E=S=>{d({...m,catalogName:S,schemaName:""})},_=c==="create"&&m.catalogName&&m.schemaName&&(h==null?void 0:h.some(S=>S.name===m.schemaName));return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Schemas"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Define Unity Catalog schemas for your data and resources"})]}),s.jsxs(Q,{onClick:()=>{g(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Schema"]})]}),Object.keys(f).length===0?s.jsxs(ye,{className:"text-center py-12",children:[s.jsx(Qt,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No schemas configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Schemas define where your data and resources are stored in Unity Catalog."}),s.jsxs(Q,{onClick:()=>{g(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Schema"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(f).map(([S,N])=>{const k=v==null?void 0:v.some(A=>A.name===N.catalog_name);return s.jsx(ye,{variant:"interactive",className:"group cursor-pointer",onClick:()=>y(S,N),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center",children:s.jsx(Qt,{className:"w-5 h-5 text-blue-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:S}),s.jsxs("p",{className:"text-sm text-slate-400",children:[N.catalog_name,".",N.schema_name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[k?s.jsx(we,{variant:"success",children:"Exists"}):s.jsx(we,{variant:"warning",children:"New"}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:A=>{A.stopPropagation(),y(S,N)},children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:A=>{A.stopPropagation(),n(S)},children:s.jsx(Ge,{className:"w-4 h-4"})})]})]})},S)})}),s.jsx(En,{isOpen:a,onClose:()=>{l(!1),g()},title:o?"Edit Schema":"Add Schema",description:"Configure a Unity Catalog schema reference",children:s.jsxs("form",{onSubmit:w,className:"space-y-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., retail_schema",value:m.name,onChange:S=>d({...m,name:S.target.value}),hint:"A unique identifier for this schema in your config",required:!0,disabled:!!o}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsxs("button",{type:"button",onClick:()=>u("select"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 flex items-center justify-center gap-1.5 ${c==="select"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/40":"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:text-slate-300 hover:border-slate-600"}`,children:[s.jsx(Qt,{className:"w-3.5 h-3.5"}),"Use Existing"]}),s.jsxs("button",{type:"button",onClick:()=>u("create"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 flex items-center justify-center gap-1.5 ${c==="create"?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/40":"bg-slate-800/50 text-slate-400 border border-slate-700/50 hover:text-slate-300 hover:border-slate-600"}`,children:[s.jsx(Pe,{className:"w-3.5 h-3.5"}),"Create New"]})]})]}),c==="select"?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-slate-400",children:"Select from existing Unity Catalog"}),s.jsxs("button",{type:"button",onClick:()=>x(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:b,children:[s.jsx(gt,{className:`w-3 h-3 ${b?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),!p&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 text-amber-400 text-sm",children:"Connect to Databricks first to browse existing catalogs and schemas."}),s.jsx(Wo,{label:"Catalog Name",value:m.catalogName,onChange:E,hint:"Select a Unity Catalog catalog",required:!0}),s.jsx(Go,{label:"Schema Name",value:m.schemaName,onChange:S=>d({...m,schemaName:S,name:m.name||Jc(m.catalogName,S)}),catalog:m.catalogName||null,hint:"Select a schema within the catalog",required:!0})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:s.jsxs("p",{className:"text-sm text-green-400",children:[s.jsx("strong",{children:"Note:"})," When you deploy your dao-ai agent, it will create these Unity Catalog resources if they don't exist. Make sure you have the appropriate permissions."]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:["Catalog Name ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:m.catalogName,onChange:S=>d({...m,catalogName:S.target.value}),placeholder:"e.g., retail_catalog",className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),v&&v.length>0&&s.jsxs("select",{value:"",onChange:S=>{S.target.value&&d({...m,catalogName:S.target.value})},className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-400 cursor-pointer hover:border-slate-600",children:[s.jsx("option",{value:"",children:"Pick existing..."}),v.map(S=>s.jsx("option",{value:S.name,children:S.name},S.name))]})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter a new catalog name or pick an existing one"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:["Schema Name ",s.jsx("span",{className:"text-red-400",children:"*"})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("input",{type:"text",value:m.schemaName,onChange:S=>{const N=S.target.value;d({...m,schemaName:N,name:m.name||Jc(m.catalogName,N)})},placeholder:"e.g., hardware_store",className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),m.catalogName&&h&&h.length>0&&s.jsxs("select",{value:"",onChange:S=>{S.target.value&&d({...m,schemaName:S.target.value,name:m.name||Jc(m.catalogName,S.target.value)})},className:"px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-400 cursor-pointer hover:border-slate-600",children:[s.jsx("option",{value:"",children:"Pick existing..."}),h.map(S=>s.jsx("option",{value:S.name,children:S.name},S.name))]})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter a new schema name or pick an existing one"})]}),_&&s.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20",children:s.jsx("p",{className:"text-sm text-blue-400",children:" This schema already exists in Unity Catalog"})})]})]}),m.catalogName&&m.schemaName&&s.jsxs("div",{className:"p-3 rounded-lg bg-slate-800/50 border border-slate-700",children:[s.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Full schema path:"}),s.jsxs("code",{className:"text-sm text-white font-mono",children:[m.catalogName,".",m.schemaName]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{l(!1),g()},children:"Cancel"}),s.jsx(Q,{type:"submit",children:o?"Save Changes":"Add Schema"})]})]})})]})}const $h={ready:"bg-green-500",transitioning:"bg-yellow-500",stopped:"bg-red-500",unknown:"bg-slate-500"};function Gl({value:e,onChange:t,options:n,placeholder:r="Select...",disabled:a=!1,className:l=""}){const[o,i]=R.useState(!1),c=R.useRef(null),u=n.find(p=>p.value===e);R.useEffect(()=>{const p=v=>{c.current&&!c.current.contains(v.target)&&i(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]),R.useEffect(()=>{const p=v=>{v.key==="Escape"&&i(!1)};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[]);const m=p=>{p&&!p.startsWith("__header")&&(t(p),i(!1))},d=[];let f="";return n.forEach(p=>{p.value.startsWith("__header")?(f=p.label,d.push({group:f,items:[]})):d.length>0?d[d.length-1].items.push(p):(d.length===0&&d.push({group:"",items:[]}),d[0].items.push(p))}),s.jsxs("div",{ref:c,className:`relative ${l}`,children:[s.jsxs("button",{type:"button",onClick:()=>!a&&i(!o),disabled:a,className:`
          w-full flex items-center justify-between px-3 py-2
          bg-slate-800 border border-slate-700 rounded-lg
          text-left text-sm
          ${a?"opacity-50 cursor-not-allowed":"hover:border-slate-600 cursor-pointer"}
          focus:outline-none focus:ring-2 focus:ring-blue-500
          transition-colors
        `,children:[s.jsxs("span",{className:"flex items-center gap-2 truncate",children:[(u==null?void 0:u.status)&&s.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${$h[u.status]}`}),s.jsx("span",{className:u?"text-white":"text-slate-400",children:(u==null?void 0:u.label)||r})]}),s.jsx(Ns,{className:`w-4 h-4 text-slate-400 transition-transform ${o?"rotate-180":""}`})]}),o&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-60 overflow-auto",children:d.map((p,v)=>s.jsxs("div",{children:[p.group&&s.jsx("div",{className:"px-3 py-1.5 text-xs font-semibold text-slate-500 bg-slate-900/50 sticky top-0",children:p.group.replace(/^\s*/,"").replace(/\s*$/,"")}),p.items.map(b=>s.jsxs("button",{type:"button",onClick:()=>m(b.value),disabled:b.disabled,className:`
                    w-full flex items-center gap-2 px-3 py-2 text-sm text-left
                    ${b.disabled?"opacity-50 cursor-not-allowed":"hover:bg-slate-700/50 cursor-pointer"}
                    ${b.value===e?"bg-blue-500/20 text-blue-400":"text-slate-200"}
                    transition-colors
                  `,children:[b.status&&s.jsx("span",{className:`w-2 h-2 rounded-full flex-shrink-0 ${$h[b.status]}`}),s.jsx("span",{className:"truncate flex-1",children:b.label}),b.value===e&&s.jsx(_i,{className:"w-4 h-4 text-blue-400 flex-shrink-0"})]},b.value))]},v))})]})}function Qs(e,t){return typeof e=="string"&&e.startsWith(t)}function Lt(e){return typeof e=="string"?e:""}const Tw=[{id:"llms",label:"LLMs",icon:wl,description:"Language models"},{id:"genie_rooms",label:"Genie Rooms",icon:qs,description:"AI-powered data assistants"},{id:"warehouses",label:"SQL Warehouses",icon:Qt,description:"SQL compute resources"},{id:"tables",label:"Tables",icon:gd,description:"Unity Catalog tables"},{id:"volumes",label:"Volumes",icon:hd,description:"Unity Catalog volumes"},{id:"functions",label:"Functions",icon:fd,description:"Unity Catalog functions"},{id:"connections",label:"Connections",icon:pd,description:"External connections"},{id:"databases",label:"Databases",icon:_l,description:"Lakebase/PostgreSQL backends"},{id:"vector_stores",label:"Vector Stores",icon:hs,description:"Vector search indexes"}],Dh=[{value:"databricks-claude-3-7-sonnet",label:"Claude 3.7 Sonnet"},{value:"databricks-claude-sonnet-4",label:"Claude Sonnet 4"},{value:"databricks-meta-llama-3-3-70b-instruct",label:"Llama 3.3 70B Instruct"},{value:"databricks-meta-llama-3-1-405b-instruct",label:"Llama 3.1 405B Instruct"},{value:"databricks-meta-llama-3-1-8b-instruct",label:"Llama 3.1 8B Instruct"},{value:"databricks-dbrx-instruct",label:"DBRX Instruct"},{value:"databricks-gte-large-en",label:"GTE Large (Embeddings)"}];function De(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function ft(e,t,n){if(!e)return!1;const r=t.resources||{},a=["llms","genie_rooms","tables","volumes","functions","warehouses","connections","databases","vector_stores"];for(const p of a){const v=r[p]||{};if(e in v&&e!==n)return!0}const l=t.service_principals||{};if(e in l&&e!==n)return!0;const o=t.agents||{};if(e in o&&e!==n)return!0;const i=t.tools||{};if(e in i&&e!==n)return!0;const c=t.guardrails||{};if(e in c&&e!==n)return!0;const u=t.retrievers||{};if(e in u&&e!==n)return!0;const m=t.schemas||{};if(e in m&&e!==n)return!0;const d=t.prompts||{};if(e in d&&e!==n)return!0;const f=t.variables||{};return e in f&&e!==n}function Ow(){const{config:e}=Oe(),t=e.resources,[n,r]=R.useState("llms"),[a,l]=R.useState(!1),[o,i]=R.useState(null),c=()=>{l(!1),i(null)},u=()=>{switch(n){case"llms":return s.jsx(Lw,{});case"genie_rooms":return s.jsx($w,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"warehouses":return s.jsx(Dw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"tables":return s.jsx(Fw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"volumes":return s.jsx(zw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"functions":return s.jsx(Vw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"connections":return s.jsx(Hw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"databases":return s.jsx(Gw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});case"vector_stores":return s.jsx(Xw,{showForm:a,setShowForm:l,editingKey:o,setEditingKey:i,onClose:c});default:return null}},m=d=>{switch(d){case"llms":return Object.keys((t==null?void 0:t.llms)||{}).length;case"genie_rooms":return Object.keys((t==null?void 0:t.genie_rooms)||{}).length;case"tables":return Object.keys((t==null?void 0:t.tables)||{}).length;case"volumes":return Object.keys((t==null?void 0:t.volumes)||{}).length;case"functions":return Object.keys((t==null?void 0:t.functions)||{}).length;case"warehouses":return Object.keys((t==null?void 0:t.warehouses)||{}).length;case"connections":return Object.keys((t==null?void 0:t.connections)||{}).length;case"databases":return Object.keys((t==null?void 0:t.databases)||{}).length;case"vector_stores":return Object.keys((t==null?void 0:t.vector_stores)||{}).length;default:return 0}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Resources"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure Databricks resources that can be referenced in tools, agents, and other parts of your configuration."})]}),s.jsx(ye,{className:"p-4 bg-blue-900/20 border-blue-500/30",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(oc,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-300",children:[s.jsx("p",{className:"font-medium",children:"Resource References"}),s.jsxs("p",{className:"mt-1 text-blue-400/80",children:["Resources defined here can be referenced by their ",s.jsx("strong",{children:"reference name"}),' (the key) in tools and other configuration sections. For example, a Genie room named "retail_genie" can be used in tools to create Genie-powered assistants.']})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-2 border-b border-slate-700 pb-4",children:Tw.map(d=>{const f=d.icon,p=m(d.id);return s.jsxs("button",{onClick:()=>{r(d.id),l(!1),i(null)},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${n===d.id?"bg-blue-500/20 text-blue-300 border border-blue-500/30":"bg-slate-800/50 text-slate-400 hover:bg-slate-800 hover:text-slate-300"}`,children:[s.jsx(f,{className:"w-4 h-4"}),s.jsx("span",{children:d.label}),p>0&&s.jsx(we,{variant:"default",className:"ml-1",children:p})]},d.id)})}),s.jsx("div",{children:u()})]})}function Iw({index:e,fallback:t,isReference:n,refKey:r,hasConfiguredLLMs:a,llms:l,endpoints:o,editingKey:i,formDataName:c,onUpdate:u,onRemove:m,getEndpointStatus:d}){const[f,p]=R.useState(n?"reference":"endpoint"),v=Object.entries(l).filter(([h])=>h!==i&&h!==c).map(([h,g])=>({value:`ref:${h}`,label:`*${h}  ${g.name}`})),b=o.map(h=>({value:h.name,label:h.name,status:d(h.state)})),x=h=>{p(h),u("")};return s.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg border border-slate-700 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["Fallback #",e+1]}),s.jsx(Q,{variant:"ghost",size:"sm",type:"button",onClick:m,children:s.jsx(Ge,{className:"w-3 h-3 text-red-400"})})]}),a&&s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>x("reference"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>x("endpoint"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="endpoint"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Endpoint"})]}),f==="reference"&&a?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:t,onChange:h=>u(h.target.value),options:[{value:"",label:"Select a configured LLM..."},...v]}),n&&r&&l[r]&&s.jsxs("div",{className:"p-2 bg-slate-800/50 rounded text-xs",children:[s.jsx("span",{className:"text-blue-400",children:"YAML output:"})," ",s.jsxs("code",{className:"text-slate-300",children:["*",r]}),s.jsxs("span",{className:"text-slate-500 ml-2",children:[" ",l[r].name]})]})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsx(Gl,{value:Qs(t,"ref:")?"":Lt(t),onChange:u,options:[{value:"",label:"Select an endpoint..."},...b],placeholder:"Select an endpoint..."}),t&&!Qs(t,"ref:")&&s.jsxs("div",{className:"p-2 bg-slate-800/50 rounded text-xs",children:[s.jsx("span",{className:"text-green-400",children:"YAML output:"})," ",s.jsx("code",{className:"text-slate-300",children:t})]})]})]})}function Lw(){var A;const{config:e,addLLM:t,removeLLM:n,updateLLM:r}=Oe(),[a,l]=R.useState(!1),[o,i]=R.useState(null),[c,u]=R.useState("preset"),[m,d]=R.useState(!1),[f,p]=R.useState({name:"",modelName:"",customModelName:"",temperature:"0.1",maxTokens:"8192",onBehalfOfUser:!1,fallbacks:[]}),{data:v,loading:b,refetch:x}=kw(),h=((A=e.resources)==null?void 0:A.llms)||{},g=()=>{p({name:"",modelName:"",customModelName:"",temperature:"0.1",maxTokens:"8192",onBehalfOfUser:!1,fallbacks:[]}),u("preset"),d(!1),i(null)},y=(C,O)=>{i(C);const F=(O.fallbacks||[]).map(j=>{const T=typeof j=="string"?j:j.name;return Object.keys(h).includes(T)&&T!==C?`ref:${T}`:T});p({name:C,modelName:O.name,customModelName:O.name,temperature:String(O.temperature??.1),maxTokens:String(O.max_tokens??8192),onBehalfOfUser:O.on_behalf_of_user??!1,fallbacks:F}),Dh.some(j=>j.value===O.name)?u("preset"):v!=null&&v.some(j=>j.name===O.name)?u("endpoint"):u("custom"),d(!!(O.on_behalf_of_user||O.fallbacks&&O.fallbacks.length>0)),l(!0)},w=C=>{C.preventDefault();let O="";switch(c){case"preset":O=f.modelName;break;case"endpoint":O=f.modelName;break;case"custom":O=f.customModelName;break}if(f.name&&O){const F={name:O,temperature:parseFloat(f.temperature),max_tokens:parseInt(f.maxTokens)};f.onBehalfOfUser&&(F.on_behalf_of_user=!0),f.fallbacks.length>0&&(F.fallbacks=f.fallbacks),o?o!==f.name?(n(o),t(f.name,F)):r(o,F):t(f.name,F),g(),l(!1)}},E=()=>{p({...f,fallbacks:[...f.fallbacks,""]})},_=(C,O)=>{const F=[...f.fallbacks];F[C]=O,p({...f,fallbacks:F})},S=C=>{p({...f,fallbacks:f.fallbacks.filter((O,F)=>F!==C)})},N=C=>{var F;switch((F=C==null?void 0:C.ready)==null?void 0:F.toUpperCase()){case"READY":return"ready";case"NOT_READY":return"transitioning";default:return"unknown"}},k=[{value:"",label:b?"Loading endpoints...":"Select an endpoint..."},...(v||[]).map(C=>({value:C.name,label:C.name,status:N(C.state)}))];return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(wl,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Language Models"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add LLM"]})]}),Object.keys(h).length>0?s.jsx("div",{className:"space-y-2",children:Object.entries(h).map(([C,O])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700 cursor-pointer hover:bg-slate-800/70 transition-colors",onClick:()=>y(C,O),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(wl,{className:"w-4 h-4 text-purple-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:C}),s.jsx("p",{className:"text-xs text-slate-500",children:O.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[O.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),O.fallbacks&&O.fallbacks.length>0&&s.jsxs(we,{variant:"warning",title:`${O.fallbacks.length} fallback(s)`,children:[s.jsx(hs,{className:"w-3 h-3 mr-1"}),O.fallbacks.length]}),s.jsxs(we,{variant:"info",children:["temp: ",O.temperature??.1]}),s.jsxs(we,{variant:"default",children:["tokens: ",O.max_tokens??8192]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:F=>{F.stopPropagation(),n(C)},children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},C))}):s.jsx("p",{className:"text-slate-500 text-sm",children:"No LLMs configured. Add language models that will power your AI agents."}),s.jsx(En,{isOpen:a,onClose:()=>{l(!1),g()},title:o?"Edit Language Model":"Add Language Model",description:"Configure an LLM for your agents to use",children:s.jsxs("form",{onSubmit:w,className:"space-y-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., default_llm",value:f.name,onChange:C=>p({...f,name:C.target.value}),hint:o?"Changing this will update all references in the YAML":"A unique identifier for this LLM in your config",required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Model Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>u("preset"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${c==="preset"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Preset"}),s.jsx("button",{type:"button",onClick:()=>u("endpoint"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${c==="endpoint"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Endpoint"}),s.jsx("button",{type:"button",onClick:()=>u("custom"),className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${c==="custom"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Custom"})]})]}),c==="preset"&&s.jsx(le,{label:"Model",options:[{value:"",label:"Select a model..."},...Dh],value:f.modelName,onChange:C=>p({...f,modelName:C.target.value,name:f.name||De(C.target.value)}),required:!0}),c==="endpoint"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Serving Endpoint"}),s.jsxs("button",{type:"button",onClick:()=>x(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:b,children:[s.jsx(gt,{className:`w-3 h-3 ${b?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(Gl,{options:k,value:f.modelName,onChange:C=>p({...f,modelName:C,name:f.name||De(C)}),disabled:b,placeholder:"Select an endpoint..."}),b&&s.jsx("p",{className:"text-xs text-slate-500",children:"Loading endpoints from Databricks..."})]}),c==="custom"&&s.jsx(re,{label:"Custom Model Name",placeholder:"e.g., my-custom-endpoint",value:f.customModelName,onChange:C=>p({...f,customModelName:C.target.value}),hint:"Enter the name of your custom model endpoint",required:!0}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Temperature",type:"number",step:"0.1",min:"0",max:"2",value:f.temperature,onChange:C=>p({...f,temperature:C.target.value}),hint:"0.0 = deterministic, 2.0 = creative"}),s.jsx(re,{label:"Max Tokens",type:"number",min:"1",max:"128000",value:f.maxTokens,onChange:C=>p({...f,maxTokens:C.target.value}),hint:"Maximum response length"})]}),s.jsxs("button",{type:"button",onClick:()=>d(!m),className:"flex items-center space-x-2 text-sm text-slate-400 hover:text-white transition-colors",children:[m?s.jsx(Yl,{className:"w-4 h-4"}):s.jsx(Ns,{className:"w-4 h-4"}),s.jsx("span",{children:"Advanced Options"}),(f.onBehalfOfUser||f.fallbacks.length>0)&&s.jsxs(we,{variant:"info",className:"ml-2",children:[(f.onBehalfOfUser?1:0)+(f.fallbacks.length>0?1:0)," configured"]})]}),m&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("input",{type:"checkbox",id:"onBehalfOfUser",checked:f.onBehalfOfUser,onChange:C=>p({...f,onBehalfOfUser:C.target.checked}),className:"mt-1 rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"onBehalfOfUser",className:"block text-sm font-medium text-slate-300 cursor-pointer",children:"On Behalf of User"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"When enabled, API calls will use the requesting user's credentials."})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Fallback Models"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Alternative models to try if the primary model fails."})]}),s.jsxs(Q,{variant:"secondary",size:"sm",type:"button",onClick:E,children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Fallback"]})]}),f.fallbacks.length>0?s.jsx("div",{className:"space-y-3",children:f.fallbacks.map((C,O)=>{const F=Lt(C),j=Qs(F,"ref:"),T=j?F.slice(4):null,I=Object.keys(h).filter($=>$!==o&&$!==f.name).length>0;return s.jsx(Iw,{index:O,fallback:C,isReference:j,refKey:T,hasConfiguredLLMs:I,llms:h,endpoints:v||[],editingKey:o,formDataName:f.name,onUpdate:$=>_(O,$),onRemove:()=>S(O),getEndpointStatus:N},O)})}):s.jsx("p",{className:"text-xs text-slate-500 italic",children:"No fallbacks configured."})]})]}),f.name&&ft(f.name,e,o)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',f.name,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{l(!1),g()},children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:ft(f.name,e,o),children:o?"Save Changes":"Add LLM"})]})]})})]})}function $w({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var _;const{config:l,addGenieRoom:o,updateGenieRoom:i,removeGenieRoom:c}=Oe(),u=((_=l.resources)==null?void 0:_.genie_rooms)||{},m=l.variables||{},{data:d,loading:f,refetch:p}=Yg(),[v,b]=R.useState("select"),[x,h]=R.useState({refName:"",name:"",description:"",space_id:"",space_id_variable:"",on_behalf_of_user:!1}),g=S=>{const N=u[S],k=Lt(N.space_id),A=Qs(k,"*"),C=d==null?void 0:d.some(O=>O.space_id===k);b(A?"variable":C?"select":"manual"),h({refName:S,name:N.name,description:N.description||"",space_id:A?"":k,space_id_variable:A?k.substring(1):"",on_behalf_of_user:N.on_behalf_of_user||!1}),r(S),t(!0)},y=()=>{let S=x.space_id;v==="variable"&&x.space_id_variable&&(S=`*${x.space_id_variable}`);const N={name:x.name,description:x.description||void 0,space_id:S,on_behalf_of_user:x.on_behalf_of_user};n?n!==x.refName?(c(n),o(x.refName,N)):i(x.refName,N):o(x.refName,N),b("select"),h({refName:"",name:"",description:"",space_id:"",space_id_variable:"",on_behalf_of_user:!1}),a()},w=S=>{c(S)},E=[{value:"",label:f?"Loading Genie spaces...":"Select a Genie space..."},...(d||[]).map(S=>({value:S.space_id,label:`${S.title}${S.description?` - ${S.description.substring(0,50)}${S.description.length>50?"...":""}`:""}`}))];return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(qs,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Genie Rooms"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{b("select"),h({refName:"",name:"",description:"",space_id:"",space_id_variable:"",on_behalf_of_user:!1}),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Genie Room"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([S,N])=>{var k;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(qs,{className:"w-4 h-4 text-purple-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:S}),s.jsxs("p",{className:"text-xs text-slate-500",children:[N.name,"  Space ID: ",(k=N.space_id)==null?void 0:k.substring(0,12),"..."]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[N.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>g(S),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>w(S),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},S)})}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No Genie rooms configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Genie Room"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:S=>h({...x,refName:S.target.value}),placeholder:"retail_genie",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Genie Space"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>{b("select"),h({...x,space_id:"",space_id_variable:"",name:"",description:""})},className:`px-2 py-1 text-xs rounded ${v==="select"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"}),s.jsx("button",{type:"button",onClick:()=>{b("manual"),h({...x,space_id:"",space_id_variable:"",name:"",description:""})},className:`px-2 py-1 text-xs rounded ${v==="manual"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Manual"}),s.jsxs("button",{type:"button",onClick:()=>{b("variable"),h({...x,space_id:"",space_id_variable:"",name:"",description:""})},className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${v==="variable"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(Cn,{className:"w-3 h-3"}),s.jsx("span",{children:"Variable"})]})]})]}),v==="select"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(le,{value:x.space_id,onChange:S=>{const N=S.target.value,k=d==null?void 0:d.find(O=>O.space_id===N),A=(k==null?void 0:k.title)||"",C=(k==null?void 0:k.description)||"";h({...x,space_id:N,space_id_variable:"",refName:n?x.refName:De(A),name:A,description:C})},options:E})}),s.jsx("button",{type:"button",onClick:()=>p(),className:"p-2 text-slate-400 hover:text-white",disabled:f,children:s.jsx(gt,{className:`w-4 h-4 ${f?"animate-spin":""}`})})]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select from ",(d==null?void 0:d.length)||0," available Genie spaces. Display Name and Description will auto-fill."]})]}),v==="manual"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(re,{value:x.space_id,onChange:S=>{const N=S.target.value;h({...x,space_id:N,space_id_variable:"",refName:n?x.refName:De(N)})},placeholder:"01f0d05d42ed11eeae85802c1d5bcccd"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Enter the Genie space ID directly. You can find this in the Genie room URL."})]}),v==="variable"&&s.jsxs("div",{className:"space-y-2",children:[Object.keys(m).length>0?s.jsx(le,{value:x.space_id_variable,onChange:S=>{const N=S.target.value;h({...x,space_id_variable:N,space_id:"",refName:n?x.refName:De(N||"genie")})},options:[{value:"",label:"Select a variable..."},...Object.keys(m).map(S=>({value:S,label:S}))]}):s.jsx(re,{value:x.space_id_variable,onChange:S=>{const N=S.target.value;h({...x,space_id_variable:N,space_id:"",refName:n?x.refName:De(N||"genie")})},placeholder:"genie_space_id"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Reference a variable containing the Genie space ID. The value will be resolved at runtime."})]})]}),s.jsx(re,{label:"Display Name",value:x.name,onChange:S=>h({...x,name:S.target.value}),placeholder:"Retail Analytics Genie",required:!0}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Description"}),s.jsx("textarea",{value:x.description,onChange:S=>h({...x,description:S.target.value}),placeholder:"Query retail data using natural language",rows:3,className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:S=>h({...x,on_behalf_of_user:S.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"}),s.jsx("span",{className:"text-xs text-slate-500",children:"(Use requesting user's credentials)"})]}),x.refName&&ft(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:y,disabled:!x.refName||!x.name||v==="select"&&!x.space_id||v==="manual"&&!x.space_id||v==="variable"&&!x.space_id_variable||ft(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function Dw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var S;const{config:l,addWarehouse:o,updateWarehouse:i,removeWarehouse:c}=Oe(),u=((S=l.resources)==null?void 0:S.warehouses)||{},m=l.variables||{},{data:d,loading:f,refetch:p}=Ew(),[v,b]=R.useState("select"),[x,h]=R.useState({refName:"",name:"",description:"",warehouse_id:"",warehouse_id_variable:"",on_behalf_of_user:!1}),g=N=>{const k=u[N],A=Lt(k.warehouse_id),C=Qs(A,"__REF__"),O=C?A.substring(7):"",F=C?"":A;let j="manual";C?j="variable":d!=null&&d.some(T=>T.id===A)&&(j="select"),b(j),h({refName:N,name:k.name,description:k.description||"",warehouse_id:F,warehouse_id_variable:O,on_behalf_of_user:k.on_behalf_of_user||!1}),r(N),t(!0)},y=()=>{let N=x.warehouse_id;v==="variable"&&x.warehouse_id_variable&&(N=`__REF__${x.warehouse_id_variable}`);const k={name:x.name,description:x.description||void 0,warehouse_id:N,on_behalf_of_user:x.on_behalf_of_user};n?n!==x.refName?(c(n),o(x.refName,k)):i(x.refName,k):o(x.refName,k),h({refName:"",name:"",description:"",warehouse_id:"",warehouse_id_variable:"",on_behalf_of_user:!1}),b("select"),a()},w=N=>{c(N)},E=N=>{switch(N==null?void 0:N.toUpperCase()){case"RUNNING":return"ready";case"STARTING":case"STOPPING":case"RESTARTING":return"transitioning";case"STOPPED":case"DELETED":case"DELETING":return"stopped";default:return"unknown"}},_=[{value:"",label:f?"Loading...":"Select a SQL warehouse..."},...(d||[]).map(N=>({value:N.id,label:N.name,status:E(N.state)}))];return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Qt,{className:"w-5 h-5 text-emerald-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"SQL Warehouses"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{h({refName:"",name:"",description:"",warehouse_id:"",warehouse_id_variable:"",on_behalf_of_user:!1}),b("select"),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Warehouse"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([N,k])=>{const A=Lt(k.warehouse_id),C=Qs(A,"__REF__"),O=C?`$${A.substring(7)}`:`${A==null?void 0:A.substring(0,12)}...`;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Qt,{className:"w-4 h-4 text-emerald-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:N}),s.jsxs("p",{className:"text-xs text-slate-500",children:[k.name,"  ",C?"Var: ":"ID: ",O]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[k.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>g(N),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>w(N),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},N)})}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No SQL warehouses configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," SQL Warehouse"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:N=>h({...x,refName:N.target.value}),placeholder:"main_warehouse",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Warehouse ID"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>{b("select"),h({...x,warehouse_id_variable:""})},className:`px-2 py-1 text-xs rounded ${v==="select"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"}),s.jsx("button",{type:"button",onClick:()=>{b("manual"),h({...x,warehouse_id_variable:""})},className:`px-2 py-1 text-xs rounded ${v==="manual"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Manual"}),s.jsxs("button",{type:"button",onClick:()=>{b("variable"),h({...x,warehouse_id:""})},className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${v==="variable"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(Cn,{className:"w-3 h-3"}),s.jsx("span",{children:"Variable"})]})]})]}),v==="select"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(Gl,{value:x.warehouse_id,onChange:N=>{const k=d==null?void 0:d.find(C=>C.id===N),A=(k==null?void 0:k.name)||"";h({...x,warehouse_id:N,warehouse_id_variable:"",refName:n?x.refName:De(A),name:A||x.name||""})},options:_,placeholder:"Select a SQL warehouse..."})}),s.jsx("button",{type:"button",onClick:()=>p(),className:"p-2 text-slate-400 hover:text-white",disabled:f,children:s.jsx(gt,{className:`w-4 h-4 ${f?"animate-spin":""}`})})]}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select from ",(d==null?void 0:d.length)||0," available SQL warehouses. Display Name will auto-fill."]})]}),v==="manual"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(re,{value:x.warehouse_id,onChange:N=>{const k=N.target.value;h({...x,warehouse_id:k,warehouse_id_variable:"",refName:n?x.refName:De(k)})},placeholder:"abc123def456"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Enter the warehouse ID directly. You can find this in the SQL warehouse settings."})]}),v==="variable"&&s.jsxs("div",{className:"space-y-2",children:[Object.keys(m).length>0?s.jsx(le,{value:x.warehouse_id_variable,onChange:N=>{const k=N.target.value;h({...x,warehouse_id_variable:k,warehouse_id:"",refName:n?x.refName:De(k||"warehouse")})},options:[{value:"",label:"Select a variable..."},...Object.keys(m).map(N=>({value:N,label:N}))]}):s.jsx(re,{value:x.warehouse_id_variable,onChange:N=>{const k=N.target.value;h({...x,warehouse_id_variable:k,warehouse_id:"",refName:n?x.refName:De(k||"warehouse")})},placeholder:"warehouse_id"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Reference a variable containing the warehouse ID. The value will be resolved at runtime."})]})]}),s.jsx(re,{label:"Display Name",value:x.name,onChange:N=>h({...x,name:N.target.value}),placeholder:"Main Analytics Warehouse",required:!0}),s.jsx(re,{label:"Description",value:x.description,onChange:N=>h({...x,description:N.target.value}),placeholder:"Primary warehouse for analytics queries"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:N=>h({...x,on_behalf_of_user:N.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"}),s.jsx("span",{className:"text-xs text-slate-500",children:"(Use requesting user's credentials)"})]}),x.refName&&ft(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:y,disabled:!x.refName||!x.name||v==="select"&&!x.warehouse_id||v==="manual"&&!x.warehouse_id||v==="variable"&&!x.warehouse_id_variable||ft(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function Fw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var C,O,F;const{config:l,addTable:o,updateTable:i,removeTable:c}=Oe(),u=((C=l.resources)==null?void 0:C.tables)||{},m=l.schemas||{},{data:d}=Rr(),[f,p]=R.useState("reference"),[v,b]=R.useState({schemaRef:"",catalog_name:"",schema_name:"",source:"reference"}),[x,h]=R.useState({refName:"",schemaRef:"",catalog_name:"",schema_name:"",name:"",on_behalf_of_user:!1}),{data:g,loading:y}=Kn(x.catalog_name||null),{data:w,loading:E}=Nd(f==="reference"&&x.schemaRef?(O=m[x.schemaRef])==null?void 0:O.catalog_name:x.catalog_name||null,f==="reference"&&x.schemaRef?(F=m[x.schemaRef])==null?void 0:F.schema_name:x.schema_name||null),_=j=>{var P,M,D;const T=u[j],$=T.schema&&Object.entries(m).some(([,V])=>{var B,K;return V.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&V.schema_name===((K=T.schema)==null?void 0:K.schema_name)})?(P=Object.entries(m).find(([,V])=>{var B,K;return V.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&V.schema_name===((K=T.schema)==null?void 0:K.schema_name)}))==null?void 0:P[0]:"";p($?"reference":"direct"),h({refName:j,schemaRef:$||"",catalog_name:((M=T.schema)==null?void 0:M.catalog_name)||"",schema_name:((D=T.schema)==null?void 0:D.schema_name)||"",name:T.name||"",on_behalf_of_user:T.on_behalf_of_user||!1}),r(j),t(!0)},S=()=>{const j={name:x.name||void 0,on_behalf_of_user:x.on_behalf_of_user};if(f==="reference"&&x.schemaRef){const T=m[x.schemaRef];T&&(j.schema={catalog_name:T.catalog_name,schema_name:T.schema_name})}else x.catalog_name&&x.schema_name&&(j.schema={catalog_name:x.catalog_name,schema_name:x.schema_name});n?n!==x.refName?(c(n),o(x.refName,j)):i(x.refName,j):o(x.refName,j),b({schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,source:f}),h({refName:"",schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,name:"",on_behalf_of_user:!1}),a()},N=j=>{c(j)},k=Object.keys(m).length>0,A=f==="reference"?!!x.schemaRef:!!x.catalog_name&&!!x.schema_name;return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(gd,{className:"w-5 h-5 text-cyan-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Tables"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{h({refName:"",schemaRef:v.schemaRef,catalog_name:v.catalog_name,schema_name:v.schema_name,name:"",on_behalf_of_user:!1}),p(v.source),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Table"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([j,T])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(gd,{className:"w-4 h-4 text-cyan-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:j}),s.jsx("p",{className:"text-xs text-slate-500",children:T.schema?`${T.schema.catalog_name}.${T.schema.schema_name}${T.name?`.${T.name}`:".*"}`:T.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[T.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>_(j),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>N(j),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},j))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No tables configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Table"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:j=>h({...x,refName:j.target.value}),placeholder:"sales_data",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),k&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{p("reference"),h({...x,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{p("direct"),h({...x,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),f==="reference"&&k?s.jsx(le,{label:"Schema Reference",value:x.schemaRef,onChange:j=>{const T=j.target.value,I=m[T],$=I?De(`${I.catalog_name}_${I.schema_name}_tables`):"";h({...x,schemaRef:T,name:"",refName:x.refName||$})},options:[{value:"",label:"Select a configured schema..."},...Object.entries(m).map(([j,T])=>({value:j,label:`${j} (${T.catalog_name}.${T.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:x.catalog_name,onChange:j=>h({...x,catalog_name:j.target.value,schema_name:"",name:""}),options:[{value:"",label:"Select catalog..."},...(d||[]).map(j=>({value:j.name,label:j.name}))]}),s.jsx(le,{label:"Schema",value:x.schema_name,onChange:j=>{const T=j.target.value,I=T?De(`${x.catalog_name}_${T}_tables`):"";h({...x,schema_name:T,name:"",refName:x.refName||I})},options:[{value:"",label:y?"Loading schemas...":"Select schema..."},...(g||[]).map(j=>({value:j.name,label:j.name}))],disabled:!x.catalog_name||y})]}),f==="reference"&&x.schemaRef&&m[x.schemaRef]&&s.jsxs("div",{className:"p-2 bg-slate-900/50 rounded text-xs text-slate-400",children:["Using schema: ",s.jsxs("span",{className:"text-slate-300",children:[m[x.schemaRef].catalog_name,".",m[x.schemaRef].schema_name]})]}),s.jsx(le,{label:"Table",value:x.name,onChange:j=>{const T=j.target.value;h(I=>{let $="";if(T)$=De(T);else if(f==="reference"&&I.schemaRef){const M=m[I.schemaRef];M&&($=De(`${M.catalog_name}_${M.schema_name}_tables`))}else I.catalog_name&&I.schema_name&&($=De(`${I.catalog_name}_${I.schema_name}_tables`));const P=n&&I.refName;return{...I,name:T,refName:P?I.refName:$}})},options:[{value:"",label:E?"Loading tables...":"All tables (*)"},...(w||[]).map(j=>({value:j.name,label:j.name}))],disabled:!A||E,hint:"Leave empty for all tables in schema"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:j=>h({...x,on_behalf_of_user:j.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),x.refName&&ft(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:S,disabled:!x.refName||!A||ft(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function zw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var C,O,F;const{config:l,addVolume:o,updateVolume:i,removeVolume:c}=Oe(),u=((C=l.resources)==null?void 0:C.volumes)||{},m=l.schemas||{},{data:d}=Rr(),[f,p]=R.useState("reference"),[v,b]=R.useState({schemaRef:"",catalog_name:"",schema_name:"",source:"reference"}),[x,h]=R.useState({refName:"",schemaRef:"",catalog_name:"",schema_name:"",name:"",on_behalf_of_user:!1}),{data:g,loading:y}=Kn(x.catalog_name||null),{data:w,loading:E}=jd(f==="reference"&&x.schemaRef?(O=m[x.schemaRef])==null?void 0:O.catalog_name:x.catalog_name||null,f==="reference"&&x.schemaRef?(F=m[x.schemaRef])==null?void 0:F.schema_name:x.schema_name||null),_=j=>{var P,M,D;const T=u[j],$=T.schema&&Object.entries(m).some(([,V])=>{var B,K;return V.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&V.schema_name===((K=T.schema)==null?void 0:K.schema_name)})?(P=Object.entries(m).find(([,V])=>{var B,K;return V.catalog_name===((B=T.schema)==null?void 0:B.catalog_name)&&V.schema_name===((K=T.schema)==null?void 0:K.schema_name)}))==null?void 0:P[0]:"";p($?"reference":"direct"),h({refName:j,schemaRef:$||"",catalog_name:((M=T.schema)==null?void 0:M.catalog_name)||"",schema_name:((D=T.schema)==null?void 0:D.schema_name)||"",name:T.name||"",on_behalf_of_user:T.on_behalf_of_user||!1}),r(j),t(!0)},S=()=>{const j={name:x.name,on_behalf_of_user:x.on_behalf_of_user};if(f==="reference"&&x.schemaRef){const T=m[x.schemaRef];T&&(j.schema={catalog_name:T.catalog_name,schema_name:T.schema_name})}else x.catalog_name&&x.schema_name&&(j.schema={catalog_name:x.catalog_name,schema_name:x.schema_name});n?n!==x.refName?(c(n),o(x.refName,j)):i(x.refName,j):o(x.refName,j),b({schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,source:f}),h({refName:"",schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,name:"",on_behalf_of_user:!1}),a()},N=j=>{c(j)},k=Object.keys(m).length>0,A=f==="reference"?!!x.schemaRef:!!x.catalog_name&&!!x.schema_name;return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(hd,{className:"w-5 h-5 text-amber-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Volumes"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{h({refName:"",schemaRef:v.schemaRef,catalog_name:v.catalog_name,schema_name:v.schema_name,name:"",on_behalf_of_user:!1}),p(v.source),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Volume"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([j,T])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(hd,{className:"w-4 h-4 text-amber-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:j}),s.jsx("p",{className:"text-xs text-slate-500",children:T.schema?`${T.schema.catalog_name}.${T.schema.schema_name}.${T.name}`:T.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[T.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>_(j),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>N(j),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},j))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No volumes configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Volume"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:j=>h({...x,refName:j.target.value}),placeholder:"data_volume",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),k&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{p("reference"),h({...x,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{p("direct"),h({...x,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),f==="reference"&&k?s.jsx(le,{label:"Schema Reference",value:x.schemaRef,onChange:j=>{const T=j.target.value;h({...x,schemaRef:T,name:""})},options:[{value:"",label:"Select a configured schema..."},...Object.entries(m).map(([j,T])=>({value:j,label:`${j} (${T.catalog_name}.${T.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:x.catalog_name,onChange:j=>h({...x,catalog_name:j.target.value,schema_name:"",name:""}),options:[{value:"",label:"Select catalog..."},...(d||[]).map(j=>({value:j.name,label:j.name}))]}),s.jsx(le,{label:"Schema",value:x.schema_name,onChange:j=>h({...x,schema_name:j.target.value,name:""}),options:[{value:"",label:y?"Loading schemas...":"Select schema..."},...(g||[]).map(j=>({value:j.name,label:j.name}))],disabled:!x.catalog_name||y})]}),f==="reference"&&x.schemaRef&&m[x.schemaRef]&&s.jsxs("div",{className:"p-2 bg-slate-900/50 rounded text-xs text-slate-400",children:["Using schema: ",s.jsxs("span",{className:"text-slate-300",children:[m[x.schemaRef].catalog_name,".",m[x.schemaRef].schema_name]})]}),s.jsx(le,{label:"Volume",value:x.name,onChange:j=>{const T=j.target.value;h({...x,name:T,refName:x.refName||De(T)})},options:[{value:"",label:E?"Loading volumes...":"Select volume..."},...(w||[]).map(j=>({value:j.name,label:j.name}))],disabled:!A||E}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:j=>h({...x,on_behalf_of_user:j.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),x.refName&&ft(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:S,disabled:!x.refName||!x.name||!A||ft(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function Vw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var T,I,$;const{config:l,addFunction:o,updateFunction:i,removeFunction:c}=Oe(),u=((T=l.resources)==null?void 0:T.functions)||{},m=l.schemas||{},{data:d}=Rr(),[f,p]=R.useState("reference"),[v,b]=R.useState({schemaRef:"",catalog_name:"",schema_name:"",source:"reference"}),[x,h]=R.useState({refName:"",schemaRef:"",catalog_name:"",schema_name:"",name:"",on_behalf_of_user:!1}),{data:g,loading:y}=Kn(x.catalog_name||null),w=f==="reference"&&x.schemaRef?(I=m[x.schemaRef])==null?void 0:I.catalog_name:x.catalog_name,E=f==="reference"&&x.schemaRef?($=m[x.schemaRef])==null?void 0:$.schema_name:x.schema_name,{data:_,loading:S}=Bg(w||null,E||null),N=Object.values(u).filter(P=>{var M,D;return((M=P.schema)==null?void 0:M.catalog_name)===w&&((D=P.schema)==null?void 0:D.schema_name)===E}).map(P=>P.name).filter(Boolean),k=(_||[]).filter(P=>{var M;return n?!N.includes(P.name)||P.name===((M=u[n])==null?void 0:M.name):!N.includes(P.name)}),A=P=>{var B,K,J;const M=u[P],V=M.schema&&Object.entries(m).some(([,ae])=>{var U,Y;return ae.catalog_name===((U=M.schema)==null?void 0:U.catalog_name)&&ae.schema_name===((Y=M.schema)==null?void 0:Y.schema_name)})?(B=Object.entries(m).find(([,ae])=>{var U,Y;return ae.catalog_name===((U=M.schema)==null?void 0:U.catalog_name)&&ae.schema_name===((Y=M.schema)==null?void 0:Y.schema_name)}))==null?void 0:B[0]:"";p(V?"reference":"direct"),h({refName:P,schemaRef:V||"",catalog_name:((K=M.schema)==null?void 0:K.catalog_name)||"",schema_name:((J=M.schema)==null?void 0:J.schema_name)||"",name:M.name||"",on_behalf_of_user:M.on_behalf_of_user||!1}),r(P),t(!0)},C=()=>{const P={name:x.name||void 0,on_behalf_of_user:x.on_behalf_of_user};if(f==="reference"&&x.schemaRef){const M=m[x.schemaRef];M&&(P.schema={catalog_name:M.catalog_name,schema_name:M.schema_name})}else x.catalog_name&&x.schema_name&&(P.schema={catalog_name:x.catalog_name,schema_name:x.schema_name});n?n!==x.refName?(c(n),o(x.refName,P)):i(x.refName,P):o(x.refName,P),b({schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,source:f}),h({refName:"",schemaRef:x.schemaRef,catalog_name:x.catalog_name,schema_name:x.schema_name,name:"",on_behalf_of_user:!1}),a()},O=P=>{c(P)},F=Object.keys(m).length>0,j=f==="reference"?!!x.schemaRef:!!x.catalog_name&&!!x.schema_name;return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(fd,{className:"w-5 h-5 text-pink-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Functions"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{h({refName:"",schemaRef:v.schemaRef,catalog_name:v.catalog_name,schema_name:v.schema_name,name:"",on_behalf_of_user:!1}),p(v.source),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Function"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([P,M])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(fd,{className:"w-4 h-4 text-pink-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:P}),s.jsx("p",{className:"text-xs text-slate-500",children:M.schema?`${M.schema.catalog_name}.${M.schema.schema_name}${M.name?`.${M.name}`:".*"}`:M.name})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[M.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>A(P),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>O(P),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},P))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No functions configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Function"]}),s.jsx(re,{label:"Reference Name",value:x.refName,onChange:P=>h({...x,refName:P.target.value}),placeholder:"uc_functions",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),F&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{p("reference"),h({...x,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{p("direct"),h({...x,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${f==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),f==="reference"&&F?s.jsx(le,{label:"Schema Reference",value:x.schemaRef,onChange:P=>{const M=P.target.value,D=M?m[M]:null,V=D?De(`${D.catalog_name}_${D.schema_name}_functions`):"";h({...x,schemaRef:M,name:"",refName:x.refName||V})},options:[{value:"",label:"Select a configured schema..."},...Object.entries(m).map(([P,M])=>({value:P,label:`${P} (${M.catalog_name}.${M.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:x.catalog_name,onChange:P=>h({...x,catalog_name:P.target.value,schema_name:"",name:""}),options:[{value:"",label:"Select catalog..."},...(d||[]).map(P=>({value:P.name,label:P.name}))]}),s.jsx(le,{label:"Schema",value:x.schema_name,onChange:P=>{const M=P.target.value,D=M?De(`${x.catalog_name}_${M}_functions`):"";h({...x,schema_name:M,name:"",refName:x.refName||D})},options:[{value:"",label:y?"Loading schemas...":"Select schema..."},...(g||[]).map(P=>({value:P.name,label:P.name}))],disabled:!x.catalog_name||y})]}),f==="reference"&&x.schemaRef&&m[x.schemaRef]&&s.jsxs("div",{className:"p-2 bg-slate-900/50 rounded text-xs text-slate-400",children:["Using schema: ",s.jsxs("span",{className:"text-slate-300",children:[m[x.schemaRef].catalog_name,".",m[x.schemaRef].schema_name]})]}),s.jsx(le,{label:"Function",value:x.name,onChange:P=>{const M=P.target.value;h(D=>{let V="";if(M)V=De(M);else if(f==="reference"&&D.schemaRef){const K=m[D.schemaRef];K&&(V=De(`${K.catalog_name}_${K.schema_name}_functions`))}else D.catalog_name&&D.schema_name&&(V=De(`${D.catalog_name}_${D.schema_name}_functions`));const B=n&&D.refName;return{...D,name:M,refName:B?D.refName:V}})},options:[{value:"",label:S?"Loading functions...":"All functions (*)"},...k.map(P=>({value:P.name,label:P.name}))],disabled:!j||S,hint:"Leave empty for all functions in schema"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:x.on_behalf_of_user,onChange:P=>h({...x,on_behalf_of_user:P.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),x.refName&&ft(x.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',x.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:C,disabled:!x.refName||!j||ft(x.refName,l,n),children:n?"Update":"Add"})]})]})]})}function Hw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var h;const{config:l,addConnection:o,updateConnection:i,removeConnection:c}=Oe(),u=((h=l.resources)==null?void 0:h.connections)||{},{data:m,loading:d}=Wg(),[f,p]=R.useState({refName:"",name:"",on_behalf_of_user:!1}),v=g=>{const y=u[g];p({refName:g,name:y.name,on_behalf_of_user:y.on_behalf_of_user||!1}),r(g),t(!0)},b=()=>{const g={name:f.name,on_behalf_of_user:f.on_behalf_of_user};n?n!==f.refName?(c(n),o(f.refName,g)):i(f.refName,g):o(f.refName,g),p({refName:"",name:"",on_behalf_of_user:!1}),a()},x=g=>{c(g)};return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(pd,{className:"w-5 h-5 text-indigo-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Connections"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{p({refName:"",name:"",on_behalf_of_user:!1}),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Connection"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([g,y])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(pd,{className:"w-4 h-4 text-indigo-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:g}),s.jsxs("p",{className:"text-xs text-slate-500",children:["UC Connection: ",y.name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[y.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>v(g),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>x(g),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},g))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No connections configured."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Connection"]}),s.jsx(re,{label:"Reference Name",value:f.refName,onChange:g=>p({...f,refName:g.target.value}),placeholder:"external_api",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),s.jsx(le,{label:"Unity Catalog Connection",value:f.name,onChange:g=>{p({...f,name:g.target.value,refName:f.refName||De(g.target.value)})},options:[{value:"",label:d?"Loading connections...":"Select a connection..."},...(m||[]).map(g=>({value:g.name,label:`${g.name}${g.connection_type?` (${g.connection_type})`:""}`}))],hint:"Select from available Unity Catalog connections",required:!0}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:f.on_behalf_of_user,onChange:g=>p({...f,on_behalf_of_user:g.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),f.refName&&ft(f.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',f.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:b,disabled:!f.refName||!f.name||ft(f.refName,l,n),children:n?"Update":"Add"})]})]})]})}const eu={refName:"",name:"",instanceSource:"existing",instance_name:"",description:"",capacity:"CU_2",max_pool_size:10,timeout_seconds:10,authMethod:"service_principal",servicePrincipalRef:"",clientIdSource:"variable",clientSecretSource:"variable",workspaceHostSource:"variable",client_id:"",client_secret:"",workspace_host:"",clientIdVariable:"",clientSecretVariable:"",workspaceHostVariable:"",userSource:"manual",passwordSource:"variable",user:"",password:"",userVariable:"",passwordVariable:"",on_behalf_of_user:!1},Uw=[{value:"CU_1",label:"CU_1 (Small)"},{value:"CU_2",label:"CU_2 (Large)"}],Bw=[{value:"service_principal",label:"Configured Service Principal"},{value:"oauth",label:"Manual OAuth2 Credentials"},{value:"user",label:"User/Password"}],Yw=e=>`*${e}`,Ww=e=>"env"in e?`env: ${e.env}`:"scope"in e&&"secret"in e?`secret: ${e.scope}/${e.secret}`:"value"in e?`value: ${String(e.value)}`:"options"in e?`composite (${e.options.length} options)`:"unknown";function $a({label:e,source:t,onSourceChange:n,manualValue:r,onManualChange:a,variableValue:l,onVariableChange:o,placeholder:i,isPassword:c=!1,hint:u,variableNames:m,variables:d}){return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>n("variable"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 flex items-center gap-1 ${t==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>n("manual"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${t==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),t==="variable"?s.jsx(le,{value:l,onChange:f=>o(f.target.value),options:[{value:"",label:"Select a variable..."},...m.map(f=>({value:f,label:`${f} (${Ww(d[f])})`}))],hint:m.length===0?"Define variables in the Variables section first":u}):s.jsx(re,{value:r,onChange:f=>a(f.target.value),placeholder:i,type:c?"password":"text",hint:u})]})}function Gw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var S;const{config:l,addDatabase:o,updateDatabase:i,removeDatabase:c}=Oe(),u=((S=l.resources)==null?void 0:S.databases)||{},m=l.variables||{},d=Object.keys(m),{data:f,loading:p,refetch:v}=Cw(),b=N=>{switch(N==null?void 0:N.toUpperCase()){case"AVAILABLE":case"RUNNING":return"ready";case"CREATING":case"STARTING":case"STOPPING":case"PROVISIONING":case"UPDATING":return"transitioning";case"STOPPED":case"FAILED":case"DELETED":case"DELETING":return"stopped";default:return"unknown"}},x=[{value:"",label:p?"Loading...":"Select an instance..."},...(f||[]).map(N=>({value:N.name,label:N.name,status:b(N.state)}))],[h,g]=R.useState(eu),y=N=>{const k=u[N];if(k){const A=O=>Qs(O,"*"),C=O=>{const F=Lt(O);return F.startsWith("*")?F.slice(1):""};g({refName:N,name:k.name,instanceSource:"existing",instance_name:k.instance_name||"",description:k.description||"",capacity:k.capacity||"CU_2",max_pool_size:k.max_pool_size||10,timeout_seconds:k.timeout_seconds||10,authMethod:k.service_principal?"service_principal":k.client_id?"oauth":"user",servicePrincipalRef:Qs(k.service_principal,"*")?Lt(k.service_principal).slice(1):"",clientIdSource:A(k.client_id)?"variable":"manual",clientSecretSource:A(k.client_secret)?"variable":"manual",workspaceHostSource:A(k.workspace_host)?"variable":"manual",client_id:A(k.client_id)?"":Lt(k.client_id),client_secret:A(k.client_secret)?"":Lt(k.client_secret),workspace_host:A(k.workspace_host)?"":Lt(k.workspace_host),clientIdVariable:C(k.client_id),clientSecretVariable:C(k.client_secret),workspaceHostVariable:C(k.workspace_host),userSource:A(k.user)?"variable":"manual",passwordSource:A(k.password)?"variable":"manual",user:A(k.user)?"":Lt(k.user),password:A(k.password)?"":Lt(k.password),userVariable:C(k.user),passwordVariable:C(k.password),on_behalf_of_user:k.on_behalf_of_user||!1}),r(N),t(!0)}},w=N=>{c(N)},E=(N,k,A)=>N==="variable"&&A?Yw(A):k,_=()=>{const N={name:h.name,instance_name:h.instance_name||void 0,description:h.description||void 0,capacity:h.capacity,max_pool_size:h.max_pool_size,timeout_seconds:h.timeout_seconds,on_behalf_of_user:h.on_behalf_of_user||void 0};if(h.authMethod==="service_principal")h.servicePrincipalRef&&(N.service_principal=`*${h.servicePrincipalRef}`);else if(h.authMethod==="oauth"){const k=E(h.clientIdSource,h.client_id,h.clientIdVariable),A=E(h.clientSecretSource,h.client_secret,h.clientSecretVariable),C=E(h.workspaceHostSource,h.workspace_host,h.workspaceHostVariable);k&&(N.client_id=k),A&&(N.client_secret=A),C&&(N.workspace_host=C)}else{const k=E(h.userSource,h.user,h.userVariable),A=E(h.passwordSource,h.password,h.passwordVariable);k&&(N.user=k),A&&(N.password=A)}n?n!==h.refName?(c(n),o(h.refName,N)):i(n,N):o(h.refName,N),t(!1),r(null),g(eu),a()};return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(_l,{className:"w-5 h-5 text-emerald-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Databases (Lakebase/PostgreSQL)"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{g(eu),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Database"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([N,k])=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(_l,{className:"w-4 h-4 text-emerald-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:N}),s.jsxs("p",{className:"text-xs text-slate-500",children:[k.instance_name||k.name||"Default instance","  ",k.capacity||"CU_2",k.client_id?"  OAuth":k.user?"  User auth":""]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[k.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>y(N),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>w(N),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},N))}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No databases configured. Add a database for PostgreSQL/Lakebase memory storage."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Database"]}),s.jsx(re,{label:"Reference Name",value:h.refName,onChange:N=>g({...h,refName:N.target.value}),placeholder:"retail_database",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium flex items-center",children:[s.jsx(q1,{className:"w-4 h-4 mr-2 text-emerald-400"}),"Lakebase Instance"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>g({...h,instanceSource:"existing"}),className:`px-2 py-1 text-xs rounded ${h.instanceSource==="existing"?"bg-emerald-500/30 text-emerald-300":"bg-slate-700 text-slate-400"}`,children:"Use Existing"}),s.jsx("button",{type:"button",onClick:()=>g({...h,instanceSource:"new"}),className:`px-2 py-1 text-xs rounded ${h.instanceSource==="new"?"bg-emerald-500/30 text-emerald-300":"bg-slate-700 text-slate-400"}`,children:"Create New"})]})]}),h.instanceSource==="existing"?s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Select Lakebase Instance"}),s.jsx(Gl,{value:h.instance_name,onChange:N=>{g({...h,instance_name:N,name:N||h.name,refName:n?h.refName:De(N)})},options:x,placeholder:"Select an instance..."})]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>v(),disabled:p,className:"mt-6",children:p?s.jsx(dt,{className:"w-4 h-4 animate-spin"}):s.jsx(gt,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Or enter instance name manually:"}),s.jsx(re,{value:h.instance_name,onChange:N=>g({...h,instance_name:N.target.value}),placeholder:"my-lakebase-instance"})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsx(re,{label:"New Instance Name",value:h.instance_name,onChange:N=>{const k=N.target.value;g({...h,instance_name:k,name:k||h.name,refName:n?h.refName:De(k)})},placeholder:"my-new-lakebase",hint:"Name for the new Lakebase instance to create"}),s.jsx(le,{label:"Capacity",value:h.capacity,onChange:N=>g({...h,capacity:N.target.value}),options:Uw,hint:"CU_1 = Small (dev/test), CU_2 = Large (production)"}),s.jsx("p",{className:"text-xs text-amber-400",children:"Note: Instance will be created when the agent is deployed with this configuration."})]})]}),s.jsx(re,{label:"Display Name",value:h.name,onChange:N=>g({...h,name:N.target.value}),placeholder:"Retail Database"}),s.jsx(re,{label:"Description",value:h.description,onChange:N=>g({...h,description:N.target.value}),placeholder:"Database for agent memory and checkpoints"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Max Pool Size",type:"number",value:h.max_pool_size,onChange:N=>g({...h,max_pool_size:parseInt(N.target.value)||10})}),s.jsx(re,{label:"Timeout (seconds)",type:"number",value:h.timeout_seconds,onChange:N=>g({...h,timeout_seconds:parseInt(N.target.value)||10})})]}),s.jsx(le,{label:"Authentication Method",value:h.authMethod,onChange:N=>g({...h,authMethod:N.target.value}),options:Bw}),h.authMethod==="service_principal"?s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"Select Configured Service Principal"}),s.jsx(le,{label:"Service Principal",value:h.servicePrincipalRef,onChange:N=>g({...h,servicePrincipalRef:N.target.value}),options:[{value:"",label:"Select a service principal..."},...Object.keys(l.service_principals||{}).map(N=>({value:N,label:N}))],hint:"Reference a pre-configured service principal"}),Object.keys(l.service_principals||{}).length===0&&s.jsx("div",{className:"p-2 bg-amber-500/10 border border-amber-500/30 rounded text-amber-400 text-xs",children:"No service principals configured. Add one in the Service Principals tab first."})]}):h.authMethod==="oauth"?s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"OAuth2 / Service Principal Credentials"}),s.jsx($a,{label:"Client ID",source:h.clientIdSource,onSourceChange:N=>g({...h,clientIdSource:N}),manualValue:h.client_id,onManualChange:N=>g({...h,client_id:N}),variableValue:h.clientIdVariable,onVariableChange:N=>g({...h,clientIdVariable:N}),placeholder:"your-service-principal-client-id",variableNames:d,variables:m}),s.jsx($a,{label:"Client Secret",source:h.clientSecretSource,onSourceChange:N=>g({...h,clientSecretSource:N}),manualValue:h.client_secret,onManualChange:N=>g({...h,client_secret:N}),variableValue:h.clientSecretVariable,onVariableChange:N=>g({...h,clientSecretVariable:N}),placeholder:"your-client-secret",isPassword:!0,variableNames:d,variables:m}),s.jsx($a,{label:"Workspace Host (Optional)",source:h.workspaceHostSource,onSourceChange:N=>g({...h,workspaceHostSource:N}),manualValue:h.workspace_host,onManualChange:N=>g({...h,workspace_host:N}),variableValue:h.workspaceHostVariable,onVariableChange:N=>g({...h,workspaceHostVariable:N}),placeholder:"https://your-workspace.cloud.databricks.com",hint:"Only required if connecting from outside the workspace",variableNames:d,variables:m})]}):s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-xs text-slate-400 font-medium",children:"User/Password Credentials"}),s.jsx($a,{label:"Username",source:h.userSource,onSourceChange:N=>g({...h,userSource:N}),manualValue:h.user,onManualChange:N=>g({...h,user:N}),variableValue:h.userVariable,onVariableChange:N=>g({...h,userVariable:N}),placeholder:"postgres",variableNames:d,variables:m}),s.jsx($a,{label:"Password",source:h.passwordSource,onSourceChange:N=>g({...h,passwordSource:N}),manualValue:h.password,onManualChange:N=>g({...h,password:N}),variableValue:h.passwordVariable,onVariableChange:N=>g({...h,passwordVariable:N}),placeholder:"your-password",isPassword:!0,variableNames:d,variables:m})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:h.on_behalf_of_user,onChange:N=>g({...h,on_behalf_of_user:N.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),h.refName&&ft(h.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',h.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:_,disabled:!h.refName||!h.name||ft(h.refName,l,n),children:n?"Update":"Add"})]})]})]})}const tu={refName:"",endpoint_name:"",endpoint_type:"STANDARD",indexSchemaSource:"direct",indexSchemaRefName:"",index_catalog:"",index_schema:"",indexNameSource:"select",index_name:"",sourceSchemaSource:"direct",sourceSchemaRefName:"",source_catalog:"",source_schema:"",source_table:"",primary_key:"",embedding_source_column:"",columns:[],doc_uri:"",embedding_model:"databricks-gte-large-en",sourcePathEnabled:!1,sourcePathSchemaSource:"direct",sourcePathSchemaRef:"",sourcePathVolumeCatalog:"",sourcePathVolumeSchema:"",sourcePathVolumeName:"",sourcePathPath:"",checkpointPathEnabled:!1,checkpointPathSchemaSource:"direct",checkpointPathSchemaRef:"",checkpointPathVolumeCatalog:"",checkpointPathVolumeSchema:"",checkpointPathVolumeName:"",checkpointPathPath:"",on_behalf_of_user:!1};function qw({formData:e,setFormData:t,configuredSchemas:n,configuredSchemaOptions:r,catalogs:a,sourcePathSchemas:l,sourcePathVolumes:o,sourcePathVolumesLoading:i,checkpointPathSchemas:c,checkpointPathVolumes:u,checkpointPathVolumesLoading:m}){const d=Object.keys(n).length>0;return s.jsxs("div",{className:"space-y-4 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium",children:["Volume Paths ",s.jsx("span",{className:"text-slate-500 font-normal",children:"(Optional)"})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-800/30 rounded border border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Source Path"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:e.sourcePathEnabled,onChange:f=>t(p=>({...p,sourcePathEnabled:f.target.checked,sourcePathSchemaSource:d?"reference":"direct"})),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-xs text-slate-400",children:"Enable"})]})]}),e.sourcePathEnabled&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-xs text-slate-400",children:"Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[d&&s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,sourcePathSchemaSource:"reference",sourcePathVolumeCatalog:"",sourcePathVolumeSchema:"",sourcePathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.sourcePathSchemaSource==="reference"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,sourcePathSchemaSource:"direct",sourcePathSchemaRef:"",sourcePathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.sourcePathSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),e.sourcePathSchemaSource==="reference"?s.jsx(le,{value:e.sourcePathSchemaRef,onChange:f=>{const p=f.target.value,v=n[p];t(b=>({...b,sourcePathSchemaRef:p,sourcePathVolumeCatalog:(v==null?void 0:v.catalog_name)||"",sourcePathVolumeSchema:(v==null?void 0:v.schema_name)||"",sourcePathVolumeName:""}))},options:[{value:"",label:"Select configured schema..."},...r],hint:"Select a previously configured schema"}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx(le,{value:e.sourcePathVolumeCatalog,onChange:f=>t(p=>({...p,sourcePathVolumeCatalog:f.target.value,sourcePathVolumeSchema:"",sourcePathVolumeName:""})),options:[{value:"",label:"Catalog..."},...(a||[]).map(f=>({value:f.name,label:f.name}))]}),s.jsx(le,{value:e.sourcePathVolumeSchema,onChange:f=>t(p=>({...p,sourcePathVolumeSchema:f.target.value,sourcePathVolumeName:""})),options:[{value:"",label:"Schema..."},...(l||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.sourcePathVolumeCatalog})]}),s.jsx(le,{label:"Volume",value:e.sourcePathVolumeName,onChange:f=>t(p=>({...p,sourcePathVolumeName:f.target.value})),options:[{value:"",label:i?"Loading volumes...":"Select volume..."},...(o||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.sourcePathVolumeSchema||i,hint:"Select a volume from the schema"}),s.jsx(re,{label:"Path",value:e.sourcePathPath,onChange:f=>t(p=>({...p,sourcePathPath:f.target.value})),placeholder:"/path/to/source/data",hint:"Path within the volume for source data files"})]})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-800/30 rounded border border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Checkpoint Path"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:e.checkpointPathEnabled,onChange:f=>t(p=>({...p,checkpointPathEnabled:f.target.checked,checkpointPathSchemaSource:d?"reference":"direct"})),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-xs text-slate-400",children:"Enable"})]})]}),e.checkpointPathEnabled&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-xs text-slate-400",children:"Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[d&&s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,checkpointPathSchemaSource:"reference",checkpointPathVolumeCatalog:"",checkpointPathVolumeSchema:"",checkpointPathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.checkpointPathSchemaSource==="reference"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>t(f=>({...f,checkpointPathSchemaSource:"direct",checkpointPathSchemaRef:"",checkpointPathVolumeName:""})),className:`px-2 py-1 text-xs rounded ${e.checkpointPathSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),e.checkpointPathSchemaSource==="reference"?s.jsx(le,{value:e.checkpointPathSchemaRef,onChange:f=>{const p=f.target.value,v=n[p];t(b=>({...b,checkpointPathSchemaRef:p,checkpointPathVolumeCatalog:(v==null?void 0:v.catalog_name)||"",checkpointPathVolumeSchema:(v==null?void 0:v.schema_name)||"",checkpointPathVolumeName:""}))},options:[{value:"",label:"Select configured schema..."},...r],hint:"Select a previously configured schema"}):s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsx(le,{value:e.checkpointPathVolumeCatalog,onChange:f=>t(p=>({...p,checkpointPathVolumeCatalog:f.target.value,checkpointPathVolumeSchema:"",checkpointPathVolumeName:""})),options:[{value:"",label:"Catalog..."},...(a||[]).map(f=>({value:f.name,label:f.name}))]}),s.jsx(le,{value:e.checkpointPathVolumeSchema,onChange:f=>t(p=>({...p,checkpointPathVolumeSchema:f.target.value,checkpointPathVolumeName:""})),options:[{value:"",label:"Schema..."},...(c||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.checkpointPathVolumeCatalog})]}),s.jsx(le,{label:"Volume",value:e.checkpointPathVolumeName,onChange:f=>t(p=>({...p,checkpointPathVolumeName:f.target.value})),options:[{value:"",label:m?"Loading volumes...":"Select volume..."},...(u||[]).map(f=>({value:f.name,label:f.name}))],disabled:!e.checkpointPathVolumeSchema||m,hint:"Select a volume from the schema"}),s.jsx(re,{label:"Path",value:e.checkpointPathPath,onChange:f=>t(p=>({...p,checkpointPathPath:f.target.value})),placeholder:"/path/to/checkpoints",hint:"Path within the volume for vector index checkpoints"})]})]})]})}function Xw({showForm:e,setShowForm:t,editingKey:n,setEditingKey:r,onClose:a}){var Y,W,ie;const{config:l,addVectorStore:o,updateVectorStore:i,removeVectorStore:c}=Oe(),u=((Y=l.resources)==null?void 0:Y.vector_stores)||{},m=((W=l.resources)==null?void 0:W.llms)||{},d=l.schemas||{},f=((ie=l.resources)==null?void 0:ie.volumes)||{},{data:p,loading:v,refetch:b}=Gg(),{data:x}=Rr(),[h,g]=R.useState(tu),[y,w]=R.useState(""),{data:E}=Kn(h.index_catalog||null),{data:_}=Kn(h.source_catalog||null),{data:S,loading:N}=Nd(h.source_catalog||null,h.source_schema||null),{data:k,loading:A}=Nd(h.index_catalog||null,h.index_schema||null),{data:C,loading:O,refetch:F}=Sw(h.source_catalog||null,h.source_schema||null,h.source_table||null),j=(C||[]).map(H=>({value:H.name,label:`${H.name}${H.type_text?` (${H.type_text})`:""}`}));wd(h.endpoint_name||null);const{data:T}=Kn(h.sourcePathVolumeCatalog||null),{data:I,loading:$}=jd(h.sourcePathVolumeCatalog||null,h.sourcePathVolumeSchema||null),{data:P}=Kn(h.checkpointPathVolumeCatalog||null),{data:M,loading:D}=jd(h.checkpointPathVolumeCatalog||null,h.checkpointPathVolumeSchema||null),V=Object.entries(d).map(([H,X])=>({value:H,label:`${H} (${X.catalog_name}.${X.schema_name})`})),B=H=>{var Z,oe,fe,ge,L,G,ve,me,je,ot,Bt,nn,Tt,sn,Ot,Yt,On,rs,hn,as,q,te,z,ee,ne,ce,pe;const X=u[H];if(X){const _e=Object.entries(d).find(([tt,Be])=>{var Qe,Se,Ne,be;return Be.catalog_name===((Se=(Qe=X.index)==null?void 0:Qe.schema)==null?void 0:Se.catalog_name)&&Be.schema_name===((be=(Ne=X.index)==null?void 0:Ne.schema)==null?void 0:be.schema_name)}),Le=Object.entries(d).find(([tt,Be])=>{var Qe,Se,Ne,be;return Be.catalog_name===((Se=(Qe=X.source_table)==null?void 0:Qe.schema)==null?void 0:Se.catalog_name)&&Be.schema_name===((be=(Ne=X.source_table)==null?void 0:Ne.schema)==null?void 0:be.schema_name)}),Re=X.source_path;let it=!1,It="direct",rn="",In="",Ln="",$n="",Dn="";if(Re!=null&&Re.volume){it=!0,Dn=Re.path||"";let tt="",Be="",Qe="";if(typeof Re.volume=="string"){const Ne=Lt(Re.volume),be=Ne.startsWith("*")?Ne.slice(1):Ne,ze=f[be];ze&&(tt=((Z=ze.schema)==null?void 0:Z.catalog_name)||"",Be=((oe=ze.schema)==null?void 0:oe.schema_name)||"",Qe=ze.name)}else tt=((ge=(fe=Re.volume)==null?void 0:fe.schema)==null?void 0:ge.catalog_name)||"",Be=((G=(L=Re.volume)==null?void 0:L.schema)==null?void 0:G.schema_name)||"",Qe=((ve=Re.volume)==null?void 0:ve.name)||"";const Se=Object.entries(d).find(([Ne,be])=>be.catalog_name===tt&&be.schema_name===Be);Se?(It="reference",rn=Se[0]):It="direct",In=tt,Ln=Be,$n=Qe}const ht=X.checkpoint_path;let Fn=!1,pn="direct",zn="",Vn="",Hn="",Un="",Bn="";if(ht!=null&&ht.volume){Fn=!0,Bn=ht.path||"";let tt="",Be="",Qe="";if(typeof ht.volume=="string"){const Ne=Lt(ht.volume),be=Ne.startsWith("*")?Ne.slice(1):Ne,ze=f[be];ze&&(tt=((me=ze.schema)==null?void 0:me.catalog_name)||"",Be=((je=ze.schema)==null?void 0:je.schema_name)||"",Qe=ze.name)}else tt=((Bt=(ot=ht.volume)==null?void 0:ot.schema)==null?void 0:Bt.catalog_name)||"",Be=((Tt=(nn=ht.volume)==null?void 0:nn.schema)==null?void 0:Tt.schema_name)||"",Qe=((sn=ht.volume)==null?void 0:sn.name)||"";const Se=Object.entries(d).find(([Ne,be])=>be.catalog_name===tt&&be.schema_name===Be);Se?(pn="reference",zn=Se[0]):pn="direct",Vn=tt,Hn=Be,Un=Qe}g({refName:H,endpoint_name:((Ot=X.endpoint)==null?void 0:Ot.name)||"",endpoint_type:((Yt=X.endpoint)==null?void 0:Yt.type)||"STANDARD",indexSchemaSource:_e?"reference":"direct",indexSchemaRefName:_e?_e[0]:"",index_catalog:((rs=(On=X.index)==null?void 0:On.schema)==null?void 0:rs.catalog_name)||"",index_schema:((as=(hn=X.index)==null?void 0:hn.schema)==null?void 0:as.schema_name)||"",indexNameSource:"select",index_name:((q=X.index)==null?void 0:q.name)||"",sourceSchemaSource:Le?"reference":"direct",sourceSchemaRefName:Le?Le[0]:"",source_catalog:((z=(te=X.source_table)==null?void 0:te.schema)==null?void 0:z.catalog_name)||"",source_schema:((ne=(ee=X.source_table)==null?void 0:ee.schema)==null?void 0:ne.schema_name)||"",source_table:((ce=X.source_table)==null?void 0:ce.name)||"",primary_key:X.primary_key||"",embedding_source_column:X.embedding_source_column||"",columns:X.columns||[],doc_uri:X.doc_uri||"",embedding_model:((pe=X.embedding_model)==null?void 0:pe.name)||"databricks-gte-large-en",sourcePathEnabled:it,sourcePathSchemaSource:It,sourcePathSchemaRef:rn,sourcePathVolumeCatalog:In,sourcePathVolumeSchema:Ln,sourcePathVolumeName:$n,sourcePathPath:Dn,checkpointPathEnabled:Fn,checkpointPathSchemaSource:pn,checkpointPathSchemaRef:zn,checkpointPathVolumeCatalog:Vn,checkpointPathVolumeSchema:Hn,checkpointPathVolumeName:Un,checkpointPathPath:Bn,on_behalf_of_user:X.on_behalf_of_user||!1}),w((X.columns||[]).join(", ")),r(H),t(!0)}},K=H=>{c(H)},J=()=>{const H=y.split(",").map(Z=>Z.trim()).filter(Z=>Z),X={embedding_source_column:h.embedding_source_column,primary_key:h.primary_key||void 0,columns:H.length>0?H:void 0,doc_uri:h.doc_uri||void 0,on_behalf_of_user:h.on_behalf_of_user||void 0};if(h.source_table&&h.source_catalog&&h.source_schema&&(X.source_table={schema:{catalog_name:h.source_catalog,schema_name:h.source_schema},name:h.source_table}),h.endpoint_name&&(X.endpoint={name:h.endpoint_name,type:h.endpoint_type}),(h.index_name||h.index_catalog||h.index_schema)&&(X.index={schema:{catalog_name:h.index_catalog||h.source_catalog,schema_name:h.index_schema||h.source_schema},name:h.index_name||`${h.source_table}_index`}),h.embedding_model&&(X.embedding_model={name:h.embedding_model}),h.sourcePathEnabled&&h.sourcePathVolumeName){const Z={volume:{...h.sourcePathSchemaSource==="reference"&&h.sourcePathSchemaRef?{_schemaRef:h.sourcePathSchemaRef}:{schema:{catalog_name:h.sourcePathVolumeCatalog,schema_name:h.sourcePathVolumeSchema}},name:h.sourcePathVolumeName}};h.sourcePathPath&&(Z.path=h.sourcePathPath),X.source_path=Z}if(h.checkpointPathEnabled&&h.checkpointPathVolumeName){const Z={volume:{...h.checkpointPathSchemaSource==="reference"&&h.checkpointPathSchemaRef?{_schemaRef:h.checkpointPathSchemaRef}:{schema:{catalog_name:h.checkpointPathVolumeCatalog,schema_name:h.checkpointPathVolumeSchema}},name:h.checkpointPathVolumeName}};h.checkpointPathPath&&(Z.path=h.checkpointPathPath),X.checkpoint_path=Z}n?n!==h.refName?(c(n),o(h.refName,X)):i(n,X):o(h.refName,X),t(!1),r(null),g(tu),w(""),a()},ae=[{value:"",label:v?"Loading...":"Select an endpoint..."},...(p||[]).map(H=>{var oe;const X=(oe=H.endpoint_status)==null?void 0:oe.state;let Z="unknown";return X==="ONLINE"?Z="ready":X==="PROVISIONING"||X==="SCALING"?Z="transitioning":(X==="OFFLINE"||X==="FAILED")&&(Z="stopped"),{value:H.name,label:H.name,status:Z}})],U=[{value:"",label:"Select embedding model..."},{value:"databricks-gte-large-en",label:"GTE Large (Embeddings)"},{value:"databricks-bge-large-en",label:"BGE Large (Embeddings)"},...Object.entries(m).map(([H,X])=>({value:X.name,label:`${H} (${X.name})`}))];return s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(hs,{className:"w-5 h-5 text-violet-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Vector Stores"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>{const H=Object.keys(d).length>0;g({...tu,indexSchemaSource:H?"reference":"direct",sourceSchemaSource:H?"reference":"direct",sourcePathSchemaSource:H?"reference":"direct",checkpointPathSchemaSource:H?"reference":"direct"}),w(""),r(null),t(!0)},children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Vector Store"]})]}),Object.keys(u).length>0&&s.jsx("div",{className:"space-y-2 mb-4",children:Object.entries(u).map(([H,X])=>{var Z,oe;return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(hs,{className:"w-4 h-4 text-violet-400"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:H}),s.jsxs("p",{className:"text-xs text-slate-500",children:[((Z=X.endpoint)==null?void 0:Z.name)||"No endpoint","  ",((oe=X.index)==null?void 0:oe.name)||"No index"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[X.on_behalf_of_user&&s.jsxs(we,{variant:"success",title:"On Behalf of User",children:[s.jsx(Mn,{className:"w-3 h-3 mr-1"}),"OBO"]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>B(H),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>K(H),children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]})]},H)})}),Object.keys(u).length===0&&!e&&s.jsx("p",{className:"text-slate-500 text-sm",children:"No vector stores configured. Add a vector store to enable semantic search."}),e&&s.jsxs("div",{className:"mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("h4",{className:"font-medium text-slate-200",children:[n?"Edit":"New"," Vector Store"]}),s.jsx(re,{label:"Reference Name",value:h.refName,onChange:H=>g({...h,refName:H.target.value}),placeholder:"products_vector_store",hint:n?"Changing this will update all references in the YAML":"Unique key to reference this resource",required:!0}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium",children:["Vector Search Endpoint ",s.jsx("span",{className:"text-slate-500 font-normal",children:"(Optional)"})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Auto-detected if not specified"})]}),s.jsxs("button",{type:"button",onClick:()=>b(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:v,children:[s.jsx(gt,{className:`w-3 h-3 ${v?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(Gl,{options:ae,value:h.endpoint_name,onChange:H=>{const X=p==null?void 0:p.find(oe=>oe.name===H),Z=(X==null?void 0:X.endpoint_type)==="OPTIMIZED_STORAGE"?"OPTIMIZED_STORAGE":"STANDARD";g({...h,endpoint_name:H,endpoint_type:H?Z:h.endpoint_type})},placeholder:"Select an endpoint (or leave empty for auto-detection)..."}),s.jsx(le,{label:"Endpoint Type",value:h.endpoint_type,onChange:H=>g({...h,endpoint_type:H.target.value}),options:[{value:"STANDARD",label:"Standard"},{value:"OPTIMIZED_STORAGE",label:"Optimized Storage"}],hint:h.endpoint_name?"Auto-detected from selected endpoint":"Only used if endpoint is specified",disabled:!!h.endpoint_name})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Index Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>g({...h,indexSchemaSource:"reference"}),className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${h.indexSchemaSource==="reference"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(hs,{className:"w-3 h-3"}),s.jsx("span",{children:"Configured"})]}),s.jsx("button",{type:"button",onClick:()=>g({...h,indexSchemaSource:"direct"}),className:`px-2 py-1 text-xs rounded ${h.indexSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),h.indexSchemaSource==="reference"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:h.indexSchemaRefName,onChange:H=>{const X=H.target.value,Z=d[X];g({...h,indexSchemaRefName:X,index_catalog:(Z==null?void 0:Z.catalog_name)||"",index_schema:(Z==null?void 0:Z.schema_name)||""})},options:[{value:"",label:"Select configured schema..."},...V]}),V.length===0&&s.jsx("p",{className:"text-xs text-amber-400",children:'No schemas configured. Add one in Schemas section or switch to "Select".'})]}):s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(le,{label:"Catalog",value:h.index_catalog,onChange:H=>g({...h,index_catalog:H.target.value,index_schema:"",indexSchemaRefName:""}),options:[{value:"",label:"Select catalog..."},...(x||[]).map(H=>({value:H.name,label:H.name}))]}),s.jsx(le,{label:"Schema",value:h.index_schema,onChange:H=>g({...h,index_schema:H.target.value,indexSchemaRefName:""}),options:[{value:"",label:"Select schema..."},...(E||[]).map(H=>({value:H.name,label:H.name}))],disabled:!h.index_catalog})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Index Name"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>g({...h,indexNameSource:"select",index_name:""}),className:`px-2 py-1 text-xs rounded ${h.indexNameSource==="select"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"}),s.jsx("button",{type:"button",onClick:()=>g({...h,indexNameSource:"manual"}),className:`px-2 py-1 text-xs rounded ${h.indexNameSource==="manual"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Manual"})]})]}),h.indexNameSource==="select"?s.jsx(le,{value:h.index_name,onChange:H=>{const X=H.target.value;g(Z=>({...Z,index_name:X,refName:n?Z.refName:X?De(X):Z.refName}))},options:[{value:"",label:A?"Loading tables...":"Select a table..."},...(k||[]).map(H=>({value:H.name,label:H.name}))],disabled:!h.index_catalog||!h.index_schema||A,hint:"Select a table from the index schema"}):s.jsx(re,{value:h.index_name,onChange:H=>g({...h,index_name:H.target.value}),placeholder:"products_index",hint:"Enter a custom index name"})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-sm text-slate-300 font-medium",children:["Source Table ",s.jsx("span",{className:"text-red-400 font-normal",children:"(Required for new index)"})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"The table containing data to be indexed"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Source Schema"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>g({...h,sourceSchemaSource:"reference"}),className:`px-2 py-1 text-xs rounded flex items-center space-x-1 ${h.sourceSchemaSource==="reference"?"bg-purple-500/30 text-purple-300":"bg-slate-700 text-slate-400"}`,children:[s.jsx(hs,{className:"w-3 h-3"}),s.jsx("span",{children:"Configured"})]}),s.jsx("button",{type:"button",onClick:()=>g({...h,sourceSchemaSource:"direct"}),className:`px-2 py-1 text-xs rounded ${h.sourceSchemaSource==="direct"?"bg-blue-500/30 text-blue-300":"bg-slate-700 text-slate-400"}`,children:"Select"})]})]}),h.sourceSchemaSource==="reference"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:h.sourceSchemaRefName,onChange:H=>{const X=H.target.value,Z=d[X];g({...h,sourceSchemaRefName:X,source_catalog:(Z==null?void 0:Z.catalog_name)||"",source_schema:(Z==null?void 0:Z.schema_name)||"",source_table:"",embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),w("")},options:[{value:"",label:"Select configured schema..."},...V]}),V.length===0&&s.jsx("p",{className:"text-xs text-amber-400",children:'No schemas configured. Add one in Schemas section or switch to "Select".'})]}):s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx(le,{label:"Catalog",value:h.source_catalog,onChange:H=>{g({...h,source_catalog:H.target.value,source_schema:"",source_table:"",sourceSchemaRefName:"",embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),w("")},options:[{value:"",label:"Select catalog..."},...(x||[]).map(H=>({value:H.name,label:H.name}))]}),s.jsx(le,{label:"Schema",value:h.source_schema,onChange:H=>{g({...h,source_schema:H.target.value,source_table:"",sourceSchemaRefName:"",embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),w("")},options:[{value:"",label:"Select schema..."},...(_||[]).map(H=>({value:H.name,label:H.name}))],disabled:!h.source_catalog})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(le,{label:"Table",value:h.source_table,onChange:H=>{g({...h,source_table:H.target.value,embedding_source_column:"",primary_key:"",doc_uri:"",columns:[]}),w("")},options:[{value:"",label:N?"Loading...":"Select table..."},...(S||[]).map(H=>({value:H.name,label:H.name}))],disabled:!h.source_schema&&!h.sourceSchemaRefName||N})}),h.source_table&&s.jsxs("button",{type:"button",onClick:()=>F(),className:"mt-6 text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:O,children:[s.jsx(gt,{className:`w-3 h-3 ${O?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm text-slate-300 font-medium",children:"Embedding Configuration"}),O&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[s.jsx(dt,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:"Loading columns..."})]})]}),s.jsx(le,{label:"Embedding Model",value:h.embedding_model,onChange:H=>g({...h,embedding_model:H.target.value}),options:U,hint:"Model used to create embeddings"}),s.jsx(le,{label:"Embedding Source Column",value:h.embedding_source_column,onChange:H=>g({...h,embedding_source_column:H.target.value}),options:[{value:"",label:O?"Loading columns...":j.length>0?"Select column...":"Select a table first..."},...j],hint:"Column containing text to embed (typically text/string columns)",disabled:!h.source_table||O}),s.jsx(le,{label:"Primary Key",value:h.primary_key,onChange:H=>g({...h,primary_key:H.target.value}),options:[{value:"",label:O?"Loading columns...":j.length>0?"Select primary key column...":"Select a table first..."},...j],hint:"Primary key column for the source table",disabled:!h.source_table||O})]}),s.jsxs("div",{className:"space-y-3 p-3 bg-slate-900/50 rounded border border-slate-600",children:[s.jsx("p",{className:"text-sm text-slate-300 font-medium",children:"Columns to Include"}),h.source_table&&j.length>0?s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2 max-h-40 overflow-y-auto p-2 bg-slate-800/50 rounded border border-slate-700",children:j.map(H=>{const X=y.split(",").map(Z=>Z.trim()).includes(H.value);return s.jsx("button",{type:"button",onClick:()=>{const Z=y.split(",").map(oe=>oe.trim()).filter(oe=>oe);w(X?Z.filter(oe=>oe!==H.value).join(", "):[...Z,H.value].join(", "))},className:`px-2 py-1 text-xs rounded transition-colors ${X?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:H.value},H.value)})}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Click columns to select/deselect. Selected: ",y.split(",").filter(H=>H.trim()).length||0]})]}):s.jsx(re,{label:"",value:y,onChange:H=>w(H.target.value),placeholder:"id, name, description, category",hint:"Select a table to see available columns, or enter comma-separated column names"})]}),s.jsx(le,{label:"Document URI Column (Optional)",value:h.doc_uri,onChange:H=>g({...h,doc_uri:H.target.value}),options:[{value:"",label:j.length>0?"None (no document URIs)":"Select a table first..."},...j],hint:"Column containing document URIs for linking",disabled:!h.source_table||O}),s.jsx(qw,{formData:h,setFormData:g,configuredSchemas:d,configuredSchemaOptions:V,catalogs:x,sourcePathSchemas:T,sourcePathVolumes:I,sourcePathVolumesLoading:$,checkpointPathSchemas:P,checkpointPathVolumes:M,checkpointPathVolumesLoading:D}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:h.on_behalf_of_user,onChange:H=>g({...h,on_behalf_of_user:H.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx(Rn,{className:"w-4 h-4 text-blue-400"}),s.jsx("span",{className:"text-sm text-slate-300",children:"On Behalf of User"})]}),h.refName&&ft(h.refName,l,n)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',h.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx(Q,{variant:"secondary",onClick:a,children:"Cancel"}),s.jsx(Q,{onClick:J,disabled:!h.refName||!h.embedding_source_column||ft(h.refName,l,n),children:n?"Update":"Add"})]})]})]})}const Qw=[{value:"",label:"= (equals)"},{value:" NOT",label:"!= (not equals)"},{value:" <",label:"< (less than)"},{value:" <=",label:"<= (less or equal)"},{value:" >",label:"> (greater than)"},{value:" >=",label:">= (greater or equal)"},{value:" LIKE",label:"LIKE (pattern match)"}];function Fh(){return`filter_${Date.now()}_${Math.random().toString(36).substring(2,11)}`}function Kw(e){return e.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}const Zw=[{value:"ms-marco-TinyBERT-L-2-v2",label:"TinyBERT L-2 (fastest)"},{value:"ms-marco-MiniLM-L-6-v2",label:"MiniLM L-6"},{value:"ms-marco-MiniLM-L-12-v2",label:"MiniLM L-12 (balanced)"},{value:"rank-T5-flan",label:"T5-flan (most accurate)"}],Jw=[{value:"ANN",label:"ANN (Approximate Nearest Neighbor)"},{value:"HYBRID",label:"Hybrid"}];function e_(){var k;const{config:e,addRetriever:t,updateRetriever:n,removeRetriever:r}=Oe(),[a,l]=R.useState(!1),[o,i]=R.useState(null),[c,u]=R.useState({refName:"",vectorStoreRef:"",columns:"",numResults:"10",queryType:"ANN",filters:[],enableRerank:!1,rerankModel:"ms-marco-MiniLM-L-12-v2",rerankTopN:"",rerankCacheDir:"/tmp/flashrank_cache",rerankColumns:""}),m=e.retrievers||{},d=((k=e.resources)==null?void 0:k.vector_stores)||{},f=Object.keys(d).length>0,p=Object.entries(d).map(([A,C])=>({value:A,label:`${A} (${C.embedding_source_column||"no column"})`})),v=()=>{u({refName:"",vectorStoreRef:"",columns:"",numResults:"10",queryType:"ANN",filters:[],enableRerank:!1,rerankModel:"ms-marco-MiniLM-L-12-v2",rerankTopN:"",rerankCacheDir:"/tmp/flashrank_cache",rerankColumns:""}),i(null)},b=A=>{var V,B,K,J,ae,U,Y;const C=m[A];let O="";if(C.vector_store){const W=Object.entries(d).find(([,ie])=>{var H,X;return ie.embedding_source_column===C.vector_store.embedding_source_column&&((H=ie.source_table)==null?void 0:H.name)===((X=C.vector_store.source_table)==null?void 0:X.name)});W&&(O=W[0])}let F=!1,j="ms-marco-MiniLM-L-12-v2",T="",I="/tmp/flashrank_cache",$="";C.rerank&&(F=!0,typeof C.rerank=="object"&&(j=C.rerank.model||j,T=((V=C.rerank.top_n)==null?void 0:V.toString())||"",I=C.rerank.cache_dir||I,$=((B=C.rerank.columns)==null?void 0:B.join(", "))||""));const P=O?d[O]:null,M=new Set;P&&(P.columns&&Array.isArray(P.columns)&&P.columns.forEach(W=>M.add(W)),P.embedding_source_column&&M.add(P.embedding_source_column),P.primary_key&&M.add(P.primary_key),P.doc_uri&&M.add(P.doc_uri));const D=[];(K=C.search_parameters)!=null&&K.filters&&Object.entries(C.search_parameters.filters).forEach(([W,ie])=>{let H=W,X="";const Z=[" NOT"," <="," >="," <"," >"," LIKE"];for(const fe of Z)if(W.endsWith(fe)){H=W.slice(0,-fe.length),X=fe;break}const oe=M.has(H)?"select":"manual";D.push({id:Fh(),columnSource:oe,column:H,operator:X,value:String(ie)})}),u({refName:A,vectorStoreRef:O,columns:((J=C.columns)==null?void 0:J.join(", "))||"",numResults:((U=(ae=C.search_parameters)==null?void 0:ae.num_results)==null?void 0:U.toString())||"10",queryType:((Y=C.search_parameters)==null?void 0:Y.query_type)||"ANN",filters:D,enableRerank:F,rerankModel:j,rerankTopN:T,rerankCacheDir:I,rerankColumns:$}),i(A),l(!0)},x=A=>{if(A.preventDefault(),!c.refName||!c.vectorStoreRef)return;const C=d[c.vectorStoreRef];if(!C)return;const O=c.columns.split(",").map($=>$.trim()).filter($=>$.length>0),F={};c.filters.forEach($=>{if($.column&&$.value){const P=$.operator?`${$.column}${$.operator}`:$.column;let M=$.value;$.value==="true"?M=!0:$.value==="false"?M=!1:!isNaN(Number($.value))&&$.value.trim()!==""&&(M=Number($.value)),F[P]=M}});const j={num_results:parseInt(c.numResults)||10,filters:Object.keys(F).length>0?F:void 0,query_type:c.queryType};let T;if(c.enableRerank){const $=c.rerankColumns.split(",").map(P=>P.trim()).filter(P=>P.length>0);T={model:c.rerankModel,top_n:c.rerankTopN?parseInt(c.rerankTopN):void 0,cache_dir:c.rerankCacheDir||void 0,columns:$.length>0?$:void 0}}const I={vector_store:C,columns:O.length>0?O:void 0,search_parameters:j,rerank:T};o&&o!==c.refName?(r(o),t(c.refName,I)):o?n(c.refName,I):t(c.refName,I),v(),l(!1)},h=A=>{const{name:C,value:O,type:F}=A.target;u(F==="checkbox"?j=>({...j,[C]:A.target.checked}):j=>({...j,[C]:O}))},g=A=>{u(C=>{var F;const O={...C,vectorStoreRef:A};return!C.columns&&((F=d[A])!=null&&F.columns)&&(O.columns=d[A].columns.join(", ")),!C.refName&&A&&(O.refName=`${Kw(A)}_retriever`),O})},w=(()=>{if(!c.vectorStoreRef)return[];const A=d[c.vectorStoreRef];if(!A)return[];const C=new Set;return A.columns&&Array.isArray(A.columns)&&A.columns.forEach(O=>C.add(O)),A.embedding_source_column&&C.add(A.embedding_source_column),A.primary_key&&C.add(A.primary_key),A.doc_uri&&C.add(A.doc_uri),Array.from(C).sort()})(),E=w.length>0,_=()=>{u(A=>({...A,filters:[...A.filters,{id:Fh(),columnSource:E?"select":"manual",column:"",operator:"",value:""}]}))},S=(A,C,O)=>{u(F=>({...F,filters:F.filters.map(j=>j.id!==A?j:C==="columnSource"?{...j,columnSource:O,column:""}:{...j,[C]:O})}))},N=A=>{u(C=>({...C,filters:C.filters.filter(O=>O.id!==A)}))};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-slate-100 flex items-center gap-2",children:[s.jsx(wr,{className:"w-5 h-5 text-blue-400"}),"Retrievers"]}),s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Configure vector search retrievers for semantic search and information retrieval"})]})}),!f&&s.jsx(ye,{className:"bg-amber-500/10 border-amber-500/30",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-amber-500/20 flex items-center justify-center",children:s.jsx(hs,{className:"w-4 h-4 text-amber-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-amber-200",children:"No Vector Stores Configured"}),s.jsx("p",{className:"text-xs text-amber-300/70 mt-1",children:"Retrievers require a vector store. Configure at least one vector store in the Resources section first."})]})]})}),s.jsxs(Q,{onClick:()=>{v(),l(!0)},variant:"primary",size:"sm",disabled:!f,className:"self-start",children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Retriever"]}),s.jsxs("div",{className:"space-y-3",children:[Object.entries(m).map(([A,C])=>{var O,F,j,T;return s.jsx(ye,{className:"hover:border-slate-700 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-200",children:A}),s.jsxs(we,{variant:"info",children:[s.jsx(Mh,{className:"w-3 h-3 mr-1"}),((O=C.search_parameters)==null?void 0:O.num_results)||10," results"]}),((F=C.search_parameters)==null?void 0:F.filters)&&Object.keys(C.search_parameters.filters).length>0&&s.jsxs(we,{variant:"warning",children:[Object.keys(C.search_parameters.filters).length," filter",Object.keys(C.search_parameters.filters).length!==1?"s":""]}),C.rerank&&s.jsxs(we,{variant:"success",children:[s.jsx(gt,{className:"w-3 h-3 mr-1"}),"Reranking"]})]}),s.jsxs("div",{className:"mt-2 space-y-1 text-xs text-slate-400",children:[s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Query Type:"})," ",((j=C.search_parameters)==null?void 0:j.query_type)||"ANN"]}),C.columns&&C.columns.length>0&&s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Columns:"})," ",C.columns.slice(0,3).join(", "),C.columns.length>3&&` +${C.columns.length-3} more`]}),((T=C.search_parameters)==null?void 0:T.filters)&&Object.keys(C.search_parameters.filters).length>0&&s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Filters:"})," ",Object.entries(C.search_parameters.filters).slice(0,2).map(([I,$])=>`${I}=${$}`).join(", "),Object.keys(C.search_parameters.filters).length>2&&` +${Object.keys(C.search_parameters.filters).length-2} more`]}),C.rerank&&typeof C.rerank=="object"&&s.jsxs("p",{children:[s.jsx("span",{className:"text-slate-500",children:"Rerank Model:"})," ",C.rerank.model,C.rerank.top_n&&` (top ${C.rerank.top_n})`]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>b(A),children:[s.jsx(tn,{className:"w-4 h-4 mr-1"}),"Edit"]}),s.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>r(A),className:"text-red-400 hover:text-red-300",children:[s.jsx(Ge,{className:"w-4 h-4 mr-1"}),"Delete"]})]})]})},A)}),Object.keys(m).length===0&&f&&s.jsxs("div",{className:"text-center py-8 text-slate-500",children:[s.jsx(wr,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{children:"No retrievers configured yet"}),s.jsx("p",{className:"text-xs mt-1",children:"Add a retriever to enable semantic search capabilities for your agents"})]})]}),s.jsx(En,{isOpen:a,onClose:()=>{v(),l(!1)},title:o?"Edit Retriever":"Add Retriever",size:"lg",children:s.jsxs("form",{onSubmit:x,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-300 border-b border-slate-700 pb-2",children:"Basic Configuration"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Reference Name",name:"refName",value:c.refName,onChange:h,placeholder:"products_retriever",hint:"Unique identifier for this retriever",required:!0}),s.jsx(le,{label:"Vector Store",value:c.vectorStoreRef,onChange:A=>g(A.target.value),options:[{value:"",label:"Select a vector store..."},...p],hint:"Select a configured vector store",required:!0})]}),s.jsx(re,{label:"Return Columns",name:"columns",value:c.columns,onChange:h,placeholder:"product_id, name, description",hint:"Comma-separated list of columns to return in search results"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-300 border-b border-slate-700 pb-2",children:"Search Parameters"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Number of Results",name:"numResults",type:"number",value:c.numResults,onChange:h,placeholder:"10",hint:"Maximum number of results to return"}),s.jsx(le,{label:"Query Type",value:c.queryType,onChange:A=>u(C=>({...C,queryType:A.target.value})),options:Jw,hint:"Search algorithm to use"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-2",children:[s.jsxs("h3",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[s.jsx(Mh,{className:"w-4 h-4"}),"Filters (Optional)"]}),s.jsxs(Q,{type:"button",variant:"ghost",size:"sm",onClick:_,children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Filter"]})]}),c.filters.length===0?s.jsx("div",{className:"text-xs text-slate-500 italic py-2",children:"No filters configured. Add filters to narrow down search results based on column values."}):s.jsx("div",{className:"space-y-3",children:c.filters.map(A=>s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between h-5 mb-1",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Column"}),s.jsxs("div",{className:"flex",children:[s.jsx("button",{type:"button",onClick:()=>S(A.id,"columnSource","select"),className:`px-2 py-0.5 text-[10px] rounded-l border transition-colors ${A.columnSource==="select"?"bg-blue-600 border-blue-600 text-white":"bg-slate-800 border-slate-600 text-slate-400 hover:bg-slate-700"} ${E?"":"opacity-50 cursor-not-allowed"}`,disabled:!E,title:E?"Select from available columns":"No columns available",children:"Select"}),s.jsx("button",{type:"button",onClick:()=>S(A.id,"columnSource","manual"),className:`px-2 py-0.5 text-[10px] rounded-r border-t border-r border-b transition-colors ${A.columnSource==="manual"?"bg-blue-600 border-blue-600 text-white":"bg-slate-800 border-slate-600 text-slate-400 hover:bg-slate-700"}`,children:"Manual"})]})]}),A.columnSource==="select"&&E?s.jsxs("select",{value:A.column,onChange:C=>S(A.id,"column",C.target.value),className:"w-full h-[38px] px-3 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Select column..."}),w.map(C=>s.jsx("option",{value:C,children:C},C))]}):s.jsx("input",{type:"text",value:A.column,onChange:C=>S(A.id,"column",C.target.value),placeholder:"column_name",className:"w-full h-[38px] px-3 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"flex items-center justify-between h-5 mb-1",children:s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Operator"})}),s.jsx("select",{value:A.operator,onChange:C=>S(A.id,"operator",C.target.value),className:"w-full h-[38px] px-3 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Qw.map(C=>s.jsx("option",{value:C.value,children:C.label},C.value))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1",children:"Value"}),s.jsx("input",{type:"text",value:A.value,onChange:C=>S(A.id,"value",C.target.value),placeholder:"filter value",className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),s.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Strings, numbers, or booleans (true/false)"})]})]}),s.jsx("button",{type:"button",onClick:()=>N(A.id),className:"mt-4 p-1.5 text-slate-400 hover:text-red-400 hover:bg-red-400/10 rounded transition-colors",title:"Remove filter",children:s.jsx(aa,{className:"w-4 h-4"})})]},A.id))}),s.jsx("p",{className:"text-xs text-slate-500",children:"Filters restrict search results to rows matching the specified conditions. Use column names from your source table. Values are automatically parsed as numbers or booleans when applicable."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between border-b border-slate-700 pb-2",children:[s.jsx("h3",{className:"text-sm font-medium text-slate-300",children:"Reranking (Optional)"}),s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",name:"enableRerank",checked:c.enableRerank,onChange:h,className:"rounded border-slate-600 bg-slate-700 text-blue-500 focus:ring-blue-500 focus:ring-offset-slate-800"}),s.jsx("span",{className:"text-slate-400",children:"Enable reranking"})]})]}),c.enableRerank&&s.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-slate-700",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Rerank Model",value:c.rerankModel,onChange:A=>u(C=>({...C,rerankModel:A.target.value})),options:Zw,hint:"FlashRank model for reranking"}),s.jsx(re,{label:"Top N Results",name:"rerankTopN",type:"number",value:c.rerankTopN,onChange:h,placeholder:"5",hint:"Number of results after reranking (leave empty to use search num_results)"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Columns to Rerank"}),w.length>0?s.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto p-3 bg-slate-900/50 rounded-lg border border-slate-600",children:w.map(A=>{const C=c.rerankColumns.split(",").map(F=>F.trim()).filter(F=>F),O=C.includes(A);return s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:O,onChange:F=>{let j;F.target.checked?j=[...C,A]:j=C.filter(T=>T!==A),u(T=>({...T,rerankColumns:j.join(", ")}))},className:"w-4 h-4 rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500 focus:ring-offset-0"}),s.jsx("span",{className:"text-sm text-slate-300",children:A})]},A)})}):s.jsx("div",{className:"p-3 bg-slate-900/50 rounded-lg border border-slate-600 text-slate-500 text-sm",children:c.vectorStoreRef?"No columns found in selected vector store":"Select a vector store to see available columns"}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select columns from the vector store to use for reranking.",c.rerankColumns&&` Selected: ${c.rerankColumns}`]})]}),s.jsx(re,{label:"Cache Directory",name:"rerankCacheDir",value:c.rerankCacheDir,onChange:h,placeholder:"/tmp/flashrank_cache",hint:"Directory to cache downloaded model weights"})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-700",children:[s.jsx(Q,{type:"button",variant:"ghost",onClick:()=>{v(),l(!1)},children:"Cancel"}),s.jsxs(Q,{type:"submit",variant:"primary",children:[o?"Update":"Add"," Retriever"]})]})]})})]})}const An=R.forwardRef(({className:e,label:t,error:n,hint:r,id:a,...l},o)=>{const i=a||(t==null?void 0:t.toLowerCase().replace(/\s+/g,"-"));return s.jsxs("div",{className:"space-y-1.5",children:[t&&s.jsxs("label",{htmlFor:i,className:"block text-sm font-medium text-slate-300",children:[t,l.required&&s.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),s.jsx("textarea",{ref:o,id:i,className:Te("w-full px-3 py-2 bg-slate-800/50 border rounded-lg text-slate-200 placeholder-slate-500","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200 resize-none font-mono text-sm",n?"border-red-500/50":"border-slate-700",e),...l}),r&&!n&&s.jsx("p",{className:"text-xs text-slate-500",children:r}),n&&s.jsx("p",{className:"text-xs text-red-400",children:n})]})});An.displayName="Textarea";function sr({label:e,resourceType:t,configuredOptions:n,configuredValue:r,onConfiguredChange:a,source:l,onSourceChange:o,children:i,hint:c}){return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>o("configured"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${l==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>o("select"),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${l==="select"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]}),l==="configured"?s.jsxs("div",{className:"space-y-1",children:[s.jsx(le,{options:[{value:"",label:`Select configured ${t}...`},...n],value:r,onChange:u=>a(u.target.value)}),n.length===0&&s.jsxs("p",{className:"text-xs text-amber-400",children:["No ",t,'s configured. Add one in Resources section or switch to "Select".']})]}):i,c&&s.jsx("p",{className:"text-xs text-slate-500",children:c})]})}const t_=[{value:"factory",label:"Factory Function"},{value:"python",label:"Python Function"},{value:"unity_catalog",label:"Unity Catalog Function"},{value:"mcp",label:"MCP Server"}],n_=[{value:"dao_ai.tools.create_genie_tool",label:"Genie Tool",description:"Query data using natural language via Databricks Genie",icon:qs},{value:"dao_ai.tools.create_vector_search_tool",label:"Vector Search Tool",description:"Semantic search over documents using vector embeddings",icon:wr},{value:"dao_ai.tools.search_tool",label:"Web Search Tool",description:"Search the web for information",icon:J1},{value:"dao_ai.tools.create_send_slack_message_tool",label:"Slack Message Tool",description:"Send messages to Slack channels",icon:qs},{value:"dao_ai.tools.create_uc_tools",label:"Unity Catalog Tools",description:"Execute Unity Catalog functions",icon:Qt},{value:"dao_ai.tools.create_agent_endpoint_tool",label:"Agent Endpoint Tool",description:"Call another deployed agent endpoint",icon:_t},{value:"dao_ai.tools.current_time_tool",label:"Current Time Tool",description:"Get the current date and time",icon:Si},{value:"dao_ai.tools.time_in_timezone_tool",label:"Time in Timezone Tool",description:"Get time in a specific timezone",icon:Si},{value:"databricks_langchain.vector_search_retriever_tool.VectorSearchRetrieverTool",label:"Databricks Vector Search Retriever",description:"Native Databricks vector search retriever tool",icon:wr},{value:"custom",label:"Custom Factory...",description:"Specify a custom factory function path",icon:js}],s_=[{value:"url",label:"Direct URL",description:"Connect to any MCP server via URL"},{value:"genie",label:"Genie Room",description:"Databricks Genie MCP server"},{value:"vector_search",label:"Vector Search",description:"Databricks Vector Search MCP server"},{value:"functions",label:"UC Functions",description:"Unity Catalog Functions MCP server"},{value:"sql",label:"SQL (DBSQL)",description:"Databricks SQL MCP server"},{value:"connection",label:"UC Connection",description:"External MCP server via UC Connection"}],zh={sourceType:"url",url:"",genieSource:"select",genieRefName:"",genieSpaceId:"",genieName:"",genieDescription:"",vectorStoreSource:"select",vectorStoreRefName:"",vectorEndpoint:"",vectorIndex:"",vectorCatalog:"",vectorSchema:"",schemaSource:"select",schemaRefName:"",functionsCatalog:"",functionsSchema:"",connectionSource:"select",connectionRefName:"",connectionName:"",warehouseSource:"select",warehouseRefName:"",warehouseId:"",useCredentials:!0,credentialsMode:"service_principal",servicePrincipalRef:"",clientIdSource:"variable",clientIdVar:"",clientIdManual:"",clientSecretSource:"variable",clientSecretVar:"",clientSecretManual:"",workspaceHostSource:"variable",workspaceHostVar:"",workspaceHostManual:""},Vh={enabled:!1,reviewPrompt:"Please review the tool call",allowAccept:!0,allowEdit:!0,allowRespond:!0,allowDecline:!0,declineMessage:"Tool call declined by user",customActions:[]};function wo(e){const t=e.split(".");let n=t[t.length-1];return n=n.replace(/^create_/,"").replace(/_tool$/,""),n.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}function r_(){var Z,oe,fe,ge;const{config:e,addTool:t,removeTool:n}=Oe(),[r,a]=R.useState(!1),[l,o]=R.useState({name:"",type:"factory",functionName:"",customFunctionName:"",args:"{}",genieSource:"configured",genieRefName:"",genieSpaceId:"",warehouseSource:"configured",warehouseRefName:"",warehouseId:"",retrieverSource:"configured",retrieverRefName:"",vectorEndpoint:"",vectorIndex:"",schemaSource:"configured",schemaRefName:"",ucCatalog:"",ucSchema:"",functionSource:"configured",functionRefName:"",ucFunction:""}),[i,c]=R.useState(zh),[u,m]=R.useState(Vh),[d,f]=R.useState(!1),p=((Z=e.resources)==null?void 0:Z.genie_rooms)||{},v=((oe=e.resources)==null?void 0:oe.vector_stores)||{},b=e.retrievers||{},x=e.schemas||{},h=((fe=e.resources)==null?void 0:fe.functions)||{},g=((ge=e.resources)==null?void 0:ge.connections)||{},y=Object.entries(p).map(([L,G])=>({value:L,label:`${L} (${G.name||G.space_id})`})),w=Object.entries(v).map(([L,G])=>({value:L,label:`${L} (${G.embedding_source_column||L})`})),E=Object.entries(b).map(([L,G])=>{var ve;return{value:L,label:`${L} (${((ve=G.search_parameters)==null?void 0:ve.num_results)||10} results)`}}),_=Object.entries(x).map(([L,G])=>({value:L,label:`${L} (${G.catalog_name}.${G.schema_name})`})),S=Object.entries(h).map(([L,G])=>({value:L,label:`${L} (${G.name})`})),N=Object.entries(g).map(([L,G])=>({value:L,label:`${L} (${G.name})`})),k=e.tools||{},A=e.variables||{},C=Object.keys(A),{data:O,loading:F,refetch:j}=Bg(l.ucCatalog||null,l.ucSchema||null),{data:T,loading:I,refetch:$}=wd(l.vectorEndpoint||null),{data:P,loading:M,refetch:D}=wd(i.vectorEndpoint||null),V=()=>{if(!u.enabled)return;const L={review_prompt:u.reviewPrompt,interrupt_config:{allow_accept:u.allowAccept,allow_edit:u.allowEdit,allow_respond:u.allowRespond,allow_decline:u.allowDecline},decline_message:u.declineMessage};return u.customActions.length>0&&(L.custom_actions={},u.customActions.forEach(G=>{G.key&&G.value&&(L.custom_actions[G.key]=G.value)})),L},B=()=>{const L={type:"mcp",name:l.name};switch(i.useCredentials&&(i.credentialsMode==="service_principal"&&i.servicePrincipalRef?L.service_principal=`*${i.servicePrincipalRef}`:i.credentialsMode==="manual"&&(i.clientIdSource==="variable"&&i.clientIdVar?L.client_id=`*${i.clientIdVar}`:i.clientIdSource==="manual"&&i.clientIdManual&&(L.client_id=i.clientIdManual),i.clientSecretSource==="variable"&&i.clientSecretVar?L.client_secret=`*${i.clientSecretVar}`:i.clientSecretSource==="manual"&&i.clientSecretManual&&(L.client_secret=i.clientSecretManual),i.workspaceHostSource==="variable"&&i.workspaceHostVar?L.workspace_host=`*${i.workspaceHostVar}`:i.workspaceHostSource==="manual"&&i.workspaceHostManual&&(L.workspace_host=i.workspaceHostManual))),i.sourceType){case"url":L.url=i.url;break;case"genie":L.genie_room={name:i.genieName||"Genie Room",space_id:i.genieSpaceId,description:i.genieDescription||void 0};break;case"vector_search":L.vector_search={source_table:{schema:{catalog_name:i.vectorCatalog,schema_name:i.vectorSchema}},embedding_source_column:"content",index:{name:i.vectorIndex},endpoint:{name:i.vectorEndpoint}};break;case"functions":L.functions={catalog_name:i.functionsCatalog,schema_name:i.functionsSchema};break;case"sql":L.sql=!0;break;case"connection":i.connectionSource==="configured"&&i.connectionRefName?L.connection=`*${i.connectionRefName}`:i.connectionName&&(L.connection={name:i.connectionName});break}return L},K=L=>{L.preventDefault();const G=l.functionName==="custom"?l.customFunctionName:l.functionName;if(!l.name)return;let ve;const me=V();if(l.type==="factory"){let je={};if(l.functionName==="dao_ai.tools.create_genie_tool")l.genieSource==="configured"&&l.genieRefName?je={name:l.name,description:"Tool for querying via Genie",genie_room:`__REF__${l.genieRefName}`}:je={name:l.name,description:"Tool for querying via Genie",genie_room:{space_id:l.genieSpaceId}};else if(l.functionName==="dao_ai.tools.create_vector_search_tool"||l.functionName==="databricks_langchain.vector_search_retriever_tool.VectorSearchRetrieverTool")l.retrieverSource==="configured"&&l.retrieverRefName?je={name:l.name,description:"Search using vector embeddings",retriever:`__REF__${l.retrieverRefName}`}:je={name:l.name,description:"Search using vector embeddings",index_name:l.vectorIndex};else try{je=JSON.parse(l.args||"{}")}catch{}ve={type:"factory",name:G||l.functionName,args:je,...me&&{human_in_the_loop:me}}}else if(l.type==="python")ve={type:"python",name:G,...me&&{human_in_the_loop:me}};else if(l.type==="unity_catalog")l.functionSource==="configured"&&l.functionRefName?ve={type:"unity_catalog",__MERGE__:l.functionRefName,...me&&{human_in_the_loop:me}}:ve={type:"unity_catalog",schema:{catalog_name:l.ucCatalog,schema_name:l.ucSchema},name:l.ucFunction.split(".").pop()||l.ucFunction,...me&&{human_in_the_loop:me}};else if(l.type==="mcp"){if(i.sourceType==="connection"&&!(i.connectionSource==="configured"&&i.connectionRefName||i.connectionSource==="select"&&i.connectionName))return;ve=B(),me&&(ve.human_in_the_loop=me)}else ve=G;t({name:l.name,function:ve}),J(),a(!1)},J=()=>{o({name:"",type:"factory",functionName:"",customFunctionName:"",args:"{}",genieSource:"configured",genieRefName:"",genieSpaceId:"",warehouseSource:"configured",warehouseRefName:"",warehouseId:"",retrieverSource:"configured",retrieverRefName:"",vectorEndpoint:"",vectorIndex:"",schemaSource:"configured",schemaRefName:"",ucCatalog:"",ucSchema:"",functionSource:"configured",functionRefName:"",ucFunction:""});const L=Object.keys(g).length>0,G=Object.keys(x).length>0,ve=Object.keys(p).length>0,me=Object.keys(v).length>0;c({...zh,connectionSource:L?"configured":"select",schemaSource:G?"configured":"select",genieSource:ve?"configured":"select",vectorStoreSource:me?"configured":"select"}),m(Vh),f(!1)},ae=L=>{var G;return typeof L.function=="string"?"string":((G=L.function)==null?void 0:G.type)||"unknown"},U=L=>{var G;return typeof L.function=="string"?!1:!!((G=L.function)!=null&&G.human_in_the_loop)},Y=L=>{const G=ae(L);if(G==="mcp")return tw;if(G==="unity_catalog")return Qt;if(typeof L.function=="object"&&L.function.name){if(L.function.name.includes("genie"))return qs;if(L.function.name.includes("vector")||L.function.name.includes("search"))return wr;if(L.function.name.includes("time"))return Si;if(L.function.name.includes("agent"))return _t}return js},W=[{value:"",label:"Select a function..."},...(O||[]).map(L=>({value:L.full_name,label:`${L.name}${L.comment?` - ${L.comment}`:""}`}))],ie=[{value:"",label:"Select an index..."},...(T||[]).map(L=>({value:L.name,label:`${L.name}${L.index_type?` (${L.index_type})`:""}`}))],H=[{value:"",label:"Select an index..."},...(P||[]).map(L=>({value:L.name,label:`${L.name}${L.index_type?` (${L.index_type})`:""}`}))],X=L=>L?"env"in L?`env: ${L.env}`:"scope"in L&&"secret"in L?`secret: ${L.scope}/${L.secret}`:"value"in L?`value: ${String(L.value)}`:"options"in L?`composite (${L.options.length} options)`:"unknown":"unknown";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Tools"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure tools that agents can use to perform tasks"})]}),s.jsxs(Q,{onClick:()=>a(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Tool"]})]}),Object.keys(k).length===0?s.jsxs(ye,{className:"text-center py-12",children:[s.jsx(js,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No tools configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Tools enable agents to interact with external systems and data."}),s.jsxs(Q,{onClick:()=>a(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Tool"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(k).map(([L,G])=>{const ve=Y(G);return s.jsx(ye,{variant:"interactive",className:"group",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-amber-500/20 flex items-center justify-center",children:s.jsx(ve,{className:"w-5 h-5 text-amber-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:G.name}),s.jsx("p",{className:"text-sm text-slate-400 font-mono",children:typeof G.function=="object"?G.function.name:G.function})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[U(G)&&s.jsxs(we,{variant:"success",title:"Human In The Loop Enabled",children:[s.jsx(Rn,{className:"w-3 h-3 mr-1"}),"HITL"]}),s.jsx(we,{variant:"warning",children:ae(G)}),s.jsx(Q,{variant:"danger",size:"sm",onClick:()=>n(L),children:s.jsx(Ge,{className:"w-4 h-4"})})]})]})},L)})}),s.jsx(En,{isOpen:r,onClose:()=>{a(!1),J()},title:"Add Tool",description:"Configure a tool for your agents",size:"lg",children:s.jsxs("form",{onSubmit:K,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Tool Name",placeholder:"e.g., genie_tool",value:l.name,onChange:L=>o({...l,name:L.target.value}),required:!0}),s.jsx(le,{label:"Tool Type",options:t_,value:l.type,onChange:L=>o({...l,type:L.target.value})})]}),l.type==="factory"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Factory Function"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:n_.map(L=>{const G=L.icon,ve=l.functionName===L.value;return s.jsxs("button",{type:"button",onClick:()=>o({...l,functionName:L.value,name:l.name||wo(L.value)}),className:`p-3 rounded-lg border text-left transition-all ${ve?"border-blue-500 bg-blue-500/10":"border-slate-700 hover:border-slate-600 bg-slate-800/50"}`,children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(G,{className:`w-4 h-4 ${ve?"text-blue-400":"text-slate-400"}`}),s.jsx("span",{className:`text-sm font-medium ${ve?"text-white":"text-slate-300"}`,children:L.label})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:L.description})]},L.value)})})]}),l.functionName==="dao_ai.tools.create_genie_tool"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Genie Tool Configuration"}),s.jsx(sr,{label:"Genie Room",resourceType:"Genie room",configuredOptions:y,configuredValue:l.genieRefName,onConfiguredChange:L=>o({...l,genieRefName:L,genieSpaceId:""}),source:l.genieSource,onSourceChange:L=>o({...l,genieSource:L}),children:s.jsx(Ih,{value:l.genieSpaceId,onChange:L=>o({...l,genieSpaceId:L,genieRefName:""}),required:!0})})]}),(l.functionName==="dao_ai.tools.create_vector_search_tool"||l.functionName==="databricks_langchain.vector_search_retriever_tool.VectorSearchRetrieverTool")&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Vector Search Configuration"}),s.jsx(sr,{label:"Retriever",resourceType:"Retriever",configuredOptions:E,configuredValue:l.retrieverRefName,onConfiguredChange:L=>o({...l,retrieverRefName:L,vectorEndpoint:"",vectorIndex:""}),source:l.retrieverSource,onSourceChange:L=>o({...l,retrieverSource:L}),hint:l.retrieverSource==="configured"?"Use a pre-configured retriever from the Retrievers section":void 0,children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(Lh,{label:"Vector Search Endpoint",value:l.vectorEndpoint,onChange:L=>o({...l,vectorEndpoint:L,vectorIndex:"",retrieverRefName:""}),required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Vector Index"}),l.vectorEndpoint&&s.jsxs("button",{type:"button",onClick:()=>$(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:I,children:[s.jsx(gt,{className:`w-3 h-3 ${I?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(le,{options:ie,value:l.vectorIndex,onChange:L=>o({...l,vectorIndex:L.target.value}),disabled:!l.vectorEndpoint||I,required:!0})]})]})})]}),l.functionName==="custom"&&s.jsx(re,{label:"Custom Factory Function",placeholder:"e.g., my_package.tools.my_factory",value:l.customFunctionName,onChange:L=>o({...l,customFunctionName:L.target.value}),required:!0}),(l.functionName==="custom"||l.functionName==="dao_ai.tools.search_tool"||l.functionName==="dao_ai.tools.create_send_slack_message_tool"||l.functionName==="dao_ai.tools.create_agent_endpoint_tool")&&s.jsx(An,{label:"Arguments (JSON)",placeholder:'{"key": "value"}',value:l.args,onChange:L=>o({...l,args:L.target.value}),rows:6,hint:"JSON object passed to the factory function"})]}),l.type==="python"&&s.jsx(re,{label:"Python Function Path",placeholder:"e.g., my_package.tools.my_function",value:l.functionName,onChange:L=>{const G=L.target.value;o({...l,functionName:G,name:l.name||wo(G)})},hint:"Fully qualified Python function path",required:!0}),l.type==="unity_catalog"&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Unity Catalog Function"}),s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Function Source"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>o({...l,functionSource:"configured",ucCatalog:"",ucSchema:"",ucFunction:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${l.functionSource==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>o({...l,functionSource:"select",functionRefName:""}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${l.functionSource==="select"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})]})}),l.functionSource==="configured"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{options:[{value:"",label:"Select a configured function..."},...S],value:l.functionRefName,onChange:L=>{const G=L.target.value,ve=h[G];o({...l,functionRefName:G,ucFunction:"",ucCatalog:"",ucSchema:"",name:l.name||wo((ve==null?void 0:ve.name)||G)})}}),S.length===0&&s.jsx("p",{className:"text-xs text-amber-400",children:'No functions configured. Add one in Resources  Functions or switch to "Select".'}),s.jsx("p",{className:"text-xs text-slate-500",children:"Select a pre-configured function from the Resources section"})]}),l.functionSource==="select"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx(sr,{label:"Schema",resourceType:"schema",configuredOptions:_,configuredValue:l.schemaRefName,onConfiguredChange:L=>{const G=x[L];o({...l,schemaRefName:L,ucCatalog:(G==null?void 0:G.catalog_name)||"",ucSchema:(G==null?void 0:G.schema_name)||"",ucFunction:""})},source:l.schemaSource,onSourceChange:L=>o({...l,schemaSource:L}),children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Wo,{label:"Catalog",value:l.ucCatalog,onChange:L=>o({...l,ucCatalog:L,ucSchema:"",ucFunction:"",schemaRefName:""}),required:!0}),s.jsx(Go,{label:"Schema",value:l.ucSchema,onChange:L=>o({...l,ucSchema:L,ucFunction:"",schemaRefName:""}),catalog:l.ucCatalog||null,required:!0})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Function"}),l.ucCatalog&&l.ucSchema||l.schemaRefName?s.jsxs("button",{type:"button",onClick:()=>j(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:F,children:[s.jsx(gt,{className:`w-3 h-3 ${F?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]}):null]}),s.jsx(le,{options:W,value:l.ucFunction,onChange:L=>{const G=L.target.value;o({...l,ucFunction:G,functionRefName:"",name:l.name||wo(G)})},disabled:(!l.ucCatalog||!l.ucSchema)&&!l.schemaRefName||F,required:!0}),F&&s.jsx("p",{className:"text-xs text-slate-500",children:"Loading functions..."}),!l.ucCatalog&&!l.ucSchema&&!l.schemaRefName&&s.jsx("p",{className:"text-xs text-slate-500",children:"Select a schema first to browse functions"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{type:"button",onClick:()=>f(!d),className:"flex items-center space-x-2 text-sm text-slate-400 hover:text-white transition-colors w-full",children:[d?s.jsx(Yl,{className:"w-4 h-4"}):s.jsx(Ns,{className:"w-4 h-4"}),s.jsx(Rn,{className:"w-4 h-4"}),s.jsx("span",{children:"Human In The Loop"}),u.enabled&&s.jsx(we,{variant:"success",className:"ml-2",children:"Enabled"})]}),d&&s.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("input",{type:"checkbox",id:"hitlEnabled",checked:u.enabled,onChange:L=>m({...u,enabled:L.target.checked}),className:"mt-1 rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"hitlEnabled",className:"block text-sm font-medium text-slate-300 cursor-pointer",children:"Require Human Approval"}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Pause execution and request human review before this tool runs."})]})]}),u.enabled&&s.jsxs(s.Fragment,{children:[s.jsx(re,{label:"Review Prompt",value:u.reviewPrompt,onChange:L=>m({...u,reviewPrompt:L.target.value}),placeholder:"Please review the tool call",hint:"Message shown to the reviewer"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Allowed Actions"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:u.allowAccept,onChange:L=>m({...u,allowAccept:L.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-green-500 focus:ring-green-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Accept"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:u.allowEdit,onChange:L=>m({...u,allowEdit:L.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Edit"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:u.allowRespond,onChange:L=>m({...u,allowRespond:L.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-yellow-500 focus:ring-yellow-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Respond"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:u.allowDecline,onChange:L=>m({...u,allowDecline:L.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-red-500 focus:ring-red-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Decline"})]})]})]}),s.jsx(re,{label:"Decline Message",value:u.declineMessage,onChange:L=>m({...u,declineMessage:L.target.value}),placeholder:"Tool call declined by user",hint:"Message returned when the user declines"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Custom Actions"}),s.jsxs(Q,{variant:"secondary",size:"sm",type:"button",onClick:()=>m({...u,customActions:[...u.customActions,{key:"",value:""}]}),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Action"]})]}),u.customActions.map((L,G)=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(re,{placeholder:"Action key",value:L.key,onChange:ve=>{const me=[...u.customActions];me[G].key=ve.target.value,m({...u,customActions:me})},className:"flex-1"}),s.jsx(re,{placeholder:"Action description",value:L.value,onChange:ve=>{const me=[...u.customActions];me[G].value=ve.target.value,m({...u,customActions:me})},className:"flex-1"}),s.jsx(Q,{variant:"ghost",size:"sm",type:"button",onClick:()=>{m({...u,customActions:u.customActions.filter((ve,me)=>me!==G)})},children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]},G)),s.jsx("p",{className:"text-xs text-slate-500",children:"Custom actions allow you to define additional buttons/responses for the reviewer."})]})]})]})]}),l.type==="mcp"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"MCP Server Type"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:s_.map(L=>{const G=i.sourceType===L.value;return s.jsxs("button",{type:"button",onClick:()=>c({...i,sourceType:L.value}),className:`p-3 rounded-lg border text-left transition-all ${G?"border-purple-500 bg-purple-500/10":"border-slate-700 hover:border-slate-600 bg-slate-800/50"}`,children:[s.jsx("span",{className:`text-sm font-medium ${G?"text-white":"text-slate-300"}`,children:L.label}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:L.description})]},L.value)})})]}),s.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[i.sourceType==="url"&&s.jsx(re,{label:"MCP Server URL",placeholder:"https://your-workspace.databricks.net/api/2.0/mcp/...",value:i.url,onChange:L=>c({...i,url:L.target.value}),hint:"Full URL to the MCP server endpoint",required:!0}),i.sourceType==="genie"&&s.jsxs(s.Fragment,{children:[s.jsx(sr,{label:"Genie Room",resourceType:"Genie room",configuredOptions:y,configuredValue:i.genieRefName,onConfiguredChange:L=>{const G=p[L];c({...i,genieRefName:L,genieSpaceId:"",genieName:(G==null?void 0:G.name)||L,genieDescription:(G==null?void 0:G.description)||""})},source:i.genieSource,onSourceChange:L=>c({...i,genieSource:L}),children:s.jsx(Ih,{value:i.genieSpaceId,onChange:L=>c({...i,genieSpaceId:L,genieRefName:""}),required:!0})}),s.jsx(re,{label:"Display Name",placeholder:"e.g., Retail Genie",value:i.genieName,onChange:L=>c({...i,genieName:L.target.value})}),s.jsx(re,{label:"Description (optional)",placeholder:"Query retail data using natural language",value:i.genieDescription,onChange:L=>c({...i,genieDescription:L.target.value})})]}),i.sourceType==="vector_search"&&s.jsx(sr,{label:"Vector Store",resourceType:"Vector store",configuredOptions:w,configuredValue:i.vectorStoreRefName,onConfiguredChange:L=>{c({...i,vectorStoreRefName:L,vectorEndpoint:"",vectorIndex:"",vectorCatalog:"",vectorSchema:""})},source:i.vectorStoreSource,onSourceChange:L=>c({...i,vectorStoreSource:L}),children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Wo,{label:"Catalog",value:i.vectorCatalog,onChange:L=>c({...i,vectorCatalog:L,vectorSchema:"",vectorStoreRefName:""}),required:!0}),s.jsx(Go,{label:"Schema",value:i.vectorSchema,onChange:L=>c({...i,vectorSchema:L,vectorStoreRefName:""}),catalog:i.vectorCatalog||null,required:!0})]}),s.jsx(Lh,{label:"Vector Search Endpoint",value:i.vectorEndpoint,onChange:L=>c({...i,vectorEndpoint:L,vectorIndex:"",vectorStoreRefName:""}),required:!0}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Vector Index"}),i.vectorEndpoint&&s.jsxs("button",{type:"button",onClick:()=>D(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:M,children:[s.jsx(gt,{className:`w-3 h-3 ${M?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]})]}),s.jsx(le,{options:H,value:i.vectorIndex,onChange:L=>c({...i,vectorIndex:L.target.value}),disabled:!i.vectorEndpoint||M,required:!0})]})]})}),i.sourceType==="functions"&&s.jsx(sr,{label:"Schema",resourceType:"schema",configuredOptions:_,configuredValue:i.schemaRefName,onConfiguredChange:L=>{const G=x[L];c({...i,schemaRefName:L,functionsCatalog:(G==null?void 0:G.catalog_name)||"",functionsSchema:(G==null?void 0:G.schema_name)||""})},source:i.schemaSource,onSourceChange:L=>c({...i,schemaSource:L}),children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Wo,{label:"Catalog",value:i.functionsCatalog,onChange:L=>c({...i,functionsCatalog:L,functionsSchema:"",schemaRefName:""}),required:!0}),s.jsx(Go,{label:"Schema",value:i.functionsSchema,onChange:L=>c({...i,functionsSchema:L,schemaRefName:""}),catalog:i.functionsCatalog||null,required:!0})]})}),i.sourceType==="sql"&&s.jsxs("div",{className:"p-3 bg-slate-900/50 rounded-lg",children:[s.jsxs("p",{className:"text-sm text-slate-300",children:[s.jsx("strong",{children:"Databricks SQL MCP"})," - Enables serverless SQL execution without requiring a warehouse."]}),s.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"The sql: true flag will be set automatically."})]}),i.sourceType==="connection"&&s.jsx(sr,{label:"UC Connection",resourceType:"connection",configuredOptions:N,configuredValue:i.connectionRefName,onConfiguredChange:L=>{const G=g[L];c({...i,connectionRefName:L,connectionName:(G==null?void 0:G.name)||""})},source:i.connectionSource,onSourceChange:L=>c({...i,connectionSource:L}),children:s.jsx(Rw,{label:"Select Connection",value:i.connectionName,onChange:L=>c({...i,connectionName:L,connectionRefName:""}),required:!0})})]}),s.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-700 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Authentication"}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:i.useCredentials,onChange:L=>c({...i,useCredentials:L.target.checked}),className:"rounded border-slate-600 bg-slate-800 text-blue-500 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Use credentials"})]})]}),i.useCredentials&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:()=>c({...i,credentialsMode:"service_principal"}),className:`px-3 py-1.5 text-xs rounded-lg font-medium transition-colors ${i.credentialsMode==="service_principal"?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:"Configured Service Principal"}),s.jsx("button",{type:"button",onClick:()=>c({...i,credentialsMode:"manual"}),className:`px-3 py-1.5 text-xs rounded-lg font-medium transition-colors ${i.credentialsMode==="manual"?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:"Manual Credentials"})]}),i.credentialsMode==="service_principal"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{label:"Service Principal",options:[{value:"",label:"Select a service principal..."},...Object.keys(e.service_principals||{}).map(L=>({value:L,label:L}))],value:i.servicePrincipalRef,onChange:L=>c({...i,servicePrincipalRef:L.target.value}),hint:"Reference a pre-configured service principal"}),Object.keys(e.service_principals||{}).length===0&&s.jsx("div",{className:"p-2 bg-amber-500/10 border border-amber-500/30 rounded text-amber-400 text-xs",children:"No service principals configured. Add one in Resources  Service Principals first."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client ID"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>c({...i,clientIdSource:"variable"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.clientIdSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>c({...i,clientIdSource:"manual"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.clientIdSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),i.clientIdSource==="variable"?s.jsx(le,{options:[{value:"",label:"Select a variable..."},...C.map(L=>({value:L,label:`${L} (${X(A[L])})`}))],value:i.clientIdVar,onChange:L=>c({...i,clientIdVar:L.target.value}),hint:C.length===0?"Define variables in the Variables section first":void 0}):s.jsx(re,{placeholder:"Enter client ID...",value:i.clientIdManual,onChange:L=>c({...i,clientIdManual:L.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Client Secret"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>c({...i,clientSecretSource:"variable"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.clientSecretSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>c({...i,clientSecretSource:"manual"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.clientSecretSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),i.clientSecretSource==="variable"?s.jsx(le,{options:[{value:"",label:"Select a variable..."},...C.map(L=>({value:L,label:`${L} (${X(A[L])})`}))],value:i.clientSecretVar,onChange:L=>c({...i,clientSecretVar:L.target.value}),hint:C.length===0?"Define variables in the Variables section first":void 0}):s.jsx(re,{type:"password",placeholder:"Enter client secret...",value:i.clientSecretManual,onChange:L=>c({...i,clientSecretManual:L.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("label",{className:"text-sm font-medium text-slate-300",children:["Workspace Host ",s.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>c({...i,workspaceHostSource:"variable"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.workspaceHostSource==="variable"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Variable"}),s.jsx("button",{type:"button",onClick:()=>c({...i,workspaceHostSource:"manual"}),className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${i.workspaceHostSource==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]})]}),i.workspaceHostSource==="variable"?s.jsx(le,{options:[{value:"",label:"Select a variable..."},...C.map(L=>({value:L,label:`${L} (${X(A[L])})`}))],value:i.workspaceHostVar,onChange:L=>c({...i,workspaceHostVar:L.target.value}),hint:C.length===0?"Define variables in the Variables section first":void 0}):s.jsx(re,{placeholder:"https://your-workspace.cloud.databricks.com",value:i.workspaceHostManual,onChange:L=>c({...i,workspaceHostManual:L.target.value})})]})]})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{a(!1),J()},children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:!l.name||l.type==="mcp"&&i.sourceType==="connection"&&!(i.connectionSource==="configured"&&i.connectionRefName||i.connectionSource==="select"&&i.connectionName),children:"Add Tool"})]})]})})]})}async function a_(e){const t=await fetch("/api/ai/generate-guardrail-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate guardrail prompt")}return(await t.json()).prompt}const nu=[{value:"accuracy",label:"Accuracy"},{value:"completeness",label:"Completeness"},{value:"clarity",label:"Clarity"},{value:"helpfulness",label:"Helpfulness"},{value:"safety",label:"Safety"},{value:"relevance",label:"Relevance"},{value:"tone",label:"Professional Tone"},{value:"no_hallucination",label:"No Hallucination"},{value:"pii_protection",label:"PII Protection"},{value:"bias_free",label:"Bias-Free"}],su=`You are an expert judge evaluating AI responses. Your task is to critique the AI assistant's latest response in the conversation below.

Evaluate the response based on these criteria:
1. Accuracy - Is the information correct and factual?
2. Completeness - Does it fully address the user's query?
3. Clarity - Is the explanation clear and well-structured?
4. Helpfulness - Does it provide actionable and useful information?
5. Safety - Does it avoid harmful or inappropriate content?

If the response meets ALL criteria satisfactorily, set pass to True.

If you find ANY issues with the response, do NOT set pass to True. Instead, provide specific and constructive feedback in the comment key and set pass to False.

### Inputs:
{inputs}

### Response:
{outputs}`;function l_(){var S;const{config:e,addGuardrail:t,removeGuardrail:n}=Oe(),[r,a]=R.useState(!1),[l,o]=R.useState({name:"",modelKey:"",prompt:su,numRetries:"3"}),[i,c]=R.useState(!1),[u,m]=R.useState(""),[d,f]=R.useState(!1),[p,v]=R.useState(["accuracy","completeness","clarity","helpfulness","safety"]),[b,x]=R.useState(""),h=async(N=!1)=>{c(!0);try{const k=await a_({context:u||void 0,guardrail_name:l.name||void 0,evaluation_criteria:p.length>0?p:void 0,existing_prompt:N?l.prompt:void 0});o({...l,prompt:k}),f(!1),m("")}catch(k){console.error("Failed to generate guardrail prompt:",k),alert(k instanceof Error?k.message:"Failed to generate guardrail prompt")}finally{c(!1)}},g=()=>{b&&!p.includes(b)&&(v([...p,b]),x(""))},y=e.guardrails||{},w=((S=e.resources)==null?void 0:S.llms)||{},E=Object.entries(w).map(([N,k])=>({value:N,label:`${N} (${k.name})`})),_=N=>{N.preventDefault(),l.name&&l.modelKey&&w[l.modelKey]&&(t({name:l.name,model:w[l.modelKey],prompt:l.prompt,num_retries:parseInt(l.numRetries)}),o({name:"",modelKey:"",prompt:su,numRetries:"3"}),a(!1))};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Guardrails"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure safety checks and quality controls for agent responses"})]}),s.jsxs(Q,{onClick:()=>a(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Guardrail"]})]}),Object.keys(y).length===0?s.jsxs(ye,{className:"text-center py-12",children:[s.jsx(Xs,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No guardrails configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Guardrails help ensure agent responses are safe, accurate, and helpful."}),s.jsxs(Q,{onClick:()=>a(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Guardrail"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(y).map(([N,k])=>s.jsx(ye,{variant:"interactive",className:"group",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center flex-shrink-0",children:s.jsx(Xs,{className:"w-5 h-5 text-emerald-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-white",children:k.name}),s.jsxs("p",{className:"text-sm text-slate-400",children:["Model: ",k.model.name]}),s.jsxs("p",{className:"text-xs text-slate-500 mt-2 line-clamp-2 font-mono",children:[k.prompt.substring(0,100),"..."]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs(we,{variant:"success",children:["retries: ",k.num_retries??3]}),s.jsx(Q,{variant:"danger",size:"sm",onClick:()=>n(N),children:s.jsx(Ge,{className:"w-4 h-4"})})]})]})},N))}),s.jsx(En,{isOpen:r,onClose:()=>a(!1),title:"Add Guardrail",description:"Configure a safety check for agent responses",size:"lg",children:s.jsxs("form",{onSubmit:_,className:"space-y-4",children:[E.length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 text-amber-400 text-sm",children:"You need to add an LLM first before creating a guardrail."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Guardrail Name",placeholder:"e.g., llm_judge_guardrail",value:l.name,onChange:N=>o({...l,name:N.target.value}),required:!0}),s.jsx(le,{label:"Judge LLM",options:E,value:l.modelKey,onChange:N=>o({...l,modelKey:N.target.value}),placeholder:"Select an LLM...",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Evaluation Prompt"})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>f(!d),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:i,children:[s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),l.prompt&&l.prompt!==su&&s.jsxs("button",{type:"button",onClick:()=>h(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:i,children:[i?s.jsx(dt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),d&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Guardrail Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"Describe what this guardrail should evaluate and I'll generate an optimized evaluation prompt."}),s.jsx(An,{value:u,onChange:N=>m(N.target.value),rows:2,placeholder:"e.g., This guardrail should check that responses don't contain harmful content and are factually accurate for a retail customer service agent..."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Evaluation Criteria"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Select what aspects the guardrail should evaluate"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:nu.map(N=>s.jsx("button",{type:"button",onClick:()=>{p.includes(N.value)?v(p.filter(k=>k!==N.value)):v([...p,N.value])},className:`px-2 py-1 text-xs rounded-md transition-all ${p.includes(N.value)?"bg-emerald-500/30 text-emerald-300 border border-emerald-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:N.label},N.value))}),p.filter(N=>!nu.map(k=>k.value).includes(N)).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:p.filter(N=>!nu.map(k=>k.value).includes(N)).map(N=>s.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-500/30 text-blue-300 border border-blue-500/50 flex items-center space-x-1",children:[s.jsx("span",{children:N}),s.jsx("button",{type:"button",onClick:()=>v(p.filter(k=>k!==N)),className:"hover:text-red-300",children:""})]},N))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:b,onChange:N=>x(N.target.value.replace(/[^a-z0-9_\s]/gi,"").toLowerCase()),placeholder:"Add custom criterion...",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-700 rounded-md text-slate-300 placeholder-slate-500 focus:border-purple-500 focus:outline-none",onKeyDown:N=>{N.key==="Enter"&&(N.preventDefault(),g())}}),s.jsx("button",{type:"button",onClick:g,disabled:!b,className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded-md hover:bg-slate-600 disabled:opacity-50",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:()=>{f(!1),m("")},disabled:i,children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>h(!1),disabled:i||p.length===0&&!u,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:i?s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(rt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(An,{value:l.prompt,onChange:N=>o({...l,prompt:N.target.value}),rows:12,hint:"Use {inputs} and {outputs} placeholders for conversation context",required:!0})]}),s.jsx(re,{label:"Number of Retries",type:"number",min:"0",max:"10",value:l.numRetries,onChange:N=>o({...l,numRetries:N.target.value}),hint:"How many times to retry if evaluation fails"}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>a(!1),children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:E.length===0,children:"Add Guardrail"})]})]})})]})}const Hh=[{value:"memory",label:"In-Memory"},{value:"postgres",label:"Lakebase/PostgreSQL"}];function o_(){var F,j,T,I,$,P,M,D,V,B,K,J,ae;const{config:e,updateMemory:t}=Oe(),n=e.memory,r=((F=e.resources)==null?void 0:F.databases)||{},[a,l]=R.useState(!!(n!=null&&n.checkpointer)),[o,i]=R.useState(!!(n!=null&&n.store)),[c,u]=R.useState(((j=n==null?void 0:n.checkpointer)==null?void 0:j.type)||"memory"),[m,d]=R.useState(((T=n==null?void 0:n.checkpointer)==null?void 0:T.name)||"default_checkpointer"),[f,p]=R.useState((($=(I=n==null?void 0:n.checkpointer)==null?void 0:I.database)==null?void 0:$.name)||""),[v,b]=R.useState(((P=n==null?void 0:n.store)==null?void 0:P.type)||"memory"),[x,h]=R.useState(((M=n==null?void 0:n.store)==null?void 0:M.name)||"default_store"),[g,y]=R.useState(((V=(D=n==null?void 0:n.store)==null?void 0:D.database)==null?void 0:V.name)||""),[w,E]=R.useState(((B=n==null?void 0:n.store)==null?void 0:B.dims)||1536),[_,S]=R.useState(((K=n==null?void 0:n.store)==null?void 0:K.namespace)||"{user_id}"),[N,k]=R.useState(((ae=(J=n==null?void 0:n.store)==null?void 0:J.embedding_model)==null?void 0:ae.name)||"databricks-gte-large-en");R.useEffect(()=>{var U,Y,W;n!=null&&n.checkpointer&&(l(!0),u(n.checkpointer.type||"memory"),d(n.checkpointer.name||"default_checkpointer"),p(((U=n.checkpointer.database)==null?void 0:U.name)||"")),n!=null&&n.store&&(i(!0),b(n.store.type||"memory"),h(n.store.name||"default_store"),y(((Y=n.store.database)==null?void 0:Y.name)||""),E(n.store.dims||1536),S(n.store.namespace||"{user_id}"),k(((W=n.store.embedding_model)==null?void 0:W.name)||"databricks-gte-large-en"))},[n]);const A=()=>{const U={};if(a){const Y={name:m,type:c};if(c==="postgres"&&f){const W=r[f];W&&(Y.database=W)}U.checkpointer=Y}if(o){const Y={name:x,type:v};if(N&&(Y.embedding_model={name:N,on_behalf_of_user:!1}),Y.dims=w,_&&(Y.namespace=_),v==="postgres"&&g){const W=r[g];W&&(Y.database=W)}U.store=Y}return a||o?U:void 0},C=()=>{t(A())},O=Object.keys(r);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Memory Configuration"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure conversation persistence and long-term memory storage"})]}),s.jsx(Q,{onClick:C,children:"Save Memory Config"})]}),s.jsx(ye,{className:"p-4 bg-blue-900/20 border-blue-500/30",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(oc,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-300",children:[s.jsx("p",{className:"font-medium",children:"Memory Components"}),s.jsxs("ul",{className:"mt-2 space-y-1 text-blue-400/80",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Checkpointer"}),": Saves conversation state for resumable sessions"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Store"}),": Long-term semantic memory with embeddings for context"]})]}),s.jsx("p",{className:"font-medium mt-3",children:"Storage Options"}),s.jsxs("ul",{className:"mt-2 space-y-1 text-blue-400/80",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"In-Memory"}),": No database required. Fast but data lost on restart. Best for development."]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Lakebase/PostgreSQL"}),": Requires database backend. Persistent storage. Best for production."]})]}),O.length===0&&s.jsxs("p",{className:"mt-3 text-amber-400",children:[" No databases configured. Add a database in the ",s.jsx("strong",{children:"Resources  Databases"})," section to use persistent storage."]})]})]})}),s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Lg,{className:"w-5 h-5 text-purple-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Checkpointer"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:a,onChange:U=>l(U.target.checked),className:"rounded border-slate-600 bg-slate-800 text-purple-500 focus:ring-purple-500"}),s.jsx("span",{className:"text-sm text-slate-300",children:"Enable"})]})]}),a&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-400",children:"Saves conversation state between messages for resumable sessions and multi-turn conversations."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Name",value:m,onChange:U=>d(U.target.value),placeholder:"default_checkpointer"}),s.jsx(le,{label:"Storage Type",value:c,onChange:U=>u(U.target.value),options:Hh})]}),c==="memory"&&s.jsx("div",{className:"p-3 bg-amber-900/20 border border-amber-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-amber-300",children:[s.jsx("strong",{children:"In-Memory Storage:"})," Conversation state will be stored in memory only. Data is lost when the agent restarts. Ideal for development and testing."]})}),c==="postgres"&&s.jsxs(s.Fragment,{children:[s.jsx(le,{label:"Database",value:f,onChange:U=>p(U.target.value),options:[{value:"",label:"Select a database..."},...O.map(U=>({value:U,label:U}))],hint:O.length===0?"Add a database in Resources  Databases":void 0}),s.jsx("div",{className:"p-3 bg-emerald-900/20 border border-emerald-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-emerald-300",children:[s.jsx("strong",{children:"Persistent Storage:"})," Conversation state will be stored in Lakebase/PostgreSQL. Data persists across agent restarts. Recommended for production."]})})]})]})]}),s.jsxs(ye,{className:"p-5",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Qt,{className:"w-5 h-5 text-cyan-400"}),s.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Long-Term Memory Store"})]}),s.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:o,onChange:U=>i(U.target.checked),className:"rounded border-slate-600 bg-slate-800 text-cyan-500 focus:ring-cyan-500"}),s.jsx("span",{className:"text-sm text-slate-300",children:"Enable"})]})]}),o&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-slate-400",children:"Semantic memory storage with embeddings for persistent context across sessions."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Name",value:x,onChange:U=>h(U.target.value),placeholder:"default_store"}),s.jsx(le,{label:"Storage Type",value:v,onChange:U=>b(U.target.value),options:Hh})]}),v==="memory"&&s.jsx("div",{className:"p-3 bg-amber-900/20 border border-amber-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-amber-300",children:[s.jsx("strong",{children:"In-Memory Storage:"})," Long-term memories will be stored in memory only. Data is lost when the agent restarts. Useful for development and testing."]})}),v==="postgres"&&s.jsxs(s.Fragment,{children:[s.jsx(le,{label:"Database",value:g,onChange:U=>y(U.target.value),options:[{value:"",label:"Select a database..."},...O.map(U=>({value:U,label:U}))],hint:O.length===0?"Add a database in Resources  Databases":void 0}),s.jsx("div",{className:"p-3 bg-emerald-900/20 border border-emerald-500/30 rounded-lg",children:s.jsxs("p",{className:"text-sm text-emerald-300",children:[s.jsx("strong",{children:"Persistent Storage:"})," Long-term memories will be stored in Lakebase/PostgreSQL with vector search. Data persists across agent restarts. Recommended for production."]})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Embedding Model",value:N,onChange:U=>k(U.target.value),placeholder:"databricks-gte-large-en",hint:"Databricks serving endpoint for embeddings"}),s.jsx(re,{label:"Embedding Dimensions",type:"number",value:w,onChange:U=>E(parseInt(U.target.value)||1536),hint:"Usually 1536 for GTE-Large"})]}),s.jsx(re,{label:"Namespace Template",value:_,onChange:U=>S(U.target.value),placeholder:"{user_id}",hint:"Template for partitioning memories. Use {user_id}, {thread_id}, etc."})]})]})]})}async function i_(e){const t=await fetch("/api/ai/generate-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate prompt")}return(await t.json()).prompt}const ru=[{value:"user_id",label:"User ID"},{value:"store_num",label:"Store Number"},{value:"session_id",label:"Session ID"},{value:"context",label:"Context"},{value:"current_date",label:"Current Date"},{value:"user_name",label:"User Name"},{value:"location",label:"Location"}],au=`### User Information
- **User Id**: {user_id}
- **Store Number**: {store_num}

You are a helpful assistant. Your role is to provide accurate and useful information.

#### Response Guidelines
- Be clear and concise
- Provide helpful examples when appropriate
- Always prioritize user safety
`;function Uh(e){return e.toLowerCase().trim().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")}function c_(){const{config:e,addPrompt:t,updatePrompt:n,removePrompt:r}=Oe(),[a,l]=R.useState(!1),[o,i]=R.useState(null),[c,u]=R.useState("new"),[m,d]=R.useState("reference"),[f,p]=R.useState(!1),[v,b]=R.useState("none"),[x,h]=R.useState(""),[g,y]=R.useState(""),[w,E]=R.useState(""),[_,S]=R.useState({refName:"",name:"",description:"",default_template:au,alias:"",version:"",schemaRef:"",catalog_name:"",schema_name:"",tags:{},existingPromptFullName:""}),[N,k]=R.useState(""),[A,C]=R.useState(""),[O,F]=R.useState(!1),[j,T]=R.useState(!1),[I,$]=R.useState(""),[P,M]=R.useState(!1),[D,V]=R.useState(["user_id","store_num"]),[B,K]=R.useState(""),J=async(q=!1)=>{T(!0);try{const te=await i_({context:I||void 0,agent_name:_.name||void 0,agent_description:_.description||void 0,existing_prompt:q?_.default_template:void 0,template_parameters:D.length>0?D:void 0});S({..._,default_template:te}),M(!1),$("")}catch(te){console.error("Failed to generate prompt:",te),alert(te instanceof Error?te.message:"Failed to generate prompt")}finally{T(!1)}},ae=()=>{B&&!D.includes(B)&&(V([...D,B]),K(""))},U=e.prompts||{},Y=e.schemas||{},W=e.service_principals||{},ie=e.variables||{},{data:H}=Rr(),{data:X,loading:Z}=Kn(_.catalog_name||null),oe=R.useMemo(()=>{const q=te=>{if(typeof te!="string"||!te.startsWith("*"))return te;const z=te.slice(1),ee=ie[z];return ee||te};if(v==="configured"&&x&&W[x]){const te=W[x];return{client_id:q(te.client_id),client_secret:q(te.client_secret)}}return v==="manual"&&g&&w?{client_id:g,client_secret:w}:null},[v,x,W,ie,g,w]),{data:fe,loading:ge,refetch:L}=Aw(_.catalog_name||null,_.schema_name||null,oe),{data:G,loading:ve}=Pw(_.existingPromptFullName||null,oe),[me,je]=R.useState(null),ot=["latest","champion","default"],Bt=R.useMemo(()=>{const q=(G==null?void 0:G.aliases)||[],te=[...new Set([...ot,...q])];return[{value:"",label:"Select an alias..."},...te.map(z=>({value:z,label:z==="latest"?"latest (most recent version)":z==="champion"?"champion (production)":z==="default"?"default":q.includes(z)?z:`${z} (may not exist)`}))]},[G==null?void 0:G.aliases]),nn=R.useMemo(()=>{const q=G!=null&&G.latest_version?parseInt(G.latest_version):0,te=(G==null?void 0:G.versions)||[];if(te.length>0)return[{value:"",label:"Select a version..."},...te.map(z=>({value:z.version,label:`v${z.version}${z.aliases&&z.aliases.length>0?` (${z.aliases.join(", ")})`:""}`}))];if(q>0){const z=[];for(let ee=q;ee>=1;ee--)z.push({value:String(ee),label:`v${ee}${ee===q?" (latest)":""}`});return[{value:"",label:"Select a version..."},...z]}return[{value:"",label:"No versions available"}]},[G==null?void 0:G.versions,G==null?void 0:G.latest_version]);R.useEffect(()=>{if(!_.existingPromptFullName)return;const q=G==null?void 0:G.latest_version;(async()=>{F(!0),je(null);try{let z=_.version||void 0,ee;!z&&!_.alias&&q?z=q:_.alias&&!z&&(ee=_.alias);const ne=await bt.getPromptTemplate(_.existingPromptFullName,z,ee,oe);ne!=null&&ne.error?ne.alias_not_found?je(`Alias '${_.alias}' does not exist for this prompt. Try 'latest' or select a specific version.`):ne.version_not_found?je(`Version ${_.version} does not exist for this prompt.`):je(ne.error):ne!=null&&ne.template?S(ce=>({...ce,default_template:ne.template,version:ne.version||ce.version||""})):je("No template returned from server")}catch(z){const ee=z instanceof Error?z.message:"Failed to load prompt template";je(ee),console.error("[PromptsSection] Error loading prompt template:",z)}finally{F(!1)}})()},[_.existingPromptFullName,_.version,_.alias]),R.useEffect(()=>{G&&_.existingPromptFullName&&S(q=>({...q,tags:G.tags||{},description:G.description||q.description,version:q.version||"",default_template:G.template||q.default_template}))},[G,_.existingPromptFullName]);const Tt=()=>{S({refName:"",name:"",description:"",default_template:au,alias:"",version:"",schemaRef:"",catalog_name:"",schema_name:"",tags:{},existingPromptFullName:""}),u("new"),d("reference"),k(""),C(""),i(null),p(!1)},sn=q=>{const te=Y[q];te&&S({..._,schemaRef:q,catalog_name:te.catalog_name,schema_name:te.schema_name,existingPromptFullName:"",name:"",refName:""})},Ot=q=>{const te=fe==null?void 0:fe.find(z=>z.full_name===q);if(te){const z=f?_.refName:Uh(te.name);S({..._,existingPromptFullName:q,name:te.name,refName:z,description:te.description||"",alias:"",version:te.latest_version||"",tags:te.tags||{}})}},Yt=q=>{var pe;const te=U[q];let z="",ee="",ne="",ce="direct";if(te.schema){const _e=Object.entries(Y).find(([,Le])=>{var Re,it;return Le.catalog_name===((Re=te.schema)==null?void 0:Re.catalog_name)&&Le.schema_name===((it=te.schema)==null?void 0:it.schema_name)});_e?(z=_e[0],ce="reference"):(ee=te.schema.catalog_name||"",ne=te.schema.schema_name||"",ce="direct")}if(te.service_principal&&typeof te.service_principal=="string"){const _e=te.service_principal.startsWith("*")?te.service_principal.slice(1):te.service_principal;h(_e)}u("new"),d(ce),p(!0),S({refName:q,name:te.name,description:te.description||"",default_template:te.default_template||"",alias:te.alias||"",version:((pe=te.version)==null?void 0:pe.toString())||"",schemaRef:z,catalog_name:ee,schema_name:ne,tags:te.tags||{},existingPromptFullName:""}),i(q),l(!0)},On=q=>{if(q.preventDefault(),!_.refName||!_.name)return;let te;m==="reference"&&_.schemaRef&&Y[_.schemaRef]?te=Y[_.schemaRef]:_.catalog_name&&_.schema_name&&(te={catalog_name:_.catalog_name,schema_name:_.schema_name});const z={name:_.name,schema:te,description:_.description||void 0,default_template:_.default_template||void 0,alias:_.alias||void 0,version:_.version?parseInt(_.version):void 0,tags:Object.keys(_.tags).length>0?_.tags:void 0,service_principal:v==="configured"&&x?`*${x}`:v==="manual"&&g&&w?{client_id:g,client_secret:w}:void 0};o?(o!==_.refName&&r(o),n(_.refName,z)):t(_.refName,z),Tt(),l(!1)},rs=()=>{N&&A&&(S({..._,tags:{..._.tags,[N]:A}}),k(""),C(""))},hn=q=>{const te={..._.tags};delete te[q],S({..._,tags:te})},as=Object.keys(W).length>0;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Prompts"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure reusable prompts for agents with MLflow Prompt Registry integration"})]}),s.jsxs(Q,{onClick:()=>{Tt(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Prompt"]})]}),s.jsxs(ye,{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-white mb-1",children:"Prompt Registry Authentication"}),s.jsx("p",{className:"text-xs text-slate-400",children:"Service principal used for all prompt registry operations (browsing, fetching templates)"})]}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>{b("none"),h("")},className:`px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${v==="none"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Default"}),s.jsx("button",{type:"button",onClick:()=>b("configured"),className:`px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${v==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>b("manual"),className:`px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${v==="manual"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Manual"})]}),v==="configured"&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("select",{value:x,onChange:q=>h(q.target.value),className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white focus:outline-none focus:ring-2 focus:ring-violet-500",children:[s.jsx("option",{value:"",children:"Select a service principal..."}),Object.keys(W).map(q=>s.jsx("option",{value:q,children:q},q))]}),!as&&s.jsx("p",{className:"text-xs text-amber-400/70",children:"No service principals configured. Add them in Resources  Service Principals."})]}),v==="manual"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Client ID"}),s.jsx("input",{type:"text",value:g,onChange:q=>y(q.target.value),placeholder:"Enter client ID...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-violet-500"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Client Secret"}),s.jsx("input",{type:"password",value:w,onChange:q=>E(q.target.value),placeholder:"Enter client secret...",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-violet-500"})]})]}),v!=="none"&&oe&&s.jsx("p",{className:"text-xs text-emerald-400",children:" Custom authentication configured"})]}),Object.keys(U).length===0?s.jsxs(ye,{className:"text-center py-12",children:[s.jsx(ga,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No prompts configured"}),s.jsx("p",{className:"text-slate-500 mb-4 max-w-md mx-auto",children:'Prompts define agent behavior and can be version-controlled through MLflow Prompt Registry. Use aliases like "production" or "staging" for environment management.'}),s.jsxs(Q,{onClick:()=>{Tt(),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Prompt"]})]}):s.jsx("div",{className:"grid gap-4",children:Object.entries(U).map(([q,te])=>s.jsx(ye,{variant:"interactive",className:"group",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-violet-500/20 flex items-center justify-center flex-shrink-0",children:s.jsx(ga,{className:"w-5 h-5 text-violet-400"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h3",{className:"font-medium text-white",children:q}),te.alias&&s.jsxs(we,{variant:"info",children:[s.jsx(Wl,{className:"w-3 h-3 mr-1"}),"@",te.alias]}),te.version&&s.jsxs(we,{variant:"default",children:[s.jsx($g,{className:"w-3 h-3 mr-1"}),"v",te.version]})]}),s.jsx("p",{className:"text-sm text-slate-400 mt-1",children:te.schema?`${te.schema.catalog_name}.${te.schema.schema_name}.${te.name}`:te.name}),te.description&&s.jsx("p",{className:"text-xs text-slate-500 mt-1 line-clamp-2",children:te.description}),te.tags&&Object.keys(te.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:Object.entries(te.tags).map(([z,ee])=>s.jsxs("span",{className:"px-2 py-0.5 bg-slate-700/50 rounded text-xs text-slate-400",children:[s.jsx(vd,{className:"w-3 h-3 inline mr-1"}),z,": ",ee]},z))})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>Yt(q),children:s.jsx(tn,{className:"w-4 h-4"})}),s.jsx(Q,{variant:"danger",size:"sm",onClick:()=>r(q),children:s.jsx(Ge,{className:"w-4 h-4"})})]})]})},q))}),s.jsx(En,{isOpen:a,onClose:()=>{Tt(),l(!1)},title:o?"Edit Prompt":"Add Prompt",description:"Configure a reusable prompt for agents",size:"xl",children:s.jsxs("form",{onSubmit:On,className:"space-y-4",children:[!o&&s.jsxs("div",{className:"flex items-center justify-center space-x-4 p-3 bg-slate-800/50 rounded-lg",children:[s.jsxs("button",{type:"button",onClick:()=>{u("new"),S({..._,existingPromptFullName:""})},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${c==="new"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:[s.jsx(Pe,{className:"w-4 h-4"}),s.jsx("span",{children:"New Prompt"})]}),s.jsxs("button",{type:"button",onClick:()=>{u("existing")},className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors ${c==="existing"?"bg-blue-500/30 text-blue-300 border border-blue-500/50":"bg-slate-700/50 text-slate-400 hover:bg-slate-700"}`,children:[s.jsx(Ig,{className:"w-4 h-4"}),s.jsx("span",{children:"Existing Prompt"})]})]}),c==="existing"&&!o&&s.jsxs("div",{className:"space-y-4 p-4 bg-slate-800/30 rounded-lg border border-slate-700",children:[s.jsx("h4",{className:"text-sm font-medium text-slate-300",children:"Select Existing Prompt from MLflow Registry"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema"}),s.jsx("div",{className:"flex space-x-2",children:s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{d("reference"),p(!1),S({..._,catalog_name:"",schema_name:"",existingPromptFullName:"",name:"",refName:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{d("direct"),p(!1),S({..._,schemaRef:"",existingPromptFullName:"",name:"",refName:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]})}),m==="reference"?s.jsx(le,{label:"Schema Reference",value:_.schemaRef,onChange:q=>sn(q.target.value),options:[{value:"",label:"Select a configured schema..."},...Object.entries(Y).map(([q,te])=>({value:q,label:`${q} (${te.catalog_name}.${te.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:_.catalog_name,onChange:q=>S({..._,catalog_name:q.target.value,schema_name:"",existingPromptFullName:"",name:"",refName:""}),options:[{value:"",label:"Select catalog..."},...(H||[]).map(q=>({value:q.name,label:q.name}))]}),s.jsx(le,{label:"Schema",value:_.schema_name,onChange:q=>S({..._,schema_name:q.target.value,existingPromptFullName:"",name:"",refName:""}),options:[{value:"",label:Z?"Loading...":"Select schema..."},...(X||[]).map(q=>({value:q.name,label:q.name}))],disabled:!_.catalog_name||Z})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Available Prompts"}),_.catalog_name&&_.schema_name||_.schemaRef?s.jsxs("button",{type:"button",onClick:()=>L(),className:"text-xs text-slate-400 hover:text-white flex items-center space-x-1",disabled:ge,children:[s.jsx(gt,{className:`w-3 h-3 ${ge?"animate-spin":""}`}),s.jsx("span",{children:"Refresh"})]}):null]}),s.jsx(le,{value:_.existingPromptFullName,onChange:q=>Ot(q.target.value),options:[{value:"",label:ge?"Loading prompts...":"Select a prompt..."},...(fe||[]).map(q=>({value:q.full_name,label:`${q.name}${q.description?` - ${q.description.substring(0,50)}${q.description.length>50?"...":""}`:""}`}))],disabled:(!_.catalog_name||!_.schema_name)&&!_.schemaRef||ge}),(_.catalog_name&&_.schema_name||_.schemaRef)&&!ge&&(!fe||fe.length===0)&&s.jsx("p",{className:"text-xs text-amber-400",children:"No prompts found in this schema. Try selecting a different schema or create a new prompt."})]}),_.existingPromptFullName&&s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-sm font-medium text-slate-300",children:"Version & Alias"}),(ve||O)&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[s.jsx(gt,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:O?"Loading template...":"Loading details..."})]})]}),me&&s.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:s.jsx("p",{className:"text-xs text-red-400",children:me})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Alias",value:_.alias,onChange:q=>{je(null),S({..._,alias:q.target.value,version:""})},options:Bt,hint:"latest, champion, default, or custom alias"}),s.jsx(le,{label:"Version",value:_.version,onChange:q=>{je(null),S({..._,version:q.target.value,alias:""})},options:nn,hint:"Pin to a specific version number"})]}),(_.alias||_.version)&&!me&&!O&&s.jsxs("p",{className:"text-xs text-emerald-400",children:[" Using ",_.alias?`alias: ${_.alias}`:`version: v${_.version}`]})]})]}),s.jsx(re,{label:"Reference Name",placeholder:"e.g., general_prompt",value:_.refName,onChange:q=>{S({..._,refName:q.target.value}),p(!0)},hint:o?"Changing this will update all references in the YAML":"Unique key to reference this prompt in agents (use &anchor)",required:!0}),s.jsx(re,{label:"Prompt Name",placeholder:"e.g., general_prompt",value:_.name,onChange:q=>{const te=q.target.value;S({..._,name:te,refName:!o&&!f?Uh(te):_.refName})},hint:"The prompt name in MLflow Prompt Registry",required:!0,disabled:c==="existing"&&!!_.existingPromptFullName}),s.jsx(re,{label:"Description",placeholder:"e.g., General retail store assistant prompt",value:_.description,onChange:q=>S({..._,description:q.target.value}),hint:"Used as commit message when syncing to MLflow registry"}),c==="new"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Schema (Optional)"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 w-full",children:[s.jsx("button",{type:"button",onClick:()=>{d("reference"),S({..._,catalog_name:"",schema_name:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="reference"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"}),s.jsx("button",{type:"button",onClick:()=>{d("direct"),S({..._,schemaRef:""})},className:`flex-1 px-3 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${m==="direct"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Select"})]}),m==="reference"?s.jsx(le,{label:"Schema Reference",value:_.schemaRef,onChange:q=>S({..._,schemaRef:q.target.value}),options:[{value:"",label:"Select a configured schema..."},...Object.entries(Y).map(([q,te])=>({value:q,label:`${q} (${te.catalog_name}.${te.schema_name})`}))],hint:"Reference a schema defined in the Schemas section"}):s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Catalog",value:_.catalog_name,onChange:q=>S({..._,catalog_name:q.target.value,schema_name:""}),options:[{value:"",label:"Select catalog..."},...(H||[]).map(q=>({value:q.name,label:q.name}))]}),s.jsx(le,{label:"Schema",value:_.schema_name,onChange:q=>S({..._,schema_name:q.target.value}),options:[{value:"",label:Z?"Loading schemas...":"Select schema..."},...(X||[]).map(q=>({value:q.name,label:q.name}))],disabled:!_.catalog_name||Z})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Associate prompt with a Unity Catalog schema for the full name (catalog.schema.prompt_name)"})]})]}),c==="new"&&s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Alias (Optional)",placeholder:"e.g., production, staging",value:_.alias,onChange:q=>S({..._,alias:q.target.value}),hint:"Reference a specific environment version"}),s.jsx(re,{label:"Version (Optional)",type:"number",min:"1",placeholder:"e.g., 1",value:_.version,onChange:q=>S({..._,version:q.target.value}),hint:"Pin to specific version number"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:c==="existing"?"Template":"Default Template"}),s.jsx("div",{className:"flex items-center space-x-2",children:O&&s.jsxs("span",{className:"text-xs text-slate-400 flex items-center space-x-1",children:[s.jsx(gt,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:"Loading template..."})]})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>M(!P),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:j,children:[s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),_.default_template&&_.default_template!==au&&s.jsxs("button",{type:"button",onClick:()=>J(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:j,children:[j?s.jsx(dt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),P&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"Describe what this prompt should do and I'll generate an optimized template for you."}),s.jsx(An,{value:I,onChange:q=>$(q.target.value),rows:3,placeholder:"e.g., This prompt is for a product specialist agent that helps customers find and compare products. It should include instructions for tool usage and customer service best practices..."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Template Parameters"}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select variables to include in the prompt (e.g., ","{user_id}",")"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:ru.map(q=>s.jsx("button",{type:"button",onClick:()=>{D.includes(q.value)?V(D.filter(te=>te!==q.value)):V([...D,q.value])},className:`px-2 py-1 text-xs rounded-md transition-all ${D.includes(q.value)?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:q.label},q.value))}),D.filter(q=>!ru.map(te=>te.value).includes(q)).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:D.filter(q=>!ru.map(te=>te.value).includes(q)).map(q=>s.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-500/30 text-blue-300 border border-blue-500/50 flex items-center space-x-1",children:[s.jsx("span",{children:q}),s.jsx("button",{type:"button",onClick:()=>V(D.filter(te=>te!==q)),className:"hover:text-red-300",children:""})]},q))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:B,onChange:q=>K(q.target.value.replace(/[^a-z0-9_]/gi,"_").toLowerCase()),placeholder:"Add custom parameter...",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-700 rounded-md text-slate-300 placeholder-slate-500 focus:border-purple-500 focus:outline-none",onKeyDown:q=>{q.key==="Enter"&&(q.preventDefault(),ae())}}),s.jsx("button",{type:"button",onClick:ae,disabled:!B,className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded-md hover:bg-slate-600 disabled:opacity-50",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:()=>{M(!1),$("")},disabled:j,children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>J(!1),disabled:j||!I&&!_.name&&!_.description,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:j?s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(rt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(An,{value:_.default_template,onChange:q=>S({..._,default_template:q.target.value}),rows:10,hint:c==="existing"?"Template loaded from MLflow registry. Changes here are local only.":"Fallback template if MLflow registry is unavailable. Use {variable_name} for substitutions."})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Tags"}),Object.keys(_.tags).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(_.tags).map(([q,te])=>s.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-slate-700/50 rounded text-sm",children:[s.jsx(vd,{className:"w-3 h-3 text-slate-400"}),s.jsxs("span",{className:"text-slate-300",children:[q,":"]}),s.jsx("span",{className:"text-slate-400",children:te}),s.jsx("button",{type:"button",onClick:()=>hn(q),className:"ml-1 text-slate-500 hover:text-red-400",children:""})]},q))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(re,{placeholder:"Key (e.g., environment)",value:N,onChange:q=>k(q.target.value),className:"flex-1"}),s.jsx(re,{placeholder:"Value (e.g., production)",value:A,onChange:q=>C(q.target.value),className:"flex-1"}),s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:rs,disabled:!N||!A,children:s.jsx(Pe,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Metadata tags for organization and filtering in MLflow"})]}),v!=="none"&&oe&&s.jsxs("div",{className:"p-3 bg-violet-500/10 border border-violet-500/20 rounded-lg",children:[s.jsx("p",{className:"text-xs text-violet-300",children:v==="configured"?s.jsxs(s.Fragment,{children:["Using service principal: ",s.jsx("span",{className:"font-medium",children:x})]}):s.jsx(s.Fragment,{children:"Using manual credentials"})}),s.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Change this in the Prompt Registry Authentication section above."})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:()=>{Tt(),l(!1)},children:"Cancel"}),s.jsxs(Q,{type:"submit",disabled:!_.refName||!_.name,children:[o?"Update":"Add"," Prompt"]})]})]})})]})}function Bh({label:e,options:t,value:n,onChange:r,placeholder:a,hint:l}){const[o,i]=R.useState(!1),c=R.useRef(null);R.useEffect(()=>{const f=p=>{c.current&&!c.current.contains(p.target)&&i(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const u=f=>{n.includes(f)?r(n.filter(p=>p!==f)):r([...n,f])},m=(f,p)=>{p.stopPropagation(),r(n.filter(v=>v!==f))},d=n.map(f=>{var p;return((p=t.find(v=>v.value===f))==null?void 0:p.label)||f});return s.jsxs("div",{className:"space-y-1.5",ref:c,children:[e&&s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:e}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{onClick:()=>i(!o),className:Te("w-full min-h-[42px] px-3 py-2 bg-slate-800/50 border rounded-lg cursor-pointer","focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500","transition-all duration-200 flex flex-wrap gap-1.5 items-center",o?"border-blue-500 ring-2 ring-blue-500/50":"border-slate-700"),children:[n.length===0?s.jsx("span",{className:"text-slate-500",children:a||"Select options..."}):d.map((f,p)=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-sm",children:[f,s.jsx(aa,{className:"w-3 h-3 cursor-pointer hover:text-blue-300",onClick:v=>m(n[p],v)})]},n[p])),s.jsx(Ns,{className:Te("w-4 h-4 text-slate-500 ml-auto transition-transform",o&&"rotate-180")})]}),o&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-slate-800 border border-slate-700 rounded-lg shadow-xl max-h-60 overflow-auto",children:t.length===0?s.jsx("div",{className:"px-3 py-2 text-sm text-slate-500",children:"No options available"}):t.map(f=>s.jsxs("div",{onClick:()=>u(f.value),className:Te("px-3 py-2 flex items-center justify-between cursor-pointer transition-colors",n.includes(f.value)?"bg-blue-500/20 text-blue-400":"text-slate-300 hover:bg-slate-700"),children:[s.jsx("span",{children:f.label}),n.includes(f.value)&&s.jsx(_i,{className:"w-4 h-4"})]},f.value))})]}),l&&s.jsx("p",{className:"text-xs text-slate-500",children:l})]})}function Yh(e,t,n){if(!e)return!1;const r=t.resources||{},a=["llms","genie_rooms","tables","volumes","functions","warehouses","connections","databases","vector_stores"];for(const f of a){const p=r[f]||{};if(e in p&&e!==n)return!0}const l=t.agents||{};if(e in l&&e!==n)return!0;const o=t.tools||{};if(e in o&&e!==n)return!0;const i=t.guardrails||{};if(e in i&&e!==n)return!0;const c=t.retrievers||{};if(e in c&&e!==n)return!0;const u=t.schemas||{};if(e in u&&e!==n)return!0;const m=t.prompts||{};if(e in m&&e!==n)return!0;const d=t.variables||{};return e in d&&e!==n}async function u_(e){const t=await fetch("/api/ai/generate-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate prompt")}return(await t.json()).prompt}async function d_(e){const t=await fetch("/api/ai/generate-handoff-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate handoff prompt")}return(await t.json()).prompt}const lu=[{value:"user_id",label:"User ID"},{value:"store_num",label:"Store Number"},{value:"session_id",label:"Session ID"},{value:"context",label:"Context"},{value:"current_date",label:"Current Date"},{value:"user_name",label:"User Name"},{value:"location",label:"Location"}];function m_(){var w;const{config:e,addAgent:t,removeAgent:n,updateAgent:r}=Oe(),[a,l]=R.useState(!1),[o,i]=R.useState(null),[c,u]=R.useState(null),m=e.agents||{},d=((w=e.resources)==null?void 0:w.llms)||{},f=e.tools||{},p=e.guardrails||{},v=e.prompts||{},b=Object.entries(d).map(([E,_])=>({value:E,label:`${E} (${_.name})`})),x=Object.entries(f).map(([E,_])=>({value:E,label:_.name})),h=Object.entries(p).map(([E,_])=>({value:E,label:_.name})),g=Object.entries(v).map(([E,_])=>({value:E,label:`${E} (${_.name})`})),y=E=>{i(E),l(!0)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Agents"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Create and configure your AI agents"})]}),s.jsxs(Q,{onClick:()=>{i(null),l(!0)},children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Agent"]})]}),Object.keys(m).length===0?s.jsxs(ye,{className:"text-center py-12",children:[s.jsx(_t,{className:"w-12 h-12 mx-auto text-slate-600 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:"No agents configured"}),s.jsx("p",{className:"text-slate-500 mb-4",children:"Agents are the AI assistants that interact with users and use tools."}),s.jsxs(Q,{onClick:()=>l(!0),children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add Your First Agent"]})]}):s.jsx("div",{className:"space-y-3",children:Object.entries(m).map(([E,_])=>{var S;return s.jsxs(ye,{className:"overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(c===E?null:E),children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-violet-500/20 flex items-center justify-center",children:s.jsx(_t,{className:"w-5 h-5 text-violet-400"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-slate-200",children:E}),s.jsxs("p",{className:"text-xs text-slate-500",children:[_.name,_.description?`  ${_.description}`:""]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(we,{variant:"info",children:typeof _.model=="object"?_.model.name:_.model}),s.jsxs(we,{variant:"default",children:[((S=_.tools)==null?void 0:S.length)||0," tools"]}),c===E?s.jsx(Yl,{className:"w-5 h-5 text-slate-400"}):s.jsx(Ns,{className:"w-5 h-5 text-slate-400"})]})]}),c===E&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700 space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"System Prompt"}),typeof _.prompt=="object"&&_.prompt!==null?s.jsxs("div",{className:"flex items-center space-x-2 bg-slate-800/50 p-3 rounded-lg",children:[s.jsx(ga,{className:"w-4 h-4 text-violet-400"}),s.jsxs("span",{className:"text-sm text-slate-300",children:["Using configured prompt: ",s.jsx("span",{className:"text-violet-400 font-medium",children:_.prompt.name})]})]}):s.jsx("pre",{className:"text-sm text-slate-300 bg-slate-800/50 p-3 rounded-lg overflow-auto max-h-40",children:_.prompt||"No prompt configured"})]}),_.handoff_prompt&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Handoff Prompt"}),s.jsx("pre",{className:"text-sm text-slate-300 bg-slate-800/50 p-3 rounded-lg overflow-auto max-h-20",children:_.handoff_prompt})]}),_.tools&&_.tools.length>0&&s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Tools"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:_.tools.map((N,k)=>s.jsx(we,{variant:"warning",children:N.name},k))})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>y(E),children:[s.jsx(tn,{className:"w-4 h-4"}),"Edit"]}),s.jsxs(Q,{variant:"danger",size:"sm",onClick:()=>n(E),children:[s.jsx(Ge,{className:"w-4 h-4"}),"Delete"]})]})]})]},E)})}),s.jsx(f_,{isOpen:a,onClose:()=>{l(!1),i(null)},editingAgent:o?m[o]:null,editingKey:o,llmOptions:b,toolOptions:x,guardrailOptions:h,promptOptions:g,llms:d,tools:f,guardrails:p,prompts:v,onAdd:t,onUpdate:r,onRemove:n})]})}function Wh(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function f_({isOpen:e,onClose:t,editingAgent:n,editingKey:r,llmOptions:a,toolOptions:l,guardrailOptions:o,promptOptions:i,llms:c,tools:u,guardrails:m,prompts:d,onAdd:f,onUpdate:p,onRemove:v}){var ae,U;const{config:b}=Oe(),[x,h]=R.useState("inline"),[g,y]=R.useState(!1),[w,E]=R.useState(!1),[_,S]=R.useState(""),[N,k]=R.useState(!1),[A,C]=R.useState(["user_id","store_num"]),[O,F]=R.useState(""),[j,T]=R.useState({refName:"",name:"",description:"",modelKey:"",promptRef:"",prompt:"You are a helpful assistant.",handoffPrompt:"",selectedTools:[],selectedGuardrails:[]}),[I,$]=R.useState(null),[P,M]=R.useState("inline"),D=async(Y=!1)=>{y(!0);try{const W=j.selectedTools.map(H=>{var X;return(X=u[H])==null?void 0:X.name}).filter(Boolean),ie=await u_({context:_||void 0,agent_name:j.name||void 0,agent_description:j.description||void 0,tools:W.length>0?W:void 0,existing_prompt:Y?j.prompt:void 0,template_parameters:A.length>0?A:void 0});T({...j,prompt:ie}),k(!1),S("")}catch(W){console.error("Failed to generate prompt:",W),alert(W instanceof Error?W.message:"Failed to generate prompt")}finally{y(!1)}},V=async(Y=!1)=>{E(!0);try{const W=Object.values(b.agents||{}).map(H=>H.name).filter(H=>H!==j.name),ie=await d_({agent_name:j.name||void 0,agent_description:j.description||void 0,system_prompt:j.prompt||void 0,existing_handoff:Y?j.handoffPrompt:void 0,other_agents:W.length>0?W:void 0});T({...j,handoffPrompt:ie})}catch(W){console.error("Failed to generate handoff prompt:",W),alert(W instanceof Error?W.message:"Failed to generate handoff prompt")}finally{E(!1)}},B=()=>{O&&!A.includes(O)&&(C([...A,O]),F(""))};R.useEffect(()=>{var Y,W,ie,H;if(e)if(n&&r){const X=((Y=Object.entries(c).find(([,me])=>{var je;return me.name===((je=n.model)==null?void 0:je.name)}))==null?void 0:Y[0])||"";let Z="inline",oe="",fe="";if(typeof n.prompt=="object"&&n.prompt!==null){const me=n.prompt,je=(W=Object.entries(d).find(([,ot])=>ot.name===me.name))==null?void 0:W[0];je&&(Z="configured",oe=je)}else fe=typeof n.prompt=="string"?n.prompt:"";const ge=((ie=n.tools)==null?void 0:ie.map(me=>{var je;return((je=Object.entries(u).find(([,ot])=>ot.name===me.name))==null?void 0:je[0])||""}).filter(Boolean))||[],L=((H=n.guardrails)==null?void 0:H.map(me=>{var je;return((je=Object.entries(m).find(([,ot])=>ot.name===me.name))==null?void 0:je[0])||""}).filter(Boolean))||[],G={refName:r,name:n.name,description:n.description||"",modelKey:X,promptRef:oe,prompt:fe,handoffPrompt:n.handoff_prompt||"",selectedTools:ge,selectedGuardrails:L},ve={refName:r,name:n.name,description:n.description||"",modelKey:X,promptRef:oe,prompt:fe,handoffPrompt:n.handoff_prompt||"",selectedTools:[...ge],selectedGuardrails:[...L]};h(Z),T(G),$(ve),M(Z)}else{const X={refName:"",name:"",description:"",modelKey:"",promptRef:"",prompt:"You are a helpful assistant.",handoffPrompt:"",selectedTools:[],selectedGuardrails:[]};h("inline"),T(X),$(null),M("inline"),k(!1),S("")}},[e,n,r,c,d,u,m]);const K=Y=>{if(Y.preventDefault(),!j.refName||!j.name||!j.modelKey||!c[j.modelKey])return;let W;x==="configured"&&j.promptRef&&d[j.promptRef]?W=d[j.promptRef]:W=j.prompt||void 0;const ie={name:j.name,description:j.description||void 0,model:c[j.modelKey],prompt:W,handoff_prompt:j.handoffPrompt||void 0,tools:j.selectedTools.map(H=>u[H]).filter(Boolean),guardrails:j.selectedGuardrails.map(H=>m[H]).filter(Boolean)};r?r!==j.refName?(v(r),f(j.refName,ie)):p(j.refName,ie):f(j.refName,ie),t()},J=R.useMemo(()=>!r||!I||j.refName!==I.refName||j.name!==I.name||j.description!==I.description||j.modelKey!==I.modelKey||j.prompt!==I.prompt||j.handoffPrompt!==I.handoffPrompt||j.promptRef!==I.promptRef||x!==P||j.selectedTools.length!==I.selectedTools.length||!j.selectedTools.every((Y,W)=>Y===I.selectedTools[W])||j.selectedGuardrails.length!==I.selectedGuardrails.length||!j.selectedGuardrails.every((Y,W)=>Y===I.selectedGuardrails[W]),[j,I,x,P,r]);return s.jsx(En,{isOpen:e,onClose:t,title:r?"Edit Agent":"Add Agent",description:"Configure an AI agent with its model, tools, and prompts",size:"xl",children:s.jsxs("form",{onSubmit:K,className:"space-y-4",children:[a.length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 text-amber-400 text-sm",children:"You need to add an LLM first before creating an agent."}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Reference Name",placeholder:"e.g., customer_service_agent",value:j.refName,onChange:Y=>T({...j,refName:Y.target.value}),hint:r?"Changing this will update all references in the YAML":"Unique key to reference this agent in YAML",required:!0}),s.jsx(le,{label:"Model",options:a,value:j.modelKey,onChange:Y=>T({...j,modelKey:Y.target.value}),placeholder:"Select an LLM...",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Display Name",placeholder:"e.g., Customer Service Agent",value:j.name,onChange:Y=>{const W=Y.target.value,ie=!r&&(!j.refName||j.refName===Wh(j.name));T({...j,name:W,refName:ie?Wh(W):j.refName})},hint:"Human-readable name for this agent",required:!0}),s.jsx(re,{label:"Description",placeholder:"Brief description of this agent's purpose",value:j.description,onChange:Y=>T({...j,description:Y.target.value})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"System Prompt"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5",children:[s.jsx("button",{type:"button",onClick:()=>{h("inline"),T({...j,promptRef:""})},className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${x==="inline"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Inline"}),s.jsx("button",{type:"button",onClick:()=>{h("configured"),T({...j,prompt:""})},className:`px-3 py-1 text-xs rounded-md font-medium transition-all duration-150 ${x==="configured"?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Configured"})]})]}),x==="configured"?s.jsxs("div",{className:"space-y-2",children:[s.jsx(le,{value:j.promptRef,onChange:Y=>T({...j,promptRef:Y.target.value}),options:i,placeholder:"Select a configured prompt..."}),j.promptRef&&d[j.promptRef]&&s.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(ga,{className:"w-4 h-4 text-violet-400"}),s.jsx("span",{className:"text-sm font-medium text-slate-300",children:d[j.promptRef].name})]}),d[j.promptRef].description&&s.jsx("p",{className:"text-xs text-slate-400 mb-2",children:d[j.promptRef].description}),d[j.promptRef].default_template&&s.jsxs("pre",{className:"text-xs text-slate-500 bg-slate-900/50 p-2 rounded overflow-auto max-h-32",children:[(ae=d[j.promptRef].default_template)==null?void 0:ae.substring(0,300),(((U=d[j.promptRef].default_template)==null?void 0:U.length)||0)>300?"...":""]})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Reference a prompt defined in the Prompts section. The prompt will be resolved at runtime."})]}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>k(!N),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:g,children:[s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),j.prompt&&j.prompt!=="You are a helpful assistant."&&s.jsxs("button",{type:"button",onClick:()=>D(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:g,children:[g?s.jsx(dt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]})}),N&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"Describe what this agent should do and I'll generate an optimized prompt for you."}),s.jsx(An,{value:_,onChange:Y=>S(Y.target.value),rows:3,placeholder:"e.g., This agent helps customers find products in a hardware store. It should be friendly and knowledgeable about tools and home improvement..."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-xs font-medium text-slate-400",children:"Template Parameters"}),s.jsxs("p",{className:"text-xs text-slate-500",children:["Select variables to include in the prompt (e.g., ","{user_id}",")"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:lu.map(Y=>s.jsx("button",{type:"button",onClick:()=>{A.includes(Y.value)?C(A.filter(W=>W!==Y.value)):C([...A,Y.value])},className:`px-2 py-1 text-xs rounded-md transition-all ${A.includes(Y.value)?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"}`,children:Y.label},Y.value))}),A.filter(Y=>!lu.map(W=>W.value).includes(Y)).length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:A.filter(Y=>!lu.map(W=>W.value).includes(Y)).map(Y=>s.jsxs("span",{className:"px-2 py-1 text-xs rounded-md bg-blue-500/30 text-blue-300 border border-blue-500/50 flex items-center space-x-1",children:[s.jsx("span",{children:Y}),s.jsx("button",{type:"button",onClick:()=>C(A.filter(W=>W!==Y)),className:"hover:text-red-300",children:""})]},Y))}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:O,onChange:Y=>F(Y.target.value.replace(/[^a-z0-9_]/gi,"_").toLowerCase()),placeholder:"Add custom parameter...",className:"flex-1 px-2 py-1 text-xs bg-slate-800 border border-slate-700 rounded-md text-slate-300 placeholder-slate-500 focus:border-purple-500 focus:outline-none",onKeyDown:Y=>{Y.key==="Enter"&&(Y.preventDefault(),B())}}),s.jsx("button",{type:"button",onClick:B,disabled:!O,className:"px-2 py-1 text-xs bg-slate-700 text-slate-300 rounded-md hover:bg-slate-600 disabled:opacity-50",children:"Add"})]})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{type:"button",variant:"secondary",size:"sm",onClick:()=>{k(!1),S("")},disabled:g,children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>D(!1),disabled:g||!_&&!j.name&&!j.description,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:g?s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(rt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(An,{value:j.prompt,onChange:Y=>T({...j,prompt:Y.target.value}),rows:8,hint:"The main instructions for this agent",placeholder:"You are a helpful assistant..."})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Handoff Prompt"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{type:"button",onClick:()=>V(!1),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:w||!j.prompt&&!j.description,title:!j.prompt&&!j.description?"Add a system prompt or description first":"Generate handoff prompt with AI",children:[w?s.jsx(dt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),j.handoffPrompt&&s.jsxs("button",{type:"button",onClick:()=>V(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:w,children:[w?s.jsx(dt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),s.jsx(An,{placeholder:"Describe when this agent should be called in a multi-agent system...",value:j.handoffPrompt,onChange:Y=>T({...j,handoffPrompt:Y.target.value}),rows:3,hint:"Used by the supervisor to decide when to route to this agent"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Bh,{label:"Tools",options:l,value:j.selectedTools,onChange:Y=>T({...j,selectedTools:Y}),placeholder:"Select tools...",hint:"Tools this agent can use"}),s.jsx(Bh,{label:"Guardrails",options:o,value:j.selectedGuardrails,onChange:Y=>T({...j,selectedGuardrails:Y}),placeholder:"Select guardrails...",hint:"Safety checks for this agent"})]}),j.refName&&Yh(j.refName,b,r)&&s.jsxs("div",{className:"p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:['A resource with reference name "',j.refName,'" already exists. Please choose a unique name.']}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:t,children:"Cancel"}),s.jsx(Q,{type:"submit",disabled:a.length===0||!!r&&!J||Yh(j.refName,b,r),children:r?"Save Changes":"Add Agent"})]})]})})}async function h_(e){const t=await fetch("/api/ai/generate-supervisor-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const r=await t.json();throw new Error(r.error||"Failed to generate supervisor prompt")}return(await t.json()).prompt}const p_=[{value:"TRACE",label:"TRACE"},{value:"DEBUG",label:"DEBUG"},{value:"INFO",label:"INFO"},{value:"WARNING",label:"WARNING"},{value:"ERROR",label:"ERROR"}],x_=[{value:"Small",label:"Small"},{value:"Medium",label:"Medium"},{value:"Large",label:"Large"}];function g_(e){return e.trim().replace(/[\s-]+/g,"_").replace(/([a-z])([A-Z])/g,"$1_$2").replace(/[^a-zA-Z0-9_]/g,"").toLowerCase().replace(/_+/g,"_").replace(/^_|_$/g,"")}function v_(){var sn,Ot,Yt,On,rs,hn,as,q,te;const{config:e,updateApp:t}=Oe(),n=e.app,r=e.schemas||{},a=e.agents||{},l=((sn=e.resources)==null?void 0:sn.llms)||{},o=e.tools||{},[i,c]=R.useState(()=>{var ne,ce;let z="";if((ne=n==null?void 0:n.registered_model)!=null&&ne.schema){const pe=n.registered_model.schema,_e=Object.entries(r).find(([,Le])=>Le.catalog_name===pe.catalog_name&&Le.schema_name===pe.schema_name);z=_e?_e[0]:""}let ee="";return n!=null&&n.service_principal&&typeof n.service_principal=="string"&&(ee=n.service_principal.startsWith("*")?n.service_principal.slice(1):n.service_principal),{name:(n==null?void 0:n.name)||"",description:(n==null?void 0:n.description)||"",logLevel:(n==null?void 0:n.log_level)||"INFO",endpointName:(n==null?void 0:n.endpoint_name)||"",modelName:((ce=n==null?void 0:n.registered_model)==null?void 0:ce.name)||"",modelSchema:z,workloadSize:(n==null?void 0:n.workload_size)||"Small",scaleToZero:(n==null?void 0:n.scale_to_zero)??!0,servicePrincipalRef:ee}}),[u,m]=R.useState(""),[d,f]=R.useState(""),[p,v]=R.useState((n==null?void 0:n.tags)||{}),[b,x]=R.useState(""),[h,g]=R.useState(""),y=[{value:"CAN_MANAGE",label:"Can Manage"},{value:"CAN_QUERY",label:"Can Query"},{value:"CAN_VIEW",label:"Can View"},{value:"CAN_REVIEW",label:"Can Review"},{value:"NO_PERMISSIONS",label:"No Permissions"}],[w,E]=R.useState(((Ot=n==null?void 0:n.permissions)==null?void 0:Ot.map(z=>({principals:z.principals||[],entitlements:z.entitlements||[]})))||[]),[_,S]=R.useState(""),[N,k]=R.useState(()=>n!=null&&n.agents&&Array.isArray(n.agents)&&n.agents.length>0?n.agents.map(z=>{var ne;return((ne=Object.entries(a).find(([,ce])=>ce.name===z.name))==null?void 0:ne[0])||""}).filter(Boolean):Object.keys(a)),[A,C]=R.useState((On=(Yt=e.app)==null?void 0:Yt.orchestration)!=null&&On.supervisor?"supervisor":(hn=(rs=e.app)==null?void 0:rs.orchestration)!=null&&hn.swarm?"swarm":"none"),[O,F]=R.useState(((te=(q=(as=e.app)==null?void 0:as.orchestration)==null?void 0:q.supervisor)==null?void 0:te.prompt)||""),[j,T]=R.useState(!1),[I,$]=R.useState(!1),[P,M]=R.useState(""),[D,V]=R.useState(()=>{var ee,ne,ce,pe,_e,Le,Re,it;const z=((pe=(ce=(ne=(ee=e.app)==null?void 0:ee.orchestration)==null?void 0:ne.supervisor)==null?void 0:ce.model)==null?void 0:pe.name)||((it=(Re=(Le=(_e=e.app)==null?void 0:_e.orchestration)==null?void 0:Le.swarm)==null?void 0:Re.model)==null?void 0:it.name);if(z){const It=Object.entries(l).find(([,rn])=>rn.name===z);return It?It[0]:""}return""}),[B,K]=R.useState(()=>{var ee,ne,ce;const z=(ce=(ne=(ee=e.app)==null?void 0:ee.orchestration)==null?void 0:ne.swarm)==null?void 0:ce.default_agent;return typeof z=="string"?z:z&&"name"in z?z.name:""}),[J,ae]=R.useState(()=>{var ee,ne,ce;const z=(ce=(ne=(ee=e.app)==null?void 0:ee.orchestration)==null?void 0:ne.swarm)==null?void 0:ce.handoffs;return z?Object.entries(z).map(([pe,_e])=>{if(_e==null)return{agentName:pe,type:"any",targets:[]};if(Array.isArray(_e)&&_e.length===0)return{agentName:pe,type:"none",targets:[]};const Le=_e.map(Re=>typeof Re=="string"?Re:Re.name);return{agentName:pe,type:"specific",targets:Le}}):[]}),[U,Y]=R.useState(()=>{var ee,ne,ce;const z=(ce=(ne=(ee=e.app)==null?void 0:ee.orchestration)==null?void 0:ne.supervisor)==null?void 0:ce.tools;return!z||!Array.isArray(z)?[]:z.map(pe=>{var Re;const _e=typeof pe=="string"?pe:pe==null?void 0:pe.name;return((Re=Object.entries(o).find(([,it])=>it.name===_e))==null?void 0:Re[0])||""}).filter(Boolean)}),W=(()=>{var Le,Re,it,It,rn,In,Ln,$n,Dn,ht,Fn,pn,zn,Vn,Hn,Un,Bn,tt,Be,Qe;if(i.name!==((n==null?void 0:n.name)||"")||i.description!==((n==null?void 0:n.description)||"")||i.logLevel!==((n==null?void 0:n.log_level)||"INFO")||i.endpointName!==((n==null?void 0:n.endpoint_name)||"")||i.modelName!==(((Le=n==null?void 0:n.registered_model)==null?void 0:Le.name)||"")||i.workloadSize!==((n==null?void 0:n.workload_size)||"Small")||i.scaleToZero!==((n==null?void 0:n.scale_to_zero)??!0))return!0;let z="";if((Re=n==null?void 0:n.registered_model)!=null&&Re.schema){const Se=n.registered_model.schema,Ne=Object.entries(r).find(([,be])=>be.catalog_name===Se.catalog_name&&be.schema_name===Se.schema_name);z=Ne?Ne[0]:""}if(i.modelSchema!==z)return!0;const ee=((n==null?void 0:n.agents)||[]).map(Se=>{var be;return((be=Object.entries(a).find(([,ze])=>ze.name===Se.name))==null?void 0:be[0])||""}).filter(Boolean).sort(),ne=[...N].sort();if(JSON.stringify(ee)!==JSON.stringify(ne))return!0;const ce=(it=n==null?void 0:n.orchestration)!=null&&it.supervisor?"supervisor":(It=n==null?void 0:n.orchestration)!=null&&It.swarm?"swarm":"none";if(A!==ce)return!0;if(A==="supervisor"){const Se=(Ln=(In=(rn=n==null?void 0:n.orchestration)==null?void 0:rn.supervisor)==null?void 0:In.model)==null?void 0:Ln.name,Ne=D?($n=l[D])==null?void 0:$n.name:"";if(Se!==Ne||O!==(((ht=(Dn=n==null?void 0:n.orchestration)==null?void 0:Dn.supervisor)==null?void 0:ht.prompt)||""))return!0;const be=(((pn=(Fn=n==null?void 0:n.orchestration)==null?void 0:Fn.supervisor)==null?void 0:pn.tools)||[]).map(ct=>{var eo;const Yn=typeof ct=="string"?ct:ct==null?void 0:ct.name;return((eo=Object.entries(o).find(([,Nc])=>Nc.name===Yn))==null?void 0:eo[0])||""}).filter(Boolean).sort(),ze=[...U].sort();if(JSON.stringify(be)!==JSON.stringify(ze))return!0}else if(A==="swarm"){const Se=(Hn=(Vn=(zn=n==null?void 0:n.orchestration)==null?void 0:zn.swarm)==null?void 0:Vn.model)==null?void 0:Hn.name,Ne=D?(Un=l[D])==null?void 0:Un.name:"";if(Se!==Ne)return!0;const be=(tt=(Bn=n==null?void 0:n.orchestration)==null?void 0:Bn.swarm)==null?void 0:tt.default_agent,ze=typeof be=="string"?be:(be==null?void 0:be.name)||"";if(B!==ze)return!0;const ct=((Qe=(Be=n==null?void 0:n.orchestration)==null?void 0:Be.swarm)==null?void 0:Qe.handoffs)||{},Yn={};if(J.forEach(ls=>{ls.type==="any"?Yn[ls.agentName]=null:ls.type==="none"?Yn[ls.agentName]=[]:Yn[ls.agentName]=ls.targets}),JSON.stringify(ct)!==JSON.stringify(Yn))return!0}const pe=(n==null?void 0:n.tags)||{};if(JSON.stringify(pe)!==JSON.stringify(p))return!0;const _e=(n==null?void 0:n.permissions)||[];return JSON.stringify(_e)!==JSON.stringify(w)})(),ie=[{value:"",label:"None"},...Object.keys(r).map(z=>({value:z,label:z}))],H=[{value:"",label:"Select an LLM..."},...Object.entries(l).map(([z,ee])=>({value:z,label:`${z} (${ee.name})`}))],X=Object.keys(a),Z=N.filter(z=>a[z]),oe=[{value:"",label:N.length===0?"Select agents for app first...":"Select an agent..."},...Z.map(z=>({value:z,label:a[z].name}))],fe=[{value:"any",label:"Any Agent (can hand off to all)"},{value:"specific",label:"Specific Agents (select targets)"},{value:"none",label:"No Handoffs (terminal agent)"}],ge=Z.filter(z=>!J.some(ee=>ee.agentName===z));R.useEffect(()=>{var Re,it,It,rn,In,Ln,$n,Dn,ht,Fn,pn,zn,Vn,Hn,Un,Bn,tt,Be,Qe;let z="";if((Re=n==null?void 0:n.registered_model)!=null&&Re.schema){const Se=n.registered_model.schema,Ne=Object.entries(r).find(([,be])=>be.catalog_name===Se.catalog_name&&be.schema_name===Se.schema_name);z=Ne?Ne[0]:""}let ee="";if(n!=null&&n.service_principal&&typeof n.service_principal=="string"&&(ee=n.service_principal.startsWith("*")?n.service_principal.slice(1):n.service_principal),c({name:(n==null?void 0:n.name)||"",description:(n==null?void 0:n.description)||"",logLevel:(n==null?void 0:n.log_level)||"INFO",endpointName:(n==null?void 0:n.endpoint_name)||"",modelName:((it=n==null?void 0:n.registered_model)==null?void 0:it.name)||"",modelSchema:z,workloadSize:(n==null?void 0:n.workload_size)||"Small",scaleToZero:(n==null?void 0:n.scale_to_zero)??!0,servicePrincipalRef:ee}),n!=null&&n.agents&&Array.isArray(n.agents)&&n.agents.length>0){const Se=n.agents.map(Ne=>{var ze;return((ze=Object.entries(a).find(([,ct])=>ct.name===Ne.name))==null?void 0:ze[0])||""}).filter(Boolean);k(Se)}else k(Object.keys(a));const ne=(It=n==null?void 0:n.orchestration)!=null&&It.supervisor?"supervisor":(rn=n==null?void 0:n.orchestration)!=null&&rn.swarm?"swarm":"none";C(ne);const ce=(($n=(Ln=(In=n==null?void 0:n.orchestration)==null?void 0:In.supervisor)==null?void 0:Ln.model)==null?void 0:$n.name)||((Fn=(ht=(Dn=n==null?void 0:n.orchestration)==null?void 0:Dn.swarm)==null?void 0:ht.model)==null?void 0:Fn.name);if(ce){const Se=Object.entries(l).find(([,Ne])=>Ne.name===ce);V(Se?Se[0]:"")}else V("");F(((zn=(pn=n==null?void 0:n.orchestration)==null?void 0:pn.supervisor)==null?void 0:zn.prompt)||"");const pe=(Hn=(Vn=n==null?void 0:n.orchestration)==null?void 0:Vn.supervisor)==null?void 0:Hn.tools;if(pe&&Array.isArray(pe)){const Se=pe.map(Ne=>{var ct;const be=typeof Ne=="string"?Ne:Ne==null?void 0:Ne.name;return((ct=Object.entries(o).find(([,Yn])=>Yn.name===be))==null?void 0:ct[0])||""}).filter(Boolean);Y(Se)}else Y([]);const _e=(Bn=(Un=n==null?void 0:n.orchestration)==null?void 0:Un.swarm)==null?void 0:Bn.default_agent;typeof _e=="string"?K(_e):_e&&"name"in _e?K(_e.name):K("");const Le=(Be=(tt=n==null?void 0:n.orchestration)==null?void 0:tt.swarm)==null?void 0:Be.handoffs;if(Le){const Se=Object.entries(Le).map(([Ne,be])=>{if(be==null)return{agentName:Ne,type:"any",targets:[]};if(Array.isArray(be)&&be.length===0)return{agentName:Ne,type:"none",targets:[]};const ze=be.map(ct=>typeof ct=="string"?ct:ct.name);return{agentName:Ne,type:"specific",targets:ze}});ae(Se)}else ae([]);v((n==null?void 0:n.tags)||{}),E(((Qe=n==null?void 0:n.permissions)==null?void 0:Qe.map(Se=>({principals:Se.principals||[],entitlements:Se.entitlements||[]})))||[])},[n,a,l,o]),R.useEffect(()=>{N.length<=1?A!=="none"&&C("none"):N.length>1&&A==="none"&&C("supervisor")},[N.length,A]);const L=()=>{ge.length>0&&ae([...J,{agentName:ge[0],type:"any",targets:[]}])},G=z=>{ae(J.filter((ee,ne)=>ne!==z))},ve=(z,ee)=>{ae(J.map((ne,ce)=>ce===z?{...ne,...ee}:ne))},me=(z,ee)=>{const ne=J[z],ce=ne.targets.includes(ee)?ne.targets.filter(pe=>pe!==ee):[...ne.targets,ee];ve(z,{targets:ce})},je=async(z=!1)=>{T(!0);try{const ee=Object.values(a).map(ce=>({name:ce.name,description:ce.description,handoff_prompt:ce.handoff_prompt})),ne=await h_({context:P||void 0,agents:ee.length>0?ee:void 0,existing_prompt:z?O:void 0});F(ne),$(!1),M("")}catch(ee){console.error("Failed to generate supervisor prompt:",ee),alert(ee instanceof Error?ee.message:"Failed to generate supervisor prompt")}finally{T(!1)}},ot=()=>{const z=i.modelSchema?r[i.modelSchema]:void 0;let ee;if(A==="supervisor"&&D&&l[D]){const ce=U.map(pe=>o[pe]).filter(Boolean);ee={supervisor:{model:l[D],...ce.length>0&&{tools:ce},...O&&{prompt:O}}}}else if(A==="swarm"&&D&&l[D]){const ce={};J.forEach(pe=>{pe.type==="any"?ce[pe.agentName]=null:pe.type==="none"?ce[pe.agentName]=[]:ce[pe.agentName]=pe.targets}),ee={swarm:{model:l[D],...B&&a[B]&&{default_agent:B},...Object.keys(ce).length>0&&{handoffs:ce}}}}const ne=N.map(ce=>a[ce]).filter(Boolean);t({name:i.name,description:i.description||void 0,log_level:i.logLevel,endpoint_name:i.endpointName||void 0,service_principal:i.servicePrincipalRef?`*${i.servicePrincipalRef}`:void 0,registered_model:{name:i.modelName,...z&&{schema:z}},workload_size:i.workloadSize,scale_to_zero:i.scaleToZero,orchestration:ee,agents:ne.length>0?ne:void 0,tags:Object.keys(p).length>0?p:void 0,permissions:w.length>0?w:void 0})},Bt=z=>{k(ee=>ee.includes(z)?ee.filter(ne=>ne!==z):[...ee,z])},nn=()=>{k(Object.keys(a))},Tt=()=>{k([])};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-white",children:"Application"}),s.jsx("p",{className:"text-slate-400 mt-1",children:"Configure your application settings, orchestration, and deployment options"})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(Qn,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Application Settings"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Application Name",placeholder:"e.g., my_retail_app",value:i.name,onChange:z=>{const ee=z.target.value,ne=g_(ee),ce=ne?`${ne}_endpoint`:"",pe=ne||"",_e={...i,name:ee};(!i.endpointName||i.endpointName===u)&&(_e.endpointName=ce,m(ce)),(!i.modelName||i.modelName===d)&&(_e.modelName=pe,f(pe)),c(_e)},required:!0}),s.jsx(le,{label:"Log Level",options:p_,value:i.logLevel,onChange:z=>c({...i,logLevel:z.target.value})})]}),s.jsx(re,{label:"Description",placeholder:"Brief description of your application",value:i.description,onChange:z=>c({...i,description:z.target.value})}),s.jsx(re,{label:"Endpoint Name",placeholder:"e.g., my_agent_endpoint",value:i.endpointName,onChange:z=>c({...i,endpointName:z.target.value}),hint:"The name of the model serving endpoint"}),s.jsx(le,{label:"Service Principal (Optional)",value:i.servicePrincipalRef,onChange:z=>c({...i,servicePrincipalRef:z.target.value}),options:[{value:"",label:"None - Use default credentials"},...Object.keys(e.service_principals||{}).map(z=>({value:z,label:z}))],hint:"Optional service principal for application authentication"}),Object.keys(e.service_principals||{}).length===0&&i.servicePrincipalRef===""&&s.jsx("p",{className:"text-xs text-slate-500 -mt-2",children:"Configure service principals in Resources  Service Principals to use them here."})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(_t,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Application Agents"})]}),s.jsx("div",{className:"flex items-center space-x-2",children:X.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:nn,disabled:N.length===X.length,children:"Select All"}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:Tt,disabled:N.length===0,children:"Clear"})]})})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Select the agents to include in this application. These agents will be available for orchestration."}),X.length===0?s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"No agents configured. Add agents in the Agents section first."}):s.jsx("div",{className:"space-y-2",children:X.map(z=>{const ee=a[z],ne=N.includes(z);return s.jsxs("button",{type:"button",onClick:()=>Bt(z),className:Te("w-full flex items-center justify-between p-3 rounded-lg border transition-all text-left",ne?"bg-blue-500/10 border-blue-500/50 ring-1 ring-blue-500/30":"bg-slate-800/50 border-slate-700 hover:border-slate-600"),children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:Te("w-8 h-8 rounded-lg flex items-center justify-center",ne?"bg-blue-500/20":"bg-slate-700"),children:s.jsx(_t,{className:Te("w-4 h-4",ne?"text-blue-400":"text-slate-400")})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-white",children:ee.name}),ee.description&&s.jsx("p",{className:"text-xs text-slate-500 line-clamp-1",children:ee.description})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[ee.tools&&ee.tools.length>0&&s.jsxs(we,{variant:"default",className:"text-[10px]",children:[ee.tools.length," tools"]}),ne?s.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500 flex items-center justify-center",children:s.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}):s.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-600"})]})]},z)})}),N.length>0&&s.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[s.jsxs("p",{className:"text-xs text-slate-500 mb-2",children:["Selected agents (",N.length,")"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:N.map(z=>{var ee;return s.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-500/20 text-blue-300 rounded text-xs",children:[((ee=a[z])==null?void 0:ee.name)||z,s.jsx("button",{type:"button",onClick:ne=>{ne.stopPropagation(),Bt(z)},className:"ml-1.5 hover:text-white",children:s.jsx(aa,{className:"w-3 h-3"})})]},z)})})]})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Rh,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Orchestration"})]}),s.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Configure how agents work together in your multi-agent system"}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs("button",{type:"button",onClick:()=>C("none"),disabled:N.length>1,className:Te("p-4 rounded-lg border text-center transition-all",A==="none"?"bg-blue-500/10 border-blue-500 ring-1 ring-blue-500":"bg-slate-800/50 border-slate-700 hover:border-slate-600",N.length>1&&"opacity-50 cursor-not-allowed hover:border-slate-700"),children:[s.jsx("div",{className:"w-10 h-10 mx-auto rounded-lg bg-slate-700 flex items-center justify-center mb-2",children:s.jsx(Wl,{className:"w-5 h-5 text-slate-400"})}),s.jsx("h4",{className:"text-sm font-medium text-white",children:"No Orchestration"}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Single agent mode"})]}),s.jsxs("button",{type:"button",onClick:()=>C("supervisor"),disabled:N.length<=1,className:Te("p-4 rounded-lg border text-center transition-all",A==="supervisor"?"bg-blue-500/10 border-blue-500 ring-1 ring-blue-500":"bg-slate-800/50 border-slate-700 hover:border-slate-600",N.length<=1&&"opacity-50 cursor-not-allowed hover:border-slate-700"),children:[s.jsx("div",{className:Te("w-10 h-10 mx-auto rounded-lg flex items-center justify-center mb-2",N.length<=1?"bg-slate-700":"bg-blue-500/20"),children:s.jsx(yd,{className:Te("w-5 h-5",N.length<=1?"text-slate-500":"text-blue-400")})}),s.jsx("h4",{className:"text-sm font-medium text-white",children:"Supervisor"}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Central routing agent"})]}),s.jsxs("button",{type:"button",onClick:()=>C("swarm"),disabled:N.length<=1,className:Te("p-4 rounded-lg border text-center transition-all",A==="swarm"?"bg-blue-500/10 border-blue-500 ring-1 ring-blue-500":"bg-slate-800/50 border-slate-700 hover:border-slate-600",N.length<=1&&"opacity-50 cursor-not-allowed hover:border-slate-700"),children:[s.jsx("div",{className:Te("w-10 h-10 mx-auto rounded-lg flex items-center justify-center mb-2",N.length<=1?"bg-slate-700":"bg-purple-500/20"),children:s.jsx(Rh,{className:Te("w-5 h-5",N.length<=1?"text-slate-500":"text-purple-400")})}),s.jsx("h4",{className:"text-sm font-medium text-white",children:"Swarm"}),s.jsx("p",{className:"text-xs text-slate-500 mt-0.5",children:"Peer-to-peer handoffs"})]})]}),N.length<=1&&s.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Supervisor and Swarm orchestration require multiple agents to be selected."}),A!=="none"&&s.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-700",children:[Object.keys(l).length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"Add an LLM in Resources first to configure orchestration."}),s.jsx(le,{label:"Orchestration Model",options:H,value:D,onChange:z=>V(z.target.value),hint:A==="supervisor"?"The LLM that will route requests to appropriate agents":"The LLM used for agent handoff decisions"}),A==="supervisor"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium text-slate-300",children:"Supervisor Prompt (Optional)"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[!I&&s.jsxs("button",{type:"button",onClick:()=>$(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",children:[s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"AI Assistant"})]}),O&&!I&&s.jsxs("button",{type:"button",onClick:()=>je(!0),className:"flex items-center space-x-1.5 px-3 py-1.5 text-xs rounded-lg font-medium bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 border border-purple-500/30 hover:from-purple-500/30 hover:to-pink-500/30 transition-all",disabled:j,children:[j?s.jsx(dt,{className:"w-3.5 h-3.5 animate-spin"}):s.jsx(rt,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Improve Prompt"})]})]}),I&&s.jsxs("div",{className:"p-3 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-lg border border-purple-500/30 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(rt,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:"text-sm font-medium text-purple-300",children:"Generate Supervisor Prompt with AI"})]}),s.jsx("p",{className:"text-xs text-slate-400",children:"The AI will use the configured agents' names, descriptions, and handoff prompts to generate a supervisor prompt that effectively routes requests."}),Object.keys(a).length>0&&s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs text-slate-500",children:"Agents that will be included:"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:Object.values(a).map((z,ee)=>s.jsx("span",{className:"px-2 py-0.5 bg-slate-800/50 rounded text-xs text-slate-300",children:z.name},ee))})]}),s.jsx(An,{label:"Additional Context (Optional)",placeholder:"Describe any specific routing logic, priorities, or special instructions for the supervisor...",value:P,onChange:z=>M(z.target.value),rows:3}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(Q,{variant:"secondary",size:"sm",onClick:()=>{$(!1),M("")},children:"Cancel"}),s.jsx(Q,{type:"button",size:"sm",onClick:()=>je(!1),disabled:j||Object.keys(a).length===0,className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:j?s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"w-4 h-4 mr-1.5 animate-spin"}),"Generating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(rt,{className:"w-4 h-4 mr-1.5"}),"Generate Prompt"]})})]})]}),s.jsx(An,{placeholder:"Custom instructions for the supervisor agent...",value:O,onChange:z=>F(z.target.value),rows:4,hint:"Override the default supervisor prompt"})]}),s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700/50",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-medium text-slate-200 flex items-center gap-2",children:[s.jsx(js,{className:"w-4 h-4 text-green-400"}),"Supervisor Tools"]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Assign tools that the supervisor can use directly"})]})}),Object.keys(o).length===0?s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"No tools configured. Add tools in the Tools section first."}):s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(o).map(([z,ee])=>{const ne=U.includes(z);return s.jsxs("button",{type:"button",onClick:()=>{Y(ce=>ne?ce.filter(pe=>pe!==z):[...ce,z])},className:Te("px-3 py-1.5 rounded-lg text-sm transition-colors flex items-center gap-2",ne?"bg-green-500/20 text-green-300 border border-green-500/50":"bg-slate-800 text-slate-400 border border-slate-700 hover:border-slate-600"),children:[s.jsx(js,{className:"w-3 h-3"}),ee.name,ne&&s.jsx(aa,{className:"w-3 h-3 ml-1"})]},z)})}),U.length>0&&s.jsxs("p",{className:"text-xs text-green-400",children:[" ",U.length," tool",U.length!==1?"s":""," assigned to supervisor"]})]})]})]}),A==="swarm"&&s.jsxs(s.Fragment,{children:[N.length===0&&s.jsx("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-3 text-amber-400 text-sm",children:"Select agents for the application above before configuring swarm orchestration."}),s.jsx(le,{label:"Default Agent",options:oe,value:B,onChange:z=>K(z.target.value),hint:"The agent that handles initial requests (from selected application agents)",disabled:N.length===0}),s.jsxs("div",{className:"space-y-3 pt-3 border-t border-slate-700/50",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-slate-200",children:"Agent Handoff Rules"}),s.jsx("p",{className:"text-xs text-slate-500",children:"Define which agents can hand off to which other agents"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:L,disabled:ge.length===0||N.length===0,children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Rule"]})]}),N.length===0&&s.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 text-slate-400 text-sm",children:"Select agents for the application first to configure handoff rules."}),J.length===0&&N.length>0&&s.jsx("div",{className:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(oc,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-blue-300",children:[s.jsx("p",{className:"font-medium",children:"No handoff rules defined"}),s.jsxs("p",{className:"text-blue-400/80 mt-1 text-xs",children:["Without explicit rules, agents will use their ",s.jsx("code",{className:"bg-blue-900/50 px-1 rounded",children:"handoff_prompt"})," to determine routing."]})]})]})}),J.map((z,ee)=>{var ne;return s.jsxs("div",{className:"bg-slate-800/30 rounded-lg p-3 border border-slate-700/50 space-y-2",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[s.jsx(le,{label:"From Agent",value:z.agentName,onChange:ce=>ve(ee,{agentName:ce.target.value}),options:[{value:z.agentName,label:((ne=a[z.agentName])==null?void 0:ne.name)||z.agentName},...ge.map(ce=>{var pe;return{value:ce,label:((pe=a[ce])==null?void 0:pe.name)||ce}})]}),s.jsx(le,{label:"Can Hand Off To",value:z.type,onChange:ce=>ve(ee,{type:ce.target.value,targets:ce.target.value==="specific"?z.targets:[]}),options:fe})]}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>G(ee),className:"ml-2 mt-6",children:s.jsx(Ge,{className:"w-4 h-4 text-red-400"})})]}),z.type==="specific"&&s.jsxs("div",{className:"pt-1",children:[s.jsx("p",{className:"text-xs text-slate-400 mb-2",children:"Select target agents:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Z.filter(ce=>ce!==z.agentName).map(ce=>{var pe;return s.jsx("button",{type:"button",onClick:()=>me(ee,ce),className:Te("px-2.5 py-1 rounded-lg text-xs transition-colors",z.targets.includes(ce)?"bg-purple-500/30 text-purple-300 border border-purple-500/50":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"),children:((pe=a[ce])==null?void 0:pe.name)||ce},ce)})})]}),z.type==="any"&&s.jsx("p",{className:"text-xs text-emerald-400",children:" This agent can hand off to any other agent"}),z.type==="none"&&s.jsx("p",{className:"text-xs text-amber-400",children:" This agent cannot hand off (terminal agent)"})]},ee)})]})]})]}),s.jsxs("div",{className:"bg-slate-800/30 rounded-lg p-3 text-xs text-slate-400 space-y-1.5",children:[s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(we,{variant:"info",className:"text-[10px] px-1.5 py-0",children:"Supervisor"}),s.jsx("span",{children:"Central agent analyzes requests and routes to appropriate specialized agents."})]}),s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(we,{variant:"info",className:"text-[10px] px-1.5 py-0",children:"Swarm"}),s.jsx("span",{children:"Agents hand off conversations directly to each other based on handoff rules."})]})]})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsx("h3",{className:"font-medium text-white",children:"Model Registration"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(re,{label:"Registered Model Name",placeholder:"e.g., my_agent_model",value:i.modelName,onChange:z=>c({...i,modelName:z.target.value}),required:!0}),s.jsx(le,{label:"Model Schema",options:ie,value:i.modelSchema,onChange:z=>c({...i,modelSchema:z.target.value}),hint:"Unity Catalog schema for model registration"})]})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsx("h3",{className:"font-medium text-white",children:"Deployment Options"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(le,{label:"Workload Size",options:x_,value:i.workloadSize,onChange:z=>c({...i,workloadSize:z.target.value})}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx("label",{className:"block text-sm font-medium text-slate-300",children:"Scale to Zero"}),s.jsxs("div",{className:"inline-flex rounded-lg bg-slate-900/50 p-0.5 mt-1",children:[s.jsx("button",{type:"button",onClick:()=>c({...i,scaleToZero:!0}),className:`px-4 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i.scaleToZero?"bg-violet-500/20 text-violet-400 border border-violet-500/40":"text-slate-400 border border-transparent hover:text-slate-300"}`,children:"Enabled"}),s.jsx("button",{type:"button",onClick:()=>c({...i,scaleToZero:!1}),className:`px-4 py-1.5 text-xs rounded-md font-medium transition-all duration-150 ${i.scaleToZero?"text-slate-400 border border-transparent hover:text-slate-300":"bg-violet-500/20 text-violet-400 border border-violet-500/40"}`,children:"Disabled"})]})]})]})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(vd,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Tags"})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Add metadata tags to your application for organization and filtering"}),Object.keys(p).length>0&&s.jsx("div",{className:"space-y-2",children:Object.entries(p).map(([z,ee])=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-800/50 rounded-lg border border-slate-700",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm font-medium text-blue-400",children:z}),s.jsx("span",{className:"text-slate-500",children:"="}),s.jsx("span",{className:"text-sm text-slate-300",children:String(ee)})]}),s.jsx("button",{type:"button",onClick:()=>{const ne={...p};delete ne[z],v(ne)},className:"text-slate-400 hover:text-red-400",children:s.jsx(Ge,{className:"w-4 h-4"})})]},z))}),s.jsxs("div",{className:"flex items-end space-x-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(re,{label:"Key",placeholder:"e.g., environment",value:b,onChange:z=>x(z.target.value)})}),s.jsx("div",{className:"flex-1",children:s.jsx(re,{label:"Value",placeholder:"e.g., production",value:h,onChange:z=>g(z.target.value)})}),s.jsxs(Q,{variant:"secondary",onClick:()=>{b&&h&&(v({...p,[b]:h}),x(""),g(""))},disabled:!b||!h,children:[s.jsx(Pe,{className:"w-4 h-4"}),"Add"]})]})]}),s.jsxs(ye,{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(yd,{className:"w-5 h-5 text-slate-400"}),s.jsx("h3",{className:"font-medium text-white",children:"Permissions"})]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>E([...w,{principals:[],entitlements:[]}]),children:[s.jsx(Pe,{className:"w-4 h-4 mr-1"}),"Add Permission"]})]}),s.jsx("p",{className:"text-sm text-slate-400",children:"Configure who can access this application and with what permissions"}),w.length===0?s.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 text-slate-400 text-sm",children:"No permissions configured. Add permissions to control access to this application."}):s.jsx("div",{className:"space-y-3",children:w.map((z,ee)=>s.jsxs("div",{className:"p-3 bg-slate-800/30 rounded-lg border border-slate-700 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium text-slate-300",children:["Permission Rule ",ee+1]}),s.jsx("button",{type:"button",onClick:()=>E(w.filter((ne,ce)=>ce!==ee)),className:"text-slate-400 hover:text-red-400",children:s.jsx(Ge,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-xs font-medium text-slate-400",children:"Principals (users, groups, service principals)"}),s.jsx("div",{className:"flex flex-wrap gap-2 min-h-[32px]",children:z.principals.map((ne,ce)=>s.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-500/20 text-blue-300 rounded text-xs",children:[ne,s.jsx("button",{type:"button",onClick:()=>{const pe=[...w];pe[ee].principals=z.principals.filter((_e,Le)=>Le!==ce),E(pe)},className:"ml-1.5 hover:text-white",children:s.jsx(aa,{className:"w-3 h-3"})})]},ce))}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(re,{placeholder:"e.g., user@example.com or group_name",value:_,onChange:ne=>S(ne.target.value),className:"flex-1"}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>{if(_){const ne=[...w];ne[ee].principals=[...z.principals,_],E(ne),S("")}},disabled:!_,children:"Add"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-xs font-medium text-slate-400",children:"Entitlements"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(ne=>s.jsx("button",{type:"button",onClick:()=>{const ce=[...w];z.entitlements.includes(ne.value)?ce[ee].entitlements=z.entitlements.filter(pe=>pe!==ne.value):ce[ee].entitlements=[...z.entitlements,ne.value],E(ce)},className:Te("px-2.5 py-1 rounded-lg text-xs transition-colors",z.entitlements.includes(ne.value)?"bg-green-500/30 text-green-300 border border-green-500/50":"bg-slate-700 text-slate-400 border border-slate-600 hover:border-slate-500"),children:ne.label},ne.value))})]})]},ee))})]}),s.jsxs(ye,{variant:"highlight",children:[s.jsx("h3",{className:"font-medium text-white mb-3",children:"Configuration Summary"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Application:"}),s.jsx("span",{className:"text-white ml-2",children:i.name||"Not set"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Agents:"}),s.jsxs(we,{variant:N.length>0?"success":"warning",className:"ml-2",children:[N.length," selected"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Orchestration:"}),s.jsx(we,{variant:A!=="none"?"info":"default",className:"ml-2",children:A==="supervisor"?"Supervisor":A==="swarm"?"Swarm":"None"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-slate-400",children:"Endpoint:"}),s.jsx("span",{className:"text-white ml-2",children:i.endpointName||"Not set"})]})]})]}),s.jsxs("div",{className:"flex justify-end items-center space-x-3",children:[!W&&s.jsx("span",{className:"text-sm text-slate-500",children:"No unsaved changes"}),s.jsxs(Q,{onClick:ot,size:"lg",disabled:!W,children:[s.jsx(sw,{className:"w-4 h-4"}),"Save Configuration"]})]})]})}function y_({activeSection:e,onNavigate:t}){const n=()=>{switch(e){case"overview":return s.jsx(iw,{onNavigate:t});case"variables":return s.jsx(mw,{});case"service_principals":return s.jsx(fw,{});case"schemas":return s.jsx(Mw,{});case"resources":return s.jsx(Ow,{});case"retrievers":return s.jsx(e_,{});case"tools":return s.jsx(r_,{});case"guardrails":return s.jsx(l_,{});case"memory":return s.jsx(o_,{});case"prompts":return s.jsx(c_,{});case"agents":return s.jsx(m_,{});case"app":return s.jsx(v_,{});default:return null}};return s.jsx("div",{className:"h-full overflow-y-auto bg-slate-900/50",children:s.jsx("div",{className:"p-6 animate-fade-in",children:n()})})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function qg(e){return typeof e>"u"||e===null}function b_(e){return typeof e=="object"&&e!==null}function N_(e){return Array.isArray(e)?e:qg(e)?[]:[e]}function j_(e,t){var n,r,a,l;if(t)for(l=Object.keys(t),n=0,r=l.length;n<r;n+=1)a=l[n],e[a]=t[a];return e}function w_(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function __(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var S_=qg,k_=b_,C_=N_,E_=w_,A_=__,P_=j_,at={isNothing:S_,isObject:k_,toArray:C_,repeat:E_,isNegativeZero:A_,extend:P_};function Xg(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function kl(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Xg(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}kl.prototype=Object.create(Error.prototype);kl.prototype.constructor=kl;kl.prototype.toString=function(t){return this.name+": "+Xg(this,t)};var At=kl;function ou(e,t,n,r,a){var l="",o="",i=Math.floor(a/2)-1;return r-t>i&&(l=" ... ",t=r-i+l.length),n-r>i&&(o=" ...",n=r+i-o.length),{str:l+e.slice(t,n).replace(/\t/g,"")+o,pos:r-t+l.length}}function iu(e,t){return at.repeat(" ",t-e.length)+e}function R_(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],a=[],l,o=-1;l=n.exec(e.buffer);)a.push(l.index),r.push(l.index+l[0].length),e.position<=l.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var i="",c,u,m=Math.min(e.line+t.linesAfter,a.length).toString().length,d=t.maxLength-(t.indent+m+3);for(c=1;c<=t.linesBefore&&!(o-c<0);c++)u=ou(e.buffer,r[o-c],a[o-c],e.position-(r[o]-r[o-c]),d),i=at.repeat(" ",t.indent)+iu((e.line-c+1).toString(),m)+" | "+u.str+`
`+i;for(u=ou(e.buffer,r[o],a[o],e.position,d),i+=at.repeat(" ",t.indent)+iu((e.line+1).toString(),m)+" | "+u.str+`
`,i+=at.repeat("-",t.indent+m+3+u.pos)+`^
`,c=1;c<=t.linesAfter&&!(o+c>=a.length);c++)u=ou(e.buffer,r[o+c],a[o+c],e.position-(r[o]-r[o+c]),d),i+=at.repeat(" ",t.indent)+iu((e.line+c+1).toString(),m)+" | "+u.str+`
`;return i.replace(/\n$/,"")}var M_=R_,T_=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],O_=["scalar","sequence","mapping"];function I_(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function L_(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(T_.indexOf(n)===-1)throw new At('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=I_(t.styleAliases||null),O_.indexOf(this.kind)===-1)throw new At('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var vt=L_;function Gh(e,t){var n=[];return e[t].forEach(function(r){var a=n.length;n.forEach(function(l,o){l.tag===r.tag&&l.kind===r.kind&&l.multi===r.multi&&(a=o)}),n[a]=r}),n}function $_(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(a){a.multi?(e.multi[a.kind].push(a),e.multi.fallback.push(a)):e[a.kind][a.tag]=e.fallback[a.tag]=a}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function _d(e){return this.extend(e)}_d.prototype.extend=function(t){var n=[],r=[];if(t instanceof vt)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new At("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(l){if(!(l instanceof vt))throw new At("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(l.loadKind&&l.loadKind!=="scalar")throw new At("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(l.multi)throw new At("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(l){if(!(l instanceof vt))throw new At("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(_d.prototype);return a.implicit=(this.implicit||[]).concat(n),a.explicit=(this.explicit||[]).concat(r),a.compiledImplicit=Gh(a,"implicit"),a.compiledExplicit=Gh(a,"explicit"),a.compiledTypeMap=$_(a.compiledImplicit,a.compiledExplicit),a};var Qg=_d,Kg=new vt("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),Zg=new vt("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),Jg=new vt("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),ev=new Qg({explicit:[Kg,Zg,Jg]});function D_(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function F_(){return null}function z_(e){return e===null}var tv=new vt("tag:yaml.org,2002:null",{kind:"scalar",resolve:D_,construct:F_,predicate:z_,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function V_(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function H_(e){return e==="true"||e==="True"||e==="TRUE"}function U_(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var nv=new vt("tag:yaml.org,2002:bool",{kind:"scalar",resolve:V_,construct:H_,predicate:U_,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function B_(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Y_(e){return 48<=e&&e<=55}function W_(e){return 48<=e&&e<=57}function G_(e){if(e===null)return!1;var t=e.length,n=0,r=!1,a;if(!t)return!1;if(a=e[n],(a==="-"||a==="+")&&(a=e[++n]),a==="0"){if(n+1===t)return!0;if(a=e[++n],a==="b"){for(n++;n<t;n++)if(a=e[n],a!=="_"){if(a!=="0"&&a!=="1")return!1;r=!0}return r&&a!=="_"}if(a==="x"){for(n++;n<t;n++)if(a=e[n],a!=="_"){if(!B_(e.charCodeAt(n)))return!1;r=!0}return r&&a!=="_"}if(a==="o"){for(n++;n<t;n++)if(a=e[n],a!=="_"){if(!Y_(e.charCodeAt(n)))return!1;r=!0}return r&&a!=="_"}}if(a==="_")return!1;for(;n<t;n++)if(a=e[n],a!=="_"){if(!W_(e.charCodeAt(n)))return!1;r=!0}return!(!r||a==="_")}function q_(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function X_(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!at.isNegativeZero(e)}var sv=new vt("tag:yaml.org,2002:int",{kind:"scalar",resolve:G_,construct:q_,predicate:X_,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Q_=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function K_(e){return!(e===null||!Q_.test(e)||e[e.length-1]==="_")}function Z_(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var J_=/^[-+]?[0-9]+e/;function e2(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(at.isNegativeZero(e))return"-0.0";return n=e.toString(10),J_.test(n)?n.replace("e",".e"):n}function t2(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||at.isNegativeZero(e))}var rv=new vt("tag:yaml.org,2002:float",{kind:"scalar",resolve:K_,construct:Z_,predicate:t2,represent:e2,defaultStyle:"lowercase"}),av=ev.extend({implicit:[tv,nv,sv,rv]}),lv=av,ov=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),iv=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function n2(e){return e===null?!1:ov.exec(e)!==null||iv.exec(e)!==null}function s2(e){var t,n,r,a,l,o,i,c=0,u=null,m,d,f;if(t=ov.exec(e),t===null&&(t=iv.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,r,a));if(l=+t[4],o=+t[5],i=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(m=+t[10],d=+(t[11]||0),u=(m*60+d)*6e4,t[9]==="-"&&(u=-u)),f=new Date(Date.UTC(n,r,a,l,o,i,c)),u&&f.setTime(f.getTime()-u),f}function r2(e){return e.toISOString()}var cv=new vt("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:n2,construct:s2,instanceOf:Date,represent:r2});function a2(e){return e==="<<"||e===null}var uv=new vt("tag:yaml.org,2002:merge",{kind:"scalar",resolve:a2}),Hm=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function l2(e){if(e===null)return!1;var t,n,r=0,a=e.length,l=Hm;for(n=0;n<a;n++)if(t=l.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function o2(e){var t,n,r=e.replace(/[\r\n=]/g,""),a=r.length,l=Hm,o=0,i=[];for(t=0;t<a;t++)t%4===0&&t&&(i.push(o>>16&255),i.push(o>>8&255),i.push(o&255)),o=o<<6|l.indexOf(r.charAt(t));return n=a%4*6,n===0?(i.push(o>>16&255),i.push(o>>8&255),i.push(o&255)):n===18?(i.push(o>>10&255),i.push(o>>2&255)):n===12&&i.push(o>>4&255),new Uint8Array(i)}function i2(e){var t="",n=0,r,a,l=e.length,o=Hm;for(r=0;r<l;r++)r%3===0&&r&&(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]),n=(n<<8)+e[r];return a=l%3,a===0?(t+=o[n>>18&63],t+=o[n>>12&63],t+=o[n>>6&63],t+=o[n&63]):a===2?(t+=o[n>>10&63],t+=o[n>>4&63],t+=o[n<<2&63],t+=o[64]):a===1&&(t+=o[n>>2&63],t+=o[n<<4&63],t+=o[64],t+=o[64]),t}function c2(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var dv=new vt("tag:yaml.org,2002:binary",{kind:"scalar",resolve:l2,construct:o2,predicate:c2,represent:i2}),u2=Object.prototype.hasOwnProperty,d2=Object.prototype.toString;function m2(e){if(e===null)return!0;var t=[],n,r,a,l,o,i=e;for(n=0,r=i.length;n<r;n+=1){if(a=i[n],o=!1,d2.call(a)!=="[object Object]")return!1;for(l in a)if(u2.call(a,l))if(!o)o=!0;else return!1;if(!o)return!1;if(t.indexOf(l)===-1)t.push(l);else return!1}return!0}function f2(e){return e!==null?e:[]}var mv=new vt("tag:yaml.org,2002:omap",{kind:"sequence",resolve:m2,construct:f2}),h2=Object.prototype.toString;function p2(e){if(e===null)return!0;var t,n,r,a,l,o=e;for(l=new Array(o.length),t=0,n=o.length;t<n;t+=1){if(r=o[t],h2.call(r)!=="[object Object]"||(a=Object.keys(r),a.length!==1))return!1;l[t]=[a[0],r[a[0]]]}return!0}function x2(e){if(e===null)return[];var t,n,r,a,l,o=e;for(l=new Array(o.length),t=0,n=o.length;t<n;t+=1)r=o[t],a=Object.keys(r),l[t]=[a[0],r[a[0]]];return l}var fv=new vt("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:p2,construct:x2}),g2=Object.prototype.hasOwnProperty;function v2(e){if(e===null)return!0;var t,n=e;for(t in n)if(g2.call(n,t)&&n[t]!==null)return!1;return!0}function y2(e){return e!==null?e:{}}var hv=new vt("tag:yaml.org,2002:set",{kind:"mapping",resolve:v2,construct:y2}),Um=lv.extend({implicit:[cv,uv],explicit:[dv,mv,fv,hv]}),Ks=Object.prototype.hasOwnProperty,Ei=1,pv=2,xv=3,Ai=4,cu=1,b2=2,qh=3,N2=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,j2=/[\x85\u2028\u2029]/,w2=/[,\[\]\{\}]/,gv=/^(?:!|!!|![a-z\-]+!)$/i,vv=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Xh(e){return Object.prototype.toString.call(e)}function es(e){return e===10||e===13}function pr(e){return e===9||e===32}function Ft(e){return e===9||e===32||e===10||e===13}function Xr(e){return e===44||e===91||e===93||e===123||e===125}function _2(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function S2(e){return e===120?2:e===117?4:e===85?8:0}function k2(e){return 48<=e&&e<=57?e-48:-1}function Qh(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function C2(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function yv(e,t,n){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}var bv=new Array(256),Nv=new Array(256);for(var Tr=0;Tr<256;Tr++)bv[Tr]=Qh(Tr)?1:0,Nv[Tr]=Qh(Tr);function E2(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Um,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function jv(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=M_(n),new At(t,n)}function xe(e,t){throw jv(e,t)}function Pi(e,t){e.onWarning&&e.onWarning.call(null,jv(e,t))}var Kh={YAML:function(t,n,r){var a,l,o;t.version!==null&&xe(t,"duplication of %YAML directive"),r.length!==1&&xe(t,"YAML directive accepts exactly one argument"),a=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),a===null&&xe(t,"ill-formed argument of the YAML directive"),l=parseInt(a[1],10),o=parseInt(a[2],10),l!==1&&xe(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,o!==1&&o!==2&&Pi(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var a,l;r.length!==2&&xe(t,"TAG directive accepts exactly two arguments"),a=r[0],l=r[1],gv.test(a)||xe(t,"ill-formed tag handle (first argument) of the TAG directive"),Ks.call(t.tagMap,a)&&xe(t,'there is a previously declared suffix for "'+a+'" tag handle'),vv.test(l)||xe(t,"ill-formed tag prefix (second argument) of the TAG directive");try{l=decodeURIComponent(l)}catch{xe(t,"tag prefix is malformed: "+l)}t.tagMap[a]=l}};function Bs(e,t,n,r){var a,l,o,i;if(t<n){if(i=e.input.slice(t,n),r)for(a=0,l=i.length;a<l;a+=1)o=i.charCodeAt(a),o===9||32<=o&&o<=1114111||xe(e,"expected valid JSON character");else N2.test(i)&&xe(e,"the stream contains non-printable characters");e.result+=i}}function Zh(e,t,n,r){var a,l,o,i;for(at.isObject(n)||xe(e,"cannot merge mappings; the provided source object is unacceptable"),a=Object.keys(n),o=0,i=a.length;o<i;o+=1)l=a[o],Ks.call(t,l)||(yv(t,l,n[l]),r[l]=!0)}function Qr(e,t,n,r,a,l,o,i,c){var u,m;if(Array.isArray(a))for(a=Array.prototype.slice.call(a),u=0,m=a.length;u<m;u+=1)Array.isArray(a[u])&&xe(e,"nested arrays are not supported inside keys"),typeof a=="object"&&Xh(a[u])==="[object Object]"&&(a[u]="[object Object]");if(typeof a=="object"&&Xh(a)==="[object Object]"&&(a="[object Object]"),a=String(a),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(l))for(u=0,m=l.length;u<m;u+=1)Zh(e,t,l[u],n);else Zh(e,t,l,n);else!e.json&&!Ks.call(n,a)&&Ks.call(t,a)&&(e.line=o||e.line,e.lineStart=i||e.lineStart,e.position=c||e.position,xe(e,"duplicated mapping key")),yv(t,a,l),delete n[a];return t}function Bm(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):xe(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Je(e,t,n){for(var r=0,a=e.input.charCodeAt(e.position);a!==0;){for(;pr(a);)a===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),a=e.input.charCodeAt(++e.position);if(t&&a===35)do a=e.input.charCodeAt(++e.position);while(a!==10&&a!==13&&a!==0);if(es(a))for(Bm(e),a=e.input.charCodeAt(e.position),r++,e.lineIndent=0;a===32;)e.lineIndent++,a=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&Pi(e,"deficient indentation"),r}function ic(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Ft(n)))}function Ym(e,t){t===1?e.result+=" ":t>1&&(e.result+=at.repeat(`
`,t-1))}function A2(e,t,n){var r,a,l,o,i,c,u,m,d=e.kind,f=e.result,p;if(p=e.input.charCodeAt(e.position),Ft(p)||Xr(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(a=e.input.charCodeAt(e.position+1),Ft(a)||n&&Xr(a)))return!1;for(e.kind="scalar",e.result="",l=o=e.position,i=!1;p!==0;){if(p===58){if(a=e.input.charCodeAt(e.position+1),Ft(a)||n&&Xr(a))break}else if(p===35){if(r=e.input.charCodeAt(e.position-1),Ft(r))break}else{if(e.position===e.lineStart&&ic(e)||n&&Xr(p))break;if(es(p))if(c=e.line,u=e.lineStart,m=e.lineIndent,Je(e,!1,-1),e.lineIndent>=t){i=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=c,e.lineStart=u,e.lineIndent=m;break}}i&&(Bs(e,l,o,!1),Ym(e,e.line-c),l=o=e.position,i=!1),pr(p)||(o=e.position+1),p=e.input.charCodeAt(++e.position)}return Bs(e,l,o,!1),e.result?!0:(e.kind=d,e.result=f,!1)}function P2(e,t){var n,r,a;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=a=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Bs(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,a=e.position;else return!0;else es(n)?(Bs(e,r,a,!0),Ym(e,Je(e,!1,t)),r=a=e.position):e.position===e.lineStart&&ic(e)?xe(e,"unexpected end of the document within a single quoted scalar"):(e.position++,a=e.position);xe(e,"unexpected end of the stream within a single quoted scalar")}function R2(e,t){var n,r,a,l,o,i;if(i=e.input.charCodeAt(e.position),i!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(i=e.input.charCodeAt(e.position))!==0;){if(i===34)return Bs(e,n,e.position,!0),e.position++,!0;if(i===92){if(Bs(e,n,e.position,!0),i=e.input.charCodeAt(++e.position),es(i))Je(e,!1,t);else if(i<256&&bv[i])e.result+=Nv[i],e.position++;else if((o=S2(i))>0){for(a=o,l=0;a>0;a--)i=e.input.charCodeAt(++e.position),(o=_2(i))>=0?l=(l<<4)+o:xe(e,"expected hexadecimal character");e.result+=C2(l),e.position++}else xe(e,"unknown escape sequence");n=r=e.position}else es(i)?(Bs(e,n,r,!0),Ym(e,Je(e,!1,t)),n=r=e.position):e.position===e.lineStart&&ic(e)?xe(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}xe(e,"unexpected end of the stream within a double quoted scalar")}function M2(e,t){var n=!0,r,a,l,o=e.tag,i,c=e.anchor,u,m,d,f,p,v=Object.create(null),b,x,h,g;if(g=e.input.charCodeAt(e.position),g===91)m=93,p=!1,i=[];else if(g===123)m=125,p=!0,i={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),g=e.input.charCodeAt(++e.position);g!==0;){if(Je(e,!0,t),g=e.input.charCodeAt(e.position),g===m)return e.position++,e.tag=o,e.anchor=c,e.kind=p?"mapping":"sequence",e.result=i,!0;n?g===44&&xe(e,"expected the node content, but found ','"):xe(e,"missed comma between flow collection entries"),x=b=h=null,d=f=!1,g===63&&(u=e.input.charCodeAt(e.position+1),Ft(u)&&(d=f=!0,e.position++,Je(e,!0,t))),r=e.line,a=e.lineStart,l=e.position,va(e,t,Ei,!1,!0),x=e.tag,b=e.result,Je(e,!0,t),g=e.input.charCodeAt(e.position),(f||e.line===r)&&g===58&&(d=!0,g=e.input.charCodeAt(++e.position),Je(e,!0,t),va(e,t,Ei,!1,!0),h=e.result),p?Qr(e,i,v,x,b,h,r,a,l):d?i.push(Qr(e,null,v,x,b,h,r,a,l)):i.push(b),Je(e,!0,t),g=e.input.charCodeAt(e.position),g===44?(n=!0,g=e.input.charCodeAt(++e.position)):n=!1}xe(e,"unexpected end of the stream within a flow collection")}function T2(e,t){var n,r,a=cu,l=!1,o=!1,i=t,c=0,u=!1,m,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)cu===a?a=d===43?qh:b2:xe(e,"repeat of a chomping mode identifier");else if((m=k2(d))>=0)m===0?xe(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?xe(e,"repeat of an indentation width identifier"):(i=t+m-1,o=!0);else break;if(pr(d)){do d=e.input.charCodeAt(++e.position);while(pr(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!es(d)&&d!==0)}for(;d!==0;){for(Bm(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!o||e.lineIndent<i)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>i&&(i=e.lineIndent),es(d)){c++;continue}if(e.lineIndent<i){a===qh?e.result+=at.repeat(`
`,l?1+c:c):a===cu&&l&&(e.result+=`
`);break}for(r?pr(d)?(u=!0,e.result+=at.repeat(`
`,l?1+c:c)):u?(u=!1,e.result+=at.repeat(`
`,c+1)):c===0?l&&(e.result+=" "):e.result+=at.repeat(`
`,c):e.result+=at.repeat(`
`,l?1+c:c),l=!0,o=!0,c=0,n=e.position;!es(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Bs(e,n,e.position,!1)}return!0}function Jh(e,t){var n,r=e.tag,a=e.anchor,l=[],o,i=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,xe(e,"tab characters must not be used in indentation")),!(c!==45||(o=e.input.charCodeAt(e.position+1),!Ft(o))));){if(i=!0,e.position++,Je(e,!0,-1)&&e.lineIndent<=t){l.push(null),c=e.input.charCodeAt(e.position);continue}if(n=e.line,va(e,t,xv,!1,!0),l.push(e.result),Je(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&c!==0)xe(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return i?(e.tag=r,e.anchor=a,e.kind="sequence",e.result=l,!0):!1}function O2(e,t,n){var r,a,l,o,i,c,u=e.tag,m=e.anchor,d={},f=Object.create(null),p=null,v=null,b=null,x=!1,h=!1,g;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),g=e.input.charCodeAt(e.position);g!==0;){if(!x&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,xe(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),l=e.line,(g===63||g===58)&&Ft(r))g===63?(x&&(Qr(e,d,f,p,v,null,o,i,c),p=v=b=null),h=!0,x=!0,a=!0):x?(x=!1,a=!0):xe(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,g=r;else{if(o=e.line,i=e.lineStart,c=e.position,!va(e,n,pv,!1,!0))break;if(e.line===l){for(g=e.input.charCodeAt(e.position);pr(g);)g=e.input.charCodeAt(++e.position);if(g===58)g=e.input.charCodeAt(++e.position),Ft(g)||xe(e,"a whitespace character is expected after the key-value separator within a block mapping"),x&&(Qr(e,d,f,p,v,null,o,i,c),p=v=b=null),h=!0,x=!1,a=!1,p=e.tag,v=e.result;else if(h)xe(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=u,e.anchor=m,!0}else if(h)xe(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=u,e.anchor=m,!0}if((e.line===l||e.lineIndent>t)&&(x&&(o=e.line,i=e.lineStart,c=e.position),va(e,t,Ai,!0,a)&&(x?v=e.result:b=e.result),x||(Qr(e,d,f,p,v,b,o,i,c),p=v=b=null),Je(e,!0,-1),g=e.input.charCodeAt(e.position)),(e.line===l||e.lineIndent>t)&&g!==0)xe(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return x&&Qr(e,d,f,p,v,null,o,i,c),h&&(e.tag=u,e.anchor=m,e.kind="mapping",e.result=d),h}function I2(e){var t,n=!1,r=!1,a,l,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&xe(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(n=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,a="!!",o=e.input.charCodeAt(++e.position)):a="!",t=e.position,n){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(l=e.input.slice(t,e.position),o=e.input.charCodeAt(++e.position)):xe(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!Ft(o);)o===33&&(r?xe(e,"tag suffix cannot contain exclamation marks"):(a=e.input.slice(t-1,e.position+1),gv.test(a)||xe(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),o=e.input.charCodeAt(++e.position);l=e.input.slice(t,e.position),w2.test(l)&&xe(e,"tag suffix cannot contain flow indicator characters")}l&&!vv.test(l)&&xe(e,"tag name cannot contain such characters: "+l);try{l=decodeURIComponent(l)}catch{xe(e,"tag name is malformed: "+l)}return n?e.tag=l:Ks.call(e.tagMap,a)?e.tag=e.tagMap[a]+l:a==="!"?e.tag="!"+l:a==="!!"?e.tag="tag:yaml.org,2002:"+l:xe(e,'undeclared tag handle "'+a+'"'),!0}function L2(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&xe(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Ft(n)&&!Xr(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&xe(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function $2(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Ft(r)&&!Xr(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&xe(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Ks.call(e.anchorMap,n)||xe(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Je(e,!0,-1),!0}function va(e,t,n,r,a){var l,o,i,c=1,u=!1,m=!1,d,f,p,v,b,x;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,l=o=i=Ai===n||xv===n,r&&Je(e,!0,-1)&&(u=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;I2(e)||L2(e);)Je(e,!0,-1)?(u=!0,i=l,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):i=!1;if(i&&(i=u||a),(c===1||Ai===n)&&(Ei===n||pv===n?b=t:b=t+1,x=e.position-e.lineStart,c===1?i&&(Jh(e,x)||O2(e,x,b))||M2(e,b)?m=!0:(o&&T2(e,b)||P2(e,b)||R2(e,b)?m=!0:$2(e)?(m=!0,(e.tag!==null||e.anchor!==null)&&xe(e,"alias node should not have any properties")):A2(e,b,Ei===n)&&(m=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(m=i&&Jh(e,x))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&xe(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,f=e.implicitTypes.length;d<f;d+=1)if(v=e.implicitTypes[d],v.resolve(e.result)){e.result=v.construct(e.result),e.tag=v.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Ks.call(e.typeMap[e.kind||"fallback"],e.tag))v=e.typeMap[e.kind||"fallback"][e.tag];else for(v=null,p=e.typeMap.multi[e.kind||"fallback"],d=0,f=p.length;d<f;d+=1)if(e.tag.slice(0,p[d].tag.length)===p[d].tag){v=p[d];break}v||xe(e,"unknown tag !<"+e.tag+">"),e.result!==null&&v.kind!==e.kind&&xe(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+v.kind+'", not "'+e.kind+'"'),v.resolve(e.result,e.tag)?(e.result=v.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):xe(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||m}function D2(e){var t=e.position,n,r,a,l=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(Je(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(l=!0,o=e.input.charCodeAt(++e.position),n=e.position;o!==0&&!Ft(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),a=[],r.length<1&&xe(e,"directive name must not be less than one character in length");o!==0;){for(;pr(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!es(o));break}if(es(o))break;for(n=e.position;o!==0&&!Ft(o);)o=e.input.charCodeAt(++e.position);a.push(e.input.slice(n,e.position))}o!==0&&Bm(e),Ks.call(Kh,r)?Kh[r](e,r,a):Pi(e,'unknown document directive "'+r+'"')}if(Je(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,Je(e,!0,-1)):l&&xe(e,"directives end mark is expected"),va(e,e.lineIndent-1,Ai,!1,!0),Je(e,!0,-1),e.checkLineBreaks&&j2.test(e.input.slice(t,e.position))&&Pi(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ic(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,Je(e,!0,-1));return}if(e.position<e.length-1)xe(e,"end of the stream or a document separator is expected");else return}function wv(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new E2(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,xe(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)D2(n);return n.documents}function F2(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=wv(e,n);if(typeof t!="function")return r;for(var a=0,l=r.length;a<l;a+=1)t(r[a])}function z2(e,t){var n=wv(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new At("expected a single document in the stream, but found more")}}var V2=F2,H2=z2,_v={loadAll:V2,load:H2},Sv=Object.prototype.toString,kv=Object.prototype.hasOwnProperty,Wm=65279,U2=9,Cl=10,B2=13,Y2=32,W2=33,G2=34,Sd=35,q2=37,X2=38,Q2=39,K2=42,Cv=44,Z2=45,Ri=58,J2=61,eS=62,tS=63,nS=64,Ev=91,Av=93,sS=96,Pv=123,rS=124,Rv=125,Ct={};Ct[0]="\\0";Ct[7]="\\a";Ct[8]="\\b";Ct[9]="\\t";Ct[10]="\\n";Ct[11]="\\v";Ct[12]="\\f";Ct[13]="\\r";Ct[27]="\\e";Ct[34]='\\"';Ct[92]="\\\\";Ct[133]="\\N";Ct[160]="\\_";Ct[8232]="\\L";Ct[8233]="\\P";var aS=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],lS=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function oS(e,t){var n,r,a,l,o,i,c;if(t===null)return{};for(n={},r=Object.keys(t),a=0,l=r.length;a<l;a+=1)o=r[a],i=String(t[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),c=e.compiledTypeMap.fallback[o],c&&kv.call(c.styleAliases,i)&&(i=c.styleAliases[i]),n[o]=i;return n}function iS(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new At("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+at.repeat("0",r-t.length)+t}var cS=1,El=2;function uS(e){this.schema=e.schema||Um,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=at.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=oS(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?El:cS,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function ep(e,t){for(var n=at.repeat(" ",t),r=0,a=-1,l="",o,i=e.length;r<i;)a=e.indexOf(`
`,r),a===-1?(o=e.slice(r),r=i):(o=e.slice(r,a+1),r=a+1),o.length&&o!==`
`&&(l+=n),l+=o;return l}function kd(e,t){return`
`+at.repeat(" ",e.indent*t)}function dS(e,t){var n,r,a;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(a=e.implicitTypes[n],a.resolve(t))return!0;return!1}function Mi(e){return e===Y2||e===U2}function Al(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Wm||65536<=e&&e<=1114111}function tp(e){return Al(e)&&e!==Wm&&e!==B2&&e!==Cl}function np(e,t,n){var r=tp(e),a=r&&!Mi(e);return(n?r:r&&e!==Cv&&e!==Ev&&e!==Av&&e!==Pv&&e!==Rv)&&e!==Sd&&!(t===Ri&&!a)||tp(t)&&!Mi(t)&&e===Sd||t===Ri&&a}function mS(e){return Al(e)&&e!==Wm&&!Mi(e)&&e!==Z2&&e!==tS&&e!==Ri&&e!==Cv&&e!==Ev&&e!==Av&&e!==Pv&&e!==Rv&&e!==Sd&&e!==X2&&e!==K2&&e!==W2&&e!==rS&&e!==J2&&e!==eS&&e!==Q2&&e!==G2&&e!==q2&&e!==nS&&e!==sS}function fS(e){return!Mi(e)&&e!==Ri}function Ya(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function Mv(e){var t=/^\n* /;return t.test(e)}var Tv=1,Cd=2,Ov=3,Iv=4,Ir=5;function hS(e,t,n,r,a,l,o,i){var c,u=0,m=null,d=!1,f=!1,p=r!==-1,v=-1,b=mS(Ya(e,0))&&fS(Ya(e,e.length-1));if(t||o)for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=Ya(e,c),!Al(u))return Ir;b=b&&np(u,m,i),m=u}else{for(c=0;c<e.length;u>=65536?c+=2:c++){if(u=Ya(e,c),u===Cl)d=!0,p&&(f=f||c-v-1>r&&e[v+1]!==" ",v=c);else if(!Al(u))return Ir;b=b&&np(u,m,i),m=u}f=f||p&&c-v-1>r&&e[v+1]!==" "}return!d&&!f?b&&!o&&!a(e)?Tv:l===El?Ir:Cd:n>9&&Mv(e)?Ir:o?l===El?Ir:Cd:f?Iv:Ov}function pS(e,t,n,r,a){e.dump=function(){if(t.length===0)return e.quotingType===El?'""':"''";if(!e.noCompatMode&&(aS.indexOf(t)!==-1||lS.test(t)))return e.quotingType===El?'"'+t+'"':"'"+t+"'";var l=e.indent*Math.max(1,n),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-l),i=r||e.flowLevel>-1&&n>=e.flowLevel;function c(u){return dS(e,u)}switch(hS(t,i,e.indent,o,c,e.quotingType,e.forceQuotes&&!r,a)){case Tv:return t;case Cd:return"'"+t.replace(/'/g,"''")+"'";case Ov:return"|"+sp(t,e.indent)+rp(ep(t,l));case Iv:return">"+sp(t,e.indent)+rp(ep(xS(t,o),l));case Ir:return'"'+gS(t)+'"';default:throw new At("impossible error: invalid scalar style")}}()}function sp(e,t){var n=Mv(e)?String(t):"",r=e[e.length-1]===`
`,a=r&&(e[e.length-2]===`
`||e===`
`),l=a?"+":r?"":"-";return n+l+`
`}function rp(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function xS(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,n.lastIndex=u,ap(e.slice(0,u),t)}(),a=e[0]===`
`||e[0]===" ",l,o;o=n.exec(e);){var i=o[1],c=o[2];l=c[0]===" ",r+=i+(!a&&!l&&c!==""?`
`:"")+ap(c,t),a=l}return r}function ap(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,a=0,l,o=0,i=0,c="";r=n.exec(e);)i=r.index,i-a>t&&(l=o>a?o:i,c+=`
`+e.slice(a,l),a=l+1),o=i;return c+=`
`,e.length-a>t&&o>a?c+=e.slice(a,o)+`
`+e.slice(o+1):c+=e.slice(a),c.slice(1)}function gS(e){for(var t="",n=0,r,a=0;a<e.length;n>=65536?a+=2:a++)n=Ya(e,a),r=Ct[n],!r&&Al(n)?(t+=e[a],n>=65536&&(t+=e[a+1])):t+=r||iS(n);return t}function vS(e,t,n){var r="",a=e.tag,l,o,i;for(l=0,o=n.length;l<o;l+=1)i=n[l],e.replacer&&(i=e.replacer.call(n,String(l),i)),(ws(e,t,i,!1,!1)||typeof i>"u"&&ws(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=a,e.dump="["+r+"]"}function lp(e,t,n,r){var a="",l=e.tag,o,i,c;for(o=0,i=n.length;o<i;o+=1)c=n[o],e.replacer&&(c=e.replacer.call(n,String(o),c)),(ws(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&ws(e,t+1,null,!0,!0,!1,!0))&&((!r||a!=="")&&(a+=kd(e,t)),e.dump&&Cl===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=l,e.dump=a||"[]"}function yS(e,t,n){var r="",a=e.tag,l=Object.keys(n),o,i,c,u,m;for(o=0,i=l.length;o<i;o+=1)m="",r!==""&&(m+=", "),e.condenseFlow&&(m+='"'),c=l[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),ws(e,t,c,!1,!1)&&(e.dump.length>1024&&(m+="? "),m+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),ws(e,t,u,!1,!1)&&(m+=e.dump,r+=m));e.tag=a,e.dump="{"+r+"}"}function bS(e,t,n,r){var a="",l=e.tag,o=Object.keys(n),i,c,u,m,d,f;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new At("sortKeys must be a boolean or a function");for(i=0,c=o.length;i<c;i+=1)f="",(!r||a!=="")&&(f+=kd(e,t)),u=o[i],m=n[u],e.replacer&&(m=e.replacer.call(n,u,m)),ws(e,t+1,u,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&Cl===e.dump.charCodeAt(0)?f+="?":f+="? "),f+=e.dump,d&&(f+=kd(e,t)),ws(e,t+1,m,!0,d)&&(e.dump&&Cl===e.dump.charCodeAt(0)?f+=":":f+=": ",f+=e.dump,a+=f));e.tag=l,e.dump=a||"{}"}function op(e,t,n){var r,a,l,o,i,c;for(a=n?e.explicitTypes:e.implicitTypes,l=0,o=a.length;l<o;l+=1)if(i=a[l],(i.instanceOf||i.predicate)&&(!i.instanceOf||typeof t=="object"&&t instanceof i.instanceOf)&&(!i.predicate||i.predicate(t))){if(n?i.multi&&i.representName?e.tag=i.representName(t):e.tag=i.tag:e.tag="?",i.represent){if(c=e.styleMap[i.tag]||i.defaultStyle,Sv.call(i.represent)==="[object Function]")r=i.represent(t,c);else if(kv.call(i.represent,c))r=i.represent[c](t,c);else throw new At("!<"+i.tag+'> tag resolver accepts not "'+c+'" style');e.dump=r}return!0}return!1}function ws(e,t,n,r,a,l,o){e.tag=null,e.dump=n,op(e,n,!1)||op(e,n,!0);var i=Sv.call(e.dump),c=r,u;r&&(r=e.flowLevel<0||e.flowLevel>t);var m=i==="[object Object]"||i==="[object Array]",d,f;if(m&&(d=e.duplicates.indexOf(n),f=d!==-1),(e.tag!==null&&e.tag!=="?"||f||e.indent!==2&&t>0)&&(a=!1),f&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(m&&f&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),i==="[object Object]")r&&Object.keys(e.dump).length!==0?(bS(e,t,e.dump,a),f&&(e.dump="&ref_"+d+e.dump)):(yS(e,t,e.dump),f&&(e.dump="&ref_"+d+" "+e.dump));else if(i==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&t>0?lp(e,t-1,e.dump,a):lp(e,t,e.dump,a),f&&(e.dump="&ref_"+d+e.dump)):(vS(e,t,e.dump),f&&(e.dump="&ref_"+d+" "+e.dump));else if(i==="[object String]")e.tag!=="?"&&pS(e,e.dump,t,l,c);else{if(i==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new At("unacceptable kind of an object to dump "+i)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function NS(e,t){var n=[],r=[],a,l;for(Ed(e,n,r),a=0,l=r.length;a<l;a+=1)t.duplicates.push(n[r[a]]);t.usedDuplicates=new Array(l)}function Ed(e,t,n){var r,a,l;if(e!==null&&typeof e=="object")if(a=t.indexOf(e),a!==-1)n.indexOf(a)===-1&&n.push(a);else if(t.push(e),Array.isArray(e))for(a=0,l=e.length;a<l;a+=1)Ed(e[a],t,n);else for(r=Object.keys(e),a=0,l=r.length;a<l;a+=1)Ed(e[r[a]],t,n)}function jS(e,t){t=t||{};var n=new uS(t);n.noRefs||NS(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),ws(n,0,r,!0,!0)?n.dump+`
`:""}var wS=jS,_S={dump:wS};function Gm(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var SS=vt,kS=Qg,CS=ev,ES=av,AS=lv,PS=Um,RS=_v.load,MS=_v.loadAll,TS=_S.dump,OS=At,IS={binary:dv,float:rv,map:Jg,null:tv,pairs:fv,set:hv,timestamp:cv,bool:nv,int:sv,merge:uv,omap:mv,seq:Zg,str:Kg},LS=Gm("safeLoad","load"),$S=Gm("safeLoadAll","loadAll"),DS=Gm("safeDump","dump"),sl={Type:SS,Schema:kS,FAILSAFE_SCHEMA:CS,JSON_SCHEMA:ES,CORE_SCHEMA:AS,DEFAULT_SCHEMA:PS,load:RS,loadAll:MS,dump:TS,YAMLException:OS,types:IS,safeLoad:LS,safeLoadAll:$S,safeDump:DS};function Lv(e){const t=[],n=[],r={},a={},l={},o={},i=e.split(`
`),c=[],u=new Map;for(let m=0;m<i.length;m++){const d=i[m],f=m+1;if(!d.trim()||d.trim().startsWith("#"))continue;const p=d.search(/\S/);if(p===-1)continue;for(;c.length>0&&c[c.length-1].indent>=p;)c.pop();const v=/^\s*-/.test(d),b=d.match(/^\s*-?\s*([^:\s]+)\s*:/);if(b){const w=b[1];c.push({indent:p,key:w});const E=c.map(_=>_.key).join(".");u.delete(E)}const x=c.map(w=>w.key).join(".");let h=x;if(v&&!b){const w=u.get(x)||0;h=`${x}.${w}`,u.set(x,w+1)}const g=d.match(/&(\w+)/);if(g){const w=g[1];t.push({name:w,path:x,lineNumber:f}),a[w]=x,b&&b[1]!==w&&(o[x]=w)}const y=d.matchAll(new RegExp(`(?<!["\\w])\\*(\\w+)(?!["'])`,"g"));for(const w of y){const E=w[1];if(d.includes(`&${E}`))continue;n.push({name:E,path:h,lineNumber:f}),r[E]||(r[E]=[]),r[E].push(h);const _=h.split(".");if(_.length>=2){const S=_.slice(-3).join(".");l[`${S}=${E}`]=E;const N=_.slice(-2).join(".");l[`${N}=${E}`]=E}}}return{anchors:t,aliases:n,aliasUsage:r,anchorPaths:a,pathSuffixToAnchor:l,keyToAnchorName:o}}let la=null;function $v(e){la=e}function FS(){return la}function zS(){la=null}function VS(e){return!la||!la.keyToAnchorName?null:la.keyToAnchorName[e]||null}function ip(e,t){return typeof e=="string"&&e.startsWith(t)}function cp(e){return typeof e=="string"?e:""}function HS(e){const t=["variables","schemas","service_principals","retrievers","tools","guardrails","prompts","agents"],n=["llms","vector_stores","genie_rooms","tables","volumes","functions","warehouses","connections","databases"],r=["memory","app"],a=e.split(`
`),l=[];for(let o=0;o<a.length;o++){const c=a[o].match(/^(\s*)(\w[\w_-]*):\s*$/);if(c){const u=c[2],m=c[1].length;if(m===0&&t.includes(u))l.push({name:u,startLine:o,indent:m,childIndent:m+2,endLine:-1});else if(m===0&&u==="resources")for(let d=o+1;d<a.length;d++){const p=a[d].match(/^(\s*)(\w[\w_-]*):\s*$/);if(p){const v=p[2],b=p[1].length;if(b===0)break;b===2&&n.includes(v)&&l.push({name:v,startLine:d,indent:b,childIndent:b+2,endLine:-1})}}}}for(let o=0;o<l.length;o++){const i=l[o];for(let c=i.startLine+1;c<a.length;c++){const u=a[c];if(!u.trim())continue;const m=u.search(/\S/);if(m!==-1&&m<=i.indent){i.endLine=c;break}}i.endLine===-1&&(i.endLine=a.length)}for(const o of l){if(r.includes(o.name))continue;const i=o.indent===0?o.name:`resources.${o.name}`;for(let c=o.startLine+1;c<o.endLine;c++){const u=a[c];if(!u.trim()||u.search(/\S/)!==o.childIndent)continue;const d=u.match(new RegExp(`^( {${o.childIndent}})(\\w[\\w_-]*):\\s*$`));if(d){const f=d[1],p=d[2];if(!u.includes("&")){const v=`${i}.${p}`,b=VS(v);b?a[c]=`${f}${p}: &${b}`:["tables","volumes","functions"].includes(o.name)||(a[c]=`${f}${p}: &${p}`)}}}}return a.join(`
`)}function US(e){let t=e.replace(/__MERGE__: "(\w+)"/g,"<<: *$1");return t=t.replace(/__MERGE__: (\w+)/g,"<<: *$1"),t=t.replace(/"__REF__(\w+)"/g,"*$1"),t=t.replace(/- __REF__(\w+)/g,"- *$1"),t=t.replace(/__REF__(\w+)/g,"*$1"),t}function Ce(e){return`__REF__${e}`}function Nn(e,t){const n=FS();if(!n)return null;const r=e.toLowerCase().replace(/-/g,"_"),a=e.split(".");for(const[i,c]of Object.entries(n.aliasUsage))for(const u of c){const m=u.toLowerCase().replace(/-/g,"_");if(r===m&&n.anchorPaths[i])return i}const l=a[a.length-1];if(/^\d+$/.test(l))for(const[i,c]of Object.entries(n.aliasUsage))for(const u of c){const m=u.toLowerCase().replace(/-/g,"_");if(r===m||m.endsWith(r))return i}if(t&&typeof t=="object"&&"name"in t&&"function"in t){for(const[i,c]of Object.entries(n.anchorPaths))if(c.startsWith("tools.")){const u=n.aliasUsage[i]||[];for(const m of u){const d=m.split("."),f=e.split(".");if(d.includes("tools")&&f.includes("tools")){const p=d.indexOf("agents"),v=f.indexOf("agents");if(p!==-1&&v!==-1){const b=d[p+1],x=f[v+1];if(b===x)return i}}}}}const o=a.slice(-2).join(".");if(n.pathSuffixToAnchor){const i=o.toLowerCase().replace(/-/g,"_");for(const[c,u]of Object.entries(n.pathSuffixToAnchor)){const m=c.toLowerCase().replace(/-/g,"_");if((i===m||i.endsWith("."+m))&&n.anchorPaths[u])return u}}if(t&&typeof t=="object"&&t.catalog_name&&t.schema_name){for(const[i,c]of Object.entries(n.anchorPaths))if(c.includes("schema"))return i}return null}function Ti(e,t){if(typeof e=="string")return t[e]?Ce(e):e;if(e&&typeof e=="object"&&e.name){for(const[n,r]of Object.entries(t))if(r.name===e.name)return Ce(n);return{name:e.name,...e.temperature!==void 0&&{temperature:e.temperature},...e.max_tokens!==void 0&&{max_tokens:e.max_tokens},...e.on_behalf_of_user!==void 0&&{on_behalf_of_user:e.on_behalf_of_user},...e.fallbacks&&e.fallbacks.length>0&&{fallbacks:e.fallbacks}}}return e}function rr(e,t,n){if(e){if(n){const r=Nn(n,e);if(r)return Ce(r)}for(const[r,a]of Object.entries(t))if(a.catalog_name===e.catalog_name&&a.schema_name===e.schema_name)return Ce(r);return{catalog_name:e.catalog_name,schema_name:e.schema_name}}}function up(e,t){var r,a,l,o;if(!e)return;const n={};if(e.volume)if(typeof e.volume=="string")e.volume.startsWith("*")?n.volume=Ce(e.volume.substring(1)):n.volume=Ce(e.volume);else{let i;for(const[c,u]of Object.entries(t))if(u.name===e.volume.name&&((r=u.schema)==null?void 0:r.catalog_name)===((a=e.volume.schema)==null?void 0:a.catalog_name)&&((l=u.schema)==null?void 0:l.schema_name)===((o=e.volume.schema)==null?void 0:o.schema_name)){i=c;break}i?n.volume=Ce(i):e.volume._schemaRef?n.volume={schema:Ce(e.volume._schemaRef),name:e.volume.name}:n.volume={...e.volume.schema&&{schema:{catalog_name:e.volume.schema.catalog_name,schema_name:e.volume.schema.schema_name}},name:e.volume.name}}return e.path&&(n.path=e.path),Object.keys(n).length>0?n:void 0}function BS(e,t,n){const r={};if(e.supervisor){let a;e.supervisor.tools&&e.supervisor.tools.length>0&&(a=e.supervisor.tools.map(l=>{const o=typeof l=="string"?l:l.name,i=Object.entries(n).find(([,u])=>u.name===o),c=i?i[0]:o;return Ce(c)})),r.supervisor={model:Ti(e.supervisor.model,t),...a&&a.length>0&&{tools:a},...e.supervisor.prompt&&{prompt:e.supervisor.prompt}}}if(e.swarm){if(r.swarm={model:Ti(e.swarm.model,t)},e.swarm.default_agent){const a=e.swarm.default_agent;typeof a=="string"?r.swarm.default_agent=a:"name"in a&&(r.swarm.default_agent=a.name)}e.swarm.handoffs&&Object.keys(e.swarm.handoffs).length>0&&(r.swarm.handoffs={},Object.entries(e.swarm.handoffs).forEach(([a,l])=>{l==null?r.swarm.handoffs[a]=null:Array.isArray(l)&&(l.length===0?r.swarm.handoffs[a]=[]:r.swarm.handoffs[a]=l.map(o=>typeof o=="string"?o:o.name))}))}return e.memory&&(r.memory=e.memory),r}function YS(e){return{review_prompt:e.review_prompt,...e.interrupt_config&&{interrupt_config:e.interrupt_config},...e.decline_message&&{decline_message:e.decline_message},...e.custom_actions&&Object.keys(e.custom_actions).length>0&&{custom_actions:e.custom_actions}}}function WS(e,t){if(typeof e=="string")return e;const n={type:e.type};if("__MERGE__"in e||(n.name=e.name),e.type==="factory"&&"args"in e&&e.args&&Object.keys(e.args).length>0){const r={};for(const[a,l]of Object.entries(e.args)){const o=t?Nn(`tools.${t}.function.args.${a}`,l):null;o?r[a]=Ce(o):r[a]=l}n.args=r}if(e.type==="unity_catalog"&&("__MERGE__"in e&&e.__MERGE__?n.__MERGE__=e.__MERGE__:"schema"in e&&e.schema&&(n.schema=e.schema,n.name=e.name),"partial_args"in e&&e.partial_args)){const r={};for(const[a,l]of Object.entries(e.partial_args)){const o=t?Nn(`tools.${t}.function.partial_args.${a}`,l):null;o?r[a]=Ce(o):r[a]=l}n.partial_args=r}if(e.type==="mcp"){if("transport"in e&&e.transport&&(n.transport=e.transport),"command"in e&&e.command&&(n.command=e.command),"url"in e&&e.url&&(n.url=e.url),"headers"in e&&e.headers&&(n.headers=e.headers),"args"in e&&e.args&&(n.args=e.args),"pat"in e&&e.pat&&(n.pat=st(e.pat)),"service_principal"in e&&e.service_principal){const r=e.service_principal;typeof r=="string"?r.startsWith("*")?n.service_principal=Ce(r.slice(1)):n.service_principal=Ce(r):n.service_principal={client_id:st(r.client_id),client_secret:st(r.client_secret)}}else"client_id"in e&&e.client_id&&(n.client_id=st(e.client_id)),"client_secret"in e&&e.client_secret&&(n.client_secret=st(e.client_secret)),"workspace_host"in e&&e.workspace_host&&(n.workspace_host=st(e.workspace_host));if("connection"in e&&e.connection){const r=e.connection;typeof r=="string"&&r.startsWith("*")?n.connection=Ce(r.slice(1)):n.connection=r}if("functions"in e&&e.functions&&(n.functions=e.functions),"genie_room"in e&&e.genie_room){const r=t?Nn(`tools.${t}.function.genie_room`,e.genie_room):null;n.genie_room=r?Ce(r):e.genie_room}if("sql"in e&&e.sql&&(n.sql=e.sql),"vector_search"in e&&e.vector_search){const r=t?Nn(`tools.${t}.function.vector_search`,e.vector_search):null;if(r)n.vector_search=Ce(r);else if("retriever"in e.vector_search){const a=t?Nn(`tools.${t}.function.vector_search.retriever`,e.vector_search.retriever):null;n.vector_search={...e.vector_search,retriever:a?Ce(a):e.vector_search.retriever}}else n.vector_search=e.vector_search}}return"human_in_the_loop"in e&&e.human_in_the_loop&&(n.human_in_the_loop=YS(e.human_in_the_loop)),n}function uu(e){const t={name:e.name};return e.instance_name&&(t.instance_name=e.instance_name),e.description&&(t.description=e.description),e.capacity&&(t.capacity=e.capacity),e.max_pool_size&&(t.max_pool_size=e.max_pool_size),e.timeout_seconds&&(t.timeout_seconds=e.timeout_seconds),e.service_principal?typeof e.service_principal=="string"?e.service_principal.startsWith("*")?t.service_principal=Ce(e.service_principal.slice(1)):t.service_principal=Ce(e.service_principal):t.service_principal={client_id:st(e.service_principal.client_id),client_secret:st(e.service_principal.client_secret)}:(e.client_id&&(t.client_id=st(e.client_id)),e.client_secret&&(t.client_secret=st(e.client_secret)),e.workspace_host&&(t.workspace_host=st(e.workspace_host))),e.user&&(t.user=st(e.user)),e.password&&(t.password=st(e.password)),t}function st(e){if(typeof e!="string")return e;if(e.startsWith("*"))return Ce(e.slice(1));if(e.startsWith("env:"))return{env:e.slice(4)};if(e.startsWith("secret:")){const t=e.slice(7).split("/");if(t.length===2)return{scope:t[0],secret:t[1]}}return e&&{env:e}}function Dv(e){switch(e.type){case"primitive":return{value:e.value};case"env":const t=e;return{env:t.env,...t.default_value!==void 0&&{default_value:t.default_value}};case"secret":const n=e;return{scope:n.scope,secret:n.secret,...n.default_value!==void 0&&{default_value:n.default_value}};case"composite":const r=e;return{options:r.options.map(a=>Dv(a)),...r.default_value!==void 0&&{default_value:r.default_value}};default:return e}}function qm(e){var l,o,i,c;const t={},n=e.schemas||{};if(e.variables&&Object.keys(e.variables).length>0&&(t.variables={},Object.entries(e.variables).forEach(([u,m])=>{t.variables[u]=Dv(m)})),e.service_principals&&Object.keys(e.service_principals).length>0&&(t.service_principals={},Object.entries(e.service_principals).forEach(([u,m])=>{t.service_principals[u]={client_id:st(m.client_id),client_secret:st(m.client_secret)}})),e.schemas&&Object.keys(e.schemas).length>0&&(t.schemas={},Object.entries(e.schemas).forEach(([u,m])=>{t.schemas[u]={catalog_name:m.catalog_name,schema_name:m.schema_name,...m.permissions&&{permissions:m.permissions}}})),e.resources&&(e.resources.llms&&Object.keys(e.resources.llms).length>0||e.resources.vector_stores&&Object.keys(e.resources.vector_stores).length>0||e.resources.genie_rooms&&Object.keys(e.resources.genie_rooms).length>0||e.resources.tables&&Object.keys(e.resources.tables).length>0||e.resources.volumes&&Object.keys(e.resources.volumes).length>0||e.resources.functions&&Object.keys(e.resources.functions).length>0||e.resources.warehouses&&Object.keys(e.resources.warehouses).length>0||e.resources.connections&&Object.keys(e.resources.connections).length>0||e.resources.databases&&Object.keys(e.resources.databases).length>0)){if(t.resources={},e.resources.llms&&Object.keys(e.resources.llms).length>0&&(t.resources.llms={},Object.entries(e.resources.llms).forEach(([u,m])=>{let d;m.fallbacks&&m.fallbacks.length>0&&(d=m.fallbacks.map(f=>typeof f=="string"&&f.startsWith("ref:")?Ce(f.slice(4)):typeof f=="string"?f:f.name)),t.resources.llms[u]={name:m.name,...m.temperature!==void 0&&{temperature:m.temperature},...m.max_tokens!==void 0&&{max_tokens:m.max_tokens},...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user},...d&&d.length>0&&{fallbacks:d}}})),e.resources.vector_stores&&Object.keys(e.resources.vector_stores).length>0){const u=e.resources.volumes||{};t.resources.vector_stores={},Object.entries(e.resources.vector_stores).forEach(([m,d])=>{let f;if(d.source_table){const b=rr(d.source_table.schema,n,`resources.vector_stores.${m}.source_table.schema`);f={...b&&{schema:b},...d.source_table.name&&{name:d.source_table.name}}}let p;if(d.index&&d.index.name){const b=rr(d.index.schema,n,`resources.vector_stores.${m}.index.schema`);p={...b&&{schema:b},name:d.index.name}}let v;if(d.embedding_model){const b=Nn(`resources.vector_stores.${m}.embedding_model`,d.embedding_model);b?v=Ce(b):v=d.embedding_model}t.resources.vector_stores[m]={...f&&{source_table:f},embedding_source_column:d.embedding_source_column,...v&&{embedding_model:v},...p&&{index:p},...d.endpoint&&d.endpoint.name&&{endpoint:d.endpoint},...d.primary_key&&{primary_key:d.primary_key},...d.columns&&d.columns.length>0&&{columns:d.columns},...d.doc_uri&&{doc_uri:d.doc_uri},...d.source_path&&{source_path:up(d.source_path,u)},...d.checkpoint_path&&{checkpoint_path:up(d.checkpoint_path,u)},...d.on_behalf_of_user!==void 0&&{on_behalf_of_user:d.on_behalf_of_user}}})}e.resources.genie_rooms&&Object.keys(e.resources.genie_rooms).length>0&&(t.resources.genie_rooms={},Object.entries(e.resources.genie_rooms).forEach(([u,m])=>{const d=cp(m.space_id);let f=d;ip(d,"*")&&(f=Ce(d.substring(1))),t.resources.genie_rooms[u]={name:m.name,space_id:f,...m.description&&{description:m.description},...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user}}})),e.resources.tables&&Object.keys(e.resources.tables).length>0&&(t.resources.tables={},Object.entries(e.resources.tables).forEach(([u,m])=>{const d=rr(m.schema,n,`resources.tables.${u}.schema`);t.resources.tables[u]={...d&&{schema:d},...m.name&&{name:m.name},...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user}}})),e.resources.volumes&&Object.keys(e.resources.volumes).length>0&&(t.resources.volumes={},Object.entries(e.resources.volumes).forEach(([u,m])=>{const d=rr(m.schema,n,`resources.volumes.${u}.schema`);t.resources.volumes[u]={name:m.name,...d&&{schema:d},...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user}}})),e.resources.functions&&Object.keys(e.resources.functions).length>0&&(t.resources.functions={},Object.entries(e.resources.functions).forEach(([u,m])=>{const d=rr(m.schema,n,`resources.functions.${u}.schema`);t.resources.functions[u]={...d&&{schema:d},...m.name&&{name:m.name},...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user}}})),e.resources.warehouses&&Object.keys(e.resources.warehouses).length>0&&(t.resources.warehouses={},Object.entries(e.resources.warehouses).forEach(([u,m])=>{const d=cp(m.warehouse_id);let f=d;ip(d,"*")&&(f=Ce(d.substring(1))),t.resources.warehouses[u]={name:m.name,warehouse_id:f,...m.description&&{description:m.description},...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user}}})),e.resources.connections&&Object.keys(e.resources.connections).length>0&&(t.resources.connections={},Object.entries(e.resources.connections).forEach(([u,m])=>{t.resources.connections[u]={name:m.name,...m.on_behalf_of_user!==void 0&&{on_behalf_of_user:m.on_behalf_of_user}}})),e.resources.databases&&Object.keys(e.resources.databases).length>0&&(t.resources.databases={},Object.entries(e.resources.databases).forEach(([u,m])=>{t.resources.databases[u]=uu(m)}))}if(e.retrievers&&Object.keys(e.retrievers).length>0&&(t.retrievers={},Object.entries(e.retrievers).forEach(([u,m])=>{var v,b;let d;const f=Nn(`retrievers.${u}.vector_store`,m.vector_store);if(f)d=Ce(f);else{const x=((v=e.resources)==null?void 0:v.vector_stores)||{},h=(b=Object.entries(x).find(([,g])=>{var y,w,E,_;return g.embedding_source_column===((y=m.vector_store)==null?void 0:y.embedding_source_column)&&((w=g.source_table)==null?void 0:w.name)===((_=(E=m.vector_store)==null?void 0:E.source_table)==null?void 0:_.name)}))==null?void 0:b[0];h&&(d=Ce(h))}const p={vector_store:d||m.vector_store};if(m.columns&&m.columns.length>0&&(p.columns=m.columns),m.search_parameters){const x={num_results:m.search_parameters.num_results||10,query_type:m.search_parameters.query_type||"ANN"};m.search_parameters.filters&&Object.keys(m.search_parameters.filters).length>0&&(x.filters=m.search_parameters.filters),p.search_parameters=x}m.rerank&&(typeof m.rerank=="boolean"?p.rerank=m.rerank:p.rerank={...m.rerank.model&&{model:m.rerank.model},...m.rerank.top_n!==void 0&&{top_n:m.rerank.top_n},...m.rerank.cache_dir&&{cache_dir:m.rerank.cache_dir},...m.rerank.columns&&m.rerank.columns.length>0&&{columns:m.rerank.columns}}),t.retrievers[u]=p})),e.tools&&Object.keys(e.tools).length>0&&(t.tools={},Object.entries(e.tools).forEach(([u,m])=>{t.tools[u]={name:m.name,function:WS(m.function,u)}})),e.guardrails&&Object.keys(e.guardrails).length>0){const u=((l=e.resources)==null?void 0:l.llms)||{};t.guardrails={},Object.entries(e.guardrails).forEach(([m,d])=>{t.guardrails[m]={name:d.name,model:Ti(d.model,u),prompt:d.prompt,...d.num_retries!==void 0&&{num_retries:d.num_retries}}})}if(e.memory&&(t.memory={},e.memory.checkpointer&&(t.memory.checkpointer={name:e.memory.checkpointer.name,type:e.memory.checkpointer.type||"memory",...e.memory.checkpointer.database&&{database:uu(e.memory.checkpointer.database)}}),e.memory.store&&(t.memory.store={name:e.memory.store.name,type:e.memory.store.type||"memory",...e.memory.store.embedding_model&&{embedding_model:e.memory.store.embedding_model},...e.memory.store.dims&&{dims:e.memory.store.dims},...e.memory.store.database&&{database:uu(e.memory.store.database)},...e.memory.store.namespace&&{namespace:e.memory.store.namespace}})),e.prompts&&Object.keys(e.prompts).length>0&&(t.prompts={},Object.entries(e.prompts).forEach(([u,m])=>{let d;if(m.service_principal)if(typeof m.service_principal=="string"){const f=m.service_principal.startsWith("*")?m.service_principal.slice(1):m.service_principal;d=Ce(f)}else d={client_id:st(m.service_principal.client_id),client_secret:st(m.service_principal.client_secret)};t.prompts[u]={name:m.name,...m.schema&&{schema:rr(m.schema,n)},...m.description&&{description:m.description},...m.default_template&&{default_template:m.default_template},...m.alias&&{alias:m.alias},...m.version!==void 0&&{version:m.version},...m.tags&&Object.keys(m.tags).length>0&&{tags:m.tags},...d&&{service_principal:d}}})),e.agents&&Object.keys(e.agents).length>0){const u=((o=e.resources)==null?void 0:o.llms)||{},m=e.prompts||{},d=e.tools||{},f=e.guardrails||{};t.agents={},Object.entries(e.agents).forEach(([p,v])=>{var g;let b=v.prompt;if(v.prompt&&typeof v.prompt=="object"&&"name"in v.prompt){const y=v.prompt,w=(g=Object.entries(m).find(([,E])=>E.name===y.name))==null?void 0:g[0];w&&(b=Ce(w))}let x;v.tools&&v.tools.length>0&&(x=v.tools.map((y,w)=>{const E=Nn(`agents.${p}.tools.${w}`,y);if(E)return Ce(E);const _=typeof y=="string"?y:y.name,S=Object.entries(d).find(([,k])=>k.name===_),N=S?S[0]:_;return Ce(N)}));let h;v.guardrails&&v.guardrails.length>0&&(h=v.guardrails.map((y,w)=>{const E=Nn(`agents.${p}.guardrails.${w}`,y);if(E)return Ce(E);const _=typeof y=="string"?y:y.name,S=Object.entries(f).find(([,k])=>k.name===_),N=S?S[0]:_;return Ce(N)})),t.agents[p]={name:v.name,model:Ti(v.model,u),...v.description&&{description:v.description},...x&&x.length>0&&{tools:x},...h&&h.length>0&&{guardrails:h},...b&&{prompt:b},...v.handoff_prompt&&{handoff_prompt:v.handoff_prompt}}})}if(e.app&&e.app.name&&((i=e.app.registered_model)!=null&&i.name)){const u=e.agents||{};let m;e.app.agents&&e.app.agents.length>0&&(m=e.app.agents.map((p,v)=>{const b=Nn(`app.agents.${v}`,p);if(b)return Ce(b);const x=typeof p=="string"?p:p.name,h=Object.entries(u).find(([,y])=>y.name===x),g=h?h[0]:x;return Ce(g)}));let d={name:e.app.registered_model.name};if(e.app.registered_model.schema){const p=rr(e.app.registered_model.schema,n,"app.registered_model.schema");p&&(d.schema=p)}let f;if(e.app.service_principal)if(typeof e.app.service_principal=="string"){const p=e.app.service_principal.startsWith("*")?e.app.service_principal.slice(1):e.app.service_principal;f=Ce(p)}else f={client_id:st(e.app.service_principal.client_id),client_secret:st(e.app.service_principal.client_secret)};if(t.app={name:e.app.name,registered_model:d,...e.app.description&&{description:e.app.description},...e.app.log_level&&{log_level:e.app.log_level},...f&&{service_principal:f},...e.app.endpoint_name&&{endpoint_name:e.app.endpoint_name},...e.app.tags&&{tags:e.app.tags},...e.app.permissions&&{permissions:e.app.permissions},...m&&m.length>0&&{agents:m}},e.app.orchestration){const p=((c=e.resources)==null?void 0:c.llms)||{},v=e.tools||{};t.app.orchestration=BS(e.app.orchestration,p,v)}}let a=sl.dump(t,{indent:2,lineWidth:-1,noRefs:!0,sortKeys:!1,quotingType:'"'});return a=HS(a),a=US(a),a}function GS(e,t="model_config.yaml"){const n=qm(e),r=new Blob([n],{type:"text/yaml"}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)}async function dp(e){try{const t=qm(e);return await qS(t)}catch(t){return{valid:!1,errors:[],schemaError:t instanceof Error?t.message:"Validation failed"}}}async function qS(e){try{const t=await fetch("/api/validate/schema",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({yaml_content:e})});if(!t.ok){const r=await t.json().catch(()=>({error:t.statusText}));return{valid:!1,errors:[],schemaError:r.error||`Validation request failed: ${t.status}`}}const n=await t.json();return{valid:n.valid,errors:(n.errors||[]).map(r=>({path:r.path||"/",message:r.message||"Unknown validation error",keyword:r.type||"validation"})),warnings:(n.warnings||[]).map(r=>({path:r.path||"/",message:r.message||"Unknown warning",keyword:r.type||"warning"}))}}catch(t){return{valid:!1,errors:[],schemaError:t instanceof Error?t.message:"Validation request failed"}}}async function XS(){}function QS(e=500){const{config:t}=Oe(),[n,r]=R.useState(null),[a,l]=R.useState(!1),[o,i]=R.useState(!1),c=R.useRef(null);R.useEffect(()=>{XS().then(()=>{i(!0)})},[]),R.useEffect(()=>{if(o)return c.current&&clearTimeout(c.current),c.current=setTimeout(async()=>{l(!0);try{const m=await dp(t);r(m)}catch(m){r({valid:!1,errors:[],schemaError:m instanceof Error?m.message:"Validation failed"})}finally{l(!1)}},e),()=>{c.current&&clearTimeout(c.current)}},[t,o,e]);const u=R.useCallback(async()=>{l(!0);try{const m=await dp(t);return r(m),m}catch(m){const d={valid:!1,errors:[],schemaError:m instanceof Error?m.message:"Validation failed"};return r(d),d}finally{l(!1)}},[t]);return{validationResult:n,isValidating:a,schemaReady:o,validate:u,isValid:(n==null?void 0:n.valid)??null,errors:(n==null?void 0:n.errors)??[],schemaError:n==null?void 0:n.schemaError}}function KS(){const{config:e,setConfig:t}=Oe(),[n,r]=R.useState(!1),[a,l]=R.useState(!0),[o,i]=R.useState(!0),[c,u]=R.useState(""),[m,d]=R.useState(null),[f,p]=R.useState(!1),v=R.useRef(null),b=R.useRef(null),{isValid:x,errors:h,schemaError:g,isValidating:y,schemaReady:w}=QS(800),E=qm(e);R.useEffect(()=>{o&&(u(E),d(null),p(!1))},[E,o]),R.useEffect(()=>{c||u(E)},[E,c]);const _=R.useCallback(()=>{v.current&&b.current&&(b.current.scrollTop=v.current.scrollTop)},[]),S=async()=>{await navigator.clipboard.writeText(o?E:c),r(!0),setTimeout(()=>r(!1),2e3)},N=P=>{var M;u(P),p(P!==E);try{sl.load(P),d(null)}catch(D){D instanceof sl.YAMLException&&d({line:(M=D.mark)!=null&&M.line?D.mark.line+1:0,message:D.message})}},k=()=>{if(!m)try{const P=Lv(c);$v(P);const M=sl.load(c);t(M),p(!1),i(!0)}catch(P){console.error("Failed to apply YAML changes:",P)}},A=()=>{u(E),d(null),p(!1)},C=()=>{if(!o&&f){if(!confirm("You have unsaved changes. Discard them?"))return;A()}i(!o)},F=(()=>{const P=new Set;return m!=null&&m.line&&P.add(m.line),P})(),j=P=>P.split(`
`).map((D,V)=>{const B=V+1,K=F.has(B);return s.jsx("div",{className:`text-right pr-3 select-none ${K?"bg-red-500/20 text-red-400 font-bold":"text-slate-600"}`,style:{height:"1.5rem",lineHeight:"1.5rem"},children:B},V)}),T=P=>P.split(`
`).map((M,D)=>{const V=D+1,B=F.has(V);let K;if(M.trim().startsWith("#"))K=s.jsx("span",{className:"text-slate-500",children:M});else if(M.match(/^(\s*)([a-zA-Z_][a-zA-Z0-9_]*):(.*)$/)){const J=M.match(/^(\s*)([a-zA-Z_][a-zA-Z0-9_]*):(.*)$/),[,ae,U,Y]=J;K=s.jsxs("span",{children:[ae,s.jsx("span",{className:"text-blue-400",children:U}),s.jsx("span",{className:"text-slate-400",children:":"}),s.jsx("span",{className:"text-emerald-400",children:Y})]})}else M.trim().startsWith("-")?K=s.jsx("span",{className:"text-amber-400",children:M}):K=s.jsx("span",{className:"text-slate-300",children:M});return s.jsx("div",{className:`px-2 -mx-2 ${B?"bg-red-500/20 border-l-2 border-red-500":"hover:bg-slate-800/30"}`,style:{height:"1.5rem",lineHeight:"1.5rem"},children:K},D)}),I=()=>!o&&m?s.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[s.jsx(cn,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-xs",children:["YAML Error (line ",m.line,")"]})]}):w?y?s.jsxs("div",{className:"flex items-center space-x-2 text-slate-400",children:[s.jsx(dt,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-xs",children:"Validating..."})]}):g?s.jsxs("div",{className:"flex items-center space-x-2 text-amber-400",children:[s.jsx(wi,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs",title:g,children:"Schema error"})]}):x===!0?s.jsxs("div",{className:"flex items-center space-x-2 text-emerald-400",children:[s.jsx(W1,{className:"w-4 h-4"}),s.jsx("span",{className:"text-xs",children:"Valid"})]}):x===!1?s.jsxs("button",{onClick:()=>l(!a),className:"flex items-center space-x-2 text-red-400 hover:text-red-300 transition-colors",children:[s.jsx(cn,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-xs",children:[h.length," error",h.length!==1?"s":""]}),a?s.jsx(Yl,{className:"w-3 h-3"}):s.jsx(Ns,{className:"w-3 h-3"})]}):null:s.jsxs("div",{className:"flex items-center space-x-2 text-slate-400",children:[s.jsx(dt,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{className:"text-xs",children:"Loading schema..."})]}),$=o?E:c;return s.jsxs("div",{className:"h-full flex flex-col bg-slate-950",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-800",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Fm,{className:"w-4 h-4 text-slate-400"}),s.jsxs("span",{className:"text-sm font-medium text-slate-300",children:["YAML ",o?"Preview":"Editor"]}),!o&&f&&s.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-amber-500/20 text-amber-400 rounded",children:"Modified"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[I(),s.jsx(Q,{variant:"ghost",size:"sm",onClick:C,title:o?"Unlock to edit YAML":"Lock to prevent edits",className:o?"":"text-amber-400 hover:text-amber-300",children:o?s.jsxs(s.Fragment,{children:[s.jsx(zm,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Locked"})]}):s.jsxs(s.Fragment,{children:[s.jsx(aw,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Editing"})]})}),s.jsx(Q,{variant:"ghost",size:"sm",onClick:S,children:n?s.jsxs(s.Fragment,{children:[s.jsx(_i,{className:"w-4 h-4 text-emerald-400"}),s.jsx("span",{className:"text-emerald-400",children:"Copied!"})]}):s.jsxs(s.Fragment,{children:[s.jsx(X1,{className:"w-4 h-4"}),"Copy"]})})]})]}),!o&&s.jsx("div",{className:"px-4 py-2 bg-amber-950/30 border-b border-amber-900/50",children:s.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-400",children:[s.jsx(Dm,{className:"w-3 h-3"}),s.jsx("span",{children:"Edit mode: Changes here will update the UI configuration when applied"})]})}),!o&&m&&s.jsx("div",{className:"border-b border-slate-800 bg-red-950/30 px-4 py-2",children:s.jsxs("div",{className:"text-xs flex items-start space-x-2",children:[s.jsxs("span",{className:"text-red-400 font-mono shrink-0",children:["Line ",m.line,":"]}),s.jsx("span",{className:"text-red-300",children:m.message})]})}),x===!1&&a&&h.length>0&&!m&&s.jsx("div",{className:"border-b border-slate-800 bg-red-950/30 max-h-48 overflow-auto",children:s.jsx("div",{className:"px-4 py-2 space-y-1",children:h.map((P,M)=>s.jsxs("div",{className:"text-xs flex items-start space-x-2",children:[s.jsx("span",{className:"text-red-400 font-mono shrink-0",children:P.path||"/"}),s.jsx("span",{className:"text-red-300",children:P.message})]},M))})}),g&&s.jsxs("div",{className:"border-b border-slate-800 bg-amber-950/30 px-4 py-2",children:[s.jsxs("p",{className:"text-xs text-amber-400",children:[s.jsx("strong",{children:"Schema Error:"})," ",g]}),s.jsx("p",{className:"text-xs text-amber-500 mt-1",children:"Validation is unavailable. The YAML may still be valid."})]}),s.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[s.jsx("div",{ref:b,className:"w-12 bg-slate-900/50 border-r border-slate-800 overflow-hidden font-mono text-sm",style:{lineHeight:"1.5rem"},children:s.jsx("div",{className:"py-4",children:j($)})}),s.jsx("div",{className:"flex-1 overflow-auto",children:o?s.jsx("pre",{className:"code-block text-sm p-4",style:{lineHeight:"1.5rem"},children:T($)}):s.jsx("textarea",{ref:v,value:c,onChange:P=>N(P.target.value),onScroll:_,spellCheck:!1,className:"w-full h-full p-4 bg-transparent text-slate-300 font-mono text-sm resize-none focus:outline-none",style:{lineHeight:"1.5rem",tabSize:2}})})]}),s.jsx("div",{className:"px-4 py-3 border-t border-slate-800 bg-slate-900/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-xs text-slate-500",children:[$.split(`
`).length," lines  ",o?"Auto-updates as you configure":"Editing manually"]}),!o&&f?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Q,{variant:"ghost",size:"sm",onClick:A,children:"Discard"}),s.jsxs(Q,{variant:"primary",size:"sm",onClick:k,disabled:!!m,children:[s.jsx(_i,{className:"w-4 h-4"}),"Apply Changes"]})]}):w&&!g&&s.jsx("p",{className:"text-xs text-slate-600",children:"Validated against dao-ai schema"})]})})]})}function _o({isOpen:e,onClose:t,onConfigured:n,autoDetectedHost:r,inDatabricksApp:a=!1,hasOboToken:l=!1,oauthInfo:o}){const[i,c]=R.useState(""),[u,m]=R.useState(""),[d,f]=R.useState(!1),[p,v]=R.useState(!1),[b,x]=R.useState(null),h=dr();R.useEffect(()=>{if(e){const N=dr();N?(c(N.host),m(N.token)):r&&c(r),x(null)}},[e,r]);const g=async()=>{if(u){f(!0),x(null);try{console.log("[DatabricksConfigModal] Testing manual token...");const N=await fetch("/api/auth/verify",{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json","X-Databricks-Host":(i||r||"").replace(/\/$/,"")},credentials:"include"}),k=await N.json();if(console.log("[DatabricksConfigModal] Verify response:",k),k.authenticated&&k.user){const A=k.token_source==="manual"?"Personal Access Token":k.token_source==="obo"?"On-Behalf-Of User":k.token_source==="oauth"?"OAuth":k.token_source==="sdk"?"SDK Config":k.token_source==="env"?"Environment Variable":k.token_source;Ba({host:k.host||i||r||"",token:u,source:"manual"}),x({success:!0,message:`Connected as ${k.user.displayName||k.user.userName}`,tokenSource:A})}else{const A=k.error||k.message||k.help||`Connection failed (${N.status}): ${N.statusText||"Unknown error"}`;x({success:!1,message:A,requiredScopes:k.required_scopes})}}catch(N){const k=N instanceof Error?`${N.name}: ${N.message}`:"Connection failed - unknown error";x({success:!1,message:k})}finally{f(!1)}}else{f(!0),x(null);try{const k=await(await fetch("/api/auth/verify",{credentials:"include"})).json();k.authenticated&&k.user?(Ba({host:k.host||r||"",token:`__${(k.token_source||"AUTO").toUpperCase()}_TOKEN__`,isAutoDetected:!0,source:k.token_source}),x({success:!0,message:`Connected as ${k.user.displayName||k.user.userName}`})):x({success:!1,message:k.error||k.help||"Authentication failed",requiredScopes:k.required_scopes})}catch(N){const k=N instanceof Error?`${N.name}: ${N.message}`:"Connection failed - unknown error";x({success:!1,message:k})}finally{f(!1)}}},y=()=>{if(u)Ba({host:i||r||"",token:u,source:"manual"});else if(b!=null&&b.success){const N=dr();N&&Ba(N)}else return;n(),t()},w=async()=>{(h==null?void 0:h.source)==="oauth"&&await vw(),Hg(),c(r||""),m(""),x(null),n(),t()},E=async()=>{v(!0),x(null);try{const k=await gw(i||r||void 0);k.auth_url&&k.redirect?window.location.href=k.auth_url:k.error&&x({success:!1,message:k.message||k.error})}catch(N){x({success:!1,message:N instanceof Error?N.message:"OAuth login failed"})}finally{v(!1)}},_=N=>{switch(N){case"oauth":return"OAuth";case"obo":return"On-Behalf-Of User";case"header":return"On-Behalf-Of User Auth";case"sdk":return"Databricks SDK Config";case"env":return"Environment Variables";case"manual":return"Manual Configuration";default:return"Unknown"}},S=N=>{switch(N){case"oauth":return xd;case"obo":case"header":return Xs;case"sdk":case"env":return _l;default:return ki}};return s.jsx(En,{isOpen:e,onClose:t,title:"Databricks Connection",description:"Configure your Databricks workspace connection.",children:s.jsxs("div",{className:"space-y-4",children:[a&&l&&(h==null?void 0:h.source)==="obo"&&s.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(Xs,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"text-blue-300 font-medium",children:"On-Behalf-Of User Authentication Active"}),s.jsx("p",{className:"text-blue-400/80 mt-1",children:"API calls are authenticated using your Databricks session. No manual token required."})]})]})}),a&&!l&&!h&&s.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(wi,{className:"w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"text-amber-300 font-medium",children:"On-Behalf-Of User Auth Not Enabled"}),s.jsx("p",{className:"text-amber-400/80 mt-1",children:"This app is running in Databricks but OBO auth is not enabled. You can still configure a Personal Access Token manually."})]})]})}),(h==null?void 0:h.isAutoDetected)&&h.source!=="obo"&&s.jsx("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[(()=>{const N=S(h.source);return s.jsx(N,{className:"w-5 h-5 text-green-400 mt-0.5 flex-shrink-0"})})(),s.jsxs("div",{className:"text-sm",children:[s.jsxs("p",{className:"text-green-300 font-medium",children:["Connected via ",_(h.source)]}),s.jsx("p",{className:"text-green-400/80 mt-1",children:h.source==="oauth"?"Authenticated via OAuth. Your session is secure.":h.source==="sdk"?"Using Databricks SDK Config (~/.databrickscfg or environment variables).":h.source==="env"?"Using DATABRICKS_HOST and DATABRICKS_TOKEN environment variables.":"Using X-Forwarded-Access-Token from Databricks App proxy."}),h.host&&s.jsxs("p",{className:"text-green-400/60 mt-1 font-mono text-xs",children:["Host: ",h.host]})]})]})}),(o==null?void 0:o.configured)&&!h&&s.jsx("div",{className:"p-4 rounded-lg bg-gradient-to-r from-blue-600/20 to-purple-600/20 border border-blue-500/30",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(xd,{className:"w-6 h-6 text-blue-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-300 font-medium",children:"Login with Databricks"}),s.jsx("p",{className:"text-blue-400/80 text-sm mt-1",children:"Securely authenticate with OAuth to access Databricks APIs."}),o.scopes&&o.scopes.length>0&&s.jsxs("p",{className:"text-blue-400/60 text-xs mt-2",children:["Scopes: ",o.scopes.slice(0,3).join(", "),o.scopes.length>3&&` +${o.scopes.length-3} more`]})]})]}),s.jsx(Q,{type:"button",onClick:E,disabled:p||!i,className:"flex items-center space-x-2",children:p?"Redirecting...":s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Login"}),s.jsx(Q1,{className:"w-4 h-4"})]})})]})}),r&&!h&&s.jsx("div",{className:"p-3 rounded-lg bg-blue-500/10 border border-blue-500/20",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(ki,{className:"w-5 h-5 text-blue-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"text-blue-300 font-medium",children:"Workspace Detected"}),s.jsxs("p",{className:"text-blue-400/80 mt-1",children:["Host auto-detected. Enter your Personal Access Token or set ",s.jsx("code",{className:"text-xs bg-blue-900/50 px-1 rounded",children:"DATABRICKS_TOKEN"})," env var."]})]})]})}),s.jsx(re,{label:"Workspace URL",placeholder:"https://your-workspace.cloud.databricks.com",value:i,onChange:N=>c(N.target.value),hint:r?"Auto-detected from URL (editable)":"Your Databricks workspace URL",required:!0}),s.jsx(re,{label:"Personal Access Token",type:"password",placeholder:"dapi...",value:u,onChange:N=>m(N.target.value),hint:"Or set DATABRICKS_TOKEN environment variable",required:!0}),!(h!=null&&h.isAutoDetected)&&s.jsx("div",{className:"p-3 rounded-lg bg-slate-800/50 border border-slate-700",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(wi,{className:"w-5 h-5 text-slate-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"text-sm text-slate-400",children:[s.jsx("p",{className:"font-medium text-slate-300",children:"Authentication Options"}),s.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-xs",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"On-behalf-of-user auth"})," - Automatic in Databricks Apps"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Personal Access Token"})," - Enter manually below"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Environment variable"})," - Set ",s.jsx("code",{className:"bg-slate-700 px-1 rounded",children:"DATABRICKS_TOKEN"})]})]}),s.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[s.jsx("strong",{children:"Scope errors?"})," If using OBO auth, try signing out of Databricks and signing back in to re-authorize the app with updated scopes."]})]})]})}),b&&s.jsxs("div",{className:`p-3 rounded-lg text-sm ${b.success?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{children:b.message}),b.success&&b.tokenSource&&s.jsxs("span",{className:"text-xs bg-green-900/30 px-2 py-0.5 rounded",children:["via ",b.tokenSource]})]}),b.requiredScopes&&b.requiredScopes.length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-red-500/20",children:[s.jsx("p",{className:"font-medium mb-1",children:"Required scopes:"}),s.jsx("ul",{className:"list-disc list-inside text-xs space-y-0.5",children:b.requiredScopes.map(N=>s.jsx("li",{children:s.jsx("code",{className:"bg-red-900/30 px-1 rounded",children:N})},N))}),s.jsxs("p",{className:"mt-2 text-xs text-red-300/80",children:["Add these to ",s.jsx("code",{className:"bg-red-900/30 px-1 rounded",children:"user_api_scopes"})," in databricks.yml and redeploy."]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsx(Q,{variant:"danger",type:"button",onClick:w,disabled:!dr(),children:"Disconnect"}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx(Q,{variant:"secondary",type:"button",onClick:g,disabled:d||!u&&!l&&!a,children:d?"Testing...":"Test Connection"}),s.jsx(Q,{type:"button",onClick:y,disabled:!(b!=null&&b.success),children:"Save"})]})]}),s.jsx("div",{className:"pt-4 border-t border-slate-700",children:s.jsx("p",{className:"text-xs text-slate-500",children:"Credentials are stored in browser localStorage and sent only to your Databricks workspace."})})]})})}function ZS(){const[e,t]=R.useState(!1),{detecting:n,detected:r,autoDetectedHost:a,inDatabricksApp:l,hasToken:o,oauthInfo:i,redetect:c}=ww(),{data:u,loading:m,error:d,refetch:f,configured:p}=_w(),v=R.useCallback(()=>{console.log("[ConnectionStatus] Config changed, re-detecting and refetching..."),c(),f()},[f,c]);if(R.useEffect(()=>{!n&&r&&f()},[n,r,f]),n)return s.jsxs("div",{className:"flex items-center space-x-2 text-slate-400",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"}),s.jsx("span",{className:"text-sm",children:"Detecting..."})]});if(!p)return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 text-slate-400 hover:text-white transition-colors",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-500"}),s.jsx("span",{className:"text-sm",children:a?"Token required":"Not connected"}),s.jsx(Qn,{className:"w-4 h-4"})]}),s.jsx(_o,{isOpen:e,onClose:()=>t(!1),onConfigured:v,autoDetectedHost:a,oauthInfo:i})]});if(m)return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 text-slate-400",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-yellow-500 animate-pulse"}),s.jsx("span",{className:"text-sm",children:"Connecting..."}),s.jsx(Qn,{className:"w-4 h-4"})]}),s.jsx(_o,{isOpen:e,onClose:()=>t(!1),onConfigured:v,autoDetectedHost:a,oauthInfo:i})]});if(d||!(u!=null&&u.connected))return console.log("[ConnectionStatus] Showing failed state - error:",d,"status:",u),s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 text-red-400 hover:text-red-300 transition-colors",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),s.jsxs("span",{className:"text-sm",children:["Connection failed",u!=null&&u.error?`: ${u.error}`:""]}),s.jsx(Qn,{className:"w-4 h-4"})]}),s.jsx(_o,{isOpen:e,onClose:()=>t(!1),onConfigured:v,autoDetectedHost:a,oauthInfo:i})]});const b=u.source==="oauth"?"OAuth":u.source==="obo"?"On-Behalf-Of User":u.source==="sdk"?"SDK Config":u.source==="env"?"Environment":"Manual",h=u.source==="oauth"?xd:u.source==="obo"?Xs:ki;return s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 hover:bg-slate-800 px-2 py-1 rounded transition-colors",title:`Connected via ${b} authentication`,children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),u.isAutoDetected&&s.jsx(h,{className:`w-3 h-3 ${u.source==="obo"?"text-blue-400":"text-yellow-400"}`}),s.jsx("span",{className:"text-sm text-slate-300",children:s.jsx("span",{className:"text-white font-medium",children:u.display_name||u.user})}),s.jsx(Qn,{className:"w-4 h-4 text-slate-500"})]}),s.jsx(_o,{isOpen:e,onClose:()=>t(!1),onConfigured:v,autoDetectedHost:a,inDatabricksApp:l,hasOboToken:o,oauthInfo:i})]})}function et(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=et(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var JS={value:()=>{}};function cc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new qo(n)}function qo(e){this._=e}function ek(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");if(a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}qo.prototype=cc.prototype={constructor:qo,on:function(e,t){var n=this._,r=ek(e+"",n),a,l=-1,o=r.length;if(arguments.length<2){for(;++l<o;)if((a=(e=r[l]).type)&&(a=tk(n[a],e.name)))return a;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<o;)if(a=(e=r[l]).type)n[a]=mp(n[a],e.name,t);else if(t==null)for(a in n)n[a]=mp(n[a],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new qo(e)},call:function(e,t){if((a=arguments.length-2)>0)for(var n=new Array(a),r=0,a,l;r<a;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],r=0,a=l.length;r<a;++r)l[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,l=r.length;a<l;++a)r[a].value.apply(t,n)}};function tk(e,t){for(var n=0,r=e.length,a;n<r;++n)if((a=e[n]).name===t)return a.value}function mp(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=JS,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ad="http://www.w3.org/1999/xhtml";const fp={svg:"http://www.w3.org/2000/svg",xhtml:Ad,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function uc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),fp.hasOwnProperty(t)?{space:fp[t],local:e}:e}function nk(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ad&&t.documentElement.namespaceURI===Ad?t.createElement(e):t.createElementNS(n,e)}}function sk(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Fv(e){var t=uc(e);return(t.local?sk:nk)(t)}function rk(){}function Xm(e){return e==null?rk:function(){return this.querySelector(e)}}function ak(e){typeof e!="function"&&(e=Xm(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var l=t[a],o=l.length,i=r[a]=new Array(o),c,u,m=0;m<o;++m)(c=l[m])&&(u=e.call(c,c.__data__,m,l))&&("__data__"in c&&(u.__data__=c.__data__),i[m]=u);return new Zt(r,this._parents)}function lk(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function ok(){return[]}function zv(e){return e==null?ok:function(){return this.querySelectorAll(e)}}function ik(e){return function(){return lk(e.apply(this,arguments))}}function ck(e){typeof e=="function"?e=ik(e):e=zv(e);for(var t=this._groups,n=t.length,r=[],a=[],l=0;l<n;++l)for(var o=t[l],i=o.length,c,u=0;u<i;++u)(c=o[u])&&(r.push(e.call(c,c.__data__,u,o)),a.push(c));return new Zt(r,a)}function Vv(e){return function(){return this.matches(e)}}function Hv(e){return function(t){return t.matches(e)}}var uk=Array.prototype.find;function dk(e){return function(){return uk.call(this.children,e)}}function mk(){return this.firstElementChild}function fk(e){return this.select(e==null?mk:dk(typeof e=="function"?e:Hv(e)))}var hk=Array.prototype.filter;function pk(){return Array.from(this.children)}function xk(e){return function(){return hk.call(this.children,e)}}function gk(e){return this.selectAll(e==null?pk:xk(typeof e=="function"?e:Hv(e)))}function vk(e){typeof e!="function"&&(e=Vv(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var l=t[a],o=l.length,i=r[a]=[],c,u=0;u<o;++u)(c=l[u])&&e.call(c,c.__data__,u,l)&&i.push(c);return new Zt(r,this._parents)}function Uv(e){return new Array(e.length)}function yk(){return new Zt(this._enter||this._groups.map(Uv),this._parents)}function Oi(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Oi.prototype={constructor:Oi,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function bk(e){return function(){return e}}function Nk(e,t,n,r,a,l){for(var o=0,i,c=t.length,u=l.length;o<u;++o)(i=t[o])?(i.__data__=l[o],r[o]=i):n[o]=new Oi(e,l[o]);for(;o<c;++o)(i=t[o])&&(a[o]=i)}function jk(e,t,n,r,a,l,o){var i,c,u=new Map,m=t.length,d=l.length,f=new Array(m),p;for(i=0;i<m;++i)(c=t[i])&&(f[i]=p=o.call(c,c.__data__,i,t)+"",u.has(p)?a[i]=c:u.set(p,c));for(i=0;i<d;++i)p=o.call(e,l[i],i,l)+"",(c=u.get(p))?(r[i]=c,c.__data__=l[i],u.delete(p)):n[i]=new Oi(e,l[i]);for(i=0;i<m;++i)(c=t[i])&&u.get(f[i])===c&&(a[i]=c)}function wk(e){return e.__data__}function _k(e,t){if(!arguments.length)return Array.from(this,wk);var n=t?jk:Nk,r=this._parents,a=this._groups;typeof e!="function"&&(e=bk(e));for(var l=a.length,o=new Array(l),i=new Array(l),c=new Array(l),u=0;u<l;++u){var m=r[u],d=a[u],f=d.length,p=Sk(e.call(m,m&&m.__data__,u,r)),v=p.length,b=i[u]=new Array(v),x=o[u]=new Array(v),h=c[u]=new Array(f);n(m,d,b,x,h,p,t);for(var g=0,y=0,w,E;g<v;++g)if(w=b[g]){for(g>=y&&(y=g+1);!(E=x[y])&&++y<v;);w._next=E||null}}return o=new Zt(o,r),o._enter=i,o._exit=c,o}function Sk(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kk(){return new Zt(this._exit||this._groups.map(Uv),this._parents)}function Ck(e,t,n){var r=this.enter(),a=this,l=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(a=t(a),a&&(a=a.selection())),n==null?l.remove():n(l),r&&a?r.merge(a).order():a}function Ek(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,a=n.length,l=r.length,o=Math.min(a,l),i=new Array(a),c=0;c<o;++c)for(var u=n[c],m=r[c],d=u.length,f=i[c]=new Array(d),p,v=0;v<d;++v)(p=u[v]||m[v])&&(f[v]=p);for(;c<a;++c)i[c]=n[c];return new Zt(i,this._parents)}function Ak(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],a=r.length-1,l=r[a],o;--a>=0;)(o=r[a])&&(l&&o.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(o,l),l=o);return this}function Pk(e){e||(e=Rk);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,a=new Array(r),l=0;l<r;++l){for(var o=n[l],i=o.length,c=a[l]=new Array(i),u,m=0;m<i;++m)(u=o[m])&&(c[m]=u);c.sort(t)}return new Zt(a,this._parents).order()}function Rk(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Mk(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Tk(){return Array.from(this)}function Ok(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,l=r.length;a<l;++a){var o=r[a];if(o)return o}return null}function Ik(){let e=0;for(const t of this)++e;return e}function Lk(){return!this.node()}function $k(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a=t[n],l=0,o=a.length,i;l<o;++l)(i=a[l])&&e.call(i,i.__data__,l,a);return this}function Dk(e){return function(){this.removeAttribute(e)}}function Fk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zk(e,t){return function(){this.setAttribute(e,t)}}function Vk(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Hk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Uk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Bk(e,t){var n=uc(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?Fk:Dk:typeof t=="function"?n.local?Uk:Hk:n.local?Vk:zk)(n,t))}function Bv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Yk(e){return function(){this.style.removeProperty(e)}}function Wk(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Gk(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function qk(e,t,n){return arguments.length>1?this.each((t==null?Yk:typeof t=="function"?Gk:Wk)(e,t,n??"")):ya(this.node(),e)}function ya(e,t){return e.style.getPropertyValue(t)||Bv(e).getComputedStyle(e,null).getPropertyValue(t)}function Xk(e){return function(){delete this[e]}}function Qk(e,t){return function(){this[e]=t}}function Kk(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Zk(e,t){return arguments.length>1?this.each((t==null?Xk:typeof t=="function"?Kk:Qk)(e,t)):this.node()[e]}function Yv(e){return e.trim().split(/^|\s+/)}function Qm(e){return e.classList||new Wv(e)}function Wv(e){this._node=e,this._names=Yv(e.getAttribute("class")||"")}Wv.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Gv(e,t){for(var n=Qm(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function qv(e,t){for(var n=Qm(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function Jk(e){return function(){Gv(this,e)}}function eC(e){return function(){qv(this,e)}}function tC(e,t){return function(){(t.apply(this,arguments)?Gv:qv)(this,e)}}function nC(e,t){var n=Yv(e+"");if(arguments.length<2){for(var r=Qm(this.node()),a=-1,l=n.length;++a<l;)if(!r.contains(n[a]))return!1;return!0}return this.each((typeof t=="function"?tC:t?Jk:eC)(n,t))}function sC(){this.textContent=""}function rC(e){return function(){this.textContent=e}}function aC(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function lC(e){return arguments.length?this.each(e==null?sC:(typeof e=="function"?aC:rC)(e)):this.node().textContent}function oC(){this.innerHTML=""}function iC(e){return function(){this.innerHTML=e}}function cC(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function uC(e){return arguments.length?this.each(e==null?oC:(typeof e=="function"?cC:iC)(e)):this.node().innerHTML}function dC(){this.nextSibling&&this.parentNode.appendChild(this)}function mC(){return this.each(dC)}function fC(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hC(){return this.each(fC)}function pC(e){var t=typeof e=="function"?e:Fv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function xC(){return null}function gC(e,t){var n=typeof e=="function"?e:Fv(e),r=t==null?xC:typeof t=="function"?t:Xm(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function vC(){var e=this.parentNode;e&&e.removeChild(this)}function yC(){return this.each(vC)}function bC(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function NC(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function jC(e){return this.select(e?NC:bC)}function wC(e){return arguments.length?this.property("__data__",e):this.node().__data__}function _C(e){return function(t){e.call(this,t,this.__data__)}}function SC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function kC(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,a=t.length,l;n<a;++n)l=t[n],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++r]=l;++r?t.length=r:delete this.__on}}}function CC(e,t,n){return function(){var r=this.__on,a,l=_C(t);if(r){for(var o=0,i=r.length;o<i;++o)if((a=r[o]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=l,a.options=n),a.value=t;return}}this.addEventListener(e.type,l,n),a={type:e.type,name:e.name,value:t,listener:l,options:n},r?r.push(a):this.__on=[a]}}function EC(e,t,n){var r=SC(e+""),a,l=r.length,o;if(arguments.length<2){var i=this.node().__on;if(i){for(var c=0,u=i.length,m;c<u;++c)for(a=0,m=i[c];a<l;++a)if((o=r[a]).type===m.type&&o.name===m.name)return m.value}return}for(i=t?CC:kC,a=0;a<l;++a)this.each(i(r[a],t,n));return this}function Xv(e,t,n){var r=Bv(e),a=r.CustomEvent;typeof a=="function"?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function AC(e,t){return function(){return Xv(this,e,t)}}function PC(e,t){return function(){return Xv(this,e,t.apply(this,arguments))}}function RC(e,t){return this.each((typeof t=="function"?PC:AC)(e,t))}function*MC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,l=r.length,o;a<l;++a)(o=r[a])&&(yield o)}var Qv=[null];function Zt(e,t){this._groups=e,this._parents=t}function ql(){return new Zt([[document.documentElement]],Qv)}function TC(){return this}Zt.prototype=ql.prototype={constructor:Zt,select:ak,selectAll:ck,selectChild:fk,selectChildren:gk,filter:vk,data:_k,enter:yk,exit:kk,join:Ck,merge:Ek,selection:TC,order:Ak,sort:Pk,call:Mk,nodes:Tk,node:Ok,size:Ik,empty:Lk,each:$k,attr:Bk,style:qk,property:Zk,classed:nC,text:lC,html:uC,raise:mC,lower:hC,append:pC,insert:gC,remove:yC,clone:jC,datum:wC,on:EC,dispatch:RC,[Symbol.iterator]:MC};function Gt(e){return typeof e=="string"?new Zt([[document.querySelector(e)]],[document.documentElement]):new Zt([[e]],Qv)}function OC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function yn(e,t){if(e=OC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]}const IC={passive:!1},Pl={capture:!0,passive:!1};function du(e){e.stopImmediatePropagation()}function oa(e){e.preventDefault(),e.stopImmediatePropagation()}function Kv(e){var t=e.document.documentElement,n=Gt(e).on("dragstart.drag",oa,Pl);"onselectstart"in t?n.on("selectstart.drag",oa,Pl):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Zv(e,t){var n=e.document.documentElement,r=Gt(e).on("dragstart.drag",null);t&&(r.on("click.drag",oa,Pl),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const So=e=>()=>e;function Pd(e,{sourceEvent:t,subject:n,target:r,identifier:a,active:l,x:o,y:i,dx:c,dy:u,dispatch:m}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:i,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:m}})}Pd.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function LC(e){return!e.ctrlKey&&!e.button}function $C(){return this.parentNode}function DC(e,t){return t??{x:e.x,y:e.y}}function FC(){return navigator.maxTouchPoints||"ontouchstart"in this}function Jv(){var e=LC,t=$C,n=DC,r=FC,a={},l=cc("start","drag","end"),o=0,i,c,u,m,d=0;function f(w){w.on("mousedown.drag",p).filter(r).on("touchstart.drag",x).on("touchmove.drag",h,IC).on("touchend.drag touchcancel.drag",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(w,E){if(!(m||!e.call(this,w,E))){var _=y(this,t.call(this,w,E),w,E,"mouse");_&&(Gt(w.view).on("mousemove.drag",v,Pl).on("mouseup.drag",b,Pl),Kv(w.view),du(w),u=!1,i=w.clientX,c=w.clientY,_("start",w))}}function v(w){if(oa(w),!u){var E=w.clientX-i,_=w.clientY-c;u=E*E+_*_>d}a.mouse("drag",w)}function b(w){Gt(w.view).on("mousemove.drag mouseup.drag",null),Zv(w.view,u),oa(w),a.mouse("end",w)}function x(w,E){if(e.call(this,w,E)){var _=w.changedTouches,S=t.call(this,w,E),N=_.length,k,A;for(k=0;k<N;++k)(A=y(this,S,w,E,_[k].identifier,_[k]))&&(du(w),A("start",w,_[k]))}}function h(w){var E=w.changedTouches,_=E.length,S,N;for(S=0;S<_;++S)(N=a[E[S].identifier])&&(oa(w),N("drag",w,E[S]))}function g(w){var E=w.changedTouches,_=E.length,S,N;for(m&&clearTimeout(m),m=setTimeout(function(){m=null},500),S=0;S<_;++S)(N=a[E[S].identifier])&&(du(w),N("end",w,E[S]))}function y(w,E,_,S,N,k){var A=l.copy(),C=yn(k||_,E),O,F,j;if((j=n.call(w,new Pd("beforestart",{sourceEvent:_,target:f,identifier:N,active:o,x:C[0],y:C[1],dx:0,dy:0,dispatch:A}),S))!=null)return O=j.x-C[0]||0,F=j.y-C[1]||0,function T(I,$,P){var M=C,D;switch(I){case"start":a[N]=T,D=o++;break;case"end":delete a[N],--o;case"drag":C=yn(P||$,E),D=o;break}A.call(I,w,new Pd(I,{sourceEvent:$,subject:j,target:f,identifier:N,active:D,x:C[0]+O,y:C[1]+F,dx:C[0]-M[0],dy:C[1]-M[1],dispatch:A}),S)}}return f.filter=function(w){return arguments.length?(e=typeof w=="function"?w:So(!!w),f):e},f.container=function(w){return arguments.length?(t=typeof w=="function"?w:So(w),f):t},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:So(w),f):n},f.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:So(!!w),f):r},f.on=function(){var w=l.on.apply(l,arguments);return w===l?f:w},f.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,f):Math.sqrt(d)},f}function Km(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ey(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Xl(){}var Rl=.7,Ii=1/Rl,ia="\\s*([+-]?\\d+)\\s*",Ml="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ts="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zC=/^#([0-9a-f]{3,8})$/,VC=new RegExp(`^rgb\\(${ia},${ia},${ia}\\)$`),HC=new RegExp(`^rgb\\(${ts},${ts},${ts}\\)$`),UC=new RegExp(`^rgba\\(${ia},${ia},${ia},${Ml}\\)$`),BC=new RegExp(`^rgba\\(${ts},${ts},${ts},${Ml}\\)$`),YC=new RegExp(`^hsl\\(${Ml},${ts},${ts}\\)$`),WC=new RegExp(`^hsla\\(${Ml},${ts},${ts},${Ml}\\)$`),hp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Km(Xl,_r,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:pp,formatHex:pp,formatHex8:GC,formatHsl:qC,formatRgb:xp,toString:xp});function pp(){return this.rgb().formatHex()}function GC(){return this.rgb().formatHex8()}function qC(){return ty(this).formatHsl()}function xp(){return this.rgb().formatRgb()}function _r(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=zC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?gp(t):n===3?new zt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ko(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ko(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=VC.exec(e))?new zt(t[1],t[2],t[3],1):(t=HC.exec(e))?new zt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=UC.exec(e))?ko(t[1],t[2],t[3],t[4]):(t=BC.exec(e))?ko(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=YC.exec(e))?bp(t[1],t[2]/100,t[3]/100,1):(t=WC.exec(e))?bp(t[1],t[2]/100,t[3]/100,t[4]):hp.hasOwnProperty(e)?gp(hp[e]):e==="transparent"?new zt(NaN,NaN,NaN,0):null}function gp(e){return new zt(e>>16&255,e>>8&255,e&255,1)}function ko(e,t,n,r){return r<=0&&(e=t=n=NaN),new zt(e,t,n,r)}function XC(e){return e instanceof Xl||(e=_r(e)),e?(e=e.rgb(),new zt(e.r,e.g,e.b,e.opacity)):new zt}function Rd(e,t,n,r){return arguments.length===1?XC(e):new zt(e,t,n,r??1)}function zt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Km(zt,Rd,ey(Xl,{brighter(e){return e=e==null?Ii:Math.pow(Ii,e),new zt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Rl:Math.pow(Rl,e),new zt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new zt(xr(this.r),xr(this.g),xr(this.b),Li(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vp,formatHex:vp,formatHex8:QC,formatRgb:yp,toString:yp}));function vp(){return`#${mr(this.r)}${mr(this.g)}${mr(this.b)}`}function QC(){return`#${mr(this.r)}${mr(this.g)}${mr(this.b)}${mr((isNaN(this.opacity)?1:this.opacity)*255)}`}function yp(){const e=Li(this.opacity);return`${e===1?"rgb(":"rgba("}${xr(this.r)}, ${xr(this.g)}, ${xr(this.b)}${e===1?")":`, ${e})`}`}function Li(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xr(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function mr(e){return e=xr(e),(e<16?"0":"")+e.toString(16)}function bp(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new jn(e,t,n,r)}function ty(e){if(e instanceof jn)return new jn(e.h,e.s,e.l,e.opacity);if(e instanceof Xl||(e=_r(e)),!e)return new jn;if(e instanceof jn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),l=Math.max(t,n,r),o=NaN,i=l-a,c=(l+a)/2;return i?(t===l?o=(n-r)/i+(n<r)*6:n===l?o=(r-t)/i+2:o=(t-n)/i+4,i/=c<.5?l+a:2-l-a,o*=60):i=c>0&&c<1?0:o,new jn(o,i,c,e.opacity)}function KC(e,t,n,r){return arguments.length===1?ty(e):new jn(e,t,n,r??1)}function jn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Km(jn,KC,ey(Xl,{brighter(e){return e=e==null?Ii:Math.pow(Ii,e),new jn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Rl:Math.pow(Rl,e),new jn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new zt(mu(e>=240?e-240:e+120,a,r),mu(e,a,r),mu(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new jn(Np(this.h),Co(this.s),Co(this.l),Li(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Li(this.opacity);return`${e===1?"hsl(":"hsla("}${Np(this.h)}, ${Co(this.s)*100}%, ${Co(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Np(e){return e=(e||0)%360,e<0?e+360:e}function Co(e){return Math.max(0,Math.min(1,e||0))}function mu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Zm=e=>()=>e;function ZC(e,t){return function(n){return e+n*t}}function JC(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function e4(e){return(e=+e)==1?ny:function(t,n){return n-t?JC(t,n,e):Zm(isNaN(t)?n:t)}}function ny(e,t){var n=t-e;return n?ZC(e,n):Zm(isNaN(e)?t:e)}const $i=function e(t){var n=e4(t);function r(a,l){var o=n((a=Rd(a)).r,(l=Rd(l)).r),i=n(a.g,l.g),c=n(a.b,l.b),u=ny(a.opacity,l.opacity);return function(m){return a.r=o(m),a.g=i(m),a.b=c(m),a.opacity=u(m),a+""}}return r.gamma=e,r}(1);function t4(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(l){for(a=0;a<n;++a)r[a]=e[a]*(1-l)+t[a]*l;return r}}function n4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function s4(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),l=new Array(n),o;for(o=0;o<r;++o)a[o]=rl(e[o],t[o]);for(;o<n;++o)l[o]=t[o];return function(i){for(o=0;o<r;++o)l[o]=a[o](i);return l}}function r4(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function qn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function a4(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=rl(e[a],t[a]):r[a]=t[a];return function(l){for(a in n)r[a]=n[a](l);return r}}var Md=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,fu=new RegExp(Md.source,"g");function l4(e){return function(){return e}}function o4(e){return function(t){return e(t)+""}}function sy(e,t){var n=Md.lastIndex=fu.lastIndex=0,r,a,l,o=-1,i=[],c=[];for(e=e+"",t=t+"";(r=Md.exec(e))&&(a=fu.exec(t));)(l=a.index)>n&&(l=t.slice(n,l),i[o]?i[o]+=l:i[++o]=l),(r=r[0])===(a=a[0])?i[o]?i[o]+=a:i[++o]=a:(i[++o]=null,c.push({i:o,x:qn(r,a)})),n=fu.lastIndex;return n<t.length&&(l=t.slice(n),i[o]?i[o]+=l:i[++o]=l),i.length<2?c[0]?o4(c[0].x):l4(t):(t=c.length,function(u){for(var m=0,d;m<t;++m)i[(d=c[m]).i]=d.x(u);return i.join("")})}function rl(e,t){var n=typeof t,r;return t==null||n==="boolean"?Zm(t):(n==="number"?qn:n==="string"?(r=_r(t))?(t=r,$i):sy:t instanceof _r?$i:t instanceof Date?r4:n4(t)?t4:Array.isArray(t)?s4:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?a4:qn)(e,t)}var jp=180/Math.PI,Td={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ry(e,t,n,r,a,l){var o,i,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(i=Math.sqrt(n*n+r*r))&&(n/=i,r/=i,c/=i),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:a,translateY:l,rotate:Math.atan2(t,e)*jp,skewX:Math.atan(c)*jp,scaleX:o,scaleY:i}}var Eo;function i4(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Td:ry(t.a,t.b,t.c,t.d,t.e,t.f)}function c4(e){return e==null||(Eo||(Eo=document.createElementNS("http://www.w3.org/2000/svg","g")),Eo.setAttribute("transform",e),!(e=Eo.transform.baseVal.consolidate()))?Td:(e=e.matrix,ry(e.a,e.b,e.c,e.d,e.e,e.f))}function ay(e,t,n,r){function a(u){return u.length?u.pop()+" ":""}function l(u,m,d,f,p,v){if(u!==d||m!==f){var b=p.push("translate(",null,t,null,n);v.push({i:b-4,x:qn(u,d)},{i:b-2,x:qn(m,f)})}else(d||f)&&p.push("translate("+d+t+f+n)}function o(u,m,d,f){u!==m?(u-m>180?m+=360:m-u>180&&(u+=360),f.push({i:d.push(a(d)+"rotate(",null,r)-2,x:qn(u,m)})):m&&d.push(a(d)+"rotate("+m+r)}function i(u,m,d,f){u!==m?f.push({i:d.push(a(d)+"skewX(",null,r)-2,x:qn(u,m)}):m&&d.push(a(d)+"skewX("+m+r)}function c(u,m,d,f,p,v){if(u!==d||m!==f){var b=p.push(a(p)+"scale(",null,",",null,")");v.push({i:b-4,x:qn(u,d)},{i:b-2,x:qn(m,f)})}else(d!==1||f!==1)&&p.push(a(p)+"scale("+d+","+f+")")}return function(u,m){var d=[],f=[];return u=e(u),m=e(m),l(u.translateX,u.translateY,m.translateX,m.translateY,d,f),o(u.rotate,m.rotate,d,f),i(u.skewX,m.skewX,d,f),c(u.scaleX,u.scaleY,m.scaleX,m.scaleY,d,f),u=m=null,function(p){for(var v=-1,b=f.length,x;++v<b;)d[(x=f[v]).i]=x.x(p);return d.join("")}}}var u4=ay(i4,"px, ","px)","deg)"),d4=ay(c4,", ",")",")"),m4=1e-12;function wp(e){return((e=Math.exp(e))+1/e)/2}function f4(e){return((e=Math.exp(e))-1/e)/2}function h4(e){return((e=Math.exp(2*e))-1)/(e+1)}const Xo=function e(t,n,r){function a(l,o){var i=l[0],c=l[1],u=l[2],m=o[0],d=o[1],f=o[2],p=m-i,v=d-c,b=p*p+v*v,x,h;if(b<m4)h=Math.log(f/u)/t,x=function(S){return[i+S*p,c+S*v,u*Math.exp(t*S*h)]};else{var g=Math.sqrt(b),y=(f*f-u*u+r*b)/(2*u*n*g),w=(f*f-u*u-r*b)/(2*f*n*g),E=Math.log(Math.sqrt(y*y+1)-y),_=Math.log(Math.sqrt(w*w+1)-w);h=(_-E)/t,x=function(S){var N=S*h,k=wp(E),A=u/(n*g)*(k*h4(t*N+E)-f4(E));return[i+A*p,c+A*v,u*k/wp(t*N+E)]}}return x.duration=h*1e3*t/Math.SQRT2,x}return a.rho=function(l){var o=Math.max(.001,+l),i=o*o,c=i*i;return e(o,i,c)},a}(Math.SQRT2,2,4);var ba=0,Wa=0,Da=0,ly=1e3,Di,Ga,Fi=0,Sr=0,dc=0,Tl=typeof performance=="object"&&performance.now?performance:Date,oy=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Jm(){return Sr||(oy(p4),Sr=Tl.now()+dc)}function p4(){Sr=0}function zi(){this._call=this._time=this._next=null}zi.prototype=iy.prototype={constructor:zi,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Jm():+n)+(t==null?0:+t),!this._next&&Ga!==this&&(Ga?Ga._next=this:Di=this,Ga=this),this._call=e,this._time=n,Od()},stop:function(){this._call&&(this._call=null,this._time=1/0,Od())}};function iy(e,t,n){var r=new zi;return r.restart(e,t,n),r}function x4(){Jm(),++ba;for(var e=Di,t;e;)(t=Sr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ba}function _p(){Sr=(Fi=Tl.now())+dc,ba=Wa=0;try{x4()}finally{ba=0,v4(),Sr=0}}function g4(){var e=Tl.now(),t=e-Fi;t>ly&&(dc-=t,Fi=e)}function v4(){for(var e,t=Di,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Di=n);Ga=e,Od(r)}function Od(e){if(!ba){Wa&&(Wa=clearTimeout(Wa));var t=e-Sr;t>24?(e<1/0&&(Wa=setTimeout(_p,e-Tl.now()-dc)),Da&&(Da=clearInterval(Da))):(Da||(Fi=Tl.now(),Da=setInterval(g4,ly)),ba=1,oy(_p))}}function Sp(e,t,n){var r=new zi;return t=t==null?0:+t,r.restart(a=>{r.stop(),e(a+t)},t,n),r}var y4=cc("start","end","cancel","interrupt"),b4=[],cy=0,kp=1,Id=2,Qo=3,Cp=4,Ld=5,Ko=6;function mc(e,t,n,r,a,l){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;N4(e,n,{name:t,index:r,group:a,on:y4,tween:b4,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:cy})}function ef(e,t){var n=Tn(e,t);if(n.state>cy)throw new Error("too late; already scheduled");return n}function ss(e,t){var n=Tn(e,t);if(n.state>Qo)throw new Error("too late; already running");return n}function Tn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function N4(e,t,n){var r=e.__transition,a;r[t]=n,n.timer=iy(l,0,n.time);function l(u){n.state=kp,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var m,d,f,p;if(n.state!==kp)return c();for(m in r)if(p=r[m],p.name===n.name){if(p.state===Qo)return Sp(o);p.state===Cp?(p.state=Ko,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[m]):+m<t&&(p.state=Ko,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[m])}if(Sp(function(){n.state===Qo&&(n.state=Cp,n.timer.restart(i,n.delay,n.time),i(u))}),n.state=Id,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Id){for(n.state=Qo,a=new Array(f=n.tween.length),m=0,d=-1;m<f;++m)(p=n.tween[m].value.call(e,e.__data__,n.index,n.group))&&(a[++d]=p);a.length=d+1}}function i(u){for(var m=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Ld,1),d=-1,f=a.length;++d<f;)a[d].call(e,m);n.state===Ld&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Ko,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Zo(e,t){var n=e.__transition,r,a,l=!0,o;if(n){t=t==null?null:t+"";for(o in n){if((r=n[o]).name!==t){l=!1;continue}a=r.state>Id&&r.state<Ld,r.state=Ko,r.timer.stop(),r.on.call(a?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[o]}l&&delete e.__transition}}function j4(e){return this.each(function(){Zo(this,e)})}function w4(e,t){var n,r;return function(){var a=ss(this,e),l=a.tween;if(l!==n){r=n=l;for(var o=0,i=r.length;o<i;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}a.tween=r}}function _4(e,t,n){var r,a;if(typeof n!="function")throw new Error;return function(){var l=ss(this,e),o=l.tween;if(o!==r){a=(r=o).slice();for(var i={name:t,value:n},c=0,u=a.length;c<u;++c)if(a[c].name===t){a[c]=i;break}c===u&&a.push(i)}l.tween=a}}function S4(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Tn(this.node(),n).tween,a=0,l=r.length,o;a<l;++a)if((o=r[a]).name===e)return o.value;return null}return this.each((t==null?w4:_4)(n,e,t))}function tf(e,t,n){var r=e._id;return e.each(function(){var a=ss(this,r);(a.value||(a.value={}))[t]=n.apply(this,arguments)}),function(a){return Tn(a,r).value[t]}}function uy(e,t){var n;return(typeof t=="number"?qn:t instanceof _r?$i:(n=_r(t))?(t=n,$i):sy)(e,t)}function k4(e){return function(){this.removeAttribute(e)}}function C4(e){return function(){this.removeAttributeNS(e.space,e.local)}}function E4(e,t,n){var r,a=n+"",l;return function(){var o=this.getAttribute(e);return o===a?null:o===r?l:l=t(r=o,n)}}function A4(e,t,n){var r,a=n+"",l;return function(){var o=this.getAttributeNS(e.space,e.local);return o===a?null:o===r?l:l=t(r=o,n)}}function P4(e,t,n){var r,a,l;return function(){var o,i=n(this),c;return i==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=i+"",o===c?null:o===r&&c===a?l:(a=c,l=t(r=o,i)))}}function R4(e,t,n){var r,a,l;return function(){var o,i=n(this),c;return i==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=i+"",o===c?null:o===r&&c===a?l:(a=c,l=t(r=o,i)))}}function M4(e,t){var n=uc(e),r=n==="transform"?d4:uy;return this.attrTween(e,typeof t=="function"?(n.local?R4:P4)(n,r,tf(this,"attr."+e,t)):t==null?(n.local?C4:k4)(n):(n.local?A4:E4)(n,r,t))}function T4(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function O4(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function I4(e,t){var n,r;function a(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&O4(e,l)),n}return a._value=t,a}function L4(e,t){var n,r;function a(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&T4(e,l)),n}return a._value=t,a}function $4(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=uc(e);return this.tween(n,(r.local?I4:L4)(r,t))}function D4(e,t){return function(){ef(this,e).delay=+t.apply(this,arguments)}}function F4(e,t){return t=+t,function(){ef(this,e).delay=t}}function z4(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?D4:F4)(t,e)):Tn(this.node(),t).delay}function V4(e,t){return function(){ss(this,e).duration=+t.apply(this,arguments)}}function H4(e,t){return t=+t,function(){ss(this,e).duration=t}}function U4(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?V4:H4)(t,e)):Tn(this.node(),t).duration}function B4(e,t){if(typeof t!="function")throw new Error;return function(){ss(this,e).ease=t}}function Y4(e){var t=this._id;return arguments.length?this.each(B4(t,e)):Tn(this.node(),t).ease}function W4(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ss(this,e).ease=n}}function G4(e){if(typeof e!="function")throw new Error;return this.each(W4(this._id,e))}function q4(e){typeof e!="function"&&(e=Vv(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var l=t[a],o=l.length,i=r[a]=[],c,u=0;u<o;++u)(c=l[u])&&e.call(c,c.__data__,u,l)&&i.push(c);return new _s(r,this._parents,this._name,this._id)}function X4(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,l=Math.min(r,a),o=new Array(r),i=0;i<l;++i)for(var c=t[i],u=n[i],m=c.length,d=o[i]=new Array(m),f,p=0;p<m;++p)(f=c[p]||u[p])&&(d[p]=f);for(;i<r;++i)o[i]=t[i];return new _s(o,this._parents,this._name,this._id)}function Q4(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function K4(e,t,n){var r,a,l=Q4(t)?ef:ss;return function(){var o=l(this,e),i=o.on;i!==r&&(a=(r=i).copy()).on(t,n),o.on=a}}function Z4(e,t){var n=this._id;return arguments.length<2?Tn(this.node(),n).on.on(e):this.each(K4(n,e,t))}function J4(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function e5(){return this.on("end.remove",J4(this._id))}function t5(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Xm(e));for(var r=this._groups,a=r.length,l=new Array(a),o=0;o<a;++o)for(var i=r[o],c=i.length,u=l[o]=new Array(c),m,d,f=0;f<c;++f)(m=i[f])&&(d=e.call(m,m.__data__,f,i))&&("__data__"in m&&(d.__data__=m.__data__),u[f]=d,mc(u[f],t,n,f,u,Tn(m,n)));return new _s(l,this._parents,t,n)}function n5(e){var t=this._name,n=this._id;typeof e!="function"&&(e=zv(e));for(var r=this._groups,a=r.length,l=[],o=[],i=0;i<a;++i)for(var c=r[i],u=c.length,m,d=0;d<u;++d)if(m=c[d]){for(var f=e.call(m,m.__data__,d,c),p,v=Tn(m,n),b=0,x=f.length;b<x;++b)(p=f[b])&&mc(p,t,n,b,f,v);l.push(f),o.push(m)}return new _s(l,o,t,n)}var s5=ql.prototype.constructor;function r5(){return new s5(this._groups,this._parents)}function a5(e,t){var n,r,a;return function(){var l=ya(this,e),o=(this.style.removeProperty(e),ya(this,e));return l===o?null:l===n&&o===r?a:a=t(n=l,r=o)}}function dy(e){return function(){this.style.removeProperty(e)}}function l5(e,t,n){var r,a=n+"",l;return function(){var o=ya(this,e);return o===a?null:o===r?l:l=t(r=o,n)}}function o5(e,t,n){var r,a,l;return function(){var o=ya(this,e),i=n(this),c=i+"";return i==null&&(c=i=(this.style.removeProperty(e),ya(this,e))),o===c?null:o===r&&c===a?l:(a=c,l=t(r=o,i))}}function i5(e,t){var n,r,a,l="style."+t,o="end."+l,i;return function(){var c=ss(this,e),u=c.on,m=c.value[l]==null?i||(i=dy(t)):void 0;(u!==n||a!==m)&&(r=(n=u).copy()).on(o,a=m),c.on=r}}function c5(e,t,n){var r=(e+="")=="transform"?u4:uy;return t==null?this.styleTween(e,a5(e,r)).on("end.style."+e,dy(e)):typeof t=="function"?this.styleTween(e,o5(e,r,tf(this,"style."+e,t))).each(i5(this._id,e)):this.styleTween(e,l5(e,r,t),n).on("end.style."+e,null)}function u5(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function d5(e,t,n){var r,a;function l(){var o=t.apply(this,arguments);return o!==a&&(r=(a=o)&&u5(e,o,n)),r}return l._value=t,l}function m5(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,d5(e,t,n??""))}function f5(e){return function(){this.textContent=e}}function h5(e){return function(){var t=e(this);this.textContent=t??""}}function p5(e){return this.tween("text",typeof e=="function"?h5(tf(this,"text",e)):f5(e==null?"":e+""))}function x5(e){return function(t){this.textContent=e.call(this,t)}}function g5(e){var t,n;function r(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&x5(a)),t}return r._value=e,r}function v5(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,g5(e))}function y5(){for(var e=this._name,t=this._id,n=my(),r=this._groups,a=r.length,l=0;l<a;++l)for(var o=r[l],i=o.length,c,u=0;u<i;++u)if(c=o[u]){var m=Tn(c,t);mc(c,e,n,u,o,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new _s(r,this._parents,e,n)}function b5(){var e,t,n=this,r=n._id,a=n.size();return new Promise(function(l,o){var i={value:o},c={value:function(){--a===0&&l()}};n.each(function(){var u=ss(this,r),m=u.on;m!==e&&(t=(e=m).copy(),t._.cancel.push(i),t._.interrupt.push(i),t._.end.push(c)),u.on=t}),a===0&&l()})}var N5=0;function _s(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function my(){return++N5}var is=ql.prototype;_s.prototype={constructor:_s,select:t5,selectAll:n5,selectChild:is.selectChild,selectChildren:is.selectChildren,filter:q4,merge:X4,selection:r5,transition:y5,call:is.call,nodes:is.nodes,node:is.node,size:is.size,empty:is.empty,each:is.each,on:Z4,attr:M4,attrTween:$4,style:c5,styleTween:m5,text:p5,textTween:v5,remove:e5,tween:S4,delay:z4,duration:U4,ease:Y4,easeVarying:G4,end:b5,[Symbol.iterator]:is[Symbol.iterator]};function j5(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var w5={time:null,delay:0,duration:250,ease:j5};function _5(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function S5(e){var t,n;e instanceof _s?(t=e._id,e=e._name):(t=my(),(n=w5).time=Jm(),e=e==null?null:e+"");for(var r=this._groups,a=r.length,l=0;l<a;++l)for(var o=r[l],i=o.length,c,u=0;u<i;++u)(c=o[u])&&mc(c,e,t,u,o,n||_5(c,t));return new _s(r,this._parents,e,t)}ql.prototype.interrupt=j4;ql.prototype.transition=S5;const Ao=e=>()=>e;function k5(e,{sourceEvent:t,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function ps(e,t,n){this.k=e,this.x=t,this.y=n}ps.prototype={constructor:ps,scale:function(e){return e===1?this:new ps(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ps(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fc=new ps(1,0,0);fy.prototype=ps.prototype;function fy(e){for(;!e.__zoom;)if(!(e=e.parentNode))return fc;return e.__zoom}function hu(e){e.stopImmediatePropagation()}function Fa(e){e.preventDefault(),e.stopImmediatePropagation()}function C5(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function E5(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ep(){return this.__zoom||fc}function A5(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function P5(){return navigator.maxTouchPoints||"ontouchstart"in this}function R5(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),o>l?(l+o)/2:Math.min(0,l)||Math.max(0,o))}function hy(){var e=C5,t=E5,n=R5,r=A5,a=P5,l=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],i=250,c=Xo,u=cc("start","zoom","end"),m,d,f,p=500,v=150,b=0,x=10;function h(j){j.property("__zoom",Ep).on("wheel.zoom",N,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",A).filter(a).on("touchstart.zoom",C).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",F).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(j,T,I,$){var P=j.selection?j.selection():j;P.property("__zoom",Ep),j!==P?E(j,T,I,$):P.interrupt().each(function(){_(this,arguments).event($).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},h.scaleBy=function(j,T,I,$){h.scaleTo(j,function(){var P=this.__zoom.k,M=typeof T=="function"?T.apply(this,arguments):T;return P*M},I,$)},h.scaleTo=function(j,T,I,$){h.transform(j,function(){var P=t.apply(this,arguments),M=this.__zoom,D=I==null?w(P):typeof I=="function"?I.apply(this,arguments):I,V=M.invert(D),B=typeof T=="function"?T.apply(this,arguments):T;return n(y(g(M,B),D,V),P,o)},I,$)},h.translateBy=function(j,T,I,$){h.transform(j,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof I=="function"?I.apply(this,arguments):I),t.apply(this,arguments),o)},null,$)},h.translateTo=function(j,T,I,$,P){h.transform(j,function(){var M=t.apply(this,arguments),D=this.__zoom,V=$==null?w(M):typeof $=="function"?$.apply(this,arguments):$;return n(fc.translate(V[0],V[1]).scale(D.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof I=="function"?-I.apply(this,arguments):-I),M,o)},$,P)};function g(j,T){return T=Math.max(l[0],Math.min(l[1],T)),T===j.k?j:new ps(T,j.x,j.y)}function y(j,T,I){var $=T[0]-I[0]*j.k,P=T[1]-I[1]*j.k;return $===j.x&&P===j.y?j:new ps(j.k,$,P)}function w(j){return[(+j[0][0]+ +j[1][0])/2,(+j[0][1]+ +j[1][1])/2]}function E(j,T,I,$){j.on("start.zoom",function(){_(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){_(this,arguments).event($).end()}).tween("zoom",function(){var P=this,M=arguments,D=_(P,M).event($),V=t.apply(P,M),B=I==null?w(V):typeof I=="function"?I.apply(P,M):I,K=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),J=P.__zoom,ae=typeof T=="function"?T.apply(P,M):T,U=c(J.invert(B).concat(K/J.k),ae.invert(B).concat(K/ae.k));return function(Y){if(Y===1)Y=ae;else{var W=U(Y),ie=K/W[2];Y=new ps(ie,B[0]-W[0]*ie,B[1]-W[1]*ie)}D.zoom(null,Y)}})}function _(j,T,I){return!I&&j.__zooming||new S(j,T)}function S(j,T){this.that=j,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(j,T),this.taps=0}S.prototype={event:function(j){return j&&(this.sourceEvent=j),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(j,T){return this.mouse&&j!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&j!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&j!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(j){var T=Gt(this.that).datum();u.call(j,this.that,new k5(j,{sourceEvent:this.sourceEvent,target:h,transform:this.that.__zoom,dispatch:u}),T)}};function N(j,...T){if(!e.apply(this,arguments))return;var I=_(this,T).event(j),$=this.__zoom,P=Math.max(l[0],Math.min(l[1],$.k*Math.pow(2,r.apply(this,arguments)))),M=yn(j);if(I.wheel)(I.mouse[0][0]!==M[0]||I.mouse[0][1]!==M[1])&&(I.mouse[1]=$.invert(I.mouse[0]=M)),clearTimeout(I.wheel);else{if($.k===P)return;I.mouse=[M,$.invert(M)],Zo(this),I.start()}Fa(j),I.wheel=setTimeout(D,v),I.zoom("mouse",n(y(g($,P),I.mouse[0],I.mouse[1]),I.extent,o));function D(){I.wheel=null,I.end()}}function k(j,...T){if(f||!e.apply(this,arguments))return;var I=j.currentTarget,$=_(this,T,!0).event(j),P=Gt(j.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",K,!0),M=yn(j,I),D=j.clientX,V=j.clientY;Kv(j.view),hu(j),$.mouse=[M,this.__zoom.invert(M)],Zo(this),$.start();function B(J){if(Fa(J),!$.moved){var ae=J.clientX-D,U=J.clientY-V;$.moved=ae*ae+U*U>b}$.event(J).zoom("mouse",n(y($.that.__zoom,$.mouse[0]=yn(J,I),$.mouse[1]),$.extent,o))}function K(J){P.on("mousemove.zoom mouseup.zoom",null),Zv(J.view,$.moved),Fa(J),$.event(J).end()}}function A(j,...T){if(e.apply(this,arguments)){var I=this.__zoom,$=yn(j.changedTouches?j.changedTouches[0]:j,this),P=I.invert($),M=I.k*(j.shiftKey?.5:2),D=n(y(g(I,M),$,P),t.apply(this,T),o);Fa(j),i>0?Gt(this).transition().duration(i).call(E,D,$,j):Gt(this).call(h.transform,D,$,j)}}function C(j,...T){if(e.apply(this,arguments)){var I=j.touches,$=I.length,P=_(this,T,j.changedTouches.length===$).event(j),M,D,V,B;for(hu(j),D=0;D<$;++D)V=I[D],B=yn(V,this),B=[B,this.__zoom.invert(B),V.identifier],P.touch0?!P.touch1&&P.touch0[2]!==B[2]&&(P.touch1=B,P.taps=0):(P.touch0=B,M=!0,P.taps=1+!!m);m&&(m=clearTimeout(m)),M&&(P.taps<2&&(d=B[0],m=setTimeout(function(){m=null},p)),Zo(this),P.start())}}function O(j,...T){if(this.__zooming){var I=_(this,T).event(j),$=j.changedTouches,P=$.length,M,D,V,B;for(Fa(j),M=0;M<P;++M)D=$[M],V=yn(D,this),I.touch0&&I.touch0[2]===D.identifier?I.touch0[0]=V:I.touch1&&I.touch1[2]===D.identifier&&(I.touch1[0]=V);if(D=I.that.__zoom,I.touch1){var K=I.touch0[0],J=I.touch0[1],ae=I.touch1[0],U=I.touch1[1],Y=(Y=ae[0]-K[0])*Y+(Y=ae[1]-K[1])*Y,W=(W=U[0]-J[0])*W+(W=U[1]-J[1])*W;D=g(D,Math.sqrt(Y/W)),V=[(K[0]+ae[0])/2,(K[1]+ae[1])/2],B=[(J[0]+U[0])/2,(J[1]+U[1])/2]}else if(I.touch0)V=I.touch0[0],B=I.touch0[1];else return;I.zoom("touch",n(y(D,V,B),I.extent,o))}}function F(j,...T){if(this.__zooming){var I=_(this,T).event(j),$=j.changedTouches,P=$.length,M,D;for(hu(j),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),M=0;M<P;++M)D=$[M],I.touch0&&I.touch0[2]===D.identifier?delete I.touch0:I.touch1&&I.touch1[2]===D.identifier&&delete I.touch1;if(I.touch1&&!I.touch0&&(I.touch0=I.touch1,delete I.touch1),I.touch0)I.touch0[1]=this.__zoom.invert(I.touch0[0]);else if(I.end(),I.taps===2&&(D=yn(D,this),Math.hypot(d[0]-D[0],d[1]-D[1])<x)){var V=Gt(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return h.wheelDelta=function(j){return arguments.length?(r=typeof j=="function"?j:Ao(+j),h):r},h.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Ao(!!j),h):e},h.touchable=function(j){return arguments.length?(a=typeof j=="function"?j:Ao(!!j),h):a},h.extent=function(j){return arguments.length?(t=typeof j=="function"?j:Ao([[+j[0][0],+j[0][1]],[+j[1][0],+j[1][1]]]),h):t},h.scaleExtent=function(j){return arguments.length?(l[0]=+j[0],l[1]=+j[1],h):[l[0],l[1]]},h.translateExtent=function(j){return arguments.length?(o[0][0]=+j[0][0],o[1][0]=+j[1][0],o[0][1]=+j[0][1],o[1][1]=+j[1][1],h):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},h.constrain=function(j){return arguments.length?(n=j,h):n},h.duration=function(j){return arguments.length?(i=+j,h):i},h.interpolate=function(j){return arguments.length?(c=j,h):c},h.on=function(){var j=u.on.apply(u,arguments);return j===u?h:j},h.clickDistance=function(j){return arguments.length?(b=(j=+j)*j,h):Math.sqrt(b)},h.tapDistance=function(j){return arguments.length?(x=+j,h):x},h}const ns={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Ol=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],py=["Enter"," ","Escape"],xy={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Na;(function(e){e.Strict="strict",e.Loose="loose"})(Na||(Na={}));var gr;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(gr||(gr={}));var Il;(function(e){e.Partial="partial",e.Full="full"})(Il||(Il={}));const gy={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var ds;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ds||(ds={}));var kr;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(kr||(kr={}));var he;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(he||(he={}));const Ap={[he.Left]:he.Right,[he.Right]:he.Left,[he.Top]:he.Bottom,[he.Bottom]:he.Top};function vy(e){return e===null?null:e?"valid":"invalid"}const yy=e=>"id"in e&&"source"in e&&"target"in e,M5=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),nf=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Ql=(e,t=[0,0])=>{const{width:n,height:r}=ks(e),a=e.origin??t,l=n*a[0],o=r*a[1];return{x:e.position.x-l,y:e.position.y-o}},T5=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,a)=>{const l=typeof a=="string";let o=!t.nodeLookup&&!l?a:void 0;t.nodeLookup&&(o=l?t.nodeLookup.get(a):nf(a)?a:t.nodeLookup.get(a.id));const i=o?Vi(o,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return hc(r,i)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return pc(n)},Kl=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},r=!1;return e.forEach(a=>{(t.filter===void 0||t.filter(a))&&(n=hc(n,Vi(a)),r=!0)}),r?pc(n):{x:0,y:0,width:0,height:0}},sf=(e,t,[n,r,a]=[0,0,1],l=!1,o=!1)=>{const i={...Jl(t,[n,r,a]),width:t.width/a,height:t.height/a},c=[];for(const u of e.values()){const{measured:m,selectable:d=!0,hidden:f=!1}=u;if(o&&!d||f)continue;const p=m.width??u.width??u.initialWidth??null,v=m.height??u.height??u.initialHeight??null,b=Ll(i,wa(u)),x=(p??0)*(v??0),h=l&&b>0;(!u.internals.handleBounds||h||b>=x||u.dragging)&&c.push(u)}return c},O5=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function I5(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(a=>a.id)):null;return e.forEach(a=>{a.measured.width&&a.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!a.hidden)&&(!r||r.has(a.id))&&n.set(a.id,a)}),n}async function L5({nodes:e,width:t,height:n,panZoom:r,minZoom:a,maxZoom:l},o){if(e.size===0)return Promise.resolve(!0);const i=I5(e,o),c=Kl(i),u=rf(c,t,n,(o==null?void 0:o.minZoom)??a,(o==null?void 0:o.maxZoom)??l,(o==null?void 0:o.padding)??.1);return await r.setViewport(u,{duration:o==null?void 0:o.duration,ease:o==null?void 0:o.ease,interpolate:o==null?void 0:o.interpolate}),Promise.resolve(!0)}function by({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:a,onError:l}){const o=n.get(e),i=o.parentId?n.get(o.parentId):void 0,{x:c,y:u}=i?i.internals.positionAbsolute:{x:0,y:0},m=o.origin??r;let d=o.extent||a;if(o.extent==="parent"&&!o.expandParent)if(!i)l==null||l("005",ns.error005());else{const p=i.measured.width,v=i.measured.height;p&&v&&(d=[[c,u],[c+p,u+v]])}else i&&_a(o.extent)&&(d=[[o.extent[0][0]+c,o.extent[0][1]+u],[o.extent[1][0]+c,o.extent[1][1]+u]]);const f=_a(d)?Cr(t,d,o.measured):t;return(o.measured.width===void 0||o.measured.height===void 0)&&(l==null||l("015",ns.error015())),{position:{x:f.x-c+(o.measured.width??0)*m[0],y:f.y-u+(o.measured.height??0)*m[1]},positionAbsolute:f}}async function $5({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:a}){const l=new Set(e.map(f=>f.id)),o=[];for(const f of n){if(f.deletable===!1)continue;const p=l.has(f.id),v=!p&&f.parentId&&o.find(b=>b.id===f.parentId);(p||v)&&o.push(f)}const i=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),m=O5(o,c);for(const f of c)i.has(f.id)&&!m.find(v=>v.id===f.id)&&m.push(f);if(!a)return{edges:m,nodes:o};const d=await a({nodes:o,edges:m});return typeof d=="boolean"?d?{edges:m,nodes:o}:{edges:[],nodes:[]}:d}const ja=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Cr=(e={x:0,y:0},t,n)=>({x:ja(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:ja(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Ny(e,t,n){const{width:r,height:a}=ks(n),{x:l,y:o}=n.internals.positionAbsolute;return Cr(e,[[l,o],[l+r,o+a]],t)}const Pp=(e,t,n)=>e<t?ja(Math.abs(e-t),1,t)/t:e>n?-ja(Math.abs(e-n),1,t)/t:0,jy=(e,t,n=15,r=40)=>{const a=Pp(e.x,r,t.width-r)*n,l=Pp(e.y,r,t.height-r)*n;return[a,l]},hc=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),$d=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),pc=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),wa=(e,t=[0,0])=>{var a,l;const{x:n,y:r}=nf(e)?e.internals.positionAbsolute:Ql(e,t);return{x:n,y:r,width:((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0,height:((l=e.measured)==null?void 0:l.height)??e.height??e.initialHeight??0}},Vi=(e,t=[0,0])=>{var a,l;const{x:n,y:r}=nf(e)?e.internals.positionAbsolute:Ql(e,t);return{x:n,y:r,x2:n+(((a=e.measured)==null?void 0:a.width)??e.width??e.initialWidth??0),y2:r+(((l=e.measured)==null?void 0:l.height)??e.height??e.initialHeight??0)}},wy=(e,t)=>pc(hc($d(e),$d(t))),Ll=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Rp=e=>wn(e.width)&&wn(e.height)&&wn(e.x)&&wn(e.y),wn=e=>!isNaN(e)&&isFinite(e),D5=(e,t)=>{},Zl=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Jl=({x:e,y:t},[n,r,a],l=!1,o=[1,1])=>{const i={x:(e-n)/a,y:(t-r)/a};return l?Zl(i,o):i},Hi=({x:e,y:t},[n,r,a])=>({x:e*a+n,y:t*a+r});function Or(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function F5(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=Or(e,n),a=Or(e,t);return{top:r,right:a,bottom:r,left:a,x:a*2,y:r*2}}if(typeof e=="object"){const r=Or(e.top??e.y??0,n),a=Or(e.bottom??e.y??0,n),l=Or(e.left??e.x??0,t),o=Or(e.right??e.x??0,t);return{top:r,right:o,bottom:a,left:l,x:l+o,y:r+a}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function z5(e,t,n,r,a,l){const{x:o,y:i}=Hi(e,[t,n,r]),{x:c,y:u}=Hi({x:e.x+e.width,y:e.y+e.height},[t,n,r]),m=a-c,d=l-u;return{left:Math.floor(o),top:Math.floor(i),right:Math.floor(m),bottom:Math.floor(d)}}const rf=(e,t,n,r,a,l)=>{const o=F5(l,t,n),i=(t-o.x)/e.width,c=(n-o.y)/e.height,u=Math.min(i,c),m=ja(u,r,a),d=e.x+e.width/2,f=e.y+e.height/2,p=t/2-d*m,v=n/2-f*m,b=z5(e,p,v,m,t,n),x={left:Math.min(b.left-o.left,0),top:Math.min(b.top-o.top,0),right:Math.min(b.right-o.right,0),bottom:Math.min(b.bottom-o.bottom,0)};return{x:p-x.left+x.right,y:v-x.top+x.bottom,zoom:m}},$l=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function _a(e){return e!=null&&e!=="parent"}function ks(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function _y(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Sy(e,t={width:0,height:0},n,r,a){const l={...e},o=r.get(n);if(o){const i=o.origin||a;l.x+=o.internals.positionAbsolute.x-(t.width??0)*i[0],l.y+=o.internals.positionAbsolute.y-(t.height??0)*i[1]}return l}function Mp(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function V5(){let e,t;return{promise:new Promise((r,a)=>{e=r,t=a}),resolve:e,reject:t}}function H5(e){return{...xy,...e||{}}}function al(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:a}){const{x:l,y:o}=_n(e),i=Jl({x:l-((a==null?void 0:a.left)??0),y:o-((a==null?void 0:a.top)??0)},r),{x:c,y:u}=n?Zl(i,t):i;return{xSnapped:c,ySnapped:u,...i}}const af=e=>({width:e.offsetWidth,height:e.offsetHeight}),ky=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},U5=["INPUT","SELECT","TEXTAREA"];function Cy(e){var r,a;const t=((a=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:a[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:U5.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Ey=e=>"clientX"in e,_n=(e,t)=>{var l,o;const n=Ey(e),r=n?e.clientX:(l=e.touches)==null?void 0:l[0].clientX,a=n?e.clientY:(o=e.touches)==null?void 0:o[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:a-((t==null?void 0:t.top)??0)}},Tp=(e,t,n,r,a)=>{const l=t.querySelectorAll(`.${e}`);return!l||!l.length?null:Array.from(l).map(o=>{const i=o.getBoundingClientRect();return{id:o.getAttribute("data-handleid"),type:e,nodeId:a,position:o.getAttribute("data-handlepos"),x:(i.left-n.left)/r,y:(i.top-n.top)/r,...af(o)}})};function Ay({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:o,targetControlY:i}){const c=e*.125+a*.375+o*.375+n*.125,u=t*.125+l*.375+i*.375+r*.125,m=Math.abs(c-e),d=Math.abs(u-t);return[c,u,m,d]}function Po(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Op({pos:e,x1:t,y1:n,x2:r,y2:a,c:l}){switch(e){case he.Left:return[t-Po(t-r,l),n];case he.Right:return[t+Po(r-t,l),n];case he.Top:return[t,n-Po(n-a,l)];case he.Bottom:return[t,n+Po(a-n,l)]}}function Py({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:l=he.Top,curvature:o=.25}){const[i,c]=Op({pos:n,x1:e,y1:t,x2:r,y2:a,c:o}),[u,m]=Op({pos:l,x1:r,y1:a,x2:e,y2:t,c:o}),[d,f,p,v]=Ay({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:i,sourceControlY:c,targetControlX:u,targetControlY:m});return[`M${e},${t} C${i},${c} ${u},${m} ${r},${a}`,d,f,p,v]}function Ry({sourceX:e,sourceY:t,targetX:n,targetY:r}){const a=Math.abs(n-e)/2,l=n<e?n+a:n-a,o=Math.abs(r-t)/2,i=r<t?r+o:r-o;return[l,i,a,o]}function B5({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:a=!1,zIndexMode:l="basic"}){if(l==="manual")return r;const o=a&&n?r+1e3:r,i=Math.max(e.parentId||a&&e.selected?e.internals.z:0,t.parentId||a&&t.selected?t.internals.z:0);return o+i}function Y5({sourceNode:e,targetNode:t,width:n,height:r,transform:a}){const l=hc(Vi(e),Vi(t));l.x===l.x2&&(l.x2+=1),l.y===l.y2&&(l.y2+=1);const o={x:-a[0]/a[2],y:-a[1]/a[2],width:n/a[2],height:r/a[2]};return Ll(o,pc(l))>0}const W5=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,G5=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),q5=(e,t,n={})=>{if(!e.source||!e.target)return t;const r=n.getEdgeId||W5;let a;return yy(e)?a={...e}:a={...e,id:r(e)},G5(a,t)?t:(a.sourceHandle===null&&delete a.sourceHandle,a.targetHandle===null&&delete a.targetHandle,t.concat(a))};function My({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[a,l,o,i]=Ry({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,a,l,o,i]}const Ip={[he.Left]:{x:-1,y:0},[he.Right]:{x:1,y:0},[he.Top]:{x:0,y:-1},[he.Bottom]:{x:0,y:1}},X5=({source:e,sourcePosition:t=he.Bottom,target:n})=>t===he.Left||t===he.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Lp=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Q5({source:e,sourcePosition:t=he.Bottom,target:n,targetPosition:r=he.Top,center:a,offset:l,stepPosition:o}){const i=Ip[t],c=Ip[r],u={x:e.x+i.x*l,y:e.y+i.y*l},m={x:n.x+c.x*l,y:n.y+c.y*l},d=X5({source:u,sourcePosition:t,target:m}),f=d.x!==0?"x":"y",p=d[f];let v=[],b,x;const h={x:0,y:0},g={x:0,y:0},[,,y,w]=Ry({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*c[f]===-1){f==="x"?(b=a.x??u.x+(m.x-u.x)*o,x=a.y??(u.y+m.y)/2):(b=a.x??(u.x+m.x)/2,x=a.y??u.y+(m.y-u.y)*o);const _=[{x:b,y:u.y},{x:b,y:m.y}],S=[{x:u.x,y:x},{x:m.x,y:x}];i[f]===p?v=f==="x"?_:S:v=f==="x"?S:_}else{const _=[{x:u.x,y:m.y}],S=[{x:m.x,y:u.y}];if(f==="x"?v=i.x===p?S:_:v=i.y===p?_:S,t===r){const O=Math.abs(e[f]-n[f]);if(O<=l){const F=Math.min(l-1,l-O);i[f]===p?h[f]=(u[f]>e[f]?-1:1)*F:g[f]=(m[f]>n[f]?-1:1)*F}}if(t!==r){const O=f==="x"?"y":"x",F=i[f]===c[O],j=u[O]>m[O],T=u[O]<m[O];(i[f]===1&&(!F&&j||F&&T)||i[f]!==1&&(!F&&T||F&&j))&&(v=f==="x"?_:S)}const N={x:u.x+h.x,y:u.y+h.y},k={x:m.x+g.x,y:m.y+g.y},A=Math.max(Math.abs(N.x-v[0].x),Math.abs(k.x-v[0].x)),C=Math.max(Math.abs(N.y-v[0].y),Math.abs(k.y-v[0].y));A>=C?(b=(N.x+k.x)/2,x=v[0].y):(b=v[0].x,x=(N.y+k.y)/2)}return[[e,{x:u.x+h.x,y:u.y+h.y},...v,{x:m.x+g.x,y:m.y+g.y},n],b,x,y,w]}function K5(e,t,n,r){const a=Math.min(Lp(e,t)/2,Lp(t,n)/2,r),{x:l,y:o}=t;if(e.x===l&&l===n.x||e.y===o&&o===n.y)return`L${l} ${o}`;if(e.y===o){const u=e.x<n.x?-1:1,m=e.y<n.y?1:-1;return`L ${l+a*u},${o}Q ${l},${o} ${l},${o+a*m}`}const i=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${l},${o+a*c}Q ${l},${o} ${l+a*i},${o}`}function Dd({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:l=he.Top,borderRadius:o=5,centerX:i,centerY:c,offset:u=20,stepPosition:m=.5}){const[d,f,p,v,b]=Q5({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:a},targetPosition:l,center:{x:i,y:c},offset:u,stepPosition:m});return[d.reduce((h,g,y)=>{let w="";return y>0&&y<d.length-1?w=K5(d[y-1],g,d[y+1],o):w=`${y===0?"M":"L"}${g.x} ${g.y}`,h+=w,h},""),f,p,v,b]}function $p(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Z5(e){var d;const{sourceNode:t,targetNode:n}=e;if(!$p(t)||!$p(n))return null;const r=t.internals.handleBounds||Dp(t.handles),a=n.internals.handleBounds||Dp(n.handles),l=Fp((r==null?void 0:r.source)??[],e.sourceHandle),o=Fp(e.connectionMode===Na.Strict?(a==null?void 0:a.target)??[]:((a==null?void 0:a.target)??[]).concat((a==null?void 0:a.source)??[]),e.targetHandle);if(!l||!o)return(d=e.onError)==null||d.call(e,"008",ns.error008(l?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const i=(l==null?void 0:l.position)||he.Bottom,c=(o==null?void 0:o.position)||he.Top,u=Er(t,l,i),m=Er(n,o,c);return{sourceX:u.x,sourceY:u.y,targetX:m.x,targetY:m.y,sourcePosition:i,targetPosition:c}}function Dp(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Er(e,t,n=he.Left,r=!1){const a=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,l=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:o,height:i}=t??ks(e);if(r)return{x:a+o/2,y:l+i/2};switch((t==null?void 0:t.position)??n){case he.Top:return{x:a+o/2,y:l};case he.Right:return{x:a+o,y:l+i/2};case he.Bottom:return{x:a+o/2,y:l+i};case he.Left:return{x:a,y:l+i/2}}}function Fp(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Fd(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function J5(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:a}){const l=new Set;return e.reduce((o,i)=>([i.markerStart||r,i.markerEnd||a].forEach(c=>{if(c&&typeof c=="object"){const u=Fd(c,t);l.has(u)||(o.push({id:u,color:c.color||n,...c}),l.add(u))}}),o),[]).sort((o,i)=>o.id.localeCompare(i.id))}const Ty=1e3,e3=10,lf={nodeOrigin:[0,0],nodeExtent:Ol,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},t3={...lf,checkEquality:!0};function of(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function n3(e,t,n){const r=of(lf,n);for(const a of e.values())if(a.parentId)uf(a,e,t,r);else{const l=Ql(a,r.nodeOrigin),o=_a(a.extent)?a.extent:r.nodeExtent,i=Cr(l,o,ks(a));a.internals.positionAbsolute=i}}function s3(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const n=[],r=[];for(const a of e.handles){const l={id:a.id,width:a.width??1,height:a.height??1,nodeId:e.id,x:a.x,y:a.y,position:a.position,type:a.type};a.type==="source"?n.push(l):a.type==="target"&&r.push(l)}return{source:n,target:r}}function cf(e){return e==="manual"}function zd(e,t,n,r={}){var u,m;const a=of(t3,r),l={i:0},o=new Map(t),i=a!=null&&a.elevateNodesOnSelect&&!cf(a.zIndexMode)?Ty:0;let c=e.length>0;t.clear(),n.clear();for(const d of e){let f=o.get(d.id);if(a.checkEquality&&d===(f==null?void 0:f.internals.userNode))t.set(d.id,f);else{const p=Ql(d,a.nodeOrigin),v=_a(d.extent)?d.extent:a.nodeExtent,b=Cr(p,v,ks(d));f={...a.defaults,...d,measured:{width:(u=d.measured)==null?void 0:u.width,height:(m=d.measured)==null?void 0:m.height},internals:{positionAbsolute:b,handleBounds:s3(d,f),z:Oy(d,i,a.zIndexMode),userNode:d}},t.set(d.id,f)}(f.measured===void 0||f.measured.width===void 0||f.measured.height===void 0)&&!f.hidden&&(c=!1),d.parentId&&uf(f,t,n,r,l)}return c}function r3(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function uf(e,t,n,r,a){const{elevateNodesOnSelect:l,nodeOrigin:o,nodeExtent:i,zIndexMode:c}=of(lf,r),u=e.parentId,m=t.get(u);if(!m){console.warn(`Parent node ${u} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}r3(e,n),a&&!m.parentId&&m.internals.rootParentIndex===void 0&&c==="auto"&&(m.internals.rootParentIndex=++a.i,m.internals.z=m.internals.z+a.i*e3),a&&m.internals.rootParentIndex!==void 0&&(a.i=m.internals.rootParentIndex);const d=l&&!cf(c)?Ty:0,{x:f,y:p,z:v}=a3(e,m,o,i,d,c),{positionAbsolute:b}=e.internals,x=f!==b.x||p!==b.y;(x||v!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:x?{x:f,y:p}:b,z:v}})}function Oy(e,t,n){const r=wn(e.zIndex)?e.zIndex:0;return cf(n)?r:r+(e.selected?t:0)}function a3(e,t,n,r,a,l){const{x:o,y:i}=t.internals.positionAbsolute,c=ks(e),u=Ql(e,n),m=_a(e.extent)?Cr(u,e.extent,c):u;let d=Cr({x:o+m.x,y:i+m.y},r,c);e.extent==="parent"&&(d=Ny(d,c,t));const f=Oy(e,a,l),p=t.internals.z??0;return{x:d.x,y:d.y,z:p>=f?p+1:f}}function df(e,t,n,r=[0,0]){var o;const a=[],l=new Map;for(const i of e){const c=t.get(i.parentId);if(!c)continue;const u=((o=l.get(i.parentId))==null?void 0:o.expandedRect)??wa(c),m=wy(u,i.rect);l.set(i.parentId,{expandedRect:m,parent:c})}return l.size>0&&l.forEach(({expandedRect:i,parent:c},u)=>{var y;const m=c.internals.positionAbsolute,d=ks(c),f=c.origin??r,p=i.x<m.x?Math.round(Math.abs(m.x-i.x)):0,v=i.y<m.y?Math.round(Math.abs(m.y-i.y)):0,b=Math.max(d.width,Math.round(i.width)),x=Math.max(d.height,Math.round(i.height)),h=(b-d.width)*f[0],g=(x-d.height)*f[1];(p>0||v>0||h||g)&&(a.push({id:u,type:"position",position:{x:c.position.x-p+h,y:c.position.y-v+g}}),(y=n.get(u))==null||y.forEach(w=>{e.some(E=>E.id===w.id)||a.push({id:w.id,type:"position",position:{x:w.position.x+p,y:w.position.y+v}})})),(d.width<i.width||d.height<i.height||p||v)&&a.push({id:u,type:"dimensions",setAttributes:!0,dimensions:{width:b+(p?f[0]*p-h:0),height:x+(v?f[1]*v-g:0)}})}),a}function l3(e,t,n,r,a,l,o){const i=r==null?void 0:r.querySelector(".xyflow__viewport");let c=!1;if(!i)return{changes:[],updatedInternals:c};const u=[],m=window.getComputedStyle(i),{m22:d}=new window.DOMMatrixReadOnly(m.transform),f=[];for(const p of e.values()){const v=t.get(p.id);if(!v)continue;if(v.hidden){t.set(v.id,{...v,internals:{...v.internals,handleBounds:void 0}}),c=!0;continue}const b=af(p.nodeElement),x=v.measured.width!==b.width||v.measured.height!==b.height;if(!!(b.width&&b.height&&(x||!v.internals.handleBounds||p.force))){const g=p.nodeElement.getBoundingClientRect(),y=_a(v.extent)?v.extent:l;let{positionAbsolute:w}=v.internals;v.parentId&&v.extent==="parent"?w=Ny(w,b,t.get(v.parentId)):y&&(w=Cr(w,y,b));const E={...v,measured:b,internals:{...v.internals,positionAbsolute:w,handleBounds:{source:Tp("source",p.nodeElement,g,d,v.id),target:Tp("target",p.nodeElement,g,d,v.id)}}};t.set(v.id,E),v.parentId&&uf(E,t,n,{nodeOrigin:a,zIndexMode:o}),c=!0,x&&(u.push({id:v.id,type:"dimensions",dimensions:b}),v.expandParent&&v.parentId&&f.push({id:v.id,parentId:v.parentId,rect:wa(E,a)}))}}if(f.length>0){const p=df(f,t,n,a);u.push(...p)}return{changes:u,updatedInternals:c}}async function o3({delta:e,panZoom:t,transform:n,translateExtent:r,width:a,height:l}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const o=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[a,l]],r),i=!!o&&(o.x!==n[0]||o.y!==n[1]||o.k!==n[2]);return Promise.resolve(i)}function zp(e,t,n,r,a,l){let o=a;const i=r.get(o)||new Map;r.set(o,i.set(n,t)),o=`${a}-${e}`;const c=r.get(o)||new Map;if(r.set(o,c.set(n,t)),l){o=`${a}-${e}-${l}`;const u=r.get(o)||new Map;r.set(o,u.set(n,t))}}function Iy(e,t,n){e.clear(),t.clear();for(const r of n){const{source:a,target:l,sourceHandle:o=null,targetHandle:i=null}=r,c={edgeId:r.id,source:a,target:l,sourceHandle:o,targetHandle:i},u=`${a}-${o}--${l}-${i}`,m=`${l}-${i}--${a}-${o}`;zp("source",c,m,e,a,o),zp("target",c,u,e,l,i),t.set(r.id,r)}}function Ly(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:Ly(n,t):!1}function Vp(e,t,n){var a;let r=e;do{if((a=r==null?void 0:r.matches)!=null&&a.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function i3(e,t,n,r){const a=new Map;for(const[l,o]of e)if((o.selected||o.id===r)&&(!o.parentId||!Ly(o,e))&&(o.draggable||t&&typeof o.draggable>"u")){const i=e.get(l);i&&a.set(l,{id:l,position:i.position||{x:0,y:0},distance:{x:n.x-i.internals.positionAbsolute.x,y:n.y-i.internals.positionAbsolute.y},extent:i.extent,parentId:i.parentId,origin:i.origin,expandParent:i.expandParent,internals:{positionAbsolute:i.internals.positionAbsolute||{x:0,y:0}},measured:{width:i.measured.width??0,height:i.measured.height??0}})}return a}function pu({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var o,i,c;const a=[];for(const[u,m]of t){const d=(o=n.get(u))==null?void 0:o.internals.userNode;d&&a.push({...d,position:m.position,dragging:r})}if(!e)return[a[0],a];const l=(i=n.get(e))==null?void 0:i.internals.userNode;return[l?{...l,position:((c=t.get(e))==null?void 0:c.position)||l.position,dragging:r}:a[0],a]}function c3({dragItems:e,snapGrid:t,x:n,y:r}){const a=e.values().next().value;if(!a)return null;const l={x:n-a.distance.x,y:r-a.distance.y},o=Zl(l,t);return{x:o.x-l.x,y:o.y-l.y}}function u3({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:a}){let l={x:null,y:null},o=0,i=new Map,c=!1,u={x:0,y:0},m=null,d=!1,f=null,p=!1,v=!1,b=null;function x({noDragClassName:g,handleSelector:y,domNode:w,isSelectable:E,nodeId:_,nodeClickDistance:S=0}){f=Gt(w);function N({x:O,y:F}){const{nodeLookup:j,nodeExtent:T,snapGrid:I,snapToGrid:$,nodeOrigin:P,onNodeDrag:M,onSelectionDrag:D,onError:V,updateNodePositions:B}=t();l={x:O,y:F};let K=!1;const J=i.size>1,ae=J&&T?$d(Kl(i)):null,U=J&&$?c3({dragItems:i,snapGrid:I,x:O,y:F}):null;for(const[Y,W]of i){if(!j.has(Y))continue;let ie={x:O-W.distance.x,y:F-W.distance.y};$&&(ie=U?{x:Math.round(ie.x+U.x),y:Math.round(ie.y+U.y)}:Zl(ie,I));let H=null;if(J&&T&&!W.extent&&ae){const{positionAbsolute:oe}=W.internals,fe=oe.x-ae.x+T[0][0],ge=oe.x+W.measured.width-ae.x2+T[1][0],L=oe.y-ae.y+T[0][1],G=oe.y+W.measured.height-ae.y2+T[1][1];H=[[fe,L],[ge,G]]}const{position:X,positionAbsolute:Z}=by({nodeId:Y,nextPosition:ie,nodeLookup:j,nodeExtent:H||T,nodeOrigin:P,onError:V});K=K||W.position.x!==X.x||W.position.y!==X.y,W.position=X,W.internals.positionAbsolute=Z}if(v=v||K,!!K&&(B(i,!0),b&&(r||M||!_&&D))){const[Y,W]=pu({nodeId:_,dragItems:i,nodeLookup:j});r==null||r(b,i,Y,W),M==null||M(b,Y,W),_||D==null||D(b,W)}}async function k(){if(!m)return;const{transform:O,panBy:F,autoPanSpeed:j,autoPanOnNodeDrag:T}=t();if(!T){c=!1,cancelAnimationFrame(o);return}const[I,$]=jy(u,m,j);(I!==0||$!==0)&&(l.x=(l.x??0)-I/O[2],l.y=(l.y??0)-$/O[2],await F({x:I,y:$})&&N(l)),o=requestAnimationFrame(k)}function A(O){var J;const{nodeLookup:F,multiSelectionActive:j,nodesDraggable:T,transform:I,snapGrid:$,snapToGrid:P,selectNodesOnDrag:M,onNodeDragStart:D,onSelectionDragStart:V,unselectNodesAndEdges:B}=t();d=!0,(!M||!E)&&!j&&_&&((J=F.get(_))!=null&&J.selected||B()),E&&M&&_&&(e==null||e(_));const K=al(O.sourceEvent,{transform:I,snapGrid:$,snapToGrid:P,containerBounds:m});if(l=K,i=i3(F,T,K,_),i.size>0&&(n||D||!_&&V)){const[ae,U]=pu({nodeId:_,dragItems:i,nodeLookup:F});n==null||n(O.sourceEvent,i,ae,U),D==null||D(O.sourceEvent,ae,U),_||V==null||V(O.sourceEvent,U)}}const C=Jv().clickDistance(S).on("start",O=>{const{domNode:F,nodeDragThreshold:j,transform:T,snapGrid:I,snapToGrid:$}=t();m=(F==null?void 0:F.getBoundingClientRect())||null,p=!1,v=!1,b=O.sourceEvent,j===0&&A(O),l=al(O.sourceEvent,{transform:T,snapGrid:I,snapToGrid:$,containerBounds:m}),u=_n(O.sourceEvent,m)}).on("drag",O=>{const{autoPanOnNodeDrag:F,transform:j,snapGrid:T,snapToGrid:I,nodeDragThreshold:$,nodeLookup:P}=t(),M=al(O.sourceEvent,{transform:j,snapGrid:T,snapToGrid:I,containerBounds:m});if(b=O.sourceEvent,(O.sourceEvent.type==="touchmove"&&O.sourceEvent.touches.length>1||_&&!P.has(_))&&(p=!0),!p){if(!c&&F&&d&&(c=!0,k()),!d){const D=_n(O.sourceEvent,m),V=D.x-u.x,B=D.y-u.y;Math.sqrt(V*V+B*B)>$&&A(O)}(l.x!==M.xSnapped||l.y!==M.ySnapped)&&i&&d&&(u=_n(O.sourceEvent,m),N(M))}}).on("end",O=>{if(!(!d||p)&&(c=!1,d=!1,cancelAnimationFrame(o),i.size>0)){const{nodeLookup:F,updateNodePositions:j,onNodeDragStop:T,onSelectionDragStop:I}=t();if(v&&(j(i,!1),v=!1),a||T||!_&&I){const[$,P]=pu({nodeId:_,dragItems:i,nodeLookup:F,dragging:!1});a==null||a(O.sourceEvent,i,$,P),T==null||T(O.sourceEvent,$,P),_||I==null||I(O.sourceEvent,P)}}}).filter(O=>{const F=O.target;return!O.button&&(!g||!Vp(F,`.${g}`,w))&&(!y||Vp(F,y,w))});f.call(C)}function h(){f==null||f.on(".drag",null)}return{update:x,destroy:h}}function d3(e,t,n){const r=[],a={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const l of t.values())Ll(a,wa(l))>0&&r.push(l);return r}const m3=250;function f3(e,t,n,r){var i,c;let a=[],l=1/0;const o=d3(e,n,t+m3);for(const u of o){const m=[...((i=u.internals.handleBounds)==null?void 0:i.source)??[],...((c=u.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of m){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:p}=Er(u,d,d.position,!0),v=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(p-e.y,2));v>t||(v<l?(a=[{...d,x:f,y:p}],l=v):v===l&&a.push({...d,x:f,y:p}))}}if(!a.length)return null;if(a.length>1){const u=r.type==="source"?"target":"source";return a.find(m=>m.type===u)??a[0]}return a[0]}function $y(e,t,n,r,a,l=!1){var u,m,d;const o=r.get(e);if(!o)return null;const i=a==="strict"?(u=o.internals.handleBounds)==null?void 0:u[t]:[...((m=o.internals.handleBounds)==null?void 0:m.source)??[],...((d=o.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?i==null?void 0:i.find(f=>f.id===n):i==null?void 0:i[0])??null;return c&&l?{...c,...Er(o,c,c.position,!0)}:c}function Dy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function h3(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Fy=()=>!0;function p3(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:a,edgeUpdaterType:l,isTarget:o,domNode:i,nodeLookup:c,lib:u,autoPanOnConnect:m,flowId:d,panBy:f,cancelConnection:p,onConnectStart:v,onConnect:b,onConnectEnd:x,isValidConnection:h=Fy,onReconnectEnd:g,updateConnection:y,getTransform:w,getFromHandle:E,autoPanSpeed:_,dragThreshold:S=1,handleDomNode:N}){const k=ky(e.target);let A=0,C;const{x:O,y:F}=_n(e),j=Dy(l,N),T=i==null?void 0:i.getBoundingClientRect();let I=!1;if(!T||!j)return;const $=$y(a,j,r,c,t);if(!$)return;let P=_n(e,T),M=!1,D=null,V=!1,B=null;function K(){if(!m||!T)return;const[X,Z]=jy(P,T,_);f({x:X,y:Z}),A=requestAnimationFrame(K)}const J={...$,nodeId:a,type:j,position:$.position},ae=c.get(a);let Y={inProgress:!0,isValid:null,from:Er(ae,J,he.Left,!0),fromHandle:J,fromPosition:J.position,fromNode:ae,to:P,toHandle:null,toPosition:Ap[J.position],toNode:null,pointer:P};function W(){I=!0,y(Y),v==null||v(e,{nodeId:a,handleId:r,handleType:j})}S===0&&W();function ie(X){if(!I){const{x:G,y:ve}=_n(X),me=G-O,je=ve-F;if(!(me*me+je*je>S*S))return;W()}if(!E()||!J){H(X);return}const Z=w();P=_n(X,T),C=f3(Jl(P,Z,!1,[1,1]),n,c,J),M||(K(),M=!0);const oe=zy(X,{handle:C,connectionMode:t,fromNodeId:a,fromHandleId:r,fromType:o?"target":"source",isValidConnection:h,doc:k,lib:u,flowId:d,nodeLookup:c});B=oe.handleDomNode,D=oe.connection,V=h3(!!C,oe.isValid);const fe=c.get(a),ge=fe?Er(fe,J,he.Left,!0):Y.from,L={...Y,from:ge,isValid:V,to:oe.toHandle&&V?Hi({x:oe.toHandle.x,y:oe.toHandle.y},Z):P,toHandle:oe.toHandle,toPosition:V&&oe.toHandle?oe.toHandle.position:Ap[J.position],toNode:oe.toHandle?c.get(oe.toHandle.nodeId):null,pointer:P};y(L),Y=L}function H(X){if(!("touches"in X&&X.touches.length>0)){if(I){(C||B)&&D&&V&&(b==null||b(D));const{inProgress:Z,...oe}=Y,fe={...oe,toPosition:Y.toHandle?Y.toPosition:null};x==null||x(X,fe),l&&(g==null||g(X,fe))}p(),cancelAnimationFrame(A),M=!1,V=!1,D=null,B=null,k.removeEventListener("mousemove",ie),k.removeEventListener("mouseup",H),k.removeEventListener("touchmove",ie),k.removeEventListener("touchend",H)}}k.addEventListener("mousemove",ie),k.addEventListener("mouseup",H),k.addEventListener("touchmove",ie),k.addEventListener("touchend",H)}function zy(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:a,fromType:l,doc:o,lib:i,flowId:c,isValidConnection:u=Fy,nodeLookup:m}){const d=l==="target",f=t?o.querySelector(`.${i}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y:v}=_n(e),b=o.elementFromPoint(p,v),x=b!=null&&b.classList.contains(`${i}-flow__handle`)?b:f,h={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const g=Dy(void 0,x),y=x.getAttribute("data-nodeid"),w=x.getAttribute("data-handleid"),E=x.classList.contains("connectable"),_=x.classList.contains("connectableend");if(!y||!g)return h;const S={source:d?y:r,sourceHandle:d?w:a,target:d?r:y,targetHandle:d?a:w};h.connection=S;const k=E&&_&&(n===Na.Strict?d&&g==="source"||!d&&g==="target":y!==r||w!==a);h.isValid=k&&u(S),h.toHandle=$y(y,g,w,m,n,!0)}return h}const Vd={onPointerDown:p3,isValid:zy};function x3({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const a=Gt(e);function l({translateExtent:i,width:c,height:u,zoomStep:m=1,pannable:d=!0,zoomable:f=!0,inversePan:p=!1}){const v=y=>{if(y.sourceEvent.type!=="wheel"||!t)return;const w=n(),E=y.sourceEvent.ctrlKey&&$l()?10:1,_=-y.sourceEvent.deltaY*(y.sourceEvent.deltaMode===1?.05:y.sourceEvent.deltaMode?1:.002)*m,S=w[2]*Math.pow(2,_*E);t.scaleTo(S)};let b=[0,0];const x=y=>{(y.sourceEvent.type==="mousedown"||y.sourceEvent.type==="touchstart")&&(b=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY])},h=y=>{const w=n();if(y.sourceEvent.type!=="mousemove"&&y.sourceEvent.type!=="touchmove"||!t)return;const E=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY],_=[E[0]-b[0],E[1]-b[1]];b=E;const S=r()*Math.max(w[2],Math.log(w[2]))*(p?-1:1),N={x:w[0]-_[0]*S,y:w[1]-_[1]*S},k=[[0,0],[c,u]];t.setViewportConstrained({x:N.x,y:N.y,zoom:w[2]},k,i)},g=hy().on("start",x).on("zoom",d?h:null).on("zoom.wheel",f?v:null);a.call(g,{})}function o(){a.on("zoom",null)}return{update:l,destroy:o,pointer:yn}}const xc=e=>({x:e.x,y:e.y,zoom:e.k}),xu=({x:e,y:t,zoom:n})=>fc.translate(e,t).scale(n),Kr=(e,t)=>e.target.closest(`.${t}`),Vy=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),g3=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,gu=(e,t=0,n=g3,r=()=>{})=>{const a=typeof t=="number"&&t>0;return a||r(),a?e.transition().duration(t).ease(n).on("end",r):e},Hy=e=>{const t=e.ctrlKey&&$l()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function v3({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:a,panOnScrollSpeed:l,zoomOnPinch:o,onPanZoomStart:i,onPanZoom:c,onPanZoomEnd:u}){return m=>{if(Kr(m,t))return m.ctrlKey&&m.preventDefault(),!1;m.preventDefault(),m.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(m.ctrlKey&&o){const x=yn(m),h=Hy(m),g=d*Math.pow(2,h);r.scaleTo(n,g,x,m);return}const f=m.deltaMode===1?20:1;let p=a===gr.Vertical?0:m.deltaX*f,v=a===gr.Horizontal?0:m.deltaY*f;!$l()&&m.shiftKey&&a!==gr.Vertical&&(p=m.deltaY*f,v=0),r.translateBy(n,-(p/d)*l,-(v/d)*l,{internal:!0});const b=xc(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(c==null||c(m,b),e.panScrollTimeout=setTimeout(()=>{u==null||u(m,b),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,i==null||i(m,b))}}function y3({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,a){const l=r.type==="wheel",o=!t&&l&&!r.ctrlKey,i=Kr(r,e);if(r.ctrlKey&&l&&i&&r.preventDefault(),o||i)return null;r.preventDefault(),n.call(this,r,a)}}function b3({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var l,o,i;if((l=r.sourceEvent)!=null&&l.internal)return;const a=xc(r.transform);e.mouseButton=((o=r.sourceEvent)==null?void 0:o.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=a,((i=r.sourceEvent)==null?void 0:i.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,a))}}function N3({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:a}){return l=>{var o,i;e.usedRightMouseButton=!!(n&&Vy(t,e.mouseButton??0)),(o=l.sourceEvent)!=null&&o.sync||r([l.transform.x,l.transform.y,l.transform.k]),a&&!((i=l.sourceEvent)!=null&&i.internal)&&(a==null||a(l.sourceEvent,xc(l.transform)))}}function j3({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:a,onPaneContextMenu:l}){return o=>{var i;if(!((i=o.sourceEvent)!=null&&i.internal)&&(e.isZoomingOrPanning=!1,l&&Vy(t,e.mouseButton??0)&&!e.usedRightMouseButton&&o.sourceEvent&&l(o.sourceEvent),e.usedRightMouseButton=!1,r(!1),a)){const c=xc(o.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{a==null||a(o.sourceEvent,c)},n?150:0)}}}function w3({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:a,zoomOnDoubleClick:l,userSelectionActive:o,noWheelClassName:i,noPanClassName:c,lib:u,connectionInProgress:m}){return d=>{var x;const f=e||t,p=n&&d.ctrlKey,v=d.type==="wheel";if(d.button===1&&d.type==="mousedown"&&(Kr(d,`${u}-flow__node`)||Kr(d,`${u}-flow__edge`)))return!0;if(!r&&!f&&!a&&!l&&!n||o||m&&!v||Kr(d,i)&&v||Kr(d,c)&&(!v||a&&v&&!e)||!n&&d.ctrlKey&&v)return!1;if(!n&&d.type==="touchstart"&&((x=d.touches)==null?void 0:x.length)>1)return d.preventDefault(),!1;if(!f&&!a&&!p&&v||!r&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(r)&&!r.includes(d.button)&&d.type==="mousedown")return!1;const b=Array.isArray(r)&&r.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||v)&&b}}function _3({domNode:e,minZoom:t,maxZoom:n,translateExtent:r,viewport:a,onPanZoom:l,onPanZoomStart:o,onPanZoomEnd:i,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},m=e.getBoundingClientRect(),d=hy().scaleExtent([t,n]).translateExtent(r),f=Gt(e).call(d);g({x:a.x,y:a.y,zoom:ja(a.zoom,t,n)},[[0,0],[m.width,m.height]],r);const p=f.on("wheel.zoom"),v=f.on("dblclick.zoom");d.wheelDelta(Hy);function b(C,O){return f?new Promise(F=>{d==null||d.interpolate((O==null?void 0:O.interpolate)==="linear"?rl:Xo).transform(gu(f,O==null?void 0:O.duration,O==null?void 0:O.ease,()=>F(!0)),C)}):Promise.resolve(!1)}function x({noWheelClassName:C,noPanClassName:O,onPaneContextMenu:F,userSelectionActive:j,panOnScroll:T,panOnDrag:I,panOnScrollMode:$,panOnScrollSpeed:P,preventScrolling:M,zoomOnPinch:D,zoomOnScroll:V,zoomOnDoubleClick:B,zoomActivationKeyPressed:K,lib:J,onTransformChange:ae,connectionInProgress:U,paneClickDistance:Y,selectionOnDrag:W}){j&&!u.isZoomingOrPanning&&h();const ie=T&&!K&&!j;d.clickDistance(W?1/0:!wn(Y)||Y<0?0:Y);const H=ie?v3({zoomPanValues:u,noWheelClassName:C,d3Selection:f,d3Zoom:d,panOnScrollMode:$,panOnScrollSpeed:P,zoomOnPinch:D,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:i}):y3({noWheelClassName:C,preventScrolling:M,d3ZoomHandler:p});if(f.on("wheel.zoom",H,{passive:!1}),!j){const Z=b3({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:o});d.on("start",Z);const oe=N3({zoomPanValues:u,panOnDrag:I,onPaneContextMenu:!!F,onPanZoom:l,onTransformChange:ae});d.on("zoom",oe);const fe=j3({zoomPanValues:u,panOnDrag:I,panOnScroll:T,onPaneContextMenu:F,onPanZoomEnd:i,onDraggingChange:c});d.on("end",fe)}const X=w3({zoomActivationKeyPressed:K,panOnDrag:I,zoomOnScroll:V,panOnScroll:T,zoomOnDoubleClick:B,zoomOnPinch:D,userSelectionActive:j,noPanClassName:O,noWheelClassName:C,lib:J,connectionInProgress:U});d.filter(X),B?f.on("dblclick.zoom",v):f.on("dblclick.zoom",null)}function h(){d.on("zoom",null)}async function g(C,O,F){const j=xu(C),T=d==null?void 0:d.constrain()(j,O,F);return T&&await b(T),new Promise(I=>I(T))}async function y(C,O){const F=xu(C);return await b(F,O),new Promise(j=>j(F))}function w(C){if(f){const O=xu(C),F=f.property("__zoom");(F.k!==C.zoom||F.x!==C.x||F.y!==C.y)&&(d==null||d.transform(f,O,null,{sync:!0}))}}function E(){const C=f?fy(f.node()):{x:0,y:0,k:1};return{x:C.x,y:C.y,zoom:C.k}}function _(C,O){return f?new Promise(F=>{d==null||d.interpolate((O==null?void 0:O.interpolate)==="linear"?rl:Xo).scaleTo(gu(f,O==null?void 0:O.duration,O==null?void 0:O.ease,()=>F(!0)),C)}):Promise.resolve(!1)}function S(C,O){return f?new Promise(F=>{d==null||d.interpolate((O==null?void 0:O.interpolate)==="linear"?rl:Xo).scaleBy(gu(f,O==null?void 0:O.duration,O==null?void 0:O.ease,()=>F(!0)),C)}):Promise.resolve(!1)}function N(C){d==null||d.scaleExtent(C)}function k(C){d==null||d.translateExtent(C)}function A(C){const O=!wn(C)||C<0?0:C;d==null||d.clickDistance(O)}return{update:x,destroy:h,setViewport:y,setViewportConstrained:g,getViewport:E,scaleTo:_,scaleBy:S,setScaleExtent:N,setTranslateExtent:k,syncViewport:w,setClickDistance:A}}var Sa;(function(e){e.Line="line",e.Handle="handle"})(Sa||(Sa={}));function S3({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:a,affectsY:l}){const o=e-t,i=n-r,c=[o>0?1:o<0?-1:0,i>0?1:i<0?-1:0];return o&&a&&(c[0]=c[0]*-1),i&&l&&(c[1]=c[1]*-1),c}function Hp(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),a=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:a}}function Es(e,t){return Math.max(0,t-e)}function As(e,t){return Math.max(0,e-t)}function Ro(e,t,n){return Math.max(0,t-e,e-n)}function Up(e,t){return e?!t:t}function k3(e,t,n,r,a,l,o,i){let{affectsX:c,affectsY:u}=t;const{isHorizontal:m,isVertical:d}=t,f=m&&d,{xSnapped:p,ySnapped:v}=n,{minWidth:b,maxWidth:x,minHeight:h,maxHeight:g}=r,{x:y,y:w,width:E,height:_,aspectRatio:S}=e;let N=Math.floor(m?p-e.pointerX:0),k=Math.floor(d?v-e.pointerY:0);const A=E+(c?-N:N),C=_+(u?-k:k),O=-l[0]*E,F=-l[1]*_;let j=Ro(A,b,x),T=Ro(C,h,g);if(o){let P=0,M=0;c&&N<0?P=Es(y+N+O,o[0][0]):!c&&N>0&&(P=As(y+A+O,o[1][0])),u&&k<0?M=Es(w+k+F,o[0][1]):!u&&k>0&&(M=As(w+C+F,o[1][1])),j=Math.max(j,P),T=Math.max(T,M)}if(i){let P=0,M=0;c&&N>0?P=As(y+N,i[0][0]):!c&&N<0&&(P=Es(y+A,i[1][0])),u&&k>0?M=As(w+k,i[0][1]):!u&&k<0&&(M=Es(w+C,i[1][1])),j=Math.max(j,P),T=Math.max(T,M)}if(a){if(m){const P=Ro(A/S,h,g)*S;if(j=Math.max(j,P),o){let M=0;!c&&!u||c&&!u&&f?M=As(w+F+A/S,o[1][1])*S:M=Es(w+F+(c?N:-N)/S,o[0][1])*S,j=Math.max(j,M)}if(i){let M=0;!c&&!u||c&&!u&&f?M=Es(w+A/S,i[1][1])*S:M=As(w+(c?N:-N)/S,i[0][1])*S,j=Math.max(j,M)}}if(d){const P=Ro(C*S,b,x)/S;if(T=Math.max(T,P),o){let M=0;!c&&!u||u&&!c&&f?M=As(y+C*S+O,o[1][0])/S:M=Es(y+(u?k:-k)*S+O,o[0][0])/S,T=Math.max(T,M)}if(i){let M=0;!c&&!u||u&&!c&&f?M=Es(y+C*S,i[1][0])/S:M=As(y+(u?k:-k)*S,i[0][0])/S,T=Math.max(T,M)}}}k=k+(k<0?T:-T),N=N+(N<0?j:-j),a&&(f?A>C*S?k=(Up(c,u)?-N:N)/S:N=(Up(c,u)?-k:k)*S:m?(k=N/S,u=c):(N=k*S,c=u));const I=c?y+N:y,$=u?w+k:w;return{width:E+(c?-N:N),height:_+(u?-k:k),x:l[0]*N*(c?-1:1)+I,y:l[1]*k*(u?-1:1)+$}}const Uy={width:0,height:0,x:0,y:0},C3={...Uy,pointerX:0,pointerY:0,aspectRatio:1};function E3(e){return[[0,0],[e.measured.width,e.measured.height]]}function A3(e,t,n){const r=t.position.x+e.position.x,a=t.position.y+e.position.y,l=e.measured.width??0,o=e.measured.height??0,i=n[0]*l,c=n[1]*o;return[[r-i,a-c],[r+l-i,a+o-c]]}function P3({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:a}){const l=Gt(e);let o={controlDirection:Hp("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function i({controlPosition:u,boundaries:m,keepAspectRatio:d,resizeDirection:f,onResizeStart:p,onResize:v,onResizeEnd:b,shouldResize:x}){let h={...Uy},g={...C3};o={boundaries:m,resizeDirection:f,keepAspectRatio:d,controlDirection:Hp(u)};let y,w=null,E=[],_,S,N,k=!1;const A=Jv().on("start",C=>{const{nodeLookup:O,transform:F,snapGrid:j,snapToGrid:T,nodeOrigin:I,paneDomNode:$}=n();if(y=O.get(t),!y)return;w=($==null?void 0:$.getBoundingClientRect())??null;const{xSnapped:P,ySnapped:M}=al(C.sourceEvent,{transform:F,snapGrid:j,snapToGrid:T,containerBounds:w});h={width:y.measured.width??0,height:y.measured.height??0,x:y.position.x??0,y:y.position.y??0},g={...h,pointerX:P,pointerY:M,aspectRatio:h.width/h.height},_=void 0,y.parentId&&(y.extent==="parent"||y.expandParent)&&(_=O.get(y.parentId),S=_&&y.extent==="parent"?E3(_):void 0),E=[],N=void 0;for(const[D,V]of O)if(V.parentId===t&&(E.push({id:D,position:{...V.position},extent:V.extent}),V.extent==="parent"||V.expandParent)){const B=A3(V,y,V.origin??I);N?N=[[Math.min(B[0][0],N[0][0]),Math.min(B[0][1],N[0][1])],[Math.max(B[1][0],N[1][0]),Math.max(B[1][1],N[1][1])]]:N=B}p==null||p(C,{...h})}).on("drag",C=>{const{transform:O,snapGrid:F,snapToGrid:j,nodeOrigin:T}=n(),I=al(C.sourceEvent,{transform:O,snapGrid:F,snapToGrid:j,containerBounds:w}),$=[];if(!y)return;const{x:P,y:M,width:D,height:V}=h,B={},K=y.origin??T,{width:J,height:ae,x:U,y:Y}=k3(g,o.controlDirection,I,o.boundaries,o.keepAspectRatio,K,S,N),W=J!==D,ie=ae!==V,H=U!==P&&W,X=Y!==M&&ie;if(!H&&!X&&!W&&!ie)return;if((H||X||K[0]===1||K[1]===1)&&(B.x=H?U:h.x,B.y=X?Y:h.y,h.x=B.x,h.y=B.y,E.length>0)){const ge=U-P,L=Y-M;for(const G of E)G.position={x:G.position.x-ge+K[0]*(J-D),y:G.position.y-L+K[1]*(ae-V)},$.push(G)}if((W||ie)&&(B.width=W&&(!o.resizeDirection||o.resizeDirection==="horizontal")?J:h.width,B.height=ie&&(!o.resizeDirection||o.resizeDirection==="vertical")?ae:h.height,h.width=B.width,h.height=B.height),_&&y.expandParent){const ge=K[0]*(B.width??0);B.x&&B.x<ge&&(h.x=ge,g.x=g.x-(B.x-ge));const L=K[1]*(B.height??0);B.y&&B.y<L&&(h.y=L,g.y=g.y-(B.y-L))}const Z=S3({width:h.width,prevWidth:D,height:h.height,prevHeight:V,affectsX:o.controlDirection.affectsX,affectsY:o.controlDirection.affectsY}),oe={...h,direction:Z};(x==null?void 0:x(C,oe))!==!1&&(k=!0,v==null||v(C,oe),r(B,$))}).on("end",C=>{k&&(b==null||b(C,{...h}),a==null||a({...h}),k=!1)});l.call(A)}function c(){l.on(".drag",null)}return{update:i,destroy:c}}const{useDebugValue:R3}=Gd,{useSyncExternalStoreWithSelector:M3}=Mg,T3=e=>e;function By(e,t=T3,n){const r=M3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return R3(r),r}const Bp=(e,t)=>{const n=Cg(e),r=(a,l=t)=>By(n,a,l);return Object.assign(r,n),r},O3=(e,t)=>e?Bp(e,t):Bp;function He(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,a]of e)if(!Object.is(a,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const gc=R.createContext(null),I3=gc.Provider,Yy=ns.error001();function Ee(e,t){const n=R.useContext(gc);if(n===null)throw new Error(Yy);return By(n,e,t)}function Ue(){const e=R.useContext(gc);if(e===null)throw new Error(Yy);return R.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Yp={display:"none"},L3={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Wy="react-flow__node-desc",Gy="react-flow__edge-desc",$3="react-flow__aria-live",D3=e=>e.ariaLiveMessage,F3=e=>e.ariaLabelConfig;function z3({rfId:e}){const t=Ee(D3);return s.jsx("div",{id:`${$3}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:L3,children:t})}function V3({rfId:e,disableKeyboardA11y:t}){const n=Ee(F3);return s.jsxs(s.Fragment,{children:[s.jsx("div",{id:`${Wy}-${e}`,style:Yp,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),s.jsx("div",{id:`${Gy}-${e}`,style:Yp,children:n["edge.a11yDescription.default"]}),!t&&s.jsx(z3,{rfId:e})]})}const vc=R.forwardRef(({position:e="top-left",children:t,className:n,style:r,...a},l)=>{const o=`${e}`.split("-");return s.jsx("div",{className:et(["react-flow__panel",n,...o]),style:r,ref:l,...a,children:t})});vc.displayName="Panel";function H3({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:s.jsx(vc,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:s.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const U3=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},Mo=e=>e.id;function B3(e,t){return He(e.selectedNodes.map(Mo),t.selectedNodes.map(Mo))&&He(e.selectedEdges.map(Mo),t.selectedEdges.map(Mo))}function Y3({onSelectionChange:e}){const t=Ue(),{selectedNodes:n,selectedEdges:r}=Ee(U3,B3);return R.useEffect(()=>{const a={nodes:n,edges:r};e==null||e(a),t.getState().onSelectionChangeHandlers.forEach(l=>l(a))},[n,r,e]),null}const W3=e=>!!e.onSelectionChangeHandlers;function G3({onSelectionChange:e}){const t=Ee(W3);return e||t?s.jsx(Y3,{onSelectionChange:e}):null}const qy=[0,0],q3={x:0,y:0,zoom:1},X3=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],Wp=[...X3,"rfId"],Q3=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),Gp={translateExtent:Ol,nodeOrigin:qy,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function K3(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:a,setTranslateExtent:l,setNodeExtent:o,reset:i,setDefaultNodesAndEdges:c}=Ee(Q3,He),u=Ue();R.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{m.current=Gp,i()}),[]);const m=R.useRef(Gp);return R.useEffect(()=>{for(const d of Wp){const f=e[d],p=m.current[d];f!==p&&(typeof e[d]>"u"||(d==="nodes"?t(f):d==="edges"?n(f):d==="minZoom"?r(f):d==="maxZoom"?a(f):d==="translateExtent"?l(f):d==="nodeExtent"?o(f):d==="ariaLabelConfig"?u.setState({ariaLabelConfig:H5(f)}):d==="fitView"?u.setState({fitViewQueued:f}):d==="fitViewOptions"?u.setState({fitViewOptions:f}):u.setState({[d]:f})))}m.current=e},Wp.map(d=>e[d])),null}function qp(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Z3(e){var r;const[t,n]=R.useState(e==="system"?null:e);return R.useEffect(()=>{if(e!=="system"){n(e);return}const a=qp(),l=()=>n(a!=null&&a.matches?"dark":"light");return l(),a==null||a.addEventListener("change",l),()=>{a==null||a.removeEventListener("change",l)}},[e]),t!==null?t:(r=qp())!=null&&r.matches?"dark":"light"}const Xp=typeof document<"u"?document:null;function Dl(e=null,t={target:Xp,actInsideInputWithModifier:!0}){const[n,r]=R.useState(!1),a=R.useRef(!1),l=R.useRef(new Set([])),[o,i]=R.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),m=u.reduce((d,f)=>d.concat(...f),[]);return[u,m]}return[[],[]]},[e]);return R.useEffect(()=>{const c=(t==null?void 0:t.target)??Xp,u=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const m=p=>{var x,h;if(a.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!a.current||a.current&&!u)&&Cy(p))return!1;const b=Kp(p.code,i);if(l.current.add(p[b]),Qp(o,l.current,!1)){const g=((h=(x=p.composedPath)==null?void 0:x.call(p))==null?void 0:h[0])||p.target,y=(g==null?void 0:g.nodeName)==="BUTTON"||(g==null?void 0:g.nodeName)==="A";t.preventDefault!==!1&&(a.current||!y)&&p.preventDefault(),r(!0)}},d=p=>{const v=Kp(p.code,i);Qp(o,l.current,!0)?(r(!1),l.current.clear()):l.current.delete(p[v]),p.key==="Meta"&&l.current.clear(),a.current=!1},f=()=>{l.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",m),c==null||c.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c==null||c.removeEventListener("keydown",m),c==null||c.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function Qp(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(a=>t.has(a)))}function Kp(e,t){return t.includes(e)?"code":"key"}const J3=()=>{const e=Ue();return R.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,a,l],panZoom:o}=e.getState();return o?(await o.setViewport({x:t.x??r,y:t.y??a,zoom:t.zoom??l},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:a,minZoom:l,maxZoom:o,panZoom:i}=e.getState(),c=rf(t,r,a,l,o,(n==null?void 0:n.padding)??.1);return i?(await i.setViewport(c,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:a,snapToGrid:l,domNode:o}=e.getState();if(!o)return t;const{x:i,y:c}=o.getBoundingClientRect(),u={x:t.x-i,y:t.y-c},m=n.snapGrid??a,d=n.snapToGrid??l;return Jl(u,r,d,m)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:a,y:l}=r.getBoundingClientRect(),o=Hi(t,n);return{x:o.x+a,y:o.y+l}}}),[])};function Xy(e,t){const n=[],r=new Map,a=[];for(const l of e)if(l.type==="add"){a.push(l);continue}else if(l.type==="remove"||l.type==="replace")r.set(l.id,[l]);else{const o=r.get(l.id);o?o.push(l):r.set(l.id,[l])}for(const l of t){const o=r.get(l.id);if(!o){n.push(l);continue}if(o[0].type==="remove")continue;if(o[0].type==="replace"){n.push({...o[0].item});continue}const i={...l};for(const c of o)eE(c,i);n.push(i)}return a.length&&a.forEach(l=>{l.index!==void 0?n.splice(l.index,0,{...l.item}):n.push({...l.item})}),n}function eE(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Qy(e,t){return Xy(e,t)}function Ky(e,t){return Xy(e,t)}function or(e,t){return{id:e,type:"select",selected:t}}function Zr(e,t=new Set,n=!1){const r=[];for(const[a,l]of e){const o=t.has(a);!(l.selected===void 0&&!o)&&l.selected!==o&&(n&&(l.selected=o),r.push(or(l.id,o)))}return r}function Zp({items:e=[],lookup:t}){var a;const n=[],r=new Map(e.map(l=>[l.id,l]));for(const[l,o]of e.entries()){const i=t.get(o.id),c=((a=i==null?void 0:i.internals)==null?void 0:a.userNode)??i;c!==void 0&&c!==o&&n.push({id:o.id,item:o,type:"replace"}),c===void 0&&n.push({item:o,type:"add",index:l})}for(const[l]of t)r.get(l)===void 0&&n.push({id:l,type:"remove"});return n}function Jp(e){return{id:e.id,type:"remove"}}const e0=e=>M5(e),tE=e=>yy(e);function Zy(e){return R.forwardRef(e)}const nE=typeof window<"u"?R.useLayoutEffect:R.useEffect;function t0(e){const[t,n]=R.useState(BigInt(0)),[r]=R.useState(()=>sE(()=>n(a=>a+BigInt(1))));return nE(()=>{const a=r.get();a.length&&(e(a),r.reset())},[t]),r}function sE(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Jy=R.createContext(null);function rE({children:e}){const t=Ue(),n=R.useCallback(i=>{const{nodes:c=[],setNodes:u,hasDefaultNodes:m,onNodesChange:d,nodeLookup:f,fitViewQueued:p,onNodesChangeMiddlewareMap:v}=t.getState();let b=c;for(const h of i)b=typeof h=="function"?h(b):h;let x=Zp({items:b,lookup:f});for(const h of v.values())x=h(x);m&&u(b),x.length>0?d==null||d(x):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:h,nodes:g,setNodes:y}=t.getState();h&&y(g)})},[]),r=t0(n),a=R.useCallback(i=>{const{edges:c=[],setEdges:u,hasDefaultEdges:m,onEdgesChange:d,edgeLookup:f}=t.getState();let p=c;for(const v of i)p=typeof v=="function"?v(p):v;m?u(p):d&&d(Zp({items:p,lookup:f}))},[]),l=t0(a),o=R.useMemo(()=>({nodeQueue:r,edgeQueue:l}),[]);return s.jsx(Jy.Provider,{value:o,children:e})}function aE(){const e=R.useContext(Jy);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const lE=e=>!!e.panZoom;function mf(){const e=J3(),t=Ue(),n=aE(),r=Ee(lE),a=R.useMemo(()=>{const l=d=>t.getState().nodeLookup.get(d),o=d=>{n.nodeQueue.push(d)},i=d=>{n.edgeQueue.push(d)},c=d=>{var h,g;const{nodeLookup:f,nodeOrigin:p}=t.getState(),v=e0(d)?d:f.get(d.id),b=v.parentId?Sy(v.position,v.measured,v.parentId,f,p):v.position,x={...v,position:b,width:((h=v.measured)==null?void 0:h.width)??v.width,height:((g=v.measured)==null?void 0:g.height)??v.height};return wa(x)},u=(d,f,p={replace:!1})=>{o(v=>v.map(b=>{if(b.id===d){const x=typeof f=="function"?f(b):f;return p.replace&&e0(x)?x:{...b,...x}}return b}))},m=(d,f,p={replace:!1})=>{i(v=>v.map(b=>{if(b.id===d){const x=typeof f=="function"?f(b):f;return p.replace&&tE(x)?x:{...b,...x}}return b}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=l(d))==null?void 0:f.internals.userNode},getInternalNode:l,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:o,setEdges:i,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:p}=t.getState(),[v,b,x]=p;return{nodes:d.map(h=>({...h})),edges:f.map(h=>({...h})),viewport:{x:v,y:b,zoom:x}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:p,edges:v,onNodesDelete:b,onEdgesDelete:x,triggerNodeChanges:h,triggerEdgeChanges:g,onDelete:y,onBeforeDelete:w}=t.getState(),{nodes:E,edges:_}=await $5({nodesToRemove:d,edgesToRemove:f,nodes:p,edges:v,onBeforeDelete:w}),S=_.length>0,N=E.length>0;if(S){const k=_.map(Jp);x==null||x(_),g(k)}if(N){const k=E.map(Jp);b==null||b(E),h(k)}return(N||S)&&(y==null||y({nodes:E,edges:_})),{deletedNodes:E,deletedEdges:_}},getIntersectingNodes:(d,f=!0,p)=>{const v=Rp(d),b=v?d:c(d),x=p!==void 0;return b?(p||t.getState().nodes).filter(h=>{const g=t.getState().nodeLookup.get(h.id);if(g&&!v&&(h.id===d.id||!g.internals.positionAbsolute))return!1;const y=wa(x?h:g),w=Ll(y,b);return f&&w>0||w>=y.width*y.height||w>=b.width*b.height}):[]},isNodeIntersecting:(d,f,p=!0)=>{const b=Rp(d)?d:c(d);if(!b)return!1;const x=Ll(b,f);return p&&x>0||x>=f.width*f.height||x>=b.width*b.height},updateNode:u,updateNodeData:(d,f,p={replace:!1})=>{u(d,v=>{const b=typeof f=="function"?f(v):f;return p.replace?{...v,data:b}:{...v,data:{...v.data,...b}}},p)},updateEdge:m,updateEdgeData:(d,f,p={replace:!1})=>{m(d,v=>{const b=typeof f=="function"?f(v):f;return p.replace?{...v,data:b}:{...v,data:{...v.data,...b}}},p)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:p}=t.getState();return T5(d,{nodeLookup:f,nodeOrigin:p})},getHandleConnections:({type:d,id:f,nodeId:p})=>{var v;return Array.from(((v=t.getState().connectionLookup.get(`${p}-${d}${f?`-${f}`:""}`))==null?void 0:v.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:p})=>{var v;return Array.from(((v=t.getState().connectionLookup.get(`${p}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:v.values())??[])},fitView:async d=>{const f=t.getState().fitViewResolver??V5();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),n.nodeQueue.push(p=>[...p]),f.promise}}},[]);return R.useMemo(()=>({...a,...e,viewportInitialized:r}),[r])}const n0=e=>e.selected,oE=typeof window<"u"?window:void 0;function iE({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=Ue(),{deleteElements:r}=mf(),a=Dl(e,{actInsideInputWithModifier:!1}),l=Dl(t,{target:oE});R.useEffect(()=>{if(a){const{edges:o,nodes:i}=n.getState();r({nodes:i.filter(n0),edges:o.filter(n0)}),n.setState({nodesSelectionActive:!1})}},[a]),R.useEffect(()=>{n.setState({multiSelectionActive:l})},[l])}function cE(e){const t=Ue();R.useEffect(()=>{const n=()=>{var a,l,o,i;if(!e.current||!(((l=(a=e.current).checkVisibility)==null?void 0:l.call(a))??!0))return!1;const r=af(e.current);(r.height===0||r.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",ns.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const yc={position:"absolute",width:"100%",height:"100%",top:0,left:0},uE=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function dE({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=gr.Free,zoomOnDoubleClick:o=!0,panOnDrag:i=!0,defaultViewport:c,translateExtent:u,minZoom:m,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:p=!0,children:v,noWheelClassName:b,noPanClassName:x,onViewportChange:h,isControlledViewport:g,paneClickDistance:y,selectionOnDrag:w}){const E=Ue(),_=R.useRef(null),{userSelectionActive:S,lib:N,connectionInProgress:k}=Ee(uE,He),A=Dl(f),C=R.useRef();cE(_);const O=R.useCallback(F=>{h==null||h({x:F[0],y:F[1],zoom:F[2]}),g||E.setState({transform:F})},[h,g]);return R.useEffect(()=>{if(_.current){C.current=_3({domNode:_.current,minZoom:m,maxZoom:d,translateExtent:u,viewport:c,onDraggingChange:I=>E.setState({paneDragging:I}),onPanZoomStart:(I,$)=>{const{onViewportChangeStart:P,onMoveStart:M}=E.getState();M==null||M(I,$),P==null||P($)},onPanZoom:(I,$)=>{const{onViewportChange:P,onMove:M}=E.getState();M==null||M(I,$),P==null||P($)},onPanZoomEnd:(I,$)=>{const{onViewportChangeEnd:P,onMoveEnd:M}=E.getState();M==null||M(I,$),P==null||P($)}});const{x:F,y:j,zoom:T}=C.current.getViewport();return E.setState({panZoom:C.current,transform:[F,j,T],domNode:_.current.closest(".react-flow")}),()=>{var I;(I=C.current)==null||I.destroy()}}},[]),R.useEffect(()=>{var F;(F=C.current)==null||F.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:a,panOnScrollMode:l,zoomOnDoubleClick:o,panOnDrag:i,zoomActivationKeyPressed:A,preventScrolling:p,noPanClassName:x,userSelectionActive:S,noWheelClassName:b,lib:N,onTransformChange:O,connectionInProgress:k,selectionOnDrag:w,paneClickDistance:y})},[e,t,n,r,a,l,o,i,A,p,x,S,b,N,O,k,w,y]),s.jsx("div",{className:"react-flow__renderer",ref:_,style:yc,children:v})}const mE=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function fE(){const{userSelectionActive:e,userSelectionRect:t}=Ee(mE,He);return e&&t?s.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const vu=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},hE=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function pE({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Il.Full,panOnDrag:r,paneClickDistance:a,selectionOnDrag:l,onSelectionStart:o,onSelectionEnd:i,onPaneClick:c,onPaneContextMenu:u,onPaneScroll:m,onPaneMouseEnter:d,onPaneMouseMove:f,onPaneMouseLeave:p,children:v}){const b=Ue(),{userSelectionActive:x,elementsSelectable:h,dragging:g,connectionInProgress:y}=Ee(hE,He),w=h&&(e||x),E=R.useRef(null),_=R.useRef(),S=R.useRef(new Set),N=R.useRef(new Set),k=R.useRef(!1),A=P=>{if(k.current||y){k.current=!1;return}c==null||c(P),b.getState().resetSelectedElements(),b.setState({nodesSelectionActive:!1})},C=P=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){P.preventDefault();return}u==null||u(P)},O=m?P=>m(P):void 0,F=P=>{k.current&&(P.stopPropagation(),k.current=!1)},j=P=>{var ae,U;const{domNode:M}=b.getState();if(_.current=M==null?void 0:M.getBoundingClientRect(),!_.current)return;const D=P.target===E.current;if(!D&&!!P.target.closest(".nokey")||!e||!(l&&D||t)||P.button!==0||!P.isPrimary)return;(U=(ae=P.target)==null?void 0:ae.setPointerCapture)==null||U.call(ae,P.pointerId),k.current=!1;const{x:K,y:J}=_n(P.nativeEvent,_.current);b.setState({userSelectionRect:{width:0,height:0,startX:K,startY:J,x:K,y:J}}),D||(P.stopPropagation(),P.preventDefault())},T=P=>{const{userSelectionRect:M,transform:D,nodeLookup:V,edgeLookup:B,connectionLookup:K,triggerNodeChanges:J,triggerEdgeChanges:ae,defaultEdgeOptions:U,resetSelectedElements:Y}=b.getState();if(!_.current||!M)return;const{x:W,y:ie}=_n(P.nativeEvent,_.current),{startX:H,startY:X}=M;if(!k.current){const L=t?0:a;if(Math.hypot(W-H,ie-X)<=L)return;Y(),o==null||o(P)}k.current=!0;const Z={startX:H,startY:X,x:W<H?W:H,y:ie<X?ie:X,width:Math.abs(W-H),height:Math.abs(ie-X)},oe=S.current,fe=N.current;S.current=new Set(sf(V,Z,D,n===Il.Partial,!0).map(L=>L.id)),N.current=new Set;const ge=(U==null?void 0:U.selectable)??!0;for(const L of S.current){const G=K.get(L);if(G)for(const{edgeId:ve}of G.values()){const me=B.get(ve);me&&(me.selectable??ge)&&N.current.add(ve)}}if(!Mp(oe,S.current)){const L=Zr(V,S.current,!0);J(L)}if(!Mp(fe,N.current)){const L=Zr(B,N.current);ae(L)}b.setState({userSelectionRect:Z,userSelectionActive:!0,nodesSelectionActive:!1})},I=P=>{var M,D;P.button===0&&((D=(M=P.target)==null?void 0:M.releasePointerCapture)==null||D.call(M,P.pointerId),!x&&P.target===E.current&&b.getState().userSelectionRect&&(A==null||A(P)),b.setState({userSelectionActive:!1,userSelectionRect:null}),k.current&&(i==null||i(P),b.setState({nodesSelectionActive:S.current.size>0})))},$=r===!0||Array.isArray(r)&&r.includes(0);return s.jsxs("div",{className:et(["react-flow__pane",{draggable:$,dragging:g,selection:e}]),onClick:w?void 0:vu(A,E),onContextMenu:vu(C,E),onWheel:vu(O,E),onPointerEnter:w?void 0:d,onPointerMove:w?T:f,onPointerUp:w?I:void 0,onPointerDownCapture:w?j:void 0,onClickCapture:w?F:void 0,onPointerLeave:p,ref:E,style:yc,children:[v,s.jsx(fE,{})]})}function Hd({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:a,unselectNodesAndEdges:l,multiSelectionActive:o,nodeLookup:i,onError:c}=t.getState(),u=i.get(e);if(!u){c==null||c("012",ns.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&o)&&(l({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var m;return(m=r==null?void 0:r.current)==null?void 0:m.blur()})):a([e])}function eb({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:a,isSelectable:l,nodeClickDistance:o}){const i=Ue(),[c,u]=R.useState(!1),m=R.useRef();return R.useEffect(()=>{m.current=u3({getStoreItems:()=>i.getState(),onNodeMouseDown:d=>{Hd({id:d,store:i,nodeRef:e})},onDragStart:()=>{u(!0)},onDragStop:()=>{u(!1)}})},[]),R.useEffect(()=>{var d,f;if(t)(d=m.current)==null||d.destroy();else if(e.current)return(f=m.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:l,nodeId:a,nodeClickDistance:o}),()=>{var p;(p=m.current)==null||p.destroy()}},[n,r,t,l,e,a]),c}const xE=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function tb(){const e=Ue();return R.useCallback(n=>{const{nodeExtent:r,snapToGrid:a,snapGrid:l,nodesDraggable:o,onError:i,updateNodePositions:c,nodeLookup:u,nodeOrigin:m}=e.getState(),d=new Map,f=xE(o),p=a?l[0]:5,v=a?l[1]:5,b=n.direction.x*p*n.factor,x=n.direction.y*v*n.factor;for(const[,h]of u){if(!f(h))continue;let g={x:h.internals.positionAbsolute.x+b,y:h.internals.positionAbsolute.y+x};a&&(g=Zl(g,l));const{position:y,positionAbsolute:w}=by({nodeId:h.id,nextPosition:g,nodeLookup:u,nodeExtent:r,nodeOrigin:m,onError:i});h.position=y,h.internals.positionAbsolute=w,d.set(h.id,h)}c(d)},[])}const ff=R.createContext(null),gE=ff.Provider;ff.Consumer;const nb=()=>R.useContext(ff),vE=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),yE=(e,t,n)=>r=>{const{connectionClickStartHandle:a,connectionMode:l,connection:o}=r,{fromHandle:i,toHandle:c,isValid:u}=o,m=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.id)===t&&(i==null?void 0:i.type)===n,connectingTo:m,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,isPossibleEndHandle:l===Na.Strict?(i==null?void 0:i.type)!==n:e!==(i==null?void 0:i.nodeId)||t!==(i==null?void 0:i.id),connectionInProcess:!!i,clickConnectionInProcess:!!a,valid:m&&u}};function bE({type:e="source",position:t=he.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:a=!0,isConnectableEnd:l=!0,id:o,onConnect:i,children:c,className:u,onMouseDown:m,onTouchStart:d,...f},p){var T,I;const v=o||null,b=e==="target",x=Ue(),h=nb(),{connectOnClick:g,noPanClassName:y,rfId:w}=Ee(vE,He),{connectingFrom:E,connectingTo:_,clickConnecting:S,isPossibleEndHandle:N,connectionInProcess:k,clickConnectionInProcess:A,valid:C}=Ee(yE(h,v,e),He);h||(I=(T=x.getState()).onError)==null||I.call(T,"010",ns.error010());const O=$=>{const{defaultEdgeOptions:P,onConnect:M,hasDefaultEdges:D}=x.getState(),V={...P,...$};if(D){const{edges:B,setEdges:K}=x.getState();K(q5(V,B))}M==null||M(V),i==null||i(V)},F=$=>{if(!h)return;const P=Ey($.nativeEvent);if(a&&(P&&$.button===0||!P)){const M=x.getState();Vd.onPointerDown($.nativeEvent,{handleDomNode:$.currentTarget,autoPanOnConnect:M.autoPanOnConnect,connectionMode:M.connectionMode,connectionRadius:M.connectionRadius,domNode:M.domNode,nodeLookup:M.nodeLookup,lib:M.lib,isTarget:b,handleId:v,nodeId:h,flowId:M.rfId,panBy:M.panBy,cancelConnection:M.cancelConnection,onConnectStart:M.onConnectStart,onConnectEnd:M.onConnectEnd,updateConnection:M.updateConnection,onConnect:O,isValidConnection:n||M.isValidConnection,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,autoPanSpeed:M.autoPanSpeed,dragThreshold:M.connectionDragThreshold})}P?m==null||m($):d==null||d($)},j=$=>{const{onClickConnectStart:P,onClickConnectEnd:M,connectionClickStartHandle:D,connectionMode:V,isValidConnection:B,lib:K,rfId:J,nodeLookup:ae,connection:U}=x.getState();if(!h||!D&&!a)return;if(!D){P==null||P($.nativeEvent,{nodeId:h,handleId:v,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:h,type:e,id:v}});return}const Y=ky($.target),W=n||B,{connection:ie,isValid:H}=Vd.isValid($.nativeEvent,{handle:{nodeId:h,id:v,type:e},connectionMode:V,fromNodeId:D.nodeId,fromHandleId:D.id||null,fromType:D.type,isValidConnection:W,flowId:J,doc:Y,lib:K,nodeLookup:ae});H&&ie&&O(ie);const X=structuredClone(U);delete X.inProgress,X.toPosition=X.toHandle?X.toHandle.position:null,M==null||M($,X),x.setState({connectionClickStartHandle:null})};return s.jsx("div",{"data-handleid":v,"data-nodeid":h,"data-handlepos":t,"data-id":`${w}-${h}-${v}-${e}`,className:et(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",y,u,{source:!b,target:b,connectable:r,connectablestart:a,connectableend:l,clickconnecting:S,connectingfrom:E,connectingto:_,valid:C,connectionindicator:r&&(!k||N)&&(k||A?l:a)}]),onMouseDown:F,onTouchStart:F,onClick:g?j:void 0,ref:p,...f,children:c})}const Zs=R.memo(Zy(bE));function NE({data:e,isConnectable:t,sourcePosition:n=he.Bottom}){return s.jsxs(s.Fragment,{children:[e==null?void 0:e.label,s.jsx(Zs,{type:"source",position:n,isConnectable:t})]})}function jE({data:e,isConnectable:t,targetPosition:n=he.Top,sourcePosition:r=he.Bottom}){return s.jsxs(s.Fragment,{children:[s.jsx(Zs,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,s.jsx(Zs,{type:"source",position:r,isConnectable:t})]})}function wE(){return null}function _E({data:e,isConnectable:t,targetPosition:n=he.Top}){return s.jsxs(s.Fragment,{children:[s.jsx(Zs,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Ui={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},s0={input:NE,default:jE,output:_E,group:wE};function SE(e){var t,n,r,a;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((a=e.style)==null?void 0:a.height)}}const kE=e=>{const{width:t,height:n,x:r,y:a}=Kl(e.nodeLookup,{filter:l=>!!l.selected});return{width:wn(t)?t:null,height:wn(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${a}px)`}};function CE({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=Ue(),{width:a,height:l,transformString:o,userSelectionActive:i}=Ee(kE,He),c=tb(),u=R.useRef(null);if(R.useEffect(()=>{var f;n||(f=u.current)==null||f.focus({preventScroll:!0})},[n]),eb({nodeRef:u}),i||!a||!l)return null;const m=e?f=>{const p=r.getState().nodes.filter(v=>v.selected);e(f,p)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(Ui,f.key)&&(f.preventDefault(),c({direction:Ui[f.key],factor:f.shiftKey?4:1}))};return s.jsx("div",{className:et(["react-flow__nodesselection","react-flow__container",t]),style:{transform:o},children:s.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:a,height:l}})})}const r0=typeof window<"u"?window:void 0,EE=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function sb({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:o,paneClickDistance:i,deleteKeyCode:c,selectionKeyCode:u,selectionOnDrag:m,selectionMode:d,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:v,panActivationKeyCode:b,zoomActivationKeyCode:x,elementsSelectable:h,zoomOnScroll:g,zoomOnPinch:y,panOnScroll:w,panOnScrollSpeed:E,panOnScrollMode:_,zoomOnDoubleClick:S,panOnDrag:N,defaultViewport:k,translateExtent:A,minZoom:C,maxZoom:O,preventScrolling:F,onSelectionContextMenu:j,noWheelClassName:T,noPanClassName:I,disableKeyboardA11y:$,onViewportChange:P,isControlledViewport:M}){const{nodesSelectionActive:D,userSelectionActive:V}=Ee(EE,He),B=Dl(u,{target:r0}),K=Dl(b,{target:r0}),J=K||N,ae=K||w,U=m&&J!==!0,Y=B||V||U;return iE({deleteKeyCode:c,multiSelectionKeyCode:v}),s.jsx(dE,{onPaneContextMenu:l,elementsSelectable:h,zoomOnScroll:g,zoomOnPinch:y,panOnScroll:ae,panOnScrollSpeed:E,panOnScrollMode:_,zoomOnDoubleClick:S,panOnDrag:!B&&J,defaultViewport:k,translateExtent:A,minZoom:C,maxZoom:O,zoomActivationKeyCode:x,preventScrolling:F,noWheelClassName:T,noPanClassName:I,onViewportChange:P,isControlledViewport:M,paneClickDistance:i,selectionOnDrag:U,children:s.jsxs(pE,{onSelectionStart:f,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:a,onPaneContextMenu:l,onPaneScroll:o,panOnDrag:J,isSelecting:!!Y,selectionMode:d,selectionKeyPressed:B,paneClickDistance:i,selectionOnDrag:U,children:[e,D&&s.jsx(CE,{onSelectionContextMenu:j,noPanClassName:I,disableKeyboardA11y:$})]})})}sb.displayName="FlowRenderer";const AE=R.memo(sb),PE=e=>t=>e?sf(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function RE(e){return Ee(R.useCallback(PE(e),[e]),He)}const ME=e=>e.updateNodeInternals;function TE(){const e=Ee(ME),[t]=R.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(a=>{const l=a.target.getAttribute("data-id");r.set(l,{id:l,nodeElement:a.target,force:!0})}),e(r)}));return R.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function OE({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const a=Ue(),l=R.useRef(null),o=R.useRef(null),i=R.useRef(e.sourcePosition),c=R.useRef(e.targetPosition),u=R.useRef(t),m=n&&!!e.internals.handleBounds;return R.useEffect(()=>{l.current&&!e.hidden&&(!m||o.current!==l.current)&&(o.current&&(r==null||r.unobserve(o.current)),r==null||r.observe(l.current),o.current=l.current)},[m,e.hidden]),R.useEffect(()=>()=>{o.current&&(r==null||r.unobserve(o.current),o.current=null)},[]),R.useEffect(()=>{if(l.current){const d=u.current!==t,f=i.current!==e.sourcePosition,p=c.current!==e.targetPosition;(d||f||p)&&(u.current=t,i.current=e.sourcePosition,c.current=e.targetPosition,a.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:l.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),l}function IE({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:a,onContextMenu:l,onDoubleClick:o,nodesDraggable:i,elementsSelectable:c,nodesConnectable:u,nodesFocusable:m,resizeObserver:d,noDragClassName:f,noPanClassName:p,disableKeyboardA11y:v,rfId:b,nodeTypes:x,nodeClickDistance:h,onError:g}){const{node:y,internals:w,isParent:E}=Ee(W=>{const ie=W.nodeLookup.get(e),H=W.parentLookup.has(e);return{node:ie,internals:ie.internals,isParent:H}},He);let _=y.type||"default",S=(x==null?void 0:x[_])||s0[_];S===void 0&&(g==null||g("003",ns.error003(_)),_="default",S=(x==null?void 0:x.default)||s0.default);const N=!!(y.draggable||i&&typeof y.draggable>"u"),k=!!(y.selectable||c&&typeof y.selectable>"u"),A=!!(y.connectable||u&&typeof y.connectable>"u"),C=!!(y.focusable||m&&typeof y.focusable>"u"),O=Ue(),F=_y(y),j=OE({node:y,nodeType:_,hasDimensions:F,resizeObserver:d}),T=eb({nodeRef:j,disabled:y.hidden||!N,noDragClassName:f,handleSelector:y.dragHandle,nodeId:e,isSelectable:k,nodeClickDistance:h}),I=tb();if(y.hidden)return null;const $=ks(y),P=SE(y),M=k||N||t||n||r||a,D=n?W=>n(W,{...w.userNode}):void 0,V=r?W=>r(W,{...w.userNode}):void 0,B=a?W=>a(W,{...w.userNode}):void 0,K=l?W=>l(W,{...w.userNode}):void 0,J=o?W=>o(W,{...w.userNode}):void 0,ae=W=>{const{selectNodesOnDrag:ie,nodeDragThreshold:H}=O.getState();k&&(!ie||!N||H>0)&&Hd({id:e,store:O,nodeRef:j}),t&&t(W,{...w.userNode})},U=W=>{if(!(Cy(W.nativeEvent)||v)){if(py.includes(W.key)&&k){const ie=W.key==="Escape";Hd({id:e,store:O,unselect:ie,nodeRef:j})}else if(N&&y.selected&&Object.prototype.hasOwnProperty.call(Ui,W.key)){W.preventDefault();const{ariaLabelConfig:ie}=O.getState();O.setState({ariaLiveMessage:ie["node.a11yDescription.ariaLiveMessage"]({direction:W.key.replace("Arrow","").toLowerCase(),x:~~w.positionAbsolute.x,y:~~w.positionAbsolute.y})}),I({direction:Ui[W.key],factor:W.shiftKey?4:1})}}},Y=()=>{var fe;if(v||!((fe=j.current)!=null&&fe.matches(":focus-visible")))return;const{transform:W,width:ie,height:H,autoPanOnNodeFocus:X,setCenter:Z}=O.getState();if(!X)return;sf(new Map([[e,y]]),{x:0,y:0,width:ie,height:H},W,!0).length>0||Z(y.position.x+$.width/2,y.position.y+$.height/2,{zoom:W[2]})};return s.jsx("div",{className:et(["react-flow__node",`react-flow__node-${_}`,{[p]:N},y.className,{selected:y.selected,selectable:k,parent:E,draggable:N,dragging:T}]),ref:j,style:{zIndex:w.z,transform:`translate(${w.positionAbsolute.x}px,${w.positionAbsolute.y}px)`,pointerEvents:M?"all":"none",visibility:F?"visible":"hidden",...y.style,...P},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:D,onMouseMove:V,onMouseLeave:B,onContextMenu:K,onClick:ae,onDoubleClick:J,onKeyDown:C?U:void 0,tabIndex:C?0:void 0,onFocus:C?Y:void 0,role:y.ariaRole??(C?"group":void 0),"aria-roledescription":"node","aria-describedby":v?void 0:`${Wy}-${b}`,"aria-label":y.ariaLabel,...y.domAttributes,children:s.jsx(gE,{value:e,children:s.jsx(S,{id:e,data:y.data,type:_,positionAbsoluteX:w.positionAbsolute.x,positionAbsoluteY:w.positionAbsolute.y,selected:y.selected??!1,selectable:k,draggable:N,deletable:y.deletable??!0,isConnectable:A,sourcePosition:y.sourcePosition,targetPosition:y.targetPosition,dragging:T,dragHandle:y.dragHandle,zIndex:w.z,parentId:y.parentId,...$})})})}var LE=R.memo(IE);const $E=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function rb(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,onError:l}=Ee($E,He),o=RE(e.onlyRenderVisibleElements),i=TE();return s.jsx("div",{className:"react-flow__nodes",style:yc,children:o.map(c=>s.jsx(LE,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:i,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:a,nodeClickDistance:e.nodeClickDistance,onError:l},c))})}rb.displayName="NodeRenderer";const DE=R.memo(rb);function FE(e){return Ee(R.useCallback(n=>{if(!e)return n.edges.map(a=>a.id);const r=[];if(n.width&&n.height)for(const a of n.edges){const l=n.nodeLookup.get(a.source),o=n.nodeLookup.get(a.target);l&&o&&Y5({sourceNode:l,targetNode:o,width:n.width,height:n.height,transform:n.transform})&&r.push(a.id)}return r},[e]),He)}const zE=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return s.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},VE=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return s.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},a0={[kr.Arrow]:zE,[kr.ArrowClosed]:VE};function HE(e){const t=Ue();return R.useMemo(()=>{var a,l;return Object.prototype.hasOwnProperty.call(a0,e)?a0[e]:((l=(a=t.getState()).onError)==null||l.call(a,"009",ns.error009(e)),null)},[e])}const UE=({id:e,type:t,color:n,width:r=12.5,height:a=12.5,markerUnits:l="strokeWidth",strokeWidth:o,orient:i="auto-start-reverse"})=>{const c=HE(t);return c?s.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${a}`,viewBox:"-10 -10 20 20",markerUnits:l,orient:i,refX:"0",refY:"0",children:s.jsx(c,{color:n,strokeWidth:o})}):null},ab=({defaultColor:e,rfId:t})=>{const n=Ee(l=>l.edges),r=Ee(l=>l.defaultEdgeOptions),a=R.useMemo(()=>J5(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return a.length?s.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:s.jsx("defs",{children:a.map(l=>s.jsx(UE,{id:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient},l.id))})}):null};ab.displayName="MarkerDefinitions";var BE=R.memo(ab);function lb({x:e,y:t,label:n,labelStyle:r,labelShowBg:a=!0,labelBgStyle:l,labelBgPadding:o=[2,4],labelBgBorderRadius:i=2,children:c,className:u,...m}){const[d,f]=R.useState({x:1,y:0,width:0,height:0}),p=et(["react-flow__edge-textwrapper",u]),v=R.useRef(null);return R.useEffect(()=>{if(v.current){const b=v.current.getBBox();f({x:b.x,y:b.y,width:b.width,height:b.height})}},[n]),n?s.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...m,children:[a&&s.jsx("rect",{width:d.width+2*o[0],x:-o[0],y:-o[1],height:d.height+2*o[1],className:"react-flow__edge-textbg",style:l,rx:i,ry:i}),s.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:v,style:r,children:n}),c]}):null}lb.displayName="EdgeText";const YE=R.memo(lb);function bc({path:e,labelX:t,labelY:n,label:r,labelStyle:a,labelShowBg:l,labelBgStyle:o,labelBgPadding:i,labelBgBorderRadius:c,interactionWidth:u=20,...m}){return s.jsxs(s.Fragment,{children:[s.jsx("path",{...m,d:e,fill:"none",className:et(["react-flow__edge-path",m.className])}),u?s.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:u,className:"react-flow__edge-interaction"}):null,r&&wn(t)&&wn(n)?s.jsx(YE,{x:t,y:n,label:r,labelStyle:a,labelShowBg:l,labelBgStyle:o,labelBgPadding:i,labelBgBorderRadius:c}):null]})}function l0({pos:e,x1:t,y1:n,x2:r,y2:a}){return e===he.Left||e===he.Right?[.5*(t+r),n]:[t,.5*(n+a)]}function ob({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:a,targetPosition:l=he.Top}){const[o,i]=l0({pos:n,x1:e,y1:t,x2:r,y2:a}),[c,u]=l0({pos:l,x1:r,y1:a,x2:e,y2:t}),[m,d,f,p]=Ay({sourceX:e,sourceY:t,targetX:r,targetY:a,sourceControlX:o,sourceControlY:i,targetControlX:c,targetControlY:u});return[`M${e},${t} C${o},${i} ${c},${u} ${r},${a}`,m,d,f,p]}function ib(e){return R.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,sourcePosition:o,targetPosition:i,label:c,labelStyle:u,labelShowBg:m,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:x,interactionWidth:h})=>{const[g,y,w]=ob({sourceX:n,sourceY:r,sourcePosition:o,targetX:a,targetY:l,targetPosition:i}),E=e.isInternal?void 0:t;return s.jsx(bc,{id:E,path:g,labelX:y,labelY:w,label:c,labelStyle:u,labelShowBg:m,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:x,interactionWidth:h})})}const WE=ib({isInternal:!1}),cb=ib({isInternal:!0});WE.displayName="SimpleBezierEdge";cb.displayName="SimpleBezierEdgeInternal";function ub(e){return R.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,label:o,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:d,style:f,sourcePosition:p=he.Bottom,targetPosition:v=he.Top,markerEnd:b,markerStart:x,pathOptions:h,interactionWidth:g})=>{const[y,w,E]=Dd({sourceX:n,sourceY:r,sourcePosition:p,targetX:a,targetY:l,targetPosition:v,borderRadius:h==null?void 0:h.borderRadius,offset:h==null?void 0:h.offset,stepPosition:h==null?void 0:h.stepPosition}),_=e.isInternal?void 0:t;return s.jsx(bc,{id:_,path:y,labelX:w,labelY:E,label:o,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:d,style:f,markerEnd:b,markerStart:x,interactionWidth:g})})}const db=ub({isInternal:!1}),mb=ub({isInternal:!0});db.displayName="SmoothStepEdge";mb.displayName="SmoothStepEdgeInternal";function fb(e){return R.memo(({id:t,...n})=>{var a;const r=e.isInternal?void 0:t;return s.jsx(db,{...n,id:r,pathOptions:R.useMemo(()=>{var l;return{borderRadius:0,offset:(l=n.pathOptions)==null?void 0:l.offset}},[(a=n.pathOptions)==null?void 0:a.offset])})})}const GE=fb({isInternal:!1}),hb=fb({isInternal:!0});GE.displayName="StepEdge";hb.displayName="StepEdgeInternal";function pb(e){return R.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,label:o,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:v,interactionWidth:b})=>{const[x,h,g]=My({sourceX:n,sourceY:r,targetX:a,targetY:l}),y=e.isInternal?void 0:t;return s.jsx(bc,{id:y,path:x,labelX:h,labelY:g,label:o,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:m,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:v,interactionWidth:b})})}const qE=pb({isInternal:!1}),xb=pb({isInternal:!0});qE.displayName="StraightEdge";xb.displayName="StraightEdgeInternal";function gb(e){return R.memo(({id:t,sourceX:n,sourceY:r,targetX:a,targetY:l,sourcePosition:o=he.Bottom,targetPosition:i=he.Top,label:c,labelStyle:u,labelShowBg:m,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:x,pathOptions:h,interactionWidth:g})=>{const[y,w,E]=Py({sourceX:n,sourceY:r,sourcePosition:o,targetX:a,targetY:l,targetPosition:i,curvature:h==null?void 0:h.curvature}),_=e.isInternal?void 0:t;return s.jsx(bc,{id:_,path:y,labelX:w,labelY:E,label:c,labelStyle:u,labelShowBg:m,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:v,markerEnd:b,markerStart:x,interactionWidth:g})})}const XE=gb({isInternal:!1}),vb=gb({isInternal:!0});XE.displayName="BezierEdge";vb.displayName="BezierEdgeInternal";const o0={default:vb,straight:xb,step:hb,smoothstep:mb,simplebezier:cb},i0={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},QE=(e,t,n)=>n===he.Left?e-t:n===he.Right?e+t:e,KE=(e,t,n)=>n===he.Top?e-t:n===he.Bottom?e+t:e,c0="react-flow__edgeupdater";function u0({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:a,onMouseEnter:l,onMouseOut:o,type:i}){return s.jsx("circle",{onMouseDown:a,onMouseEnter:l,onMouseOut:o,className:et([c0,`${c0}-${i}`]),cx:QE(t,r,e),cy:KE(n,r,e),r,stroke:"transparent",fill:"transparent"})}function ZE({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:a,targetX:l,targetY:o,sourcePosition:i,targetPosition:c,onReconnect:u,onReconnectStart:m,onReconnectEnd:d,setReconnecting:f,setUpdateHover:p}){const v=Ue(),b=(w,E)=>{if(w.button!==0)return;const{autoPanOnConnect:_,domNode:S,isValidConnection:N,connectionMode:k,connectionRadius:A,lib:C,onConnectStart:O,onConnectEnd:F,cancelConnection:j,nodeLookup:T,rfId:I,panBy:$,updateConnection:P}=v.getState(),M=E.type==="target",D=(K,J)=>{f(!1),d==null||d(K,n,E.type,J)},V=K=>u==null?void 0:u(n,K),B=(K,J)=>{f(!0),m==null||m(w,n,E.type),O==null||O(K,J)};Vd.onPointerDown(w.nativeEvent,{autoPanOnConnect:_,connectionMode:k,connectionRadius:A,domNode:S,handleId:E.id,nodeId:E.nodeId,nodeLookup:T,isTarget:M,edgeUpdaterType:E.type,lib:C,flowId:I,cancelConnection:j,panBy:$,isValidConnection:N,onConnect:V,onConnectStart:B,onConnectEnd:F,onReconnectEnd:D,updateConnection:P,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,dragThreshold:v.getState().connectionDragThreshold,handleDomNode:w.currentTarget})},x=w=>b(w,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),h=w=>b(w,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),g=()=>p(!0),y=()=>p(!1);return s.jsxs(s.Fragment,{children:[(e===!0||e==="source")&&s.jsx(u0,{position:i,centerX:r,centerY:a,radius:t,onMouseDown:x,onMouseEnter:g,onMouseOut:y,type:"source"}),(e===!0||e==="target")&&s.jsx(u0,{position:c,centerX:l,centerY:o,radius:t,onMouseDown:h,onMouseEnter:g,onMouseOut:y,type:"target"})]})}function JE({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:a,onDoubleClick:l,onContextMenu:o,onMouseEnter:i,onMouseMove:c,onMouseLeave:u,reconnectRadius:m,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,rfId:v,edgeTypes:b,noPanClassName:x,onError:h,disableKeyboardA11y:g}){let y=Ee(Z=>Z.edgeLookup.get(e));const w=Ee(Z=>Z.defaultEdgeOptions);y=w?{...w,...y}:y;let E=y.type||"default",_=(b==null?void 0:b[E])||o0[E];_===void 0&&(h==null||h("011",ns.error011(E)),E="default",_=(b==null?void 0:b.default)||o0.default);const S=!!(y.focusable||t&&typeof y.focusable>"u"),N=typeof d<"u"&&(y.reconnectable||n&&typeof y.reconnectable>"u"),k=!!(y.selectable||r&&typeof y.selectable>"u"),A=R.useRef(null),[C,O]=R.useState(!1),[F,j]=R.useState(!1),T=Ue(),{zIndex:I,sourceX:$,sourceY:P,targetX:M,targetY:D,sourcePosition:V,targetPosition:B}=Ee(R.useCallback(Z=>{const oe=Z.nodeLookup.get(y.source),fe=Z.nodeLookup.get(y.target);if(!oe||!fe)return{zIndex:y.zIndex,...i0};const ge=Z5({id:e,sourceNode:oe,targetNode:fe,sourceHandle:y.sourceHandle||null,targetHandle:y.targetHandle||null,connectionMode:Z.connectionMode,onError:h});return{zIndex:B5({selected:y.selected,zIndex:y.zIndex,sourceNode:oe,targetNode:fe,elevateOnSelect:Z.elevateEdgesOnSelect,zIndexMode:Z.zIndexMode}),...ge||i0}},[y.source,y.target,y.sourceHandle,y.targetHandle,y.selected,y.zIndex]),He),K=R.useMemo(()=>y.markerStart?`url('#${Fd(y.markerStart,v)}')`:void 0,[y.markerStart,v]),J=R.useMemo(()=>y.markerEnd?`url('#${Fd(y.markerEnd,v)}')`:void 0,[y.markerEnd,v]);if(y.hidden||$===null||P===null||M===null||D===null)return null;const ae=Z=>{var L;const{addSelectedEdges:oe,unselectNodesAndEdges:fe,multiSelectionActive:ge}=T.getState();k&&(T.setState({nodesSelectionActive:!1}),y.selected&&ge?(fe({nodes:[],edges:[y]}),(L=A.current)==null||L.blur()):oe([e])),a&&a(Z,y)},U=l?Z=>{l(Z,{...y})}:void 0,Y=o?Z=>{o(Z,{...y})}:void 0,W=i?Z=>{i(Z,{...y})}:void 0,ie=c?Z=>{c(Z,{...y})}:void 0,H=u?Z=>{u(Z,{...y})}:void 0,X=Z=>{var oe;if(!g&&py.includes(Z.key)&&k){const{unselectNodesAndEdges:fe,addSelectedEdges:ge}=T.getState();Z.key==="Escape"?((oe=A.current)==null||oe.blur(),fe({edges:[y]})):ge([e])}};return s.jsx("svg",{style:{zIndex:I},children:s.jsxs("g",{className:et(["react-flow__edge",`react-flow__edge-${E}`,y.className,x,{selected:y.selected,animated:y.animated,inactive:!k&&!a,updating:C,selectable:k}]),onClick:ae,onDoubleClick:U,onContextMenu:Y,onMouseEnter:W,onMouseMove:ie,onMouseLeave:H,onKeyDown:S?X:void 0,tabIndex:S?0:void 0,role:y.ariaRole??(S?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":y.ariaLabel===null?void 0:y.ariaLabel||`Edge from ${y.source} to ${y.target}`,"aria-describedby":S?`${Gy}-${v}`:void 0,ref:A,...y.domAttributes,children:[!F&&s.jsx(_,{id:e,source:y.source,target:y.target,type:y.type,selected:y.selected,animated:y.animated,selectable:k,deletable:y.deletable??!0,label:y.label,labelStyle:y.labelStyle,labelShowBg:y.labelShowBg,labelBgStyle:y.labelBgStyle,labelBgPadding:y.labelBgPadding,labelBgBorderRadius:y.labelBgBorderRadius,sourceX:$,sourceY:P,targetX:M,targetY:D,sourcePosition:V,targetPosition:B,data:y.data,style:y.style,sourceHandleId:y.sourceHandle,targetHandleId:y.targetHandle,markerStart:K,markerEnd:J,pathOptions:"pathOptions"in y?y.pathOptions:void 0,interactionWidth:y.interactionWidth}),N&&s.jsx(ZE,{edge:y,isReconnectable:N,reconnectRadius:m,onReconnect:d,onReconnectStart:f,onReconnectEnd:p,sourceX:$,sourceY:P,targetX:M,targetY:D,sourcePosition:V,targetPosition:B,setUpdateHover:O,setReconnecting:j})]})})}var eA=R.memo(JE);const tA=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function yb({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:a,onReconnect:l,onEdgeContextMenu:o,onEdgeMouseEnter:i,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:m,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:p,onReconnectEnd:v,disableKeyboardA11y:b}){const{edgesFocusable:x,edgesReconnectable:h,elementsSelectable:g,onError:y}=Ee(tA,He),w=FE(t);return s.jsxs("div",{className:"react-flow__edges",children:[s.jsx(BE,{defaultColor:e,rfId:n}),w.map(E=>s.jsx(eA,{id:E,edgesFocusable:x,edgesReconnectable:h,elementsSelectable:g,noPanClassName:a,onReconnect:l,onContextMenu:o,onMouseEnter:i,onMouseMove:c,onMouseLeave:u,onClick:m,reconnectRadius:d,onDoubleClick:f,onReconnectStart:p,onReconnectEnd:v,rfId:n,onError:y,edgeTypes:r,disableKeyboardA11y:b},E))]})}yb.displayName="EdgeRenderer";const nA=R.memo(yb),sA=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function rA({children:e}){const t=Ee(sA);return s.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function aA(e){const t=mf(),n=R.useRef(!1);R.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const lA=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function oA(e){const t=Ee(lA),n=Ue();return R.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function iA(e){return e.connection.inProgress?{...e.connection,to:Jl(e.connection.to,e.transform)}:{...e.connection}}function cA(e){return iA}function uA(e){const t=cA();return Ee(t,He)}const dA=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function mA({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:a,width:l,height:o,isValid:i,inProgress:c}=Ee(dA,He);return!(l&&a&&c)?null:s.jsx("svg",{style:e,width:l,height:o,className:"react-flow__connectionline react-flow__container",children:s.jsx("g",{className:et(["react-flow__connection",vy(i)]),children:s.jsx(bb,{style:t,type:n,CustomComponent:r,isValid:i})})})}const bb=({style:e,type:t=ds.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:a,from:l,fromNode:o,fromHandle:i,fromPosition:c,to:u,toNode:m,toHandle:d,toPosition:f,pointer:p}=uA();if(!a)return;if(n)return s.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:o,fromHandle:i,fromX:l.x,fromY:l.y,toX:u.x,toY:u.y,fromPosition:c,toPosition:f,connectionStatus:vy(r),toNode:m,toHandle:d,pointer:p});let v="";const b={sourceX:l.x,sourceY:l.y,sourcePosition:c,targetX:u.x,targetY:u.y,targetPosition:f};switch(t){case ds.Bezier:[v]=Py(b);break;case ds.SimpleBezier:[v]=ob(b);break;case ds.Step:[v]=Dd({...b,borderRadius:0});break;case ds.SmoothStep:[v]=Dd(b);break;default:[v]=My(b)}return s.jsx("path",{d:v,fill:"none",className:"react-flow__connection-path",style:e})};bb.displayName="ConnectionLine";const fA={};function d0(e=fA){R.useRef(e),Ue(),R.useEffect(()=>{},[e])}function hA(){Ue(),R.useRef(!1),R.useEffect(()=>{},[])}function Nb({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:o,onNodeMouseEnter:i,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:m,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:p,connectionLineType:v,connectionLineStyle:b,connectionLineComponent:x,connectionLineContainerStyle:h,selectionKeyCode:g,selectionOnDrag:y,selectionMode:w,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:S,deleteKeyCode:N,onlyRenderVisibleElements:k,elementsSelectable:A,defaultViewport:C,translateExtent:O,minZoom:F,maxZoom:j,preventScrolling:T,defaultMarkerColor:I,zoomOnScroll:$,zoomOnPinch:P,panOnScroll:M,panOnScrollSpeed:D,panOnScrollMode:V,zoomOnDoubleClick:B,panOnDrag:K,onPaneClick:J,onPaneMouseEnter:ae,onPaneMouseMove:U,onPaneMouseLeave:Y,onPaneScroll:W,onPaneContextMenu:ie,paneClickDistance:H,nodeClickDistance:X,onEdgeContextMenu:Z,onEdgeMouseEnter:oe,onEdgeMouseMove:fe,onEdgeMouseLeave:ge,reconnectRadius:L,onReconnect:G,onReconnectStart:ve,onReconnectEnd:me,noDragClassName:je,noWheelClassName:ot,noPanClassName:Bt,disableKeyboardA11y:nn,nodeExtent:Tt,rfId:sn,viewport:Ot,onViewportChange:Yt}){return d0(e),d0(t),hA(),aA(n),oA(Ot),s.jsx(AE,{onPaneClick:J,onPaneMouseEnter:ae,onPaneMouseMove:U,onPaneMouseLeave:Y,onPaneContextMenu:ie,onPaneScroll:W,paneClickDistance:H,deleteKeyCode:N,selectionKeyCode:g,selectionOnDrag:y,selectionMode:w,onSelectionStart:f,onSelectionEnd:p,multiSelectionKeyCode:E,panActivationKeyCode:_,zoomActivationKeyCode:S,elementsSelectable:A,zoomOnScroll:$,zoomOnPinch:P,zoomOnDoubleClick:B,panOnScroll:M,panOnScrollSpeed:D,panOnScrollMode:V,panOnDrag:K,defaultViewport:C,translateExtent:O,minZoom:F,maxZoom:j,onSelectionContextMenu:d,preventScrolling:T,noDragClassName:je,noWheelClassName:ot,noPanClassName:Bt,disableKeyboardA11y:nn,onViewportChange:Yt,isControlledViewport:!!Ot,children:s.jsxs(rA,{children:[s.jsx(nA,{edgeTypes:t,onEdgeClick:a,onEdgeDoubleClick:o,onReconnect:G,onReconnectStart:ve,onReconnectEnd:me,onlyRenderVisibleElements:k,onEdgeContextMenu:Z,onEdgeMouseEnter:oe,onEdgeMouseMove:fe,onEdgeMouseLeave:ge,reconnectRadius:L,defaultMarkerColor:I,noPanClassName:Bt,disableKeyboardA11y:nn,rfId:sn}),s.jsx(mA,{style:b,type:v,component:x,containerStyle:h}),s.jsx("div",{className:"react-flow__edgelabel-renderer"}),s.jsx(DE,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:i,onNodeMouseMove:c,onNodeMouseLeave:u,onNodeContextMenu:m,nodeClickDistance:X,onlyRenderVisibleElements:k,noPanClassName:Bt,noDragClassName:je,disableKeyboardA11y:nn,nodeExtent:Tt,rfId:sn}),s.jsx("div",{className:"react-flow__viewport-portal"})]})})}Nb.displayName="GraphView";const pA=R.memo(Nb),m0=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:l,fitView:o,fitViewOptions:i,minZoom:c=.5,maxZoom:u=2,nodeOrigin:m,nodeExtent:d,zIndexMode:f="basic"}={})=>{const p=new Map,v=new Map,b=new Map,x=new Map,h=r??t??[],g=n??e??[],y=m??[0,0],w=d??Ol;Iy(b,x,h);const E=zd(g,p,v,{nodeOrigin:y,nodeExtent:w,zIndexMode:f});let _=[0,0,1];if(o&&a&&l){const S=Kl(p,{filter:C=>!!((C.width||C.initialWidth)&&(C.height||C.initialHeight))}),{x:N,y:k,zoom:A}=rf(S,a,l,c,u,(i==null?void 0:i.padding)??.1);_=[N,k,A]}return{rfId:"1",width:a??0,height:l??0,transform:_,nodes:g,nodesInitialized:E,nodeLookup:p,parentLookup:v,edges:h,edgeLookup:x,connectionLookup:b,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:u,translateExtent:Ol,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Na.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:y,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:o??!1,fitViewOptions:i,fitViewResolver:null,connection:{...gy},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:D5,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:xy,zIndexMode:f,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},xA=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:l,fitView:o,fitViewOptions:i,minZoom:c,maxZoom:u,nodeOrigin:m,nodeExtent:d,zIndexMode:f})=>O3((p,v)=>{async function b(){const{nodeLookup:x,panZoom:h,fitViewOptions:g,fitViewResolver:y,width:w,height:E,minZoom:_,maxZoom:S}=v();h&&(await L5({nodes:x,width:w,height:E,panZoom:h,minZoom:_,maxZoom:S},g),y==null||y.resolve(!0),p({fitViewResolver:null}))}return{...m0({nodes:e,edges:t,width:a,height:l,fitView:o,fitViewOptions:i,minZoom:c,maxZoom:u,nodeOrigin:m,nodeExtent:d,defaultNodes:n,defaultEdges:r,zIndexMode:f}),setNodes:x=>{const{nodeLookup:h,parentLookup:g,nodeOrigin:y,elevateNodesOnSelect:w,fitViewQueued:E,zIndexMode:_}=v(),S=zd(x,h,g,{nodeOrigin:y,nodeExtent:d,elevateNodesOnSelect:w,checkEquality:!0,zIndexMode:_});E&&S?(b(),p({nodes:x,nodesInitialized:S,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:x,nodesInitialized:S})},setEdges:x=>{const{connectionLookup:h,edgeLookup:g}=v();Iy(h,g,x),p({edges:x})},setDefaultNodesAndEdges:(x,h)=>{if(x){const{setNodes:g}=v();g(x),p({hasDefaultNodes:!0})}if(h){const{setEdges:g}=v();g(h),p({hasDefaultEdges:!0})}},updateNodeInternals:x=>{const{triggerNodeChanges:h,nodeLookup:g,parentLookup:y,domNode:w,nodeOrigin:E,nodeExtent:_,debug:S,fitViewQueued:N,zIndexMode:k}=v(),{changes:A,updatedInternals:C}=l3(x,g,y,w,E,_,k);C&&(n3(g,y,{nodeOrigin:E,nodeExtent:_,zIndexMode:k}),N?(b(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),(A==null?void 0:A.length)>0&&(S&&console.log("React Flow: trigger node changes",A),h==null||h(A)))},updateNodePositions:(x,h=!1)=>{const g=[];let y=[];const{nodeLookup:w,triggerNodeChanges:E,connection:_,updateConnection:S,onNodesChangeMiddlewareMap:N}=v();for(const[k,A]of x){const C=w.get(k),O=!!(C!=null&&C.expandParent&&(C!=null&&C.parentId)&&(A!=null&&A.position)),F={id:k,type:"position",position:O?{x:Math.max(0,A.position.x),y:Math.max(0,A.position.y)}:A.position,dragging:h};if(C&&_.inProgress&&_.fromNode.id===C.id){const j=Er(C,_.fromHandle,he.Left,!0);S({..._,from:j})}O&&C.parentId&&g.push({id:k,parentId:C.parentId,rect:{...A.internals.positionAbsolute,width:A.measured.width??0,height:A.measured.height??0}}),y.push(F)}if(g.length>0){const{parentLookup:k,nodeOrigin:A}=v(),C=df(g,w,k,A);y.push(...C)}for(const k of N.values())y=k(y);E(y)},triggerNodeChanges:x=>{const{onNodesChange:h,setNodes:g,nodes:y,hasDefaultNodes:w,debug:E}=v();if(x!=null&&x.length){if(w){const _=Qy(x,y);g(_)}E&&console.log("React Flow: trigger node changes",x),h==null||h(x)}},triggerEdgeChanges:x=>{const{onEdgesChange:h,setEdges:g,edges:y,hasDefaultEdges:w,debug:E}=v();if(x!=null&&x.length){if(w){const _=Ky(x,y);g(_)}E&&console.log("React Flow: trigger edge changes",x),h==null||h(x)}},addSelectedNodes:x=>{const{multiSelectionActive:h,edgeLookup:g,nodeLookup:y,triggerNodeChanges:w,triggerEdgeChanges:E}=v();if(h){const _=x.map(S=>or(S,!0));w(_);return}w(Zr(y,new Set([...x]),!0)),E(Zr(g))},addSelectedEdges:x=>{const{multiSelectionActive:h,edgeLookup:g,nodeLookup:y,triggerNodeChanges:w,triggerEdgeChanges:E}=v();if(h){const _=x.map(S=>or(S,!0));E(_);return}E(Zr(g,new Set([...x]))),w(Zr(y,new Set,!0))},unselectNodesAndEdges:({nodes:x,edges:h}={})=>{const{edges:g,nodes:y,nodeLookup:w,triggerNodeChanges:E,triggerEdgeChanges:_}=v(),S=x||y,N=h||g,k=S.map(C=>{const O=w.get(C.id);return O&&(O.selected=!1),or(C.id,!1)}),A=N.map(C=>or(C.id,!1));E(k),_(A)},setMinZoom:x=>{const{panZoom:h,maxZoom:g}=v();h==null||h.setScaleExtent([x,g]),p({minZoom:x})},setMaxZoom:x=>{const{panZoom:h,minZoom:g}=v();h==null||h.setScaleExtent([g,x]),p({maxZoom:x})},setTranslateExtent:x=>{var h;(h=v().panZoom)==null||h.setTranslateExtent(x),p({translateExtent:x})},resetSelectedElements:()=>{const{edges:x,nodes:h,triggerNodeChanges:g,triggerEdgeChanges:y,elementsSelectable:w}=v();if(!w)return;const E=h.reduce((S,N)=>N.selected?[...S,or(N.id,!1)]:S,[]),_=x.reduce((S,N)=>N.selected?[...S,or(N.id,!1)]:S,[]);g(E),y(_)},setNodeExtent:x=>{const{nodes:h,nodeLookup:g,parentLookup:y,nodeOrigin:w,elevateNodesOnSelect:E,nodeExtent:_,zIndexMode:S}=v();x[0][0]===_[0][0]&&x[0][1]===_[0][1]&&x[1][0]===_[1][0]&&x[1][1]===_[1][1]||(zd(h,g,y,{nodeOrigin:w,nodeExtent:x,elevateNodesOnSelect:E,checkEquality:!1,zIndexMode:S}),p({nodeExtent:x}))},panBy:x=>{const{transform:h,width:g,height:y,panZoom:w,translateExtent:E}=v();return o3({delta:x,panZoom:w,transform:h,translateExtent:E,width:g,height:y})},setCenter:async(x,h,g)=>{const{width:y,height:w,maxZoom:E,panZoom:_}=v();if(!_)return Promise.resolve(!1);const S=typeof(g==null?void 0:g.zoom)<"u"?g.zoom:E;return await _.setViewport({x:y/2-x*S,y:w/2-h*S,zoom:S},{duration:g==null?void 0:g.duration,ease:g==null?void 0:g.ease,interpolate:g==null?void 0:g.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...gy}})},updateConnection:x=>{p({connection:x})},reset:()=>p({...m0()})}},Object.is);function gA({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:a,initialHeight:l,initialMinZoom:o,initialMaxZoom:i,initialFitViewOptions:c,fitView:u,nodeOrigin:m,nodeExtent:d,zIndexMode:f,children:p}){const[v]=R.useState(()=>xA({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:a,height:l,fitView:u,minZoom:o,maxZoom:i,fitViewOptions:c,nodeOrigin:m,nodeExtent:d,zIndexMode:f}));return s.jsx(I3,{value:v,children:s.jsx(rE,{children:p})})}function vA({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:a,width:l,height:o,fitView:i,fitViewOptions:c,minZoom:u,maxZoom:m,nodeOrigin:d,nodeExtent:f,zIndexMode:p}){return R.useContext(gc)?s.jsx(s.Fragment,{children:e}):s.jsx(gA,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:a,initialWidth:l,initialHeight:o,fitView:i,initialFitViewOptions:c,initialMinZoom:u,initialMaxZoom:m,nodeOrigin:d,nodeExtent:f,zIndexMode:p,children:e})}const yA={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function bA({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:a,nodeTypes:l,edgeTypes:o,onNodeClick:i,onEdgeClick:c,onInit:u,onMove:m,onMoveStart:d,onMoveEnd:f,onConnect:p,onConnectStart:v,onConnectEnd:b,onClickConnectStart:x,onClickConnectEnd:h,onNodeMouseEnter:g,onNodeMouseMove:y,onNodeMouseLeave:w,onNodeContextMenu:E,onNodeDoubleClick:_,onNodeDragStart:S,onNodeDrag:N,onNodeDragStop:k,onNodesDelete:A,onEdgesDelete:C,onDelete:O,onSelectionChange:F,onSelectionDragStart:j,onSelectionDrag:T,onSelectionDragStop:I,onSelectionContextMenu:$,onSelectionStart:P,onSelectionEnd:M,onBeforeDelete:D,connectionMode:V,connectionLineType:B=ds.Bezier,connectionLineStyle:K,connectionLineComponent:J,connectionLineContainerStyle:ae,deleteKeyCode:U="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:W=!1,selectionMode:ie=Il.Full,panActivationKeyCode:H="Space",multiSelectionKeyCode:X=$l()?"Meta":"Control",zoomActivationKeyCode:Z=$l()?"Meta":"Control",snapToGrid:oe,snapGrid:fe,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:L,nodesDraggable:G,autoPanOnNodeFocus:ve,nodesConnectable:me,nodesFocusable:je,nodeOrigin:ot=qy,edgesFocusable:Bt,edgesReconnectable:nn,elementsSelectable:Tt=!0,defaultViewport:sn=q3,minZoom:Ot=.5,maxZoom:Yt=2,translateExtent:On=Ol,preventScrolling:rs=!0,nodeExtent:hn,defaultMarkerColor:as="#b1b1b7",zoomOnScroll:q=!0,zoomOnPinch:te=!0,panOnScroll:z=!1,panOnScrollSpeed:ee=.5,panOnScrollMode:ne=gr.Free,zoomOnDoubleClick:ce=!0,panOnDrag:pe=!0,onPaneClick:_e,onPaneMouseEnter:Le,onPaneMouseMove:Re,onPaneMouseLeave:it,onPaneScroll:It,onPaneContextMenu:rn,paneClickDistance:In=1,nodeClickDistance:Ln=0,children:$n,onReconnect:Dn,onReconnectStart:ht,onReconnectEnd:Fn,onEdgeContextMenu:pn,onEdgeDoubleClick:zn,onEdgeMouseEnter:Vn,onEdgeMouseMove:Hn,onEdgeMouseLeave:Un,reconnectRadius:Bn=10,onNodesChange:tt,onEdgesChange:Be,noDragClassName:Qe="nodrag",noWheelClassName:Se="nowheel",noPanClassName:Ne="nopan",fitView:be,fitViewOptions:ze,connectOnClick:ct,attributionPosition:Yn,proOptions:ls,defaultEdgeOptions:eo,elevateNodesOnSelect:Nc=!0,elevateEdgesOnSelect:Sb=!1,disableKeyboardA11y:hf=!1,autoPanOnConnect:kb,autoPanOnNodeDrag:Cb,autoPanSpeed:Eb,connectionRadius:Ab,isValidConnection:Pb,onError:Rb,style:Mb,id:pf,nodeDragThreshold:Tb,connectionDragThreshold:Ob,viewport:Ib,onViewportChange:Lb,width:$b,height:Db,colorMode:Fb="light",debug:zb,onScroll:to,ariaLabelConfig:Vb,zIndexMode:xf="basic",...Hb},Ub){const jc=pf||"1",Bb=Z3(Fb),Yb=R.useCallback(gf=>{gf.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),to==null||to(gf)},[to]);return s.jsx("div",{"data-testid":"rf__wrapper",...Hb,onScroll:Yb,style:{...Mb,...yA},ref:Ub,className:et(["react-flow",a,Bb]),id:pf,role:"application",children:s.jsxs(vA,{nodes:e,edges:t,width:$b,height:Db,fitView:be,fitViewOptions:ze,minZoom:Ot,maxZoom:Yt,nodeOrigin:ot,nodeExtent:hn,zIndexMode:xf,children:[s.jsx(pA,{onInit:u,onNodeClick:i,onEdgeClick:c,onNodeMouseEnter:g,onNodeMouseMove:y,onNodeMouseLeave:w,onNodeContextMenu:E,onNodeDoubleClick:_,nodeTypes:l,edgeTypes:o,connectionLineType:B,connectionLineStyle:K,connectionLineComponent:J,connectionLineContainerStyle:ae,selectionKeyCode:Y,selectionOnDrag:W,selectionMode:ie,deleteKeyCode:U,multiSelectionKeyCode:X,panActivationKeyCode:H,zoomActivationKeyCode:Z,onlyRenderVisibleElements:ge,defaultViewport:sn,translateExtent:On,minZoom:Ot,maxZoom:Yt,preventScrolling:rs,zoomOnScroll:q,zoomOnPinch:te,zoomOnDoubleClick:ce,panOnScroll:z,panOnScrollSpeed:ee,panOnScrollMode:ne,panOnDrag:pe,onPaneClick:_e,onPaneMouseEnter:Le,onPaneMouseMove:Re,onPaneMouseLeave:it,onPaneScroll:It,onPaneContextMenu:rn,paneClickDistance:In,nodeClickDistance:Ln,onSelectionContextMenu:$,onSelectionStart:P,onSelectionEnd:M,onReconnect:Dn,onReconnectStart:ht,onReconnectEnd:Fn,onEdgeContextMenu:pn,onEdgeDoubleClick:zn,onEdgeMouseEnter:Vn,onEdgeMouseMove:Hn,onEdgeMouseLeave:Un,reconnectRadius:Bn,defaultMarkerColor:as,noDragClassName:Qe,noWheelClassName:Se,noPanClassName:Ne,rfId:jc,disableKeyboardA11y:hf,nodeExtent:hn,viewport:Ib,onViewportChange:Lb}),s.jsx(K3,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:v,onConnectEnd:b,onClickConnectStart:x,onClickConnectEnd:h,nodesDraggable:G,autoPanOnNodeFocus:ve,nodesConnectable:me,nodesFocusable:je,edgesFocusable:Bt,edgesReconnectable:nn,elementsSelectable:Tt,elevateNodesOnSelect:Nc,elevateEdgesOnSelect:Sb,minZoom:Ot,maxZoom:Yt,nodeExtent:hn,onNodesChange:tt,onEdgesChange:Be,snapToGrid:oe,snapGrid:fe,connectionMode:V,translateExtent:On,connectOnClick:ct,defaultEdgeOptions:eo,fitView:be,fitViewOptions:ze,onNodesDelete:A,onEdgesDelete:C,onDelete:O,onNodeDragStart:S,onNodeDrag:N,onNodeDragStop:k,onSelectionDrag:T,onSelectionDragStart:j,onSelectionDragStop:I,onMove:m,onMoveStart:d,onMoveEnd:f,noPanClassName:Ne,nodeOrigin:ot,rfId:jc,autoPanOnConnect:kb,autoPanOnNodeDrag:Cb,autoPanSpeed:Eb,onError:Rb,connectionRadius:Ab,isValidConnection:Pb,selectNodesOnDrag:L,nodeDragThreshold:Tb,connectionDragThreshold:Ob,onBeforeDelete:D,debug:zb,ariaLabelConfig:Vb,zIndexMode:xf}),s.jsx(G3,{onSelectionChange:F}),$n,s.jsx(H3,{proOptions:ls,position:Yn}),s.jsx(V3,{rfId:jc,disableKeyboardA11y:hf})]})})}var NA=Zy(bA);function jA(e){const[t,n]=R.useState(e),r=R.useCallback(a=>n(l=>Qy(a,l)),[]);return[t,n,r]}function wA(e){const[t,n]=R.useState(e),r=R.useCallback(a=>n(l=>Ky(a,l)),[]);return[t,n,r]}function _A({dimensions:e,lineWidth:t,variant:n,className:r}){return s.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:et(["react-flow__background-pattern",n,r])})}function SA({radius:e,className:t}){return s.jsx("circle",{cx:e,cy:e,r:e,className:et(["react-flow__background-pattern","dots",t])})}var Ys;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ys||(Ys={}));const kA={[Ys.Dots]:1,[Ys.Lines]:1,[Ys.Cross]:6},CA=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function jb({id:e,variant:t=Ys.Dots,gap:n=20,size:r,lineWidth:a=1,offset:l=0,color:o,bgColor:i,style:c,className:u,patternClassName:m}){const d=R.useRef(null),{transform:f,patternId:p}=Ee(CA,He),v=r||kA[t],b=t===Ys.Dots,x=t===Ys.Cross,h=Array.isArray(n)?n:[n,n],g=[h[0]*f[2]||1,h[1]*f[2]||1],y=v*f[2],w=Array.isArray(l)?l:[l,l],E=x?[y,y]:g,_=[w[0]*f[2]||1+E[0]/2,w[1]*f[2]||1+E[1]/2],S=`${p}${e||""}`;return s.jsxs("svg",{className:et(["react-flow__background",u]),style:{...c,...yc,"--xy-background-color-props":i,"--xy-background-pattern-color-props":o},ref:d,"data-testid":"rf__background",children:[s.jsx("pattern",{id:S,x:f[0]%g[0],y:f[1]%g[1],width:g[0],height:g[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${_[0]},-${_[1]})`,children:b?s.jsx(SA,{radius:y/2,className:m}):s.jsx(_A,{dimensions:E,lineWidth:a,variant:t,className:m})}),s.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${S})`})]})}jb.displayName="Background";const EA=R.memo(jb);function AA(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:s.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function PA(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:s.jsx("path",{d:"M0 0h32v4.2H0z"})})}function RA(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:s.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function MA(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:s.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function TA(){return s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:s.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function To({children:e,className:t,...n}){return s.jsx("button",{type:"button",className:et(["react-flow__controls-button",t]),...n,children:e})}const OA=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function wb({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:a,onZoomIn:l,onZoomOut:o,onFitView:i,onInteractiveChange:c,className:u,children:m,position:d="bottom-left",orientation:f="vertical","aria-label":p}){const v=Ue(),{isInteractive:b,minZoomReached:x,maxZoomReached:h,ariaLabelConfig:g}=Ee(OA,He),{zoomIn:y,zoomOut:w,fitView:E}=mf(),_=()=>{y(),l==null||l()},S=()=>{w(),o==null||o()},N=()=>{E(a),i==null||i()},k=()=>{v.setState({nodesDraggable:!b,nodesConnectable:!b,elementsSelectable:!b}),c==null||c(!b)},A=f==="horizontal"?"horizontal":"vertical";return s.jsxs(vc,{className:et(["react-flow__controls",A,u]),position:d,style:e,"data-testid":"rf__controls","aria-label":p??g["controls.ariaLabel"],children:[t&&s.jsxs(s.Fragment,{children:[s.jsx(To,{onClick:_,className:"react-flow__controls-zoomin",title:g["controls.zoomIn.ariaLabel"],"aria-label":g["controls.zoomIn.ariaLabel"],disabled:h,children:s.jsx(AA,{})}),s.jsx(To,{onClick:S,className:"react-flow__controls-zoomout",title:g["controls.zoomOut.ariaLabel"],"aria-label":g["controls.zoomOut.ariaLabel"],disabled:x,children:s.jsx(PA,{})})]}),n&&s.jsx(To,{className:"react-flow__controls-fitview",onClick:N,title:g["controls.fitView.ariaLabel"],"aria-label":g["controls.fitView.ariaLabel"],children:s.jsx(RA,{})}),r&&s.jsx(To,{className:"react-flow__controls-interactive",onClick:k,title:g["controls.interactive.ariaLabel"],"aria-label":g["controls.interactive.ariaLabel"],children:b?s.jsx(TA,{}):s.jsx(MA,{})}),m]})}wb.displayName="Controls";const IA=R.memo(wb);function LA({id:e,x:t,y:n,width:r,height:a,style:l,color:o,strokeColor:i,strokeWidth:c,className:u,borderRadius:m,shapeRendering:d,selected:f,onClick:p}){const{background:v,backgroundColor:b}=l||{},x=o||v||b;return s.jsx("rect",{className:et(["react-flow__minimap-node",{selected:f},u]),x:t,y:n,rx:m,ry:m,width:r,height:a,style:{fill:x,stroke:i,strokeWidth:c},shapeRendering:d,onClick:p?h=>p(h,e):void 0})}const $A=R.memo(LA),DA=e=>e.nodes.map(t=>t.id),yu=e=>e instanceof Function?e:()=>e;function FA({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a,nodeComponent:l=$A,onClick:o}){const i=Ee(DA,He),c=yu(t),u=yu(e),m=yu(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return s.jsx(s.Fragment,{children:i.map(f=>s.jsx(VA,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:u,nodeClassNameFunc:m,nodeBorderRadius:r,nodeStrokeWidth:a,NodeComponent:l,onClick:o,shapeRendering:d},f))})}function zA({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:a,nodeStrokeWidth:l,shapeRendering:o,NodeComponent:i,onClick:c}){const{node:u,x:m,y:d,width:f,height:p}=Ee(v=>{const{internals:b}=v.nodeLookup.get(e),x=b.userNode,{x:h,y:g}=b.positionAbsolute,{width:y,height:w}=ks(x);return{node:x,x:h,y:g,width:y,height:w}},He);return!u||u.hidden||!_y(u)?null:s.jsx(i,{x:m,y:d,width:f,height:p,style:u.style,selected:!!u.selected,className:r(u),color:t(u),borderRadius:a,strokeColor:n(u),strokeWidth:l,shapeRendering:o,onClick:c,id:u.id})}const VA=R.memo(zA);var HA=R.memo(FA);const UA=200,BA=150,YA=e=>!e.hidden,WA=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?wy(Kl(e.nodeLookup,{filter:YA}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},GA="react-flow__minimap-desc";function _b({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:a="",nodeBorderRadius:l=5,nodeStrokeWidth:o,nodeComponent:i,bgColor:c,maskColor:u,maskStrokeColor:m,maskStrokeWidth:d,position:f="bottom-right",onClick:p,onNodeClick:v,pannable:b=!1,zoomable:x=!1,ariaLabel:h,inversePan:g,zoomStep:y=1,offsetScale:w=5}){const E=Ue(),_=R.useRef(null),{boundingRect:S,viewBB:N,rfId:k,panZoom:A,translateExtent:C,flowWidth:O,flowHeight:F,ariaLabelConfig:j}=Ee(WA,He),T=(e==null?void 0:e.width)??UA,I=(e==null?void 0:e.height)??BA,$=S.width/T,P=S.height/I,M=Math.max($,P),D=M*T,V=M*I,B=w*M,K=S.x-(D-S.width)/2-B,J=S.y-(V-S.height)/2-B,ae=D+B*2,U=V+B*2,Y=`${GA}-${k}`,W=R.useRef(0),ie=R.useRef();W.current=M,R.useEffect(()=>{if(_.current&&A)return ie.current=x3({domNode:_.current,panZoom:A,getTransform:()=>E.getState().transform,getViewScale:()=>W.current}),()=>{var oe;(oe=ie.current)==null||oe.destroy()}},[A]),R.useEffect(()=>{var oe;(oe=ie.current)==null||oe.update({translateExtent:C,width:O,height:F,inversePan:g,pannable:b,zoomStep:y,zoomable:x})},[b,x,g,y,C,O,F]);const H=p?oe=>{var L;const[fe,ge]=((L=ie.current)==null?void 0:L.pointer(oe))||[0,0];p(oe,{x:fe,y:ge})}:void 0,X=v?R.useCallback((oe,fe)=>{const ge=E.getState().nodeLookup.get(fe).internals.userNode;v(oe,ge)},[]):void 0,Z=h??j["minimap.ariaLabel"];return s.jsx(vc,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-color-props":typeof m=="string"?m:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*M:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof o=="number"?o:void 0},className:et(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:s.jsxs("svg",{width:T,height:I,viewBox:`${K} ${J} ${ae} ${U}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:_,onClick:H,children:[Z&&s.jsx("title",{id:Y,children:Z}),s.jsx(HA,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:l,nodeClassName:a,nodeStrokeWidth:o,nodeComponent:i}),s.jsx("path",{className:"react-flow__minimap-mask",d:`M${K-B},${J-B}h${ae+B*2}v${U+B*2}h${-ae-B*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}_b.displayName="MiniMap";const qA=R.memo(_b),XA=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,QA={[Sa.Line]:"right",[Sa.Handle]:"bottom-right"};function KA({nodeId:e,position:t,variant:n=Sa.Handle,className:r,style:a=void 0,children:l,color:o,minWidth:i=10,minHeight:c=10,maxWidth:u=Number.MAX_VALUE,maxHeight:m=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:p=!0,shouldResize:v,onResizeStart:b,onResize:x,onResizeEnd:h}){const g=nb(),y=typeof e=="string"?e:g,w=Ue(),E=R.useRef(null),_=n===Sa.Handle,S=Ee(R.useCallback(XA(_&&p),[_,p]),He),N=R.useRef(null),k=t??QA[n];R.useEffect(()=>{if(!(!E.current||!y))return N.current||(N.current=P3({domNode:E.current,nodeId:y,getStoreItems:()=>{const{nodeLookup:C,transform:O,snapGrid:F,snapToGrid:j,nodeOrigin:T,domNode:I}=w.getState();return{nodeLookup:C,transform:O,snapGrid:F,snapToGrid:j,nodeOrigin:T,paneDomNode:I}},onChange:(C,O)=>{const{triggerNodeChanges:F,nodeLookup:j,parentLookup:T,nodeOrigin:I}=w.getState(),$=[],P={x:C.x,y:C.y},M=j.get(y);if(M&&M.expandParent&&M.parentId){const D=M.origin??I,V=C.width??M.measured.width??0,B=C.height??M.measured.height??0,K={id:M.id,parentId:M.parentId,rect:{width:V,height:B,...Sy({x:C.x??M.position.x,y:C.y??M.position.y},{width:V,height:B},M.parentId,j,D)}},J=df([K],j,T,I);$.push(...J),P.x=C.x?Math.max(D[0]*V,C.x):void 0,P.y=C.y?Math.max(D[1]*B,C.y):void 0}if(P.x!==void 0&&P.y!==void 0){const D={id:y,type:"position",position:{...P}};$.push(D)}if(C.width!==void 0&&C.height!==void 0){const V={id:y,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:C.width,height:C.height}};$.push(V)}for(const D of O){const V={...D,type:"position"};$.push(V)}F($)},onEnd:({width:C,height:O})=>{const F={id:y,type:"dimensions",resizing:!1,dimensions:{width:C,height:O}};w.getState().triggerNodeChanges([F])}})),N.current.update({controlPosition:k,boundaries:{minWidth:i,minHeight:c,maxWidth:u,maxHeight:m},keepAspectRatio:d,resizeDirection:f,onResizeStart:b,onResize:x,onResizeEnd:h,shouldResize:v}),()=>{var C;(C=N.current)==null||C.destroy()}},[k,i,c,u,m,d,b,x,h,v]);const A=k.split("-");return s.jsx("div",{className:et(["react-flow__resize-control","nodrag",...A,n,r]),ref:E,style:{...a,scale:S,...o&&{[_?"backgroundColor":"borderColor"]:o}},children:l})}R.memo(KA);function ZA({data:e}){return s.jsxs("div",{className:`px-4 py-3 rounded-xl border-2 shadow-lg min-w-[200px] ${e.isDefault?"border-amber-500 bg-amber-950/80":"border-blue-500 bg-slate-800/90"}`,children:[s.jsx(Zs,{type:"target",position:he.Top,className:"!bg-blue-500 !w-3 !h-3"}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:`p-1.5 rounded-lg ${e.isDefault?"bg-amber-500/20":"bg-blue-500/20"}`,children:s.jsx(_t,{className:`w-4 h-4 ${e.isDefault?"text-amber-400":"text-blue-400"}`})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-slate-100",children:e.name}),e.isDefault&&s.jsx("div",{className:"text-[10px] text-amber-400 font-medium",children:"Default Agent"})]})]}),e.description&&s.jsx("p",{className:"text-xs text-slate-400 mb-2 line-clamp-2",children:e.description}),s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(wl,{className:"w-3 h-3 text-purple-400"}),s.jsx("span",{className:"truncate",children:e.modelName})]}),e.toolCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(js,{className:"w-3 h-3 text-green-400"}),s.jsxs("span",{children:[e.toolCount," tool",e.toolCount!==1?"s":""]})]}),e.guardrailCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(Xs,{className:"w-3 h-3 text-red-400"}),s.jsxs("span",{children:[e.guardrailCount," guardrail",e.guardrailCount!==1?"s":""]})]}),e.handoffTargets&&e.handoffTargets.length>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(Wl,{className:"w-3 h-3 text-cyan-400"}),s.jsxs("span",{children:[" ",e.handoffTargets.join(", ")]})]})]}),s.jsx(Zs,{type:"source",position:he.Bottom,className:"!bg-blue-500 !w-3 !h-3"})]})}function JA({data:e}){return s.jsxs("div",{className:"px-4 py-3 rounded-xl border-2 border-purple-500 bg-purple-950/80 shadow-lg min-w-[180px]",children:[s.jsx(Zs,{type:"target",position:he.Top,className:"!bg-purple-500 !w-3 !h-3"}),s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-purple-500/20",children:s.jsx(yd,{className:"w-4 h-4 text-purple-400"})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-semibold text-slate-100",children:"Supervisor"}),s.jsx("div",{className:"text-[10px] text-purple-400 font-medium",children:"Orchestrator"})]})]}),s.jsxs("div",{className:"space-y-1.5 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(wl,{className:"w-3 h-3 text-purple-400"}),s.jsx("span",{className:"truncate",children:e.modelName})]}),e.toolCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[s.jsx(js,{className:"w-3 h-3 text-green-400"}),s.jsxs("span",{children:[e.toolCount," tool",e.toolCount!==1?"s":""]})]})]}),s.jsx(Zs,{type:"source",position:he.Bottom,className:"!bg-purple-500 !w-3 !h-3"})]})}const eP={agent:ZA,supervisor:JA};function tP({config:e}){var c,u,m,d;const{nodes:t,edges:n}=R.useMemo(()=>nP(e),[e]),[r,,a]=jA(t),[l,,o]=wA(n),i=(u=(c=e.app)==null?void 0:c.orchestration)!=null&&u.supervisor?"supervisor":(d=(m=e.app)==null?void 0:m.orchestration)!=null&&d.swarm?"swarm":"none";return s.jsxs("div",{className:"w-full h-full bg-slate-900 rounded-lg overflow-hidden",children:[s.jsx("div",{className:"px-4 py-3 border-b border-slate-700 bg-slate-800/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Wl,{className:"w-5 h-5 text-blue-400"}),s.jsx("h3",{className:"text-sm font-medium text-slate-200",children:"Agent Graph"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-slate-400",children:"Orchestration:"}),s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${i==="supervisor"?"bg-purple-500/20 text-purple-300":i==="swarm"?"bg-blue-500/20 text-blue-300":"bg-slate-700 text-slate-400"}`,children:i==="supervisor"?"Supervisor":i==="swarm"?"Swarm":"Not Configured"})]})]})}),s.jsx("div",{className:"h-[calc(100%-52px)]",children:t.length===0?s.jsx("div",{className:"flex items-center justify-center h-full text-slate-500",children:s.jsxs("div",{className:"text-center",children:[s.jsx(_t,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No agents configured"}),s.jsx("p",{className:"text-xs mt-1",children:"Add agents to visualize the graph"})]})}):s.jsxs(NA,{nodes:r,edges:l,onNodesChange:a,onEdgesChange:o,nodeTypes:eP,connectionLineType:ds.SmoothStep,fitView:!0,fitViewOptions:{padding:.3},minZoom:.3,maxZoom:2,defaultEdgeOptions:{type:"smoothstep",animated:!0,style:{stroke:"#64748b",strokeWidth:2},markerEnd:{type:kr.ArrowClosed,color:"#64748b"}},children:[s.jsx(EA,{color:"#334155",gap:20,size:1}),s.jsx(IA,{className:"!bg-slate-800 !border-slate-700 !rounded-lg [&>button]:!bg-slate-700 [&>button]:!border-slate-600 [&>button]:!text-slate-300 [&>button:hover]:!bg-slate-600"}),s.jsx(qA,{nodeColor:f=>{var p;return f.type==="supervisor"?"#a855f7":(p=f.data)!=null&&p.isDefault?"#f59e0b":"#3b82f6"},maskColor:"rgba(15, 23, 42, 0.8)",className:"!bg-slate-800 !border-slate-700 !rounded-lg"})]})})]})}function nP(e){var b,x,h,g,y;const t=[],n=[],r=e.agents||{},a=((b=e.app)==null?void 0:b.agents)||[],l=a.length>0?Object.keys(r).filter(w=>{const E=r[w];return a.some(_=>{const S=typeof _=="string"?_:_==null?void 0:_.name;return E.name===S})}):Object.keys(r),o=Object.fromEntries(l.map(w=>[w,r[w]]));if(l.length===0)return{nodes:t,edges:n};const i=l.map(w=>o[w].name),c=(x=e.app)==null?void 0:x.orchestration,u=240,m=180,d=100,f=120,p=u+d,v=m+f;if(c!=null&&c.supervisor){const w=c.supervisor,E=l.length,_=Math.min(3,E),k=Math.min(_,E)*p/2;t.push({id:"supervisor",type:"supervisor",position:{x:k-90,y:40},data:{modelName:((h=w.model)==null?void 0:h.name)||"Unknown",toolCount:((g=w.tools)==null?void 0:g.length)||0}}),l.forEach((A,C)=>{var P,M,D;const O=o[A],F=Math.floor(C/_),j=C%_,I=Math.min(_,E-F*_)*p,$=k-I/2;t.push({id:A,type:"agent",position:{x:$+j*p,y:40+v+F*v},data:{name:O.name,description:O.description,modelName:((P=O.model)==null?void 0:P.name)||"Unknown",toolCount:((M=O.tools)==null?void 0:M.length)||0,guardrailCount:((D=O.guardrails)==null?void 0:D.length)||0}}),n.push({id:`supervisor-${A}`,source:"supervisor",target:A,animated:!0,style:{stroke:"#a855f7",strokeWidth:2},markerEnd:{type:kr.ArrowClosed,color:"#a855f7"}})})}else if(c!=null&&c.swarm){const w=c.swarm,E=typeof w.default_agent=="string"?w.default_agent:(y=w.default_agent)==null?void 0:y.name,_=w.handoffs||{},S=A=>{if(!Object.prototype.hasOwnProperty.call(_,A))return i.filter(F=>F!==A);const O=_[A];return O==null?i.filter(F=>F!==A):Array.isArray(O)&&O.length===0?[]:Array.isArray(O)?O.map(F=>typeof F=="string"?F:(F==null?void 0:F.name)||"").filter(F=>F&&F!==A&&i.includes(F)):[]},N=l.length,k=(A,C)=>{var I,$,P,M;const O=S(A.name),F=Object.prototype.hasOwnProperty.call(_,A.name),j=!F||_[A.name]===null||_[A.name]===void 0,T=F&&Array.isArray(_[A.name])&&((I=_[A.name])==null?void 0:I.length)===0;return{name:A.name,description:A.description,modelName:(($=A.model)==null?void 0:$.name)||"Unknown",toolCount:((P=A.tools)==null?void 0:P.length)||0,guardrailCount:((M=A.guardrails)==null?void 0:M.length)||0,isDefault:C,handoffTargets:j?["(all agents)"]:T?["(none)"]:O.length>0?O:void 0}};if(N===2){const A=p*1.5,C=50;l.forEach((O,F)=>{const j=o[O],T=j.name===E;t.push({id:O,type:"agent",position:{x:C+F*A,y:100},data:k(j,T)})})}else if(N===3){const O=50+v,F=p*.7,j=o[l[0]];t.push({id:l[0],type:"agent",position:{x:300-u/2,y:50},data:k(j,j.name===E)});const T=o[l[1]];t.push({id:l[1],type:"agent",position:{x:300-u/2-F,y:O},data:k(T,T.name===E)});const I=o[l[2]];t.push({id:l[2],type:"agent",position:{x:300-u/2+F,y:O},data:k(I,I.name===E)})}else if(N<=6){const A=280+N*30,C=A+u/2+50,O=A+m/2+50,F=2*Math.PI/N,j=-Math.PI/2;l.forEach((T,I)=>{const $=o[T],P=j+I*F,M=C+A*Math.cos(P)-u/2,D=O+A*Math.sin(P)-m/2,V=$.name===E;t.push({id:T,type:"agent",position:{x:M,y:D},data:k($,V)})})}else{const O=Math.min(3,N)*p/2;l.forEach((F,j)=>{const T=o[F],I=j%3,$=Math.floor(j/3),M=Math.min(3,N-$*3)*p,D=O-M/2,V=T.name===E;t.push({id:F,type:"agent",position:{x:D+I*p,y:50+$*v},data:k(T,V)})})}l.forEach(A=>{const C=o[A];S(C.name).forEach((F,j)=>{const T=l.find(I=>o[I].name===F);!T||A===T||n.push({id:`${A}-${T}-${j}`,source:A,target:T,animated:!0,style:{stroke:"#22d3ee",strokeWidth:2},markerEnd:{type:kr.ArrowClosed,color:"#22d3ee"}})})})}else{const w=l.length,E=Math.min(3,w),S=Math.min(E,w)*p/2;l.forEach((N,k)=>{var I,$,P;const A=o[N],C=Math.floor(k/E),O=k%E,j=Math.min(E,w-C*E)*p,T=S-j/2;t.push({id:N,type:"agent",position:{x:T+O*p,y:50+C*v},data:{name:A.name,description:A.description,modelName:((I=A.model)==null?void 0:I.name)||"Unknown",toolCount:(($=A.tools)==null?void 0:$.length)||0,guardrailCount:((P=A.guardrails)==null?void 0:P.length)||0,isDefault:k===0}})})}return{nodes:t,edges:n}}const sP={validate:s.jsx(Qn,{className:"w-4 h-4"}),create_agent:s.jsx(_t,{className:"w-4 h-4"}),deploy_agent:s.jsx(_l,{className:"w-4 h-4"})},rP={validate:"Validate Configuration",create_agent:"Create Agent Model",deploy_agent:"Deploy to Endpoint"};function aP({onClose:e}){const{config:t}=Oe(),[n,r]=R.useState(null),[a,l]=R.useState(!1),[o,i]=R.useState(null),[c,u]=R.useState(null),[m,d]=R.useState(!1),[f,p]=R.useState("quick"),[v,b]=R.useState(null),[x,h]=R.useState("manual_pat"),[g,y]=R.useState(""),[w,E]=R.useState(""),[_,S]=R.useState(""),[N,k]=R.useState({hasAppCredentials:!1,hasOboToken:!1});R.useEffect(()=>{(async()=>{try{const T=await fetch("/api/auth/context");if(T.ok){const I=await T.json();k({hasAppCredentials:I.has_service_principal||!1,hasOboToken:I.has_obo_token||!1}),h("manual_pat")}}catch(T){console.error("Failed to check credentials:",T)}})()},[]);const A=R.useCallback(async()=>{l(!0),b(null);try{const j=await fetch("/api/deploy/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:t})});if(!j.ok){const I=await j.json();throw new Error(I.error||"Validation failed")}const T=await j.json();r(T)}catch(j){b(j instanceof Error?j.message:"Failed to validate configuration")}finally{l(!1)}},[t]);R.useEffect(()=>{A()},[A]),R.useEffect(()=>{if(!o)return;const j=async()=>{try{const I=await fetch(`/api/deploy/status/${o}`);if(!I.ok)return;const $=await I.json();u($),($.status==="completed"||$.status==="failed")&&d(!1)}catch(I){console.error("Failed to poll deployment status:",I)}};j();const T=setInterval(j,2e3);return()=>clearInterval(T)},[o]);const C=async()=>{if(!(n!=null&&n.valid))return;if(x==="manual_sp"&&(!g||!w)){b("Please enter both Client ID and Client Secret");return}if(x==="manual_pat"&&!_){b("Please enter a Personal Access Token");return}d(!0),b(null),u({id:"pending",status:"starting",type:f,started_at:new Date().toISOString(),steps:[{name:"validate",status:"running"},{name:"create_agent",status:"pending"},{name:"deploy_agent",status:"pending"}],current_step:0});const j={type:x};x==="manual_sp"?(j.client_id=g,j.client_secret=w):x==="manual_pat"&&(j.pat=_);try{const I=await fetch(f==="quick"?"/api/deploy/quick":"/api/deploy/full",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:t,credentials:j})});if(!I.ok){const P=await I.json();throw new Error(P.error||"Deployment failed to start")}const $=await I.json();i($.deployment_id)}catch(T){const I=T instanceof Error?T.message:"Failed to start deployment";b(I),d(!1),u($=>$?{...$,status:"failed",error:I,steps:$.steps.map((P,M)=>M===0?{...P,status:"failed",error:I}:P)}:null)}},O=j=>{switch(j){case"completed":return s.jsx(an,{className:"w-5 h-5 text-green-400"});case"failed":return s.jsx(cn,{className:"w-5 h-5 text-red-400"});case"running":return s.jsx(dt,{className:"w-5 h-5 text-blue-400 animate-spin"});default:return s.jsx(Si,{className:"w-5 h-5 text-slate-500"})}},F=()=>{if(!c)return null;switch(c.status){case"completed":return s.jsx(we,{variant:"success",children:"Completed"});case"failed":return s.jsx(we,{variant:"danger",children:"Failed"});case"creating_agent":return s.jsx(we,{variant:"info",children:"Creating Agent..."});case"deploying":return s.jsx(we,{variant:"info",children:"Deploying..."});default:return s.jsx(we,{variant:"warning",children:"Starting..."})}};return s.jsx("div",{className:"space-y-6",children:a?s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(gt,{className:"w-6 h-6 text-blue-400 animate-spin mr-2"}),s.jsx("span",{className:"text-slate-300",children:"Validating configuration..."})]}):n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`p-4 rounded-lg border ${n.valid?"bg-green-950/30 border-green-800":"bg-red-950/30 border-red-800"}`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[n.valid?s.jsx(an,{className:"w-6 h-6 text-green-400"}):s.jsx(cn,{className:"w-6 h-6 text-red-400"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-slate-100",children:n.valid?"Configuration Valid":"Configuration Invalid"}),s.jsxs("p",{className:"text-xs text-slate-400 mt-0.5",children:[n.app_name&&`App: ${n.app_name}`,n.agent_count!==void 0&&`  ${n.agent_count} agent(s)`]})]})]}),n.errors.length>0&&s.jsx("div",{className:"mt-3 space-y-1",children:n.errors.map((j,T)=>s.jsxs("div",{className:"flex items-start gap-2 text-xs text-red-400",children:[s.jsx(cn,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:j})]},T))}),n.warnings.length>0&&s.jsx("div",{className:"mt-3 space-y-1",children:n.warnings.map((j,T)=>s.jsxs("div",{className:"flex items-start gap-2 text-xs text-amber-400",children:[s.jsx(Dm,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),s.jsx("span",{children:j})]},T))})]}),n.requirements.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Resource Requirements"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:n.requirements.map((j,T)=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-slate-800/50 rounded-lg border border-slate-700",children:[j.type==="vector_search"&&s.jsx(wr,{className:"w-3 h-3 text-purple-400"}),j.type==="database"&&s.jsx(Qt,{className:"w-3 h-3 text-blue-400"}),j.type==="genie"&&s.jsx(_t,{className:"w-3 h-3 text-cyan-400"}),j.type==="functions"&&s.jsx(Qn,{className:"w-3 h-3 text-green-400"}),s.jsx("span",{className:"text-xs text-slate-300",children:j.description}),s.jsx(we,{variant:"default",className:"text-[10px]",children:j.count})]},T))})]}),n.valid&&!c&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Deployment Credentials"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("button",{onClick:()=>h("manual_pat"),className:`p-3 rounded-lg border text-left transition-all ${x==="manual_pat"?"bg-cyan-950/40 border-cyan-500 ring-1 ring-cyan-500/50":"bg-slate-800/30 border-slate-700 hover:border-slate-600"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Cn,{className:"w-4 h-4 text-cyan-400"}),s.jsx("span",{className:`text-sm font-medium ${x==="manual_pat"?"text-slate-100":"text-slate-300"}`,children:"Manual PAT"}),x==="manual_pat"&&s.jsx(an,{className:"w-3 h-3 text-cyan-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter personal access token"})]}),s.jsxs("button",{onClick:()=>h("manual_sp"),className:`p-3 rounded-lg border text-left transition-all ${x==="manual_sp"?"bg-amber-950/40 border-amber-500 ring-1 ring-amber-500/50":"bg-slate-800/30 border-slate-700 hover:border-slate-600"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xs,{className:"w-4 h-4 text-amber-400"}),s.jsx("span",{className:`text-sm font-medium ${x==="manual_sp"?"text-slate-100":"text-slate-300"}`,children:"Manual SP"}),x==="manual_sp"&&s.jsx(an,{className:"w-3 h-3 text-amber-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Enter client ID & secret"})]}),s.jsxs("button",{onClick:()=>h("obo"),disabled:!N.hasOboToken,className:`p-3 rounded-lg border text-left transition-all ${x==="obo"?"bg-purple-950/40 border-purple-500 ring-1 ring-purple-500/50":N.hasOboToken?"bg-slate-800/30 border-slate-700 hover:border-slate-600":"bg-slate-800/20 border-slate-800 opacity-50 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mn,{className:"w-4 h-4 text-purple-400"}),s.jsx("span",{className:`text-sm font-medium ${x==="obo"?"text-slate-100":"text-slate-300"}`,children:"User Token (OBO)"}),x==="obo"&&s.jsx(an,{className:"w-3 h-3 text-purple-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Use your logged-in credentials"})]}),s.jsxs("button",{onClick:()=>h("app"),disabled:!N.hasAppCredentials,className:`p-3 rounded-lg border text-left transition-all ${x==="app"?"bg-green-950/40 border-green-500 ring-1 ring-green-500/50":N.hasAppCredentials?"bg-slate-800/30 border-slate-700 hover:border-slate-600":"bg-slate-800/20 border-slate-800 opacity-50 cursor-not-allowed"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Y1,{className:"w-4 h-4 text-green-400"}),s.jsx("span",{className:`text-sm font-medium ${x==="app"?"text-slate-100":"text-slate-300"}`,children:"App Service Principal"}),x==="app"&&s.jsx(an,{className:"w-3 h-3 text-green-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Use application credentials"})]})]}),x==="manual_sp"&&s.jsxs("div",{className:"space-y-2 p-3 bg-slate-800/30 rounded-lg border border-slate-700",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Client ID"}),s.jsx("input",{type:"text",value:g,onChange:j=>y(j.target.value),placeholder:"Enter service principal client ID",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-amber-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Client Secret"}),s.jsx("input",{type:"password",value:w,onChange:j=>E(j.target.value),placeholder:"Enter service principal client secret",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-amber-500"})]})]}),x==="manual_pat"&&s.jsxs("div",{className:"p-3 bg-slate-800/30 rounded-lg border border-slate-700",children:[s.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Personal Access Token"}),s.jsx("input",{type:"password",value:_,onChange:j=>S(j.target.value),placeholder:"Enter Databricks personal access token",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded-lg text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-cyan-500"})]})]}),n.valid&&n.deployment_options&&!c&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Deployment Options"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("button",{onClick:()=>p("quick"),className:`p-4 rounded-xl border text-left transition-all ${f==="quick"?"bg-blue-950/40 border-blue-500 ring-1 ring-blue-500/50":"bg-slate-800/30 border-slate-700 hover:border-slate-600"}`,disabled:!n.deployment_options.quick.available,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/20",children:s.jsx(ki,{className:"w-4 h-4 text-blue-400"})}),s.jsx("span",{className:"font-medium text-slate-100",children:"Quick Deploy"}),f==="quick"&&s.jsx(an,{className:"w-4 h-4 text-blue-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-400 mb-3",children:n.deployment_options.quick.description}),s.jsx("div",{className:"flex flex-wrap gap-1",children:n.deployment_options.quick.provisions.map((j,T)=>s.jsx("span",{className:"px-2 py-0.5 text-[10px] bg-slate-700/50 rounded text-slate-300",children:j},T))})]}),s.jsxs("button",{onClick:()=>p("full"),className:`p-4 rounded-xl border text-left transition-all ${f==="full"?"bg-purple-950/40 border-purple-500 ring-1 ring-purple-500/50":"bg-slate-800/30 border-slate-700 hover:border-slate-600"} ${n.deployment_options.full.available?"":"opacity-50 cursor-not-allowed"}`,disabled:!n.deployment_options.full.available,children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"p-1.5 rounded-lg bg-purple-500/20",children:s.jsx(hs,{className:"w-4 h-4 text-purple-400"})}),s.jsx("span",{className:"font-medium text-slate-100",children:"Full Pipeline"}),f==="full"&&s.jsx(an,{className:"w-4 h-4 text-purple-400 ml-auto"})]}),s.jsx("p",{className:"text-xs text-slate-400 mb-3",children:n.deployment_options.full.description}),s.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.deployment_options.full.provisions.slice(0,4).map((j,T)=>s.jsx("span",{className:"px-2 py-0.5 text-[10px] bg-slate-700/50 rounded text-slate-300",children:j},T)),n.deployment_options.full.provisions.length>4&&s.jsxs("span",{className:"px-2 py-0.5 text-[10px] bg-slate-700/50 rounded text-slate-400",children:["+",n.deployment_options.full.provisions.length-4," more"]})]}),n.deployment_options.full.requires_bundle&&s.jsx("p",{className:"text-[10px] text-amber-400 mt-2",children:" Requires Databricks Asset Bundle CLI"})]})]})]}),c&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"text-xs font-medium text-slate-400 uppercase tracking-wide",children:"Deployment Progress"}),F()]}),s.jsx("div",{className:"space-y-2",children:c.steps.map(j=>s.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${j.status==="running"?"bg-blue-950/30 border-blue-800":j.status==="completed"?"bg-green-950/20 border-green-900":j.status==="failed"?"bg-red-950/20 border-red-900":"bg-slate-800/30 border-slate-700"}`,children:[s.jsx("div",{className:`p-1.5 rounded-lg ${j.status==="running"?"bg-blue-500/20":j.status==="completed"?"bg-green-500/20":j.status==="failed"?"bg-red-500/20":"bg-slate-700"}`,children:sP[j.name]||s.jsx(Qn,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-slate-200",children:rP[j.name]||j.name}),j.error&&s.jsx("p",{className:"text-xs text-red-400 mt-1",children:j.error})]}),O(j.status)]},j.name))}),c.status==="completed"&&c.result&&s.jsxs("div",{className:"p-4 bg-green-950/30 border border-green-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(an,{className:"w-5 h-5 text-green-400"}),s.jsx("span",{className:"font-medium text-green-300",children:"Deployment Successful!"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-slate-400",children:"Endpoint:"}),s.jsx("code",{className:"px-2 py-0.5 bg-slate-800 rounded text-green-300",children:c.result.endpoint_name})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-slate-400",children:"Model:"}),s.jsx("code",{className:"px-2 py-0.5 bg-slate-800 rounded text-slate-300 text-xs",children:c.result.model_name})]})]})]}),c.status==="failed"&&c.error&&s.jsxs("div",{className:"p-4 bg-red-950/30 border border-red-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(cn,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"font-medium text-red-300",children:"Deployment Failed"})]}),s.jsx("p",{className:"text-sm text-red-400",children:c.error}),c.error_trace&&s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-slate-500 cursor-pointer hover:text-slate-400",children:"Show details"}),s.jsx("pre",{className:"mt-2 p-2 bg-slate-900 rounded text-xs text-slate-400 overflow-x-auto max-h-40",children:c.error_trace})]})]})]}),v&&s.jsx("div",{className:"p-4 bg-red-950/30 border border-red-800 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(cn,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"text-red-300",children:v})]})}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-700",children:[s.jsxs(Q,{variant:"ghost",onClick:A,disabled:a,children:[s.jsx(gt,{className:`w-4 h-4 ${a?"animate-spin":""}`}),"Revalidate"]}),s.jsxs("div",{className:"flex items-center gap-3",children:[e&&s.jsx(Q,{variant:"secondary",onClick:e,children:"Cancel"}),s.jsx(Q,{variant:"primary",onClick:C,disabled:!n.valid||m||(c==null?void 0:c.status)==="completed",children:m?s.jsxs(s.Fragment,{children:[s.jsx(dt,{className:"w-4 h-4 animate-spin"}),"Deploying..."]}):(c==null?void 0:c.status)==="completed"?s.jsxs(s.Fragment,{children:[s.jsx(an,{className:"w-4 h-4"}),"Deployed"]}):s.jsxs(s.Fragment,{children:[s.jsx(Fg,{className:"w-4 h-4"}),"Deploy ",f==="quick"?"Quick":"Full Pipeline"]})})]})]})]}):v?s.jsxs("div",{className:"p-4 bg-red-950/30 border border-red-800 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(cn,{className:"w-5 h-5 text-red-400"}),s.jsx("span",{className:"text-red-300",children:v})]}),s.jsxs(Q,{variant:"ghost",onClick:A,className:"mt-3",children:[s.jsx(gt,{className:"w-4 h-4"}),"Retry"]})]}):null})}const lP={};function oP(e,t){let n;try{n=e()}catch{return}return{getItem:a=>{var l;const o=c=>c===null?null:JSON.parse(c,void 0),i=(l=n.getItem(a))!=null?l:null;return i instanceof Promise?i.then(o):o(i)},setItem:(a,l)=>n.setItem(a,JSON.stringify(l,void 0)),removeItem:a=>n.removeItem(a)}}const Fl=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return Fl(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Fl(r)(n)}}}},iP=(e,t)=>(n,r,a)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,h)=>({...h,...x}),...t},o=!1;const i=new Set,c=new Set;let u;try{u=l.getStorage()}catch{}if(!u)return e((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),n(...x)},r,a);const m=Fl(l.serialize),d=()=>{const x=l.partialize({...r()});let h;const g=m({state:x,version:l.version}).then(y=>u.setItem(l.name,y)).catch(y=>{h=y});if(h)throw h;return g},f=a.setState;a.setState=(x,h)=>{f(x,h),d()};const p=e((...x)=>{n(...x),d()},r,a);let v;const b=()=>{var x;if(!u)return;o=!1,i.forEach(g=>g(r()));const h=((x=l.onRehydrateStorage)==null?void 0:x.call(l,r()))||void 0;return Fl(u.getItem.bind(u))(l.name).then(g=>{if(g)return l.deserialize(g)}).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==l.version){if(l.migrate)return l.migrate(g.state,g.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return g.state}).then(g=>{var y;return v=l.merge(g,(y=r())!=null?y:p),n(v,!0),d()}).then(()=>{h==null||h(v,void 0),o=!0,c.forEach(g=>g(v))}).catch(g=>{h==null||h(void 0,g)})};return a.persist={setOptions:x=>{l={...l,...x},x.getStorage&&(u=x.getStorage())},clearStorage:()=>{u==null||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:x=>(i.add(x),()=>{i.delete(x)}),onFinishHydration:x=>(c.add(x),()=>{c.delete(x)})},b(),v||p},cP=(e,t)=>(n,r,a)=>{let l={storage:oP(()=>localStorage),partialize:b=>b,version:0,merge:(b,x)=>({...x,...b}),...t},o=!1;const i=new Set,c=new Set;let u=l.storage;if(!u)return e((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),n(...b)},r,a);const m=()=>{const b=l.partialize({...r()});return u.setItem(l.name,{state:b,version:l.version})},d=a.setState;a.setState=(b,x)=>{d(b,x),m()};const f=e((...b)=>{n(...b),m()},r,a);a.getInitialState=()=>f;let p;const v=()=>{var b,x;if(!u)return;o=!1,i.forEach(g=>{var y;return g((y=r())!=null?y:f)});const h=((x=l.onRehydrateStorage)==null?void 0:x.call(l,(b=r())!=null?b:f))||void 0;return Fl(u.getItem.bind(u))(l.name).then(g=>{if(g)if(typeof g.version=="number"&&g.version!==l.version){if(l.migrate)return[!0,l.migrate(g.state,g.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,g.state];return[!1,void 0]}).then(g=>{var y;const[w,E]=g;if(p=l.merge(E,(y=r())!=null?y:f),n(p,!0),w)return m()}).then(()=>{h==null||h(p,void 0),p=r(),o=!0,c.forEach(g=>g(p))}).catch(g=>{h==null||h(void 0,g)})};return a.persist={setOptions:b=>{l={...l,...b},b.storage&&(u=b.storage)},clearStorage:()=>{u==null||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:b=>(i.add(b),()=>{i.delete(b)}),onFinishHydration:b=>(c.add(b),()=>{c.delete(b)})},l.skipHydration||v(),p||f},uP=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((lP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),iP(e,t)):cP(e,t),dP=uP,f0=()=>`conv-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,mP=Og()(dP(e=>({conversationId:f0(),messages:[],logs:[],addMessage:(t,n)=>{e(r=>({messages:[...r.messages,{role:t,content:n,timestamp:new Date().toISOString()}]}))},updateLastMessage:t=>{e(n=>{const r=[...n.messages];return r.length>0&&(r[r.length-1]={...r[r.length-1],content:t}),{messages:r}})},addLog:(t,n)=>{e(r=>({logs:[...r.logs,{timestamp:new Date().toISOString(),level:t,message:n}]}))},clearLogs:()=>{e({logs:[]})},startNewSession:()=>{e({conversationId:f0(),messages:[],logs:[]})},removeEmptyMessages:()=>{e(t=>({messages:t.messages.filter(n=>n.content||n.role==="user")}))}}),{name:"dao-chat-storage",partialize:e=>({conversationId:e.conversationId,messages:e.messages})}));function fP({onClose:e}){var V,B,K,J,ae;const{config:t}=Oe(),{conversationId:n,messages:r,logs:a,addMessage:l,updateLastMessage:o,addLog:i,clearLogs:c,startNewSession:u,removeEmptyMessages:m}=mP(),[d,f]=R.useState(""),[p,v]=R.useState(!1),[b,x]=R.useState(null),[h,g]=R.useState(null),[y,w]=R.useState(!1),E=R.useRef(null),_=R.useRef(null),S=R.useRef(null),N=R.useCallback(()=>{var U;(U=E.current)==null||U.scrollIntoView({behavior:"smooth"})},[]);R.useEffect(()=>{N()},[r,N]),R.useEffect(()=>{var U;y&&((U=_.current)==null||U.scrollIntoView({behavior:"smooth"}))},[a,y]),R.useEffect(()=>{var U;(U=S.current)==null||U.focus()},[]);const k=Object.keys(t.agents||{}).length>0,A=!!((B=(V=t.app)==null?void 0:V.orchestration)!=null&&B.supervisor||(J=(K=t.app)==null?void 0:K.orchestration)!=null&&J.swarm),C=k&&A,O=async()=>{var Y,W;if(!d.trim()||p||!C)return;const U=d.trim();f(""),v(!0),x(null),g(null),l("user",U),i("info",`Sending message: "${U.substring(0,50)}${U.length>50?"...":""}"`),l("assistant","");try{const ie=[...r,{role:"user",content:U}].map(ge=>({role:ge.role,content:ge.content}));i("debug",`Preparing request with ${ie.length} messages`),i("info","Creating agent from configuration...");const H=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:t,messages:ie,context:{thread_id:n,user_id:"builder-user"}})});if(!H.ok){const ge=await H.json();throw new Error(ge.error||"Chat request failed")}const X=(Y=H.body)==null?void 0:Y.getReader(),Z=new TextDecoder;let oe="",fe="";if(X)for(;;){const{done:ge,value:L}=await X.read();if(ge)break;fe+=Z.decode(L,{stream:!0});const G=fe.split(`
`);fe=G.pop()||"";for(const ve of G)if(ve.startsWith("data: "))try{const me=JSON.parse(ve.slice(6));switch(me.type){case"log":i(me.level,me.message);break;case"delta":oe+=me.content,o(oe);break;case"done":i("info",`Completed: ${me.response.length} characters`),o(me.response||oe);break;case"error":i("error",me.error),x(me.error),me.trace&&g(me.trace),m();break}}catch{console.warn("Failed to parse SSE message:",ve)}}}catch(ie){const H=ie instanceof Error?ie.message:"Failed to get response";x(H),i("error",H),m()}finally{v(!1),(W=S.current)==null||W.focus()}},F=U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),O())},j=()=>{u(),x(null),g(null)},T=U=>new Date(U).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),I=U=>new Date(U).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),$=U=>{switch(U){case"error":return s.jsx(cn,{className:"w-3 h-3 text-red-400"});case"warning":return s.jsx(wi,{className:"w-3 h-3 text-amber-400"});case"debug":return s.jsx(Qc,{className:"w-3 h-3 text-slate-500"});default:return s.jsx(oc,{className:"w-3 h-3 text-blue-400"})}},P=U=>{switch(U){case"error":return"text-red-400";case"warning":return"text-amber-400";case"debug":return"text-slate-500";default:return"text-slate-300"}},M=r.filter(U=>U.content||U.role==="user"),D=r.length>0&&r[r.length-1].role==="assistant"&&!r[r.length-1].content;return s.jsxs("div",{className:"flex flex-col h-[70vh]",children:[s.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-slate-700",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-cyan-500/20 to-blue-500/20",children:s.jsx(qs,{className:"w-5 h-5 text-cyan-400"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-slate-100",children:"Local Agent Chat"}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[s.jsxs("span",{children:["Testing ",((ae=t.app)==null?void 0:ae.name)||"your agent"," locally"]}),s.jsx("span",{className:"text-slate-600",children:""}),s.jsxs("div",{className:"flex items-center gap-1",title:`Conversation ID: ${n}`,children:[s.jsx($g,{className:"w-3 h-3"}),s.jsx("span",{className:"font-mono",children:n.slice(-8)})]})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Q,{variant:"ghost",size:"sm",onClick:j,title:"Start a new conversation",children:[s.jsx(Pe,{className:"w-4 h-4"}),"New Session"]})})]}),!C&&s.jsx("div",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{className:"text-center p-6 max-w-md",children:[s.jsx(Dm,{className:"w-12 h-12 text-amber-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-slate-100 mb-2",children:"Configuration Required"}),s.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"To chat with your agent locally, you need to:"}),s.jsxs("ul",{className:"text-sm text-slate-400 text-left space-y-2",children:[!k&&s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(cn,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),"Add at least one agent"]}),!A&&s.jsxs("li",{className:"flex items-center gap-2",children:[s.jsx(cn,{className:"w-4 h-4 text-red-400 flex-shrink-0"}),"Configure orchestration (Supervisor or Swarm)"]})]})]})}),C&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`flex-1 overflow-y-auto py-4 space-y-4 min-h-0 ${y?"max-h-[30vh]":""}`,children:[M.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[s.jsx(_t,{className:"w-16 h-16 text-slate-600 mb-4"}),s.jsx("h4",{className:"text-lg font-medium text-slate-300 mb-2",children:"Start a Conversation"}),s.jsx("p",{className:"text-sm text-slate-500 max-w-sm",children:"Test your agent configuration locally. Messages are processed using the dao-ai library without deploying to an endpoint."}),s.jsx("p",{className:"text-xs text-slate-600 mt-4",children:"Your chat history will be preserved when you close this panel."})]}):M.map((U,Y)=>s.jsxs("div",{className:`flex gap-3 ${U.role==="user"?"flex-row-reverse":""}`,children:[s.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${U.role==="user"?"bg-blue-500/20":"bg-gradient-to-br from-cyan-500/20 to-purple-500/20"}`,children:U.role==="user"?s.jsx(Mn,{className:"w-4 h-4 text-blue-400"}):s.jsx(_t,{className:"w-4 h-4 text-cyan-400"})}),s.jsxs("div",{className:`flex flex-col max-w-[80%] ${U.role==="user"?"items-end":"items-start"}`,children:[s.jsx("div",{className:`px-4 py-3 rounded-2xl ${U.role==="user"?"bg-blue-600 text-white rounded-br-md":"bg-slate-800 text-slate-100 rounded-bl-md border border-slate-700"}`,children:s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:U.content})}),s.jsx("span",{className:"text-[10px] text-slate-500 mt-1 px-1",children:T(U.timestamp)})]})]},`${U.timestamp}-${Y}`)),p&&D&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500/20 to-purple-500/20 flex items-center justify-center",children:s.jsx(_t,{className:"w-4 h-4 text-cyan-400"})}),s.jsx("div",{className:"bg-slate-800 border border-slate-700 rounded-2xl rounded-bl-md px-4 py-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(dt,{className:"w-4 h-4 text-cyan-400 animate-spin"}),s.jsx("span",{className:"text-sm text-slate-400",children:"Generating response..."})]})})]}),s.jsx("div",{ref:E})]}),b&&s.jsxs("div",{className:"px-4 py-3 bg-red-950/30 border border-red-800 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(cn,{className:"w-4 h-4 text-red-400"}),s.jsx("span",{className:"text-sm text-red-300",children:b})]}),h&&s.jsxs("details",{className:"mt-2",children:[s.jsx("summary",{className:"text-xs text-slate-500 cursor-pointer hover:text-slate-400",children:"Show details"}),s.jsx("pre",{className:"mt-2 p-2 bg-slate-900 rounded text-xs text-slate-400 overflow-x-auto max-h-32",children:h})]})]}),s.jsxs("div",{className:"pt-4 border-t border-slate-700",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"flex-1 relative",children:s.jsx("textarea",{ref:S,value:d,onChange:U=>f(U.target.value),onKeyDown:F,placeholder:"Type your message...",disabled:p,rows:1,className:"w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-sm text-slate-100 placeholder-slate-500 focus:outline-none focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500/50 resize-none disabled:opacity-50",style:{minHeight:"48px",maxHeight:"120px"}})}),s.jsx(Q,{variant:"primary",onClick:O,disabled:!d.trim()||p,className:"self-end bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500",children:p?s.jsx(dt,{className:"w-4 h-4 animate-spin"}):s.jsx(rw,{className:"w-4 h-4"})})]}),s.jsx("p",{className:"text-[10px] text-slate-600 mt-2 text-center",children:"Press Enter to send  Shift+Enter for new line"})]}),s.jsxs("div",{className:"mt-4 border border-slate-700 rounded-lg overflow-hidden",children:[s.jsxs("button",{onClick:()=>w(!y),className:"w-full flex items-center justify-between px-4 py-2 bg-slate-800/50 hover:bg-slate-800 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qc,{className:"w-4 h-4 text-slate-400"}),s.jsx("span",{className:"text-sm font-medium text-slate-300",children:"Application Logs"}),a.length>0&&s.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-slate-700 text-slate-400 rounded",children:a.length})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[a.length>0&&s.jsx("button",{onClick:U=>{U.stopPropagation(),c()},className:"text-xs text-slate-500 hover:text-slate-300 px-2 py-1",children:"Clear"}),y?s.jsx(Ns,{className:"w-4 h-4 text-slate-400"}):s.jsx(Yl,{className:"w-4 h-4 text-slate-400"})]})]}),y&&s.jsx("div",{className:"bg-slate-900/50 max-h-40 overflow-y-auto",children:a.length===0?s.jsxs("div",{className:"px-4 py-6 text-center",children:[s.jsx(Qc,{className:"w-8 h-8 text-slate-700 mx-auto mb-2"}),s.jsx("p",{className:"text-xs text-slate-600",children:"No logs yet. Send a message to see activity."})]}):s.jsxs("div",{className:"divide-y divide-slate-800",children:[a.map((U,Y)=>s.jsxs("div",{className:"px-4 py-2 flex items-start gap-2 hover:bg-slate-800/30",children:[s.jsx("span",{className:"text-[10px] text-slate-600 font-mono whitespace-nowrap pt-0.5",children:I(U.timestamp)}),s.jsx("div",{className:"pt-0.5",children:$(U.level)}),s.jsx("span",{className:`text-xs font-mono flex-1 ${P(U.level)}`,children:U.message})]},Y)),s.jsx("div",{ref:_})]})})]})]}),e&&s.jsx("div",{className:"pt-4 mt-4 border-t border-slate-700 flex justify-end",children:s.jsx(Q,{variant:"secondary",onClick:e,children:"Close"})})]})}function hP({showPreview:e,onTogglePreview:t}){var E,_,S,N;const{config:n,setConfig:r,reset:a}=Oe(),l=R.useRef(null),[o,i]=R.useState(null),[c,u]=R.useState(!1),[m,d]=R.useState(!1),[f,p]=R.useState(!1),v=Object.keys(n.agents||{}).length>0,b=!!((_=(E=n.app)==null?void 0:E.orchestration)!=null&&_.supervisor||(N=(S=n.app)==null?void 0:S.orchestration)!=null&&N.swarm),x=v&&b,h=v;R.useEffect(()=>{fetch("/api/version").then(k=>k.json()).then(k=>i(k.dao_ai)).catch(()=>i(null))},[]);const g=()=>{var A;const k=((A=n.app)==null?void 0:A.name)||"model_config";GS(n,`${k}.yaml`)},y=k=>{var O;const A=(O=k.target.files)==null?void 0:O[0];if(!A)return;const C=new FileReader;C.onload=F=>{var j;try{const T=(j=F.target)==null?void 0:j.result,I=Lv(T);$v(I),console.log("[Import] Extracted YAML references:",I);const $=sl.load(T);r($)}catch(T){console.error("Failed to parse YAML:",T),alert("Failed to parse YAML file. Please check the format.")}},C.readAsText(A),l.current&&(l.current.value="")},w=()=>{confirm("Are you sure you want to reset all configuration? This cannot be undone.")&&(zS(),a())};return s.jsxs("header",{className:"h-16 bg-slate-900 border-b border-slate-800 px-6 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg shadow-blue-500/20",children:s.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h1",{className:"text-lg font-bold text-white",children:"DAO AI Builder"}),o&&s.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-slate-700 text-slate-400 rounded",children:["v",o]})]}),s.jsx("p",{className:"text-xs text-slate-500",children:"Agent Configuration Studio"})]})]})}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(ZS,{}),s.jsx("div",{className:"w-px h-6 bg-slate-700"}),s.jsx("input",{ref:l,type:"file",accept:".yaml,.yml",onChange:y,className:"hidden"}),s.jsxs(Q,{variant:"ghost",size:"sm",onClick:()=>{var k;return(k=l.current)==null?void 0:k.click()},children:[s.jsx(lw,{className:"w-4 h-4"}),"Import"]}),s.jsxs(Q,{variant:"ghost",size:"sm",onClick:w,children:[s.jsx(nw,{className:"w-4 h-4"}),"Reset"]}),s.jsx("div",{className:"w-px h-6 bg-slate-700"}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:t,children:[e?s.jsx(K1,{className:"w-4 h-4"}):s.jsx(Z1,{className:"w-4 h-4"}),e?"Hide":"Show"," Preview"]}),s.jsxs(Q,{variant:"primary",size:"sm",onClick:g,children:[s.jsx(Ig,{className:"w-4 h-4"}),"Export YAML"]}),s.jsx("div",{className:"w-px h-6 bg-slate-700"}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>u(!0),disabled:!v,title:v?"Visualize agent graph":"Add agents to visualize",children:[s.jsx(Wl,{className:"w-4 h-4"}),"Visualize"]}),s.jsxs(Q,{variant:"secondary",size:"sm",onClick:()=>p(!0),disabled:!h,title:h?"Test agent locally":"Add agents to chat",className:"bg-gradient-to-r from-cyan-600/80 to-blue-600/80 hover:from-cyan-500 hover:to-blue-500 text-white border-0",children:[s.jsx(qs,{className:"w-4 h-4"}),"Chat"]}),s.jsxs(Q,{variant:"primary",size:"sm",onClick:()=>d(!0),disabled:!x,title:x?"Deploy to Databricks":"Configure agents and orchestration first",className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500",children:[s.jsx(Fg,{className:"w-4 h-4"}),"Deploy"]})]}),s.jsx(En,{isOpen:c,onClose:()=>u(!1),title:"Application Visualization",description:"Interactive graph showing agent relationships and orchestration flow",size:"full",children:s.jsx("div",{className:"h-[70vh]",children:s.jsx(tP,{config:n})})}),s.jsx(En,{isOpen:m,onClose:()=>d(!1),title:"Deploy to Databricks",description:"Deploy your agent configuration to a Databricks workspace",size:"lg",children:s.jsx(aP,{onClose:()=>d(!1)})}),s.jsx(En,{isOpen:f,onClose:()=>p(!1),title:"Chat with Agent",description:"Test your agent configuration locally without deploying",size:"lg",children:s.jsx(fP,{onClose:()=>p(!1)})})]})}function pP(){const[e,t]=R.useState("overview"),[n,r]=R.useState(!0),{config:a}=Oe();return s.jsxs("div",{className:"h-screen flex flex-col bg-slate-900",children:[s.jsx(hP,{showPreview:n,onTogglePreview:()=>r(!n)}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx(ow,{activeSection:e,onSectionChange:t,config:a}),s.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[s.jsx("div",{className:`flex-1 overflow-hidden ${n?"border-r border-slate-800":""}`,children:s.jsx(y_,{activeSection:e,onNavigate:t})}),n&&s.jsx("div",{className:"w-[500px] overflow-hidden",children:s.jsx(KS,{})})]})]})]})}bu.createRoot(document.getElementById("root")).render(s.jsx(Gd.StrictMode,{children:s.jsx(pP,{})}));
//# sourceMappingURL=index-dyRWL2I7.js.map
