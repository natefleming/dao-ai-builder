# yaml-language-server: $schema=https://json.schemastore.org/databricks-asset-bundles.json
# Databricks Asset Bundle configuration for DAO AI Builder
bundle:
  name: dao_ai_builder

sync:
  include:
    - app.py
    - app.yaml
    - main.py
    - requirements.txt
    - backend/**
    - static/**
    - schemas/**
  exclude:
    - frontend/**
    - node_modules/**
    - __pycache__/**
    - "*.pyc"
    - .git/**
    - .databricks/**
    - deploy.sh
    - run.sh
    - docs/**
    - README.md
    - "*.md"

targets:
  default:
    workspace:
      root_path: "/Users/${workspace.current_user.userName}/.bundle/${bundle.name}/${bundle.target}"

resources:
  apps:
    dao-ai-builder:
      name: dao-ai-builder
      description: Visual configuration studio for dao-ai agent systems
      source_code_path: .
      # App resources - allow the app's service principal to access these resources
      resources:
        - name: serving-endpoint
          serving_endpoint:
            name: databricks-claude-sonnet-4
            permission: CAN_QUERY
      # Enable on-behalf-of-user authentication
      # These scopes allow the app to access Databricks APIs on behalf of the user
      # so that resource listings reflect the user's own permissions.
      # Reference: https://docs.databricks.com/aws/en/dev-tools/databricks-apps/auth#user-authorization
      user_api_scopes:
        - sql
        - serving.serving-endpoints
        - vectorsearch.vector-search-indexes
        - vectorsearch.vector-search-endpoints
        - files.files
        - dashboards.genie
        - catalog.connections
        - catalog.catalogs:read
        - catalog.schemas:read
        - catalog.tables:read
      permissions:
        - level: CAN_USE
          group_name: users
